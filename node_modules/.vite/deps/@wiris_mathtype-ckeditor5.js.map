{
  "version": 3,
  "sources": ["../../@ckeditor/ckeditor5-utils/src/env.js", "../../@ckeditor/ckeditor5-utils/src/fastdiff.js", "../../@ckeditor/ckeditor5-utils/src/diff.js", "../../@ckeditor/ckeditor5-utils/src/spy.js", "../../@ckeditor/ckeditor5-utils/src/eventinfo.js", "../../@ckeditor/ckeditor5-utils/src/uid.js", "../../@ckeditor/ckeditor5-utils/src/priorities.js", "../../@ckeditor/ckeditor5-utils/src/inserttopriorityarray.js", "../../@ckeditor/ckeditor5-utils/src/ckeditorerror.js", "../../@ckeditor/ckeditor5-utils/src/version.js", "../../@ckeditor/ckeditor5-utils/src/emittermixin.js", "../../@ckeditor/ckeditor5-utils/src/observablemixin.js", "../../@ckeditor/ckeditor5-utils/src/count.js", "../../@ckeditor/ckeditor5-utils/src/comparearrays.js", "../../@ckeditor/ckeditor5-utils/src/isiterable.js", "../../@ckeditor/ckeditor5-utils/src/dom/isnode.js", "../../@ckeditor/ckeditor5-utils/src/dom/iswindow.js", "../../@ckeditor/ckeditor5-utils/src/dom/emittermixin.js", "../../@ckeditor/ckeditor5-utils/src/dom/global.js", "../../@ckeditor/ckeditor5-utils/src/dom/getancestors.js", "../../@ckeditor/ckeditor5-utils/src/dom/istext.js", "../../@ckeditor/ckeditor5-utils/src/dom/resizeobserver.js", "../../@ckeditor/ckeditor5-utils/src/dom/indexof.js", "../../@ckeditor/ckeditor5-utils/src/dom/iscomment.js", "../../@ckeditor/ckeditor5-utils/src/dom/isvalidattributename.js", "../../@ckeditor/ckeditor5-utils/src/keyboard.js", "../../@ckeditor/ckeditor5-utils/src/toarray.js", "../../@ckeditor/ckeditor5-utils/src/translation-service.js", "../../@ckeditor/ckeditor5-utils/src/collection.js", "../../@ckeditor/ckeditor5-utils/src/first.js", "../../@ckeditor/ckeditor5-utils/src/focustracker.js", "../../@ckeditor/ckeditor5-utils/src/objecttomap.js", "../../@ckeditor/ckeditor5-utils/src/tomap.js", "../../@ckeditor/ckeditor5-utils/src/delay.js", "../../@ckeditor/ckeditor5-utils/src/unicode.js", "../../@ckeditor/ckeditor5-ui/src/viewcollection.js", "../../@ckeditor/ckeditor5-ui/src/template.js", "../../@ckeditor/ckeditor5-ui/src/view.js", "../../@ckeditor/ckeditor5-ui/src/icon/iconview.js", "../../@ckeditor/ckeditor5-ui/src/button/buttonlabelview.js", "../../@ckeditor/ckeditor5-ui/src/button/buttonview.js", "../../@ckeditor/ckeditor5-engine/src/view/observer/observer.js", "../../@ckeditor/ckeditor5-engine/src/view/observer/domeventdata.js", "../../@ckeditor/ckeditor5-engine/src/view/observer/domeventobserver.js", "../../@ckeditor/ckeditor5-engine/src/view/observer/clickobserver.js", "../../@ckeditor/ckeditor5-engine/src/dataprocessor/basichtmlwriter.js", "../../@ckeditor/ckeditor5-engine/src/view/typecheckable.js", "../../@ckeditor/ckeditor5-engine/src/view/node.js", "../../@ckeditor/ckeditor5-engine/src/view/text.js", "../../@ckeditor/ckeditor5-engine/src/view/textproxy.js", "../../@ckeditor/ckeditor5-engine/src/view/matcher.js", "../../@ckeditor/ckeditor5-engine/src/view/stylesmap.js", "../../@ckeditor/ckeditor5-engine/src/view/element.js", "../../@ckeditor/ckeditor5-engine/src/view/uielement.js", "../../@ckeditor/ckeditor5-engine/src/view/containerelement.js", "../../@ckeditor/ckeditor5-engine/src/view/editableelement.js", "../../@ckeditor/ckeditor5-engine/src/view/treewalker.js", "../../@ckeditor/ckeditor5-engine/src/view/position.js", "../../@ckeditor/ckeditor5-engine/src/view/range.js", "../../@ckeditor/ckeditor5-engine/src/view/documentselection.js", "../../@ckeditor/ckeditor5-engine/src/view/selection.js", "../../@ckeditor/ckeditor5-engine/src/view/documentfragment.js", "../../@ckeditor/ckeditor5-engine/src/view/filler.js", "../../@ckeditor/ckeditor5-engine/src/view/domconverter.js", "../../@ckeditor/ckeditor5-engine/src/dataprocessor/htmldataprocessor.js", "../../@ckeditor/ckeditor5-engine/src/dataprocessor/xmldataprocessor.js", "../../@ckeditor/ckeditor5-engine/src/view/upcastwriter.js", "../../dompurify/src/utils.js", "../../dompurify/src/tags.js", "../../dompurify/src/attrs.js", "../../dompurify/src/regexp.js", "../../dompurify/src/purify.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/constants.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/mathml.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/configuration.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/textcache.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/listeners.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/serviceprovider.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/latex.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/lang/strings.json", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/stringmanager.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/util.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/image.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/accessibility.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/md5.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/parser.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/editorlistener.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/telemeter-wasm/telemeter_wasm.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/telemeter.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/contentmanager.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/customeditors.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/jsvariables.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/event.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/popupmessage.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/modal.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/polyfills.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/core.src.js", "../../@wiris/mathtype-ckeditor5/node_modules/@wiris/mathtype-html-integration-devkit/src/integrationmodel.js", "../../@wiris/mathtype-ckeditor5/src/integration.js", "../../@wiris/mathtype-ckeditor5/src/commands.js", "../../@wiris/mathtype-ckeditor5/src/plugin.js", "../../@wiris/mathtype-ckeditor5/package.json"],
  "sourcesContent": ["/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* globals navigator:false */\n/**\n * @module utils/env\n */\n/**\n * Safely returns `userAgent` from browser's navigator API in a lower case.\n * If navigator API is not available it will return an empty string.\n */\nexport function getUserAgent() {\n    // In some environments navigator API might not be available.\n    try {\n        return navigator.userAgent.toLowerCase();\n    }\n    catch (e) {\n        return '';\n    }\n}\nconst userAgent = getUserAgent();\n/**\n * A namespace containing environment and browser information.\n */\nconst env = {\n    isMac: isMac(userAgent),\n    isWindows: isWindows(userAgent),\n    isGecko: isGecko(userAgent),\n    isSafari: isSafari(userAgent),\n    isiOS: isiOS(userAgent),\n    isAndroid: isAndroid(userAgent),\n    isBlink: isBlink(userAgent),\n    features: {\n        isRegExpUnicodePropertySupported: isRegExpUnicodePropertySupported()\n    }\n};\nexport default env;\n/**\n * Checks if User Agent represented by the string is running on Macintosh.\n *\n * @param userAgent **Lowercase** `navigator.userAgent` string.\n * @returns Whether User Agent is running on Macintosh or not.\n */\nexport function isMac(userAgent) {\n    return userAgent.indexOf('macintosh') > -1;\n}\n/**\n * Checks if User Agent represented by the string is running on Windows.\n *\n * @param userAgent **Lowercase** `navigator.userAgent` string.\n * @returns Whether User Agent is running on Windows or not.\n */\nexport function isWindows(userAgent) {\n    return userAgent.indexOf('windows') > -1;\n}\n/**\n * Checks if User Agent represented by the string is Firefox (Gecko).\n *\n * @param userAgent **Lowercase** `navigator.userAgent` string.\n * @returns Whether User Agent is Firefox or not.\n */\nexport function isGecko(userAgent) {\n    return !!userAgent.match(/gecko\\/\\d+/);\n}\n/**\n * Checks if User Agent represented by the string is Safari.\n *\n * @param userAgent **Lowercase** `navigator.userAgent` string.\n * @returns Whether User Agent is Safari or not.\n */\nexport function isSafari(userAgent) {\n    return userAgent.indexOf(' applewebkit/') > -1 && userAgent.indexOf('chrome') === -1;\n}\n/**\n * Checks if User Agent represented by the string is running in iOS.\n *\n * @param userAgent **Lowercase** `navigator.userAgent` string.\n * @returns Whether User Agent is running in iOS or not.\n */\nexport function isiOS(userAgent) {\n    // \"Request mobile site\" || \"Request desktop site\".\n    return !!userAgent.match(/iphone|ipad/i) || (isMac(userAgent) && navigator.maxTouchPoints > 0);\n}\n/**\n * Checks if User Agent represented by the string is Android mobile device.\n *\n * @param userAgent **Lowercase** `navigator.userAgent` string.\n * @returns Whether User Agent is Safari or not.\n */\nexport function isAndroid(userAgent) {\n    return userAgent.indexOf('android') > -1;\n}\n/**\n * Checks if User Agent represented by the string is Blink engine.\n *\n * @param userAgent **Lowercase** `navigator.userAgent` string.\n * @returns Whether User Agent is Blink engine or not.\n */\nexport function isBlink(userAgent) {\n    // The Edge browser before switching to the Blink engine used to report itself as Chrome (and \"Edge/\")\n    // but after switching to the Blink it replaced \"Edge/\" with \"Edg/\".\n    return userAgent.indexOf('chrome/') > -1 && userAgent.indexOf('edge/') < 0;\n}\n/**\n * Checks if the current environment supports ES2018 Unicode properties like `\\p{P}` or `\\p{L}`.\n * More information about unicode properties might be found\n * [in Unicode Standard Annex #44](https://www.unicode.org/reports/tr44/#GC_Values_Table).\n */\nexport function isRegExpUnicodePropertySupported() {\n    let isSupported = false;\n    // Feature detection for Unicode properties. Added in ES2018. Currently Firefox does not support it.\n    // See https://github.com/ckeditor/ckeditor5-mention/issues/44#issuecomment-487002174.\n    try {\n        // Usage of regular expression literal cause error during build (ckeditor/ckeditor5-dev#534).\n        isSupported = 'ć'.search(new RegExp('[\\\\p{L}]', 'u')) === 0;\n    }\n    catch (error) {\n        // Firefox throws a SyntaxError when the group is unsupported.\n    }\n    return isSupported;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/fastdiff\n */\n/**\n * Finds positions of the first and last change in the given string/array and generates a set of changes:\n *\n * ```ts\n * fastDiff( '12a', '12xyza' );\n * // [ { index: 2, type: 'insert', values: [ 'x', 'y', 'z' ] } ]\n *\n * fastDiff( '12a', '12aa' );\n * // [ { index: 3, type: 'insert', values: [ 'a' ] } ]\n *\n * fastDiff( '12xyza', '12a' );\n * // [ { index: 2, type: 'delete', howMany: 3 } ]\n *\n * fastDiff( [ '1', '2', 'a', 'a' ], [ '1', '2', 'a' ] );\n * // [ { index: 3, type: 'delete', howMany: 1 } ]\n *\n * fastDiff( [ '1', '2', 'a', 'b', 'c', '3' ], [ '2', 'a', 'b' ] );\n * // [ { index: 0, type: 'insert', values: [ '2', 'a', 'b' ] }, { index: 3, type: 'delete', howMany: 6 } ]\n * ```\n *\n * Passed arrays can contain any type of data, however to compare them correctly custom comparator function\n * should be passed as a third parameter:\n *\n * ```ts\n * fastDiff( [ { value: 1 }, { value: 2 } ], [ { value: 1 }, { value: 3 } ], ( a, b ) => {\n * \treturn a.value === b.value;\n * } );\n * // [ { index: 1, type: 'insert', values: [ { value: 3 } ] }, { index: 2, type: 'delete', howMany: 1 } ]\n * ```\n *\n * The resulted set of changes can be applied to the input in order to transform it into the output, for example:\n *\n * ```ts\n * let input = '12abc3';\n * const output = '2ab';\n * const changes = fastDiff( input, output );\n *\n * changes.forEach( change => {\n * \tif ( change.type == 'insert' ) {\n * \t\tinput = input.substring( 0, change.index ) + change.values.join( '' ) + input.substring( change.index );\n * \t} else if ( change.type == 'delete' ) {\n * \t\tinput = input.substring( 0, change.index ) + input.substring( change.index + change.howMany );\n * \t}\n * } );\n *\n * // input equals output now\n * ```\n *\n * or in case of arrays:\n *\n * ```ts\n * let input = [ '1', '2', 'a', 'b', 'c', '3' ];\n * const output = [ '2', 'a', 'b' ];\n * const changes = fastDiff( input, output );\n *\n * changes.forEach( change => {\n * \tif ( change.type == 'insert' ) {\n * \t\tinput = input.slice( 0, change.index ).concat( change.values, input.slice( change.index ) );\n * \t} else if ( change.type == 'delete' ) {\n * \t\tinput = input.slice( 0, change.index ).concat( input.slice( change.index + change.howMany ) );\n * \t}\n * } );\n *\n * // input equals output now\n * ```\n *\n * By passing `true` as the fourth parameter (`atomicChanges`) the output of this function will become compatible with\n * the {@link module:utils/diff~diff `diff()`} function:\n *\n * ```ts\n * fastDiff( '12a', '12xyza', undefined, true );\n * // [ 'equal', 'equal', 'insert', 'insert', 'insert', 'equal' ]\n * ```\n *\n * The default output format of this function is compatible with the output format of\n * {@link module:utils/difftochanges~diffToChanges `diffToChanges()`}. The `diffToChanges()` input format is, in turn,\n * compatible with the output of {@link module:utils/diff~diff `diff()`}:\n *\n * ```ts\n * const a = '1234';\n * const b = '12xyz34';\n *\n * // Both calls will return the same results (grouped changes format).\n * fastDiff( a, b );\n * diffToChanges( diff( a, b ) );\n *\n * // Again, both calls will return the same results (atomic changes format).\n * fastDiff( a, b, undefined, true );\n * diff( a, b );\n * ```\n *\n * @typeParam T The type of array elements.\n * @typeParam AtomicChanges The type of `atomicChanges` parameter (selects the result type).\n * @param a Input array or string.\n * @param b Input array or string.\n * @param cmp Optional function used to compare array values, by default `===` (strict equal operator) is used.\n * @param atomicChanges Whether an array of `inset|delete|equal` operations should\n * be returned instead of changes set. This makes this function compatible with {@link module:utils/diff~diff `diff()`}.\n * Defaults to `false`.\n * @returns Array of changes. The elements are either {@link module:utils/diff~DiffResult} or {@link module:utils/difftochanges~Change},\n * depending on `atomicChanges` parameter.\n */\nexport default function fastDiff(a, b, cmp, atomicChanges) {\n    // Set the comparator function.\n    cmp = cmp || function (a, b) {\n        return a === b;\n    };\n    // Convert the string (or any array-like object - eg. NodeList) to an array by using the slice() method because,\n    // unlike Array.from(), it returns array of UTF-16 code units instead of the code points of a string.\n    // One code point might be a surrogate pair of two code units. All text offsets are expected to be in code units.\n    // See ckeditor/ckeditor5#3147.\n    //\n    // We need to make sure here that fastDiff() works identical to diff().\n    const arrayA = Array.isArray(a) ? a : Array.prototype.slice.call(a);\n    const arrayB = Array.isArray(b) ? b : Array.prototype.slice.call(b);\n    // Find first and last change.\n    const changeIndexes = findChangeBoundaryIndexes(arrayA, arrayB, cmp);\n    // Transform into changes array.\n    const result = atomicChanges ?\n        changeIndexesToAtomicChanges(changeIndexes, arrayB.length) :\n        changeIndexesToChanges(arrayB, changeIndexes);\n    return result;\n}\n/**\n * Finds position of the first and last change in the given arrays. For example:\n *\n * ```ts\n * const indexes = findChangeBoundaryIndexes( [ '1', '2', '3', '4' ], [ '1', '3', '4', '2', '4' ] );\n * console.log( indexes ); // { firstIndex: 1, lastIndexOld: 3, lastIndexNew: 4 }\n * ```\n *\n * The above indexes means that in the first array the modified part is `1[23]4` and in the second array it is `1[342]4`.\n * Based on such indexes, array with `insert`/`delete` operations which allows transforming first value into the second one\n * can be generated.\n */\nfunction findChangeBoundaryIndexes(arr1, arr2, cmp) {\n    // Find the first difference between passed values.\n    const firstIndex = findFirstDifferenceIndex(arr1, arr2, cmp);\n    // If arrays are equal return -1 indexes object.\n    if (firstIndex === -1) {\n        return { firstIndex: -1, lastIndexOld: -1, lastIndexNew: -1 };\n    }\n    // Remove the common part of each value and reverse them to make it simpler to find the last difference between them.\n    const oldArrayReversed = cutAndReverse(arr1, firstIndex);\n    const newArrayReversed = cutAndReverse(arr2, firstIndex);\n    // Find the first difference between reversed values.\n    // It should be treated as \"how many elements from the end the last difference occurred\".\n    //\n    // For example:\n    //\n    // \t\t\t\tinitial\t->\tafter cut\t-> reversed:\n    // oldValue:\t'321ba'\t->\t'21ba'\t\t-> 'ab12'\n    // newValue:\t'31xba'\t->\t'1xba'\t\t-> 'abx1'\n    // lastIndex:\t\t\t\t\t\t\t-> 2\n    //\n    // So the last change occurred two characters from the end of the arrays.\n    const lastIndex = findFirstDifferenceIndex(oldArrayReversed, newArrayReversed, cmp);\n    // Use `lastIndex` to calculate proper offset, starting from the beginning (`lastIndex` kind of starts from the end).\n    const lastIndexOld = arr1.length - lastIndex;\n    const lastIndexNew = arr2.length - lastIndex;\n    return { firstIndex, lastIndexOld, lastIndexNew };\n}\n/**\n * Returns a first index on which given arrays differ. If both arrays are the same, -1 is returned.\n */\nfunction findFirstDifferenceIndex(arr1, arr2, cmp) {\n    for (let i = 0; i < Math.max(arr1.length, arr2.length); i++) {\n        if (arr1[i] === undefined || arr2[i] === undefined || !cmp(arr1[i], arr2[i])) {\n            return i;\n        }\n    }\n    return -1; // Return -1 if arrays are equal.\n}\n/**\n * Returns a copy of the given array with `howMany` elements removed starting from the beginning and in reversed order.\n *\n * @param arr Array to be processed.\n * @param howMany How many elements from array beginning to remove.\n * @returns Shortened and reversed array.\n */\nfunction cutAndReverse(arr, howMany) {\n    return arr.slice(howMany).reverse();\n}\n/**\n * Generates changes array based on change indexes from `findChangeBoundaryIndexes` function. This function will\n * generate array with 0 (no changes), 1 (deletion or insertion) or 2 records (insertion and deletion).\n *\n * @param newArray New array for which change indexes were calculated.\n * @param changeIndexes Change indexes object from `findChangeBoundaryIndexes` function.\n * @returns Array of changes compatible with {@link module:utils/difftochanges~diffToChanges} format.\n */\nfunction changeIndexesToChanges(newArray, changeIndexes) {\n    const result = [];\n    const { firstIndex, lastIndexOld, lastIndexNew } = changeIndexes;\n    // Order operations as 'insert', 'delete' array to keep compatibility with {@link module:utils/difftochanges~diffToChanges}\n    // in most cases. However, 'diffToChanges' does not stick to any order so in some cases\n    // (for example replacing '12345' with 'abcd') it will generate 'delete', 'insert' order.\n    if (lastIndexNew - firstIndex > 0) {\n        result.push({\n            index: firstIndex,\n            type: 'insert',\n            values: newArray.slice(firstIndex, lastIndexNew)\n        });\n    }\n    if (lastIndexOld - firstIndex > 0) {\n        result.push({\n            index: firstIndex + (lastIndexNew - firstIndex),\n            type: 'delete',\n            howMany: lastIndexOld - firstIndex\n        });\n    }\n    return result;\n}\n/**\n * Generates array with set `equal|insert|delete` operations based on change indexes from `findChangeBoundaryIndexes` function.\n *\n * @param changeIndexes Change indexes object from `findChangeBoundaryIndexes` function.\n * @param newLength Length of the new array on which `findChangeBoundaryIndexes` calculated change indexes.\n * @returns Array of changes compatible with {@link module:utils/diff~diff} format.\n */\nfunction changeIndexesToAtomicChanges(changeIndexes, newLength) {\n    const { firstIndex, lastIndexOld, lastIndexNew } = changeIndexes;\n    // No changes.\n    if (firstIndex === -1) {\n        return Array(newLength).fill('equal');\n    }\n    let result = [];\n    if (firstIndex > 0) {\n        result = result.concat(Array(firstIndex).fill('equal'));\n    }\n    if (lastIndexNew - firstIndex > 0) {\n        result = result.concat(Array(lastIndexNew - firstIndex).fill('insert'));\n    }\n    if (lastIndexOld - firstIndex > 0) {\n        result = result.concat(Array(lastIndexOld - firstIndex).fill('delete'));\n    }\n    if (lastIndexNew < newLength) {\n        result = result.concat(Array(newLength - lastIndexNew).fill('equal'));\n    }\n    return result;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/diff\n */\nimport fastDiff from './fastdiff.js';\n// The following code is based on the \"O(NP) Sequence Comparison Algorithm\"\n// by Sun Wu, Udi Manber, Gene Myers, Webb Miller.\n/**\n * Calculates the difference between two arrays or strings producing an array containing a list of changes\n * necessary to transform input into output.\n *\n * ```ts\n * diff( 'aba', 'acca' ); // [ 'equal', 'insert', 'insert', 'delete', 'equal' ]\n * ```\n *\n * This function is based on the \"O(NP) Sequence Comparison Algorithm\" by Sun Wu, Udi Manber, Gene Myers, Webb Miller.\n * Unfortunately, while it gives the most precise results, its to complex for longer strings/arrow (above 200 items).\n * Therefore, `diff()` automatically switches to {@link module:utils/fastdiff~fastDiff `fastDiff()`} when detecting\n * such a scenario. The return formats of both functions are identical.\n *\n * @param a Input array or string.\n * @param b Output array or string.\n * @param cmp Optional function used to compare array values, by default === is used.\n * @returns Array of changes.\n */\nexport default function diff(a, b, cmp) {\n    // Set the comparator function.\n    cmp = cmp || function (a, b) {\n        return a === b;\n    };\n    const aLength = a.length;\n    const bLength = b.length;\n    // Perform `fastDiff` for longer strings/arrays (see #269).\n    if (aLength > 200 || bLength > 200 || aLength + bLength > 300) {\n        return diff.fastDiff(a, b, cmp, true);\n    }\n    // Temporary action type statics.\n    let _insert, _delete;\n    // Swapped the arrays to use the shorter one as the first one.\n    if (bLength < aLength) {\n        const tmp = a;\n        a = b;\n        b = tmp;\n        // We swap the action types as well.\n        _insert = 'delete';\n        _delete = 'insert';\n    }\n    else {\n        _insert = 'insert';\n        _delete = 'delete';\n    }\n    const m = a.length;\n    const n = b.length;\n    const delta = n - m;\n    // Edit scripts, for each diagonal.\n    const es = {};\n    // Furthest points, the furthest y we can get on each diagonal.\n    const fp = {};\n    function snake(k) {\n        // We use -1 as an alternative below to handle initial values ( instead of filling the fp with -1 first ).\n        // Furthest points (y) on the diagonal below k.\n        const y1 = (fp[k - 1] !== undefined ? fp[k - 1] : -1) + 1;\n        // Furthest points (y) on the diagonal above k.\n        const y2 = fp[k + 1] !== undefined ? fp[k + 1] : -1;\n        // The way we should go to get further.\n        const dir = y1 > y2 ? -1 : 1;\n        // Clone previous changes array (if any).\n        if (es[k + dir]) {\n            es[k] = es[k + dir].slice(0);\n        }\n        // Create changes array.\n        if (!es[k]) {\n            es[k] = [];\n        }\n        // Push the action.\n        es[k].push(y1 > y2 ? _insert : _delete);\n        // Set the beginning coordinates.\n        let y = Math.max(y1, y2);\n        let x = y - k;\n        // Traverse the diagonal as long as the values match.\n        while (x < m && y < n && cmp(a[x], b[y])) {\n            x++;\n            y++;\n            // Push no change action.\n            es[k].push('equal');\n        }\n        return y;\n    }\n    let p = 0;\n    let k;\n    // Traverse the graph until we reach the end of the longer string.\n    do {\n        // Updates furthest points and edit scripts for diagonals below delta.\n        for (k = -p; k < delta; k++) {\n            fp[k] = snake(k);\n        }\n        // Updates furthest points and edit scripts for diagonals above delta.\n        for (k = delta + p; k > delta; k--) {\n            fp[k] = snake(k);\n        }\n        // Updates furthest point and edit script for the delta diagonal.\n        // note that the delta diagonal is the one which goes through the sink (m, n).\n        fp[delta] = snake(delta);\n        p++;\n    } while (fp[delta] !== n);\n    // Return the final list of edit changes.\n    // We remove the first item that represents the action for the injected nulls.\n    return es[delta].slice(1);\n}\n// Store the API in static property to easily overwrite it in tests.\n// Too bad dependency injection does not work in Webpack + ES 6 (const) + Babel.\ndiff.fastDiff = fastDiff;\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/spy\n */\n/**\n * Creates a spy function (ala Sinon.js) that can be used to inspect call to it.\n *\n * The following are the present features:\n *\n * * spy.called: property set to `true` if the function has been called at least once.\n *\n * @returns The spy function.\n */\nfunction spy() {\n    return function spy() {\n        spy.called = true;\n    };\n}\nexport default spy;\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/eventinfo\n */\nimport spy from './spy.js';\n/**\n * The event object passed to event callbacks. It is used to provide information about the event as well as a tool to\n * manipulate it.\n */\nexport default class EventInfo {\n    /**\n     * @param source The emitter.\n     * @param name The event name.\n     */\n    constructor(source, name) {\n        this.source = source;\n        this.name = name;\n        this.path = [];\n        // The following methods are defined in the constructor because they must be re-created per instance.\n        this.stop = spy();\n        this.off = spy();\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/uid\n */\n/**\n * A hash table of hex numbers to avoid using toString() in uid() which is costly.\n * [ '00', '01', '02', ..., 'fe', 'ff' ]\n */\nconst HEX_NUMBERS = new Array(256).fill('')\n    .map((_, index) => ('0' + (index).toString(16)).slice(-2));\n/**\n * Returns a unique id. The id starts with an \"e\" character and a randomly generated string of\n * 32 alphanumeric characters.\n *\n * **Note**: The characters the unique id is built from correspond to the hex number notation\n * (from \"0\" to \"9\", from \"a\" to \"f\"). In other words, each id corresponds to an \"e\" followed\n * by 16 8-bit numbers next to each other.\n *\n * @returns An unique id string.\n */\nexport default function uid() {\n    // Let's create some positive random 32bit integers first.\n    //\n    // 1. Math.random() is a float between 0 and 1.\n    // 2. 0x100000000 is 2^32 = 4294967296.\n    // 3. >>> 0 enforces integer (in JS all numbers are floating point).\n    //\n    // For instance:\n    //\t\tMath.random() * 0x100000000 = 3366450031.853859\n    // but\n    //\t\tMath.random() * 0x100000000 >>> 0 = 3366450031.\n    const r1 = Math.random() * 0x100000000 >>> 0;\n    const r2 = Math.random() * 0x100000000 >>> 0;\n    const r3 = Math.random() * 0x100000000 >>> 0;\n    const r4 = Math.random() * 0x100000000 >>> 0;\n    // Make sure that id does not start with number.\n    return 'e' +\n        HEX_NUMBERS[r1 >> 0 & 0xFF] +\n        HEX_NUMBERS[r1 >> 8 & 0xFF] +\n        HEX_NUMBERS[r1 >> 16 & 0xFF] +\n        HEX_NUMBERS[r1 >> 24 & 0xFF] +\n        HEX_NUMBERS[r2 >> 0 & 0xFF] +\n        HEX_NUMBERS[r2 >> 8 & 0xFF] +\n        HEX_NUMBERS[r2 >> 16 & 0xFF] +\n        HEX_NUMBERS[r2 >> 24 & 0xFF] +\n        HEX_NUMBERS[r3 >> 0 & 0xFF] +\n        HEX_NUMBERS[r3 >> 8 & 0xFF] +\n        HEX_NUMBERS[r3 >> 16 & 0xFF] +\n        HEX_NUMBERS[r3 >> 24 & 0xFF] +\n        HEX_NUMBERS[r4 >> 0 & 0xFF] +\n        HEX_NUMBERS[r4 >> 8 & 0xFF] +\n        HEX_NUMBERS[r4 >> 16 & 0xFF] +\n        HEX_NUMBERS[r4 >> 24 & 0xFF];\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * Provides group of constants to use instead of hardcoding numeric priority values.\n */\nconst priorities = {\n    get(priority = 'normal') {\n        if (typeof priority != 'number') {\n            return this[priority] || this.normal;\n        }\n        else {\n            return priority;\n        }\n    },\n    highest: 100000,\n    high: 1000,\n    normal: 0,\n    low: -1000,\n    lowest: -100000\n};\nexport default priorities;\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\nimport priorities from './priorities.js';\n/**\n * Inserts any object with priority at correct index by priority so registered objects are always sorted from highest to lowest priority.\n *\n * @param objects Array of objects with priority to insert object to.\n * @param objectToInsert Object with `priority` property.\n */\nexport default function insertToPriorityArray(objects, objectToInsert) {\n    const priority = priorities.get(objectToInsert.priority);\n    for (let i = 0; i < objects.length; i++) {\n        if (priorities.get(objects[i].priority) < priority) {\n            objects.splice(i, 0, objectToInsert);\n            return;\n        }\n    }\n    objects.push(objectToInsert);\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/ckeditorerror\n */\n/* globals console */\n/**\n * URL to the documentation with error codes.\n */\nexport const DOCUMENTATION_URL = 'https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html';\n/**\n * The CKEditor error class.\n *\n * You should throw `CKEditorError` when:\n *\n * * An unexpected situation occurred and the editor (most probably) will not work properly. Such exception will be handled\n * by the {@link module:watchdog/watchdog~Watchdog watchdog} (if it is integrated),\n * * If the editor is incorrectly integrated or the editor API is used in the wrong way. This way you will give\n * feedback to the developer as soon as possible. Keep in mind that for common integration issues which should not\n * stop editor initialization (like missing upload adapter, wrong name of a toolbar component) we use\n * {@link module:utils/ckeditorerror~logWarning `logWarning()`} and\n * {@link module:utils/ckeditorerror~logError `logError()`}\n * to improve developers experience and let them see the a working editor as soon as possible.\n *\n * ```ts\n * /**\n *  * Error thrown when a plugin cannot be loaded due to JavaScript errors, lack of plugins with a given name, etc.\n *  *\n *  * @error plugin-load\n *  * @param pluginName The name of the plugin that could not be loaded.\n *  * @param moduleName The name of the module which tried to load this plugin.\n *  *\\/\n * throw new CKEditorError( 'plugin-load', {\n * \tpluginName: 'foo',\n * \tmoduleName: 'bar'\n * } );\n * ```\n */\nexport default class CKEditorError extends Error {\n    /**\n     * Creates an instance of the CKEditorError class.\n     *\n     * @param errorName The error id in an `error-name` format. A link to this error documentation page will be added\n     * to the thrown error's `message`.\n     * @param context A context of the error by which the {@link module:watchdog/watchdog~Watchdog watchdog}\n     * is able to determine which editor crashed. It should be an editor instance or a property connected to it. It can be also\n     * a `null` value if the editor should not be restarted in case of the error (e.g. during the editor initialization).\n     * The error context should be checked using the `areConnectedThroughProperties( editor, context )` utility\n     * to check if the object works as the context.\n     * @param data Additional data describing the error. A stringified version of this object\n     * will be appended to the error message, so the data are quickly visible in the console. The original\n     * data object will also be later available under the {@link #data} property.\n     */\n    constructor(errorName, context, data) {\n        super(getErrorMessage(errorName, data));\n        this.name = 'CKEditorError';\n        this.context = context;\n        this.data = data;\n    }\n    /**\n     * Checks if the error is of the `CKEditorError` type.\n     */\n    is(type) {\n        return type === 'CKEditorError';\n    }\n    /**\n     * A utility that ensures that the thrown error is a {@link module:utils/ckeditorerror~CKEditorError} one.\n     * It is useful when combined with the {@link module:watchdog/watchdog~Watchdog} feature, which can restart the editor in case\n     * of a {@link module:utils/ckeditorerror~CKEditorError} error.\n     *\n     * @param err The error to rethrow.\n     * @param context An object connected through properties with the editor instance. This context will be used\n     * by the watchdog to verify which editor should be restarted.\n     */\n    static rethrowUnexpectedError(err, context) {\n        if (err.is && err.is('CKEditorError')) {\n            throw err;\n        }\n        /**\n         * An unexpected error occurred inside the CKEditor 5 codebase. This error will look like the original one\n         * to make the debugging easier.\n         *\n         * This error is only useful when the editor is initialized using the {@link module:watchdog/watchdog~Watchdog} feature.\n         * In case of such error (or any {@link module:utils/ckeditorerror~CKEditorError} error) the watchdog should restart the editor.\n         *\n         * @error unexpected-error\n         */\n        const error = new CKEditorError(err.message, context);\n        // Restore the original stack trace to make the error look like the original one.\n        // See https://github.com/ckeditor/ckeditor5/issues/5595 for more details.\n        error.stack = err.stack;\n        throw error;\n    }\n}\n/**\n * Logs a warning to the console with a properly formatted message and adds a link to the documentation.\n * Use whenever you want to log a warning to the console.\n *\n * ```ts\n * /**\n *  * There was a problem processing the configuration of the toolbar. The item with the given\n *  * name does not exist, so it was omitted when rendering the toolbar.\n *  *\n *  * @error toolbarview-item-unavailable\n *  * @param {String} name The name of the component.\n *  *\\/\n * logWarning( 'toolbarview-item-unavailable', { name } );\n * ```\n *\n * See also {@link module:utils/ckeditorerror~CKEditorError} for an explanation when to throw an error and when to log\n * a warning or an error to the console.\n *\n * @param errorName The error name to be logged.\n * @param data Additional data to be logged.\n */\nexport function logWarning(errorName, data) {\n    console.warn(...formatConsoleArguments(errorName, data));\n}\n/**\n * Logs an error to the console with a properly formatted message and adds a link to the documentation.\n * Use whenever you want to log an error to the console.\n *\n * ```ts\n * /**\n *  * There was a problem processing the configuration of the toolbar. The item with the given\n *  * name does not exist, so it was omitted when rendering the toolbar.\n *  *\n *  * @error toolbarview-item-unavailable\n *  * @param {String} name The name of the component.\n *  *\\/\n *  logError( 'toolbarview-item-unavailable', { name } );\n * ```\n *\n * **Note**: In most cases logging a warning using {@link module:utils/ckeditorerror~logWarning} is enough.\n *\n * See also {@link module:utils/ckeditorerror~CKEditorError} for an explanation when to use each method.\n *\n * @param errorName The error name to be logged.\n * @param data Additional data to be logged.\n */\nexport function logError(errorName, data) {\n    console.error(...formatConsoleArguments(errorName, data));\n}\n/**\n * Returns formatted link to documentation message.\n */\nfunction getLinkToDocumentationMessage(errorName) {\n    return `\\nRead more: ${DOCUMENTATION_URL}#error-${errorName}`;\n}\n/**\n * Returns formatted error message.\n */\nfunction getErrorMessage(errorName, data) {\n    const processedObjects = new WeakSet();\n    const circularReferencesReplacer = (key, value) => {\n        if (typeof value === 'object' && value !== null) {\n            if (processedObjects.has(value)) {\n                return `[object ${value.constructor.name}]`;\n            }\n            processedObjects.add(value);\n        }\n        return value;\n    };\n    const stringifiedData = data ? ` ${JSON.stringify(data, circularReferencesReplacer)}` : '';\n    const documentationLink = getLinkToDocumentationMessage(errorName);\n    return errorName + stringifiedData + documentationLink;\n}\n/**\n * Returns formatted console error arguments.\n */\nfunction formatConsoleArguments(errorName, data) {\n    const documentationMessage = getLinkToDocumentationMessage(errorName);\n    return data ? [errorName, data, documentationMessage] : [errorName, documentationMessage];\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/version\n */\nimport CKEditorError from './ckeditorerror.js';\nconst version = '41.1.0';\nexport default version;\n// The second argument is not a month. It is `monthIndex` and starts from `0`.\nexport const releaseDate = new Date(2024, 1, 7);\n/* istanbul ignore next -- @preserve */\nif (globalThis.CKEDITOR_VERSION) {\n    /**\n     * This error is thrown when due to a mistake in how CKEditor 5 was installed or initialized, some\n     * of its modules were duplicated (evaluated and executed twice). Module duplication leads to inevitable runtime\n     * errors.\n     *\n     * There are many situations in which some modules can be loaded twice. In the worst case scenario,\n     * you may need to check your project for each of these issues and fix them all.\n     *\n     * # Trying to add a plugin to an existing build\n     *\n     * If you import an existing CKEditor 5 build and a plugin like this:\n     *\n     * ```ts\n     * import ClassicEditor from '@ckeditor/ckeditor5-build-classic';\n     * import Highlight from '@ckeditor/ckeditor5-highlight/src/highlight';\n     * ```\n     *\n     * Then your project loads some CKEditor 5 packages twice. How does it happen?\n     *\n     * The build package contains a file which is already compiled with webpack. This means\n     * that it contains all the necessary code from e.g. `@ckeditor/ckeditor5-engine` and `@ckeditor/ckeditor5-utils`.\n     *\n     * However, the `Highlight` plugin imports some of the modules from these packages, too. If you ask webpack to\n     * build such a project, you will end up with the modules being included (and run) twice &ndash; first, because they are\n     * included inside the build package, and second, because they are required by the `Highlight` plugin.\n     *\n     * Therefore, **you must never add plugins to an existing build** unless your plugin has no dependencies.\n     *\n     * Adding plugins to a build is done by taking the source version of this build (so, before it was built with webpack)\n     * and adding plugins there. In this situation, webpack will know that it only needs to load each plugin once.\n     *\n     * Read more in the {@glink installation/plugins/installing-plugins Installing plugins} guide.\n     *\n     * # Confused an editor build with an editor implementation\n     *\n     * This scenario is very similar to the previous one, but has a different origin.\n     *\n     * Let's assume that you wanted to use CKEditor 5 from source, as explained in the\n     * {@glink installation/advanced/alternative-setups/integrating-from-source-webpack \"Building from source\"} section\n     * or in the {@glink framework/quick-start \"Quick start\"} guide of CKEditor 5 Framework.\n     *\n     * The correct way to do so is to import an editor and plugins and run them together like this:\n     *\n     * ```ts\n     * import ClassicEditor from '@ckeditor/ckeditor5-editor-classic/src/classiceditor';\n     * import Essentials from '@ckeditor/ckeditor5-essentials/src/essentials';\n     * import Paragraph from '@ckeditor/ckeditor5-paragraph/src/paragraph';\n     * import Bold from '@ckeditor/ckeditor5-basic-styles/src/bold';\n     * import Italic from '@ckeditor/ckeditor5-basic-styles/src/italic';\n     *\n     * ClassicEditor\n     * \t.create( document.querySelector( '#editor' ), {\n     * \t\tplugins: [ Essentials, Paragraph, Bold, Italic ],\n     * \t\ttoolbar: [ 'bold', 'italic' ]\n     * \t} )\n     * \t.then( editor => {\n     * \t\tconsole.log( 'Editor was initialized', editor );\n     * \t} )\n     * \t.catch( error => {\n     * \t\tconsole.error( error.stack );\n     * \t} );\n     * ```\n     *\n     * However, you might have mistakenly imported a build instead of the source `ClassicEditor`. In this case\n     * your imports will look like this:\n     *\n     * ```ts\n     * import ClassicEditor from '@ckeditor/ckeditor5-build-classic';\n     * import Essentials from '@ckeditor/ckeditor5-essentials/src/essentials';\n     * import Paragraph from '@ckeditor/ckeditor5-paragraph/src/paragraph';\n     * import Bold from '@ckeditor/ckeditor5-basic-styles/src/bold';\n     * import Italic from '@ckeditor/ckeditor5-basic-styles/src/italic';\n     * ```\n     *\n     * This creates the same situation as in the previous section because you use a build together with source plugins.\n     *\n     * Remember: `@ckeditor/ckeditor5-build-*` packages contain editor builds and `@ckeditor/ckeditor5-editor-*` contain source editors.\n     *\n     * # Loading two or more builds on one page\n     *\n     * If you use CKEditor 5 builds, you might have loaded two (or more) `ckeditor.js` files on one web page.\n     * Check your web page for duplicated `<script>` elements or make sure your page builder/bundler includes CKEditor only once.\n     *\n     * If you want to use two different types of editors at once, see the\n     * {@glink installation/advanced/using-two-editors \"Using two different editors\"}\n     * section.\n     *\n     * # Using outdated packages\n     *\n     * Building CKEditor 5 from source requires using multiple npm packages. These packages have their dependencies\n     * to other packages. If you use the latest version of, for example, `@ckeditor/ckeditor5-editor-classic` with\n     * an outdated version of `@ckeditor/ckeditor5-image`, npm or yarn will need to install two different versions of\n     * `@ckeditor/ckeditor5-core` because `@ckeditor/ckeditor5-editor-classic` and `@ckeditor/ckeditor5-image` may require\n     * different versions of the core package.\n     *\n     * The solution to this issue is to update all packages to their latest version. We recommend\n     * using tools like [`npm-check-updates`](https://www.npmjs.com/package/npm-check-updates) which simplify this process.\n     *\n     * # Conflicting version of dependencies\n     *\n     * This is a special case of the previous scenario. If you use CKEditor 5 with some third-party plugins,\n     * it may happen that even if you use the latest versions of the official packages and the latest version of\n     * these third-party packages, there will be a conflict between some of their dependencies.\n     *\n     * Such a problem can be resolved by either downgrading CKEditor 5 packages (which we do not recommend) or\n     * asking the author of the third-party package to upgrade its depdendencies (or forking their project and doing this yourself).\n     *\n     * **Note:** All official CKEditor 5 packages (excluding integrations and `ckeditor5-dev-*` packages) are released in the\n     * same major version. This means that in the `x.y.z` version, the `x` is the same for all packages. This is the simplest way to check\n     * whether you use packages coming from the same CKEditor 5 version. You can read more about versioning in the\n     * {@glink updating/versioning-policy Versioning policy} guide.\n     *\n     * # Packages were duplicated in `node_modules`\n     *\n     * In some situations, especially when calling `npm install` multiple times, it may happen\n     * that npm will not correctly \"deduplicate\" packages.\n     *\n     * Normally, npm deduplicates all packages so, for example, `@ckeditor/ckeditor5-core` is installed only once in `node_modules/`.\n     * However, it is known to fail to do so from time to time.\n     *\n     * We recommend checking if any of the steps listed below help:\n     *\n     * * `rm -rf node_modules && npm install` to make sure you have a clean `node_modules/` directory. This step\n     * is known to help in most cases.\n     * * If you use `yarn.lock` or `package-lock.json`, remove it before `npm install`.\n     * * Check whether all CKEditor 5 packages are up to date and reinstall them\n     * if you changed anything (`rm -rf node_modules && npm install`).\n     *\n     * If all packages are correct and compatible with each other, the steps above are known to help. If not, you may\n     * try to check with `npm ls` how many times packages like `@ckeditor/ckeditor5-core`, `@ckeditor/ckeditor5-engine` and\n     *`@ckeditor/ckeditor5-utils` are installed. If more than once, verify which package causes that.\n     *\n     * @error ckeditor-duplicated-modules\n     */\n    throw new CKEditorError('ckeditor-duplicated-modules', null);\n}\nelse {\n    globalThis.CKEDITOR_VERSION = version;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/emittermixin\n */\nimport EventInfo from './eventinfo.js';\nimport uid from './uid.js';\nimport priorities from './priorities.js';\nimport insertToPriorityArray from './inserttopriorityarray.js';\n// To check if component is loaded more than once.\nimport './version.js';\nimport CKEditorError from './ckeditorerror.js';\nconst _listeningTo = Symbol('listeningTo');\nconst _emitterId = Symbol('emitterId');\nconst _delegations = Symbol('delegations');\nconst defaultEmitterClass = EmitterMixin(Object);\nexport default function EmitterMixin(base) {\n    if (!base) {\n        return defaultEmitterClass;\n    }\n    class Mixin extends base {\n        on(event, callback, options) {\n            this.listenTo(this, event, callback, options);\n        }\n        once(event, callback, options) {\n            let wasFired = false;\n            const onceCallback = (event, ...args) => {\n                // Ensure the callback is called only once even if the callback itself leads to re-firing the event\n                // (which would call the callback again).\n                if (!wasFired) {\n                    wasFired = true;\n                    // Go off() at the first call.\n                    event.off();\n                    // Go with the original callback.\n                    callback.call(this, event, ...args);\n                }\n            };\n            // Make a similar on() call, simply replacing the callback.\n            this.listenTo(this, event, onceCallback, options);\n        }\n        off(event, callback) {\n            this.stopListening(this, event, callback);\n        }\n        listenTo(emitter, event, callback, options = {}) {\n            let emitterInfo, eventCallbacks;\n            // _listeningTo contains a list of emitters that this object is listening to.\n            // This list has the following format:\n            //\n            // _listeningTo: {\n            //     emitterId: {\n            //         emitter: emitter,\n            //         callbacks: {\n            //             event1: [ callback1, callback2, ... ]\n            //             ....\n            //         }\n            //     },\n            //     ...\n            // }\n            if (!this[_listeningTo]) {\n                this[_listeningTo] = {};\n            }\n            const emitters = this[_listeningTo];\n            if (!_getEmitterId(emitter)) {\n                _setEmitterId(emitter);\n            }\n            const emitterId = _getEmitterId(emitter);\n            if (!(emitterInfo = emitters[emitterId])) {\n                emitterInfo = emitters[emitterId] = {\n                    emitter,\n                    callbacks: {}\n                };\n            }\n            if (!(eventCallbacks = emitterInfo.callbacks[event])) {\n                eventCallbacks = emitterInfo.callbacks[event] = [];\n            }\n            eventCallbacks.push(callback);\n            // Finally register the callback to the event.\n            addEventListener(this, emitter, event, callback, options);\n        }\n        stopListening(emitter, event, callback) {\n            const emitters = this[_listeningTo];\n            let emitterId = emitter && _getEmitterId(emitter);\n            const emitterInfo = (emitters && emitterId) ? emitters[emitterId] : undefined;\n            const eventCallbacks = (emitterInfo && event) ? emitterInfo.callbacks[event] : undefined;\n            // Stop if nothing has been listened.\n            if (!emitters || (emitter && !emitterInfo) || (event && !eventCallbacks)) {\n                return;\n            }\n            // All params provided. off() that single callback.\n            if (callback) {\n                removeEventListener(this, emitter, event, callback);\n                // We must remove callbacks as well in order to prevent memory leaks.\n                // See https://github.com/ckeditor/ckeditor5/pull/8480\n                const index = eventCallbacks.indexOf(callback);\n                if (index !== -1) {\n                    if (eventCallbacks.length === 1) {\n                        delete emitterInfo.callbacks[event];\n                    }\n                    else {\n                        removeEventListener(this, emitter, event, callback);\n                    }\n                }\n            }\n            // Only `emitter` and `event` provided. off() all callbacks for that event.\n            else if (eventCallbacks) {\n                while ((callback = eventCallbacks.pop())) {\n                    removeEventListener(this, emitter, event, callback);\n                }\n                delete emitterInfo.callbacks[event];\n            }\n            // Only `emitter` provided. off() all events for that emitter.\n            else if (emitterInfo) {\n                for (event in emitterInfo.callbacks) {\n                    this.stopListening(emitter, event);\n                }\n                delete emitters[emitterId];\n            }\n            // No params provided. off() all emitters.\n            else {\n                for (emitterId in emitters) {\n                    this.stopListening(emitters[emitterId].emitter);\n                }\n                delete this[_listeningTo];\n            }\n        }\n        fire(eventOrInfo, ...args) {\n            try {\n                const eventInfo = eventOrInfo instanceof EventInfo ? eventOrInfo : new EventInfo(this, eventOrInfo);\n                const event = eventInfo.name;\n                let callbacks = getCallbacksForEvent(this, event);\n                // Record that the event passed this emitter on its path.\n                eventInfo.path.push(this);\n                // Handle event listener callbacks first.\n                if (callbacks) {\n                    // Arguments passed to each callback.\n                    const callbackArgs = [eventInfo, ...args];\n                    // Copying callbacks array is the easiest and most secure way of preventing infinite loops, when event callbacks\n                    // are added while processing other callbacks. Previous solution involved adding counters (unique ids) but\n                    // failed if callbacks were added to the queue before currently processed callback.\n                    // If this proves to be too inefficient, another method is to change `.on()` so callbacks are stored if same\n                    // event is currently processed. Then, `.fire()` at the end, would have to add all stored events.\n                    callbacks = Array.from(callbacks);\n                    for (let i = 0; i < callbacks.length; i++) {\n                        callbacks[i].callback.apply(this, callbackArgs);\n                        // Remove the callback from future requests if off() has been called.\n                        if (eventInfo.off.called) {\n                            // Remove the called mark for the next calls.\n                            delete eventInfo.off.called;\n                            this._removeEventListener(event, callbacks[i].callback);\n                        }\n                        // Do not execute next callbacks if stop() was called.\n                        if (eventInfo.stop.called) {\n                            break;\n                        }\n                    }\n                }\n                // Delegate event to other emitters if needed.\n                const delegations = this[_delegations];\n                if (delegations) {\n                    const destinations = delegations.get(event);\n                    const passAllDestinations = delegations.get('*');\n                    if (destinations) {\n                        fireDelegatedEvents(destinations, eventInfo, args);\n                    }\n                    if (passAllDestinations) {\n                        fireDelegatedEvents(passAllDestinations, eventInfo, args);\n                    }\n                }\n                return eventInfo.return;\n            }\n            catch (err) {\n                // @if CK_DEBUG // throw err;\n                /* istanbul ignore next -- @preserve */\n                CKEditorError.rethrowUnexpectedError(err, this);\n            }\n        }\n        delegate(...events) {\n            return {\n                to: (emitter, nameOrFunction) => {\n                    if (!this[_delegations]) {\n                        this[_delegations] = new Map();\n                    }\n                    // Originally there was a for..of loop which unfortunately caused an error in Babel that didn't allow\n                    // build an application. See: https://github.com/ckeditor/ckeditor5-react/issues/40.\n                    events.forEach(eventName => {\n                        const destinations = this[_delegations].get(eventName);\n                        if (!destinations) {\n                            this[_delegations].set(eventName, new Map([[emitter, nameOrFunction]]));\n                        }\n                        else {\n                            destinations.set(emitter, nameOrFunction);\n                        }\n                    });\n                }\n            };\n        }\n        stopDelegating(event, emitter) {\n            if (!this[_delegations]) {\n                return;\n            }\n            if (!event) {\n                this[_delegations].clear();\n            }\n            else if (!emitter) {\n                this[_delegations].delete(event);\n            }\n            else {\n                const destinations = this[_delegations].get(event);\n                if (destinations) {\n                    destinations.delete(emitter);\n                }\n            }\n        }\n        _addEventListener(event, callback, options) {\n            createEventNamespace(this, event);\n            const lists = getCallbacksListsForNamespace(this, event);\n            const priority = priorities.get(options.priority);\n            const callbackDefinition = {\n                callback,\n                priority\n            };\n            // Add the callback to all callbacks list.\n            for (const callbacks of lists) {\n                // Add the callback to the list in the right priority position.\n                insertToPriorityArray(callbacks, callbackDefinition);\n            }\n        }\n        _removeEventListener(event, callback) {\n            const lists = getCallbacksListsForNamespace(this, event);\n            for (const callbacks of lists) {\n                for (let i = 0; i < callbacks.length; i++) {\n                    if (callbacks[i].callback == callback) {\n                        // Remove the callback from the list (fixing the next index).\n                        callbacks.splice(i, 1);\n                        i--;\n                    }\n                }\n            }\n        }\n    }\n    return Mixin;\n}\n// Backward compatibility with `mix`\n([\n    'on', 'once', 'off', 'listenTo',\n    'stopListening', 'fire', 'delegate', 'stopDelegating',\n    '_addEventListener', '_removeEventListener'\n]).forEach(key => {\n    EmitterMixin[key] = defaultEmitterClass.prototype[key];\n});\n/**\n * Checks if `listeningEmitter` listens to an emitter with given `listenedToEmitterId` and if so, returns that emitter.\n * If not, returns `null`.\n *\n * @internal\n * @param listeningEmitter An emitter that listens.\n * @param listenedToEmitterId Unique emitter id of emitter listened to.\n */\nexport function _getEmitterListenedTo(listeningEmitter, listenedToEmitterId) {\n    const listeningTo = listeningEmitter[_listeningTo];\n    if (listeningTo && listeningTo[listenedToEmitterId]) {\n        return listeningTo[listenedToEmitterId].emitter;\n    }\n    return null;\n}\n/**\n * Sets emitter's unique id.\n *\n * **Note:** `_emitterId` can be set only once.\n *\n * @internal\n * @param emitter An emitter for which id will be set.\n * @param id Unique id to set. If not passed, random unique id will be set.\n */\nexport function _setEmitterId(emitter, id) {\n    if (!emitter[_emitterId]) {\n        emitter[_emitterId] = id || uid();\n    }\n}\n/**\n * Returns emitter's unique id.\n *\n * @internal\n * @param emitter An emitter which id will be returned.\n */\nexport function _getEmitterId(emitter) {\n    return emitter[_emitterId];\n}\n/**\n * Gets the internal `_events` property of the given object.\n * `_events` property store all lists with callbacks for registered event names.\n * If there were no events registered on the object, empty `_events` object is created.\n */\nfunction getEvents(source) {\n    if (!source._events) {\n        Object.defineProperty(source, '_events', {\n            value: {}\n        });\n    }\n    return source._events;\n}\n/**\n * Creates event node for generic-specific events relation architecture.\n */\nfunction makeEventNode() {\n    return {\n        callbacks: [],\n        childEvents: []\n    };\n}\n/**\n * Creates an architecture for generic-specific events relation.\n * If needed, creates all events for given eventName, i.e. if the first registered event\n * is foo:bar:abc, it will create foo:bar:abc, foo:bar and foo event and tie them together.\n * It also copies callbacks from more generic events to more specific events when\n * specific events are created.\n */\nfunction createEventNamespace(source, eventName) {\n    const events = getEvents(source);\n    // First, check if the event we want to add to the structure already exists.\n    if (events[eventName]) {\n        // If it exists, we don't have to do anything.\n        return;\n    }\n    // In other case, we have to create the structure for the event.\n    // Note, that we might need to create intermediate events too.\n    // I.e. if foo:bar:abc is being registered and we only have foo in the structure,\n    // we need to also register foo:bar.\n    // Currently processed event name.\n    let name = eventName;\n    // Name of the event that is a child event for currently processed event.\n    let childEventName = null;\n    // Array containing all newly created specific events.\n    const newEventNodes = [];\n    // While loop can't check for ':' index because we have to handle generic events too.\n    // In each loop, we truncate event name, going from the most specific name to the generic one.\n    // I.e. foo:bar:abc -> foo:bar -> foo.\n    while (name !== '') {\n        if (events[name]) {\n            // If the currently processed event name is already registered, we can be sure\n            // that it already has all the structure created, so we can break the loop here\n            // as no more events need to be registered.\n            break;\n        }\n        // If this event is not yet registered, create a new object for it.\n        events[name] = makeEventNode();\n        // Add it to the array with newly created events.\n        newEventNodes.push(events[name]);\n        // Add previously processed event name as a child of this event.\n        if (childEventName) {\n            events[name].childEvents.push(childEventName);\n        }\n        childEventName = name;\n        // If `.lastIndexOf()` returns -1, `.substr()` will return '' which will break the loop.\n        name = name.substr(0, name.lastIndexOf(':'));\n    }\n    if (name !== '') {\n        // If name is not empty, we found an already registered event that was a parent of the\n        // event we wanted to register.\n        // Copy that event's callbacks to newly registered events.\n        for (const node of newEventNodes) {\n            node.callbacks = events[name].callbacks.slice();\n        }\n        // Add last newly created event to the already registered event.\n        events[name].childEvents.push(childEventName);\n    }\n}\n/**\n * Gets an array containing callbacks list for a given event and it's more specific events.\n * I.e. if given event is foo:bar and there is also foo:bar:abc event registered, this will\n * return callback list of foo:bar and foo:bar:abc (but not foo).\n */\nfunction getCallbacksListsForNamespace(source, eventName) {\n    const eventNode = getEvents(source)[eventName];\n    if (!eventNode) {\n        return [];\n    }\n    let callbacksLists = [eventNode.callbacks];\n    for (let i = 0; i < eventNode.childEvents.length; i++) {\n        const childCallbacksLists = getCallbacksListsForNamespace(source, eventNode.childEvents[i]);\n        callbacksLists = callbacksLists.concat(childCallbacksLists);\n    }\n    return callbacksLists;\n}\n/**\n * Get the list of callbacks for a given event, but only if there any callbacks have been registered.\n * If there are no callbacks registered for given event, it checks if this is a specific event and looks\n * for callbacks for it's more generic version.\n */\nfunction getCallbacksForEvent(source, eventName) {\n    let event;\n    if (!source._events || !(event = source._events[eventName]) || !event.callbacks.length) {\n        // There are no callbacks registered for specified eventName.\n        // But this could be a specific-type event that is in a namespace.\n        if (eventName.indexOf(':') > -1) {\n            // If the eventName is specific, try to find callback lists for more generic event.\n            return getCallbacksForEvent(source, eventName.substr(0, eventName.lastIndexOf(':')));\n        }\n        else {\n            // If this is a top-level generic event, return null;\n            return null;\n        }\n    }\n    return event.callbacks;\n}\n/**\n * Fires delegated events for given map of destinations.\n *\n * @param destinations A map containing `[ {@link module:utils/emittermixin~Emitter}, \"event name\" ]` pair destinations.\n * @param eventInfo The original event info object.\n * @param fireArgs Arguments the original event was fired with.\n */\nfunction fireDelegatedEvents(destinations, eventInfo, fireArgs) {\n    for (let [emitter, name] of destinations) {\n        if (!name) {\n            name = eventInfo.name;\n        }\n        else if (typeof name == 'function') {\n            name = name(eventInfo.name);\n        }\n        const delegatedInfo = new EventInfo(eventInfo.source, name);\n        delegatedInfo.path = [...eventInfo.path];\n        emitter.fire(delegatedInfo, ...fireArgs);\n    }\n}\n/**\n * Helper for registering event callback on the emitter.\n */\nfunction addEventListener(listener, emitter, event, callback, options) {\n    if (emitter._addEventListener) {\n        emitter._addEventListener(event, callback, options);\n    }\n    else {\n        // Allow listening on objects that do not implement Emitter interface.\n        // This is needed in some tests that are using mocks instead of the real objects with EmitterMixin mixed.\n        (listener._addEventListener).call(emitter, event, callback, options);\n    }\n}\n/**\n * Helper for removing event callback from the emitter.\n */\nfunction removeEventListener(listener, emitter, event, callback) {\n    if (emitter._removeEventListener) {\n        emitter._removeEventListener(event, callback);\n    }\n    else {\n        // Allow listening on objects that do not implement Emitter interface.\n        // This is needed in some tests that are using mocks instead of the real objects with EmitterMixin mixed.\n        listener._removeEventListener.call(emitter, event, callback);\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* eslint-disable @typescript-eslint/unified-signatures */\n/**\n * @module utils/observablemixin\n */\nimport EmitterMixin from './emittermixin.js';\nimport CKEditorError from './ckeditorerror.js';\nimport { isObject } from 'lodash-es';\nconst observablePropertiesSymbol = Symbol('observableProperties');\nconst boundObservablesSymbol = Symbol('boundObservables');\nconst boundPropertiesSymbol = Symbol('boundProperties');\nconst decoratedMethods = Symbol('decoratedMethods');\nconst decoratedOriginal = Symbol('decoratedOriginal');\nconst defaultObservableClass = ObservableMixin(EmitterMixin());\nexport default function ObservableMixin(base) {\n    if (!base) {\n        return defaultObservableClass;\n    }\n    class Mixin extends base {\n        set(name, value) {\n            // If the first parameter is an Object, iterate over its properties.\n            if (isObject(name)) {\n                Object.keys(name).forEach(property => {\n                    this.set(property, name[property]);\n                }, this);\n                return;\n            }\n            initObservable(this);\n            const properties = this[observablePropertiesSymbol];\n            if ((name in this) && !properties.has(name)) {\n                /**\n                 * Cannot override an existing property.\n                 *\n                 * This error is thrown when trying to {@link module:utils/observablemixin~Observable#set set} a property with\n                 * a name of an already existing property. For example:\n                 *\n                 * ```ts\n                 * let observable = new Model();\n                 * observable.property = 1;\n                 * observable.set( 'property', 2 );\t\t\t// throws\n                 *\n                 * observable.set( 'property', 1 );\n                 * observable.set( 'property', 2 );\t\t\t// ok, because this is an existing property.\n                 * ```\n                 *\n                 * @error observable-set-cannot-override\n                 */\n                throw new CKEditorError('observable-set-cannot-override', this);\n            }\n            Object.defineProperty(this, name, {\n                enumerable: true,\n                configurable: true,\n                get() {\n                    return properties.get(name);\n                },\n                set(value) {\n                    const oldValue = properties.get(name);\n                    // Fire `set` event before the new value will be set to make it possible\n                    // to override observable property without affecting `change` event.\n                    // See https://github.com/ckeditor/ckeditor5-utils/issues/171.\n                    let newValue = this.fire(`set:${name}`, name, value, oldValue);\n                    if (newValue === undefined) {\n                        newValue = value;\n                    }\n                    // Allow undefined as an initial value like A.define( 'x', undefined ) (#132).\n                    // Note: When properties map has no such own property, then its value is undefined.\n                    if (oldValue !== newValue || !properties.has(name)) {\n                        properties.set(name, newValue);\n                        this.fire(`change:${name}`, name, newValue, oldValue);\n                    }\n                }\n            });\n            this[name] = value;\n        }\n        bind(...bindProperties) {\n            if (!bindProperties.length || !isStringArray(bindProperties)) {\n                /**\n                 * All properties must be strings.\n                 *\n                 * @error observable-bind-wrong-properties\n                 */\n                throw new CKEditorError('observable-bind-wrong-properties', this);\n            }\n            if ((new Set(bindProperties)).size !== bindProperties.length) {\n                /**\n                 * Properties must be unique.\n                 *\n                 * @error observable-bind-duplicate-properties\n                 */\n                throw new CKEditorError('observable-bind-duplicate-properties', this);\n            }\n            initObservable(this);\n            const boundProperties = this[boundPropertiesSymbol];\n            bindProperties.forEach(propertyName => {\n                if (boundProperties.has(propertyName)) {\n                    /**\n                     * Cannot bind the same property more than once.\n                     *\n                     * @error observable-bind-rebind\n                     */\n                    throw new CKEditorError('observable-bind-rebind', this);\n                }\n            });\n            const bindings = new Map();\n            bindProperties.forEach(a => {\n                const binding = { property: a, to: [] };\n                boundProperties.set(a, binding);\n                bindings.set(a, binding);\n            });\n            return {\n                to: bindTo,\n                toMany: bindToMany,\n                _observable: this,\n                _bindProperties: bindProperties,\n                _to: [],\n                _bindings: bindings\n            };\n        }\n        unbind(...unbindProperties) {\n            // Nothing to do here if not inited yet.\n            if (!(this[observablePropertiesSymbol])) {\n                return;\n            }\n            const boundProperties = this[boundPropertiesSymbol];\n            const boundObservables = this[boundObservablesSymbol];\n            if (unbindProperties.length) {\n                if (!isStringArray(unbindProperties)) {\n                    /**\n                     * Properties must be strings.\n                     *\n                     * @error observable-unbind-wrong-properties\n                     */\n                    throw new CKEditorError('observable-unbind-wrong-properties', this);\n                }\n                unbindProperties.forEach(propertyName => {\n                    const binding = boundProperties.get(propertyName);\n                    // Nothing to do if the binding is not defined\n                    if (!binding) {\n                        return;\n                    }\n                    binding.to.forEach(([toObservable, toProperty]) => {\n                        const toProperties = boundObservables.get(toObservable);\n                        const toPropertyBindings = toProperties[toProperty];\n                        toPropertyBindings.delete(binding);\n                        if (!toPropertyBindings.size) {\n                            delete toProperties[toProperty];\n                        }\n                        if (!Object.keys(toProperties).length) {\n                            boundObservables.delete(toObservable);\n                            this.stopListening(toObservable, 'change');\n                        }\n                    });\n                    boundProperties.delete(propertyName);\n                });\n            }\n            else {\n                boundObservables.forEach((bindings, boundObservable) => {\n                    this.stopListening(boundObservable, 'change');\n                });\n                boundObservables.clear();\n                boundProperties.clear();\n            }\n        }\n        decorate(methodName) {\n            initObservable(this);\n            const originalMethod = this[methodName];\n            if (!originalMethod) {\n                /**\n                 * Cannot decorate an undefined method.\n                 *\n                 * @error observablemixin-cannot-decorate-undefined\n                 * @param {Object} object The object which method should be decorated.\n                 * @param {String} methodName Name of the method which does not exist.\n                 */\n                throw new CKEditorError('observablemixin-cannot-decorate-undefined', this, { object: this, methodName });\n            }\n            this.on(methodName, (evt, args) => {\n                evt.return = originalMethod.apply(this, args);\n            });\n            this[methodName] = function (...args) {\n                return this.fire(methodName, args);\n            };\n            this[methodName][decoratedOriginal] = originalMethod;\n            if (!this[decoratedMethods]) {\n                this[decoratedMethods] = [];\n            }\n            this[decoratedMethods].push(methodName);\n        }\n        // Override the EmitterMixin stopListening method to be able to clean (and restore) decorated methods.\n        // This is needed in case of:\n        //  1. Have x.foo() decorated.\n        //  2. Call x.stopListening()\n        //  3. Call x.foo(). Problem: nothing happens (the original foo() method is not executed)\n        stopListening(emitter, event, callback) {\n            // Removing all listeners so let's clean the decorated methods to the original state.\n            if (!emitter && this[decoratedMethods]) {\n                for (const methodName of this[decoratedMethods]) {\n                    this[methodName] = this[methodName][decoratedOriginal];\n                }\n                delete this[decoratedMethods];\n            }\n            super.stopListening(emitter, event, callback);\n        }\n    }\n    return Mixin;\n}\n// Backward compatibility with `mix`\n([\n    'set', 'bind', 'unbind', 'decorate',\n    'on', 'once', 'off', 'listenTo',\n    'stopListening', 'fire', 'delegate', 'stopDelegating',\n    '_addEventListener', '_removeEventListener'\n]).forEach(key => {\n    ObservableMixin[key] = defaultObservableClass.prototype[key];\n});\n// Init symbol properties needed for the observable mechanism to work.\nfunction initObservable(observable) {\n    // Do nothing if already inited.\n    if (observable[observablePropertiesSymbol]) {\n        return;\n    }\n    // The internal hash containing the observable's state.\n    Object.defineProperty(observable, observablePropertiesSymbol, {\n        value: new Map()\n    });\n    // Map containing bindings to external observables. It shares the binding objects\n    // (`{ observable: A, property: 'a', to: ... }`) with {@link module:utils/observablemixin~Observable#_boundProperties} and\n    // it is used to observe external observables to update own properties accordingly.\n    // See {@link module:utils/observablemixin~Observable#bind}.\n    //\n    //\t\tA.bind( 'a', 'b', 'c' ).to( B, 'x', 'y', 'x' );\n    //\t\tconsole.log( A._boundObservables );\n    //\n    //\t\t\tMap( {\n    //\t\t\t\tB: {\n    //\t\t\t\t\tx: Set( [\n    //\t\t\t\t\t\t{ observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n    //\t\t\t\t\t\t{ observable: A, property: 'c', to: [ [ B, 'x' ] ] }\n    //\t\t\t\t\t] ),\n    //\t\t\t\t\ty: Set( [\n    //\t\t\t\t\t\t{ observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n    //\t\t\t\t\t] )\n    //\t\t\t\t}\n    //\t\t\t} )\n    //\n    //\t\tA.bind( 'd' ).to( B, 'z' ).to( C, 'w' ).as( callback );\n    //\t\tconsole.log( A._boundObservables );\n    //\n    //\t\t\tMap( {\n    //\t\t\t\tB: {\n    //\t\t\t\t\tx: Set( [\n    //\t\t\t\t\t\t{ observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n    //\t\t\t\t\t\t{ observable: A, property: 'c', to: [ [ B, 'x' ] ] }\n    //\t\t\t\t\t] ),\n    //\t\t\t\t\ty: Set( [\n    //\t\t\t\t\t\t{ observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n    //\t\t\t\t\t] ),\n    //\t\t\t\t\tz: Set( [\n    //\t\t\t\t\t\t{ observable: A, property: 'd', to: [ [ B, 'z' ], [ C, 'w' ] ], callback: callback }\n    //\t\t\t\t\t] )\n    //\t\t\t\t},\n    //\t\t\t\tC: {\n    //\t\t\t\t\tw: Set( [\n    //\t\t\t\t\t\t{ observable: A, property: 'd', to: [ [ B, 'z' ], [ C, 'w' ] ], callback: callback }\n    //\t\t\t\t\t] )\n    //\t\t\t\t}\n    //\t\t\t} )\n    //\n    Object.defineProperty(observable, boundObservablesSymbol, {\n        value: new Map()\n    });\n    // Object that stores which properties of this observable are bound and how. It shares\n    // the binding objects (`{ observable: A, property: 'a', to: ... }`) with\n    // {@link module:utils/observablemixin~Observable#_boundObservables}. This data structure is\n    // a reverse of {@link module:utils/observablemixin~Observable#_boundObservables} and it is helpful for\n    // {@link module:utils/observablemixin~Observable#unbind}.\n    //\n    // See {@link module:utils/observablemixin~Observable#bind}.\n    //\n    //\t\tA.bind( 'a', 'b', 'c' ).to( B, 'x', 'y', 'x' );\n    //\t\tconsole.log( A._boundProperties );\n    //\n    //\t\t\tMap( {\n    //\t\t\t\ta: { observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n    //\t\t\t\tb: { observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n    //\t\t\t\tc: { observable: A, property: 'c', to: [ [ B, 'x' ] ] }\n    //\t\t\t} )\n    //\n    //\t\tA.bind( 'd' ).to( B, 'z' ).to( C, 'w' ).as( callback );\n    //\t\tconsole.log( A._boundProperties );\n    //\n    //\t\t\tMap( {\n    //\t\t\t\ta: { observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n    //\t\t\t\tb: { observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n    //\t\t\t\tc: { observable: A, property: 'c', to: [ [ B, 'x' ] ] },\n    //\t\t\t\td: { observable: A, property: 'd', to: [ [ B, 'z' ], [ C, 'w' ] ], callback: callback }\n    //\t\t\t} )\n    Object.defineProperty(observable, boundPropertiesSymbol, {\n        value: new Map()\n    });\n}\n/**\n * A chaining for {@link module:utils/observablemixin~Observable#bind} providing `.to()` interface.\n *\n * @param args Arguments of the `.to( args )` binding.\n */\nfunction bindTo(...args) {\n    const parsedArgs = parseBindToArgs(...args);\n    const bindingsKeys = Array.from(this._bindings.keys());\n    const numberOfBindings = bindingsKeys.length;\n    // Eliminate A.bind( 'x' ).to( B, C )\n    if (!parsedArgs.callback && parsedArgs.to.length > 1) {\n        /**\n         * Binding multiple observables only possible with callback.\n         *\n         * @error observable-bind-to-no-callback\n         */\n        throw new CKEditorError('observable-bind-to-no-callback', this);\n    }\n    // Eliminate A.bind( 'x', 'y' ).to( B, callback )\n    if (numberOfBindings > 1 && parsedArgs.callback) {\n        /**\n         * Cannot bind multiple properties and use a callback in one binding.\n         *\n         * @error observable-bind-to-extra-callback\n         */\n        throw new CKEditorError('observable-bind-to-extra-callback', this);\n    }\n    parsedArgs.to.forEach(to => {\n        // Eliminate A.bind( 'x', 'y' ).to( B, 'a' )\n        if (to.properties.length && to.properties.length !== numberOfBindings) {\n            /**\n             * The number of properties must match.\n             *\n             * @error observable-bind-to-properties-length\n             */\n            throw new CKEditorError('observable-bind-to-properties-length', this);\n        }\n        // When no to.properties specified, observing source properties instead i.e.\n        // A.bind( 'x', 'y' ).to( B ) -> Observe B.x and B.y\n        if (!to.properties.length) {\n            to.properties = this._bindProperties;\n        }\n    });\n    this._to = parsedArgs.to;\n    // Fill {@link BindChain#_bindings} with callback. When the callback is set there's only one binding.\n    if (parsedArgs.callback) {\n        this._bindings.get(bindingsKeys[0]).callback = parsedArgs.callback;\n    }\n    attachBindToListeners(this._observable, this._to);\n    // Update observable._boundProperties and observable._boundObservables.\n    updateBindToBound(this);\n    // Set initial values of bound properties.\n    this._bindProperties.forEach(propertyName => {\n        updateBoundObservableProperty(this._observable, propertyName);\n    });\n}\n/**\n * Binds to an attribute in a set of iterable observables.\n */\nfunction bindToMany(observables, attribute, callback) {\n    if (this._bindings.size > 1) {\n        /**\n         * Binding one attribute to many observables only possible with one attribute.\n         *\n         * @error observable-bind-to-many-not-one-binding\n         */\n        throw new CKEditorError('observable-bind-to-many-not-one-binding', this);\n    }\n    this.to(\n    // Bind to #attribute of each observable...\n    ...getBindingTargets(observables, attribute), \n    // ...using given callback to parse attribute values.\n    callback);\n}\n/**\n * Returns an array of binding components for\n * {@link Observable#bind} from a set of iterable observables.\n */\nfunction getBindingTargets(observables, attribute) {\n    const observableAndAttributePairs = observables.map(observable => [observable, attribute]);\n    // Merge pairs to one-dimension array of observables and attributes.\n    return Array.prototype.concat.apply([], observableAndAttributePairs);\n}\n/**\n * Check if all entries of the array are of `String` type.\n */\nfunction isStringArray(arr) {\n    return arr.every(a => typeof a == 'string');\n}\n/**\n * Parses and validates {@link Observable#bind}`.to( args )` arguments and returns\n * an object with a parsed structure. For example\n *\n * ```ts\n * A.bind( 'x' ).to( B, 'a', C, 'b', call );\n * ```\n *\n * becomes\n *\n * ```ts\n * {\n * \tto: [\n * \t\t{ observable: B, properties: [ 'a' ] },\n * \t\t{ observable: C, properties: [ 'b' ] },\n * \t],\n * \tcallback: call\n * }\n *\n * @param args Arguments of {@link Observable#bind}`.to( args )`.\n */\nfunction parseBindToArgs(...args) {\n    // Eliminate A.bind( 'x' ).to()\n    if (!args.length) {\n        /**\n         * Invalid argument syntax in `to()`.\n         *\n         * @error observable-bind-to-parse-error\n         */\n        throw new CKEditorError('observable-bind-to-parse-error', null);\n    }\n    const parsed = { to: [] };\n    let lastObservable;\n    if (typeof args[args.length - 1] == 'function') {\n        parsed.callback = args.pop();\n    }\n    args.forEach(a => {\n        if (typeof a == 'string') {\n            lastObservable.properties.push(a);\n        }\n        else if (typeof a == 'object') {\n            lastObservable = { observable: a, properties: [] };\n            parsed.to.push(lastObservable);\n        }\n        else {\n            throw new CKEditorError('observable-bind-to-parse-error', null);\n        }\n    });\n    return parsed;\n}\n/**\n * Synchronizes {@link module:utils/observable#_boundObservables} with {@link Binding}.\n *\n * @param binding A binding to store in {@link Observable#_boundObservables}.\n * @param toObservable A observable, which is a new component of `binding`.\n * @param toPropertyName A name of `toObservable`'s property, a new component of the `binding`.\n */\nfunction updateBoundObservables(observable, binding, toObservable, toPropertyName) {\n    const boundObservables = observable[boundObservablesSymbol];\n    const bindingsToObservable = boundObservables.get(toObservable);\n    const bindings = bindingsToObservable || {};\n    if (!bindings[toPropertyName]) {\n        bindings[toPropertyName] = new Set();\n    }\n    // Pass the binding to a corresponding Set in `observable._boundObservables`.\n    bindings[toPropertyName].add(binding);\n    if (!bindingsToObservable) {\n        boundObservables.set(toObservable, bindings);\n    }\n}\n/**\n * Synchronizes {@link Observable#_boundProperties} and {@link Observable#_boundObservables}\n * with {@link BindChain}.\n *\n * Assuming the following binding being created\n *\n * ```ts\n * A.bind( 'a', 'b' ).to( B, 'x', 'y' );\n * ```\n *\n * the following bindings were initialized by {@link Observable#bind} in {@link BindChain#_bindings}:\n *\n * ```ts\n * {\n * \ta: { observable: A, property: 'a', to: [] },\n * \tb: { observable: A, property: 'b', to: [] },\n * }\n * ```\n *\n * Iterate over all bindings in this chain and fill their `to` properties with\n * corresponding to( ... ) arguments (components of the binding), so\n *\n * ```ts\n * {\n * \ta: { observable: A, property: 'a', to: [ B, 'x' ] },\n * \tb: { observable: A, property: 'b', to: [ B, 'y' ] },\n * }\n * ```\n *\n * Then update the structure of {@link Observable#_boundObservables} with updated\n * binding, so it becomes:\n *\n * ```ts\n * Map( {\n * \tB: {\n * \t\tx: Set( [\n * \t\t\t{ observable: A, property: 'a', to: [ [ B, 'x' ] ] }\n * \t\t] ),\n * \t\ty: Set( [\n * \t\t\t{ observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n * \t\t] )\n * \t}\n * } )\n * ```\n *\n * @param chain The binding initialized by {@link Observable#bind}.\n */\nfunction updateBindToBound(chain) {\n    let toProperty;\n    chain._bindings.forEach((binding, propertyName) => {\n        // Note: For a binding without a callback, this will run only once\n        // like in A.bind( 'x', 'y' ).to( B, 'a', 'b' )\n        // TODO: ES6 destructuring.\n        chain._to.forEach(to => {\n            toProperty = to.properties[binding.callback ? 0 : chain._bindProperties.indexOf(propertyName)];\n            binding.to.push([to.observable, toProperty]);\n            updateBoundObservables(chain._observable, binding, to.observable, toProperty);\n        });\n    });\n}\n/**\n * Updates an property of a {@link Observable} with a value\n * determined by an entry in {@link Observable#_boundProperties}.\n *\n * @param observable A observable which property is to be updated.\n * @param propertyName An property to be updated.\n */\nfunction updateBoundObservableProperty(observable, propertyName) {\n    const boundProperties = observable[boundPropertiesSymbol];\n    const binding = boundProperties.get(propertyName);\n    let propertyValue;\n    // When a binding with callback is created like\n    //\n    // \t\tA.bind( 'a' ).to( B, 'b', C, 'c', callback );\n    //\n    // collect B.b and C.c, then pass them to callback to set A.a.\n    if (binding.callback) {\n        propertyValue = binding.callback.apply(observable, binding.to.map(to => to[0][to[1]]));\n    }\n    else {\n        propertyValue = binding.to[0];\n        propertyValue = propertyValue[0][propertyValue[1]];\n    }\n    if (Object.prototype.hasOwnProperty.call(observable, propertyName)) {\n        observable[propertyName] = propertyValue;\n    }\n    else {\n        observable.set(propertyName, propertyValue);\n    }\n}\n/**\n * Starts listening to changes in {@link BindChain._to} observables to update\n * {@link BindChain._observable} {@link BindChain._bindProperties}. Also sets the\n * initial state of {@link BindChain._observable}.\n *\n * @param chain The chain initialized by {@link Observable#bind}.\n */\nfunction attachBindToListeners(observable, toBindings) {\n    toBindings.forEach(to => {\n        const boundObservables = observable[boundObservablesSymbol];\n        let bindings;\n        // If there's already a chain between the observables (`observable` listens to\n        // `to.observable`), there's no need to create another `change` event listener.\n        if (!boundObservables.get(to.observable)) {\n            observable.listenTo(to.observable, 'change', (evt, propertyName) => {\n                bindings = boundObservables.get(to.observable)[propertyName];\n                // Note: to.observable will fire for any property change, react\n                // to changes of properties which are bound only.\n                if (bindings) {\n                    bindings.forEach(binding => {\n                        updateBoundObservableProperty(observable, binding.property);\n                    });\n                }\n            });\n        }\n    });\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/count\n */\n/**\n * Returns the number of items return by the iterator.\n *\n * ```ts\n * count( [ 1, 2, 3, 4, 5 ] ); // 5;\n * ```\n *\n * @param iterable Any iterable.\n * @returns Number of items returned by that iterable.\n */\nexport default function count(iterable) {\n    let count = 0;\n    for (const _ of iterable) { // eslint-disable-line no-unused-vars\n        count++;\n    }\n    return count;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/comparearrays\n */\n/**\n * Compares how given arrays relate to each other. One array can be: same as another array, prefix of another array\n * or completely different. If arrays are different, first index at which they differ is returned. Otherwise,\n * a flag specifying the relation is returned. Flags are negative numbers, so whenever a number >= 0 is returned\n * it means that arrays differ.\n *\n * ```ts\n * compareArrays( [ 0, 2 ], [ 0, 2 ] );\t\t// 'same'\n * compareArrays( [ 0, 2 ], [ 0, 2, 1 ] );\t\t// 'prefix'\n * compareArrays( [ 0, 2 ], [ 0 ] );\t\t\t// 'extension'\n * compareArrays( [ 0, 2 ], [ 1, 2 ] );\t\t// 0\n * compareArrays( [ 0, 2 ], [ 0, 1 ] );\t\t// 1\n * ```\n *\n * @param a Array that is compared.\n * @param b Array to compare with.\n * @returns How array `a` is related to `b`.\n */\nexport default function compareArrays(a, b) {\n    const minLen = Math.min(a.length, b.length);\n    for (let i = 0; i < minLen; i++) {\n        if (a[i] != b[i]) {\n            // The arrays are different.\n            return i;\n        }\n    }\n    // Both arrays were same at all points.\n    if (a.length == b.length) {\n        // If their length is also same, they are the same.\n        return 'same';\n    }\n    else if (a.length < b.length) {\n        // Compared array is shorter so it is a prefix of the other array.\n        return 'prefix';\n    }\n    else {\n        // Compared array is longer so it is an extension of the other array.\n        return 'extension';\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/isiterable\n */\n/**\n * Checks if value implements iterator interface.\n *\n * @param value The value to check.\n * @returns True if value implements iterator interface.\n */\nexport default function isIterable(value) {\n    return !!(value && value[Symbol.iterator]);\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/dom/isnode\n */\n/**\n * Checks if the object is a native DOM Node.\n */\nexport default function isNode(obj) {\n    if (obj) {\n        if (obj.defaultView) {\n            return obj instanceof obj.defaultView.Document;\n        }\n        else if (obj.ownerDocument && obj.ownerDocument.defaultView) {\n            return obj instanceof obj.ownerDocument.defaultView.Node;\n        }\n    }\n    return false;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/dom/iswindow\n */\n/**\n * Checks if the object is a native DOM Window.\n */\nexport default function isWindow(obj) {\n    const stringifiedObject = Object.prototype.toString.apply(obj);\n    // Returns `true` for the `window` object in browser environments.\n    if (stringifiedObject == '[object Window]') {\n        return true;\n    }\n    // Returns `true` for the `window` object in the Electron environment.\n    if (stringifiedObject == '[object global]') {\n        return true;\n    }\n    return false;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/dom/emittermixin\n */\nimport EmitterMixin, { _getEmitterListenedTo, _setEmitterId } from '../emittermixin.js';\nimport uid from '../uid.js';\nimport isNode from './isnode.js';\nimport isWindow from './iswindow.js';\nconst defaultEmitterClass = DomEmitterMixin(EmitterMixin());\nexport default function DomEmitterMixin(base) {\n    if (!base) {\n        return defaultEmitterClass;\n    }\n    class Mixin extends base {\n        listenTo(emitter, event, callback, options = {}) {\n            // Check if emitter is an instance of DOM Node. If so, use corresponding ProxyEmitter (or create one if not existing).\n            if (isNode(emitter) || isWindow(emitter)) {\n                const proxyOptions = {\n                    capture: !!options.useCapture,\n                    passive: !!options.usePassive\n                };\n                const proxyEmitter = this._getProxyEmitter(emitter, proxyOptions) || new ProxyEmitter(emitter, proxyOptions);\n                this.listenTo(proxyEmitter, event, callback, options);\n            }\n            else {\n                // Execute parent class method with Emitter (or ProxyEmitter) instance.\n                super.listenTo(emitter, event, callback, options);\n            }\n        }\n        stopListening(emitter, event, callback) {\n            // Check if the emitter is an instance of DOM Node. If so, forward the call to the corresponding ProxyEmitters.\n            if (isNode(emitter) || isWindow(emitter)) {\n                const proxyEmitters = this._getAllProxyEmitters(emitter);\n                for (const proxy of proxyEmitters) {\n                    this.stopListening(proxy, event, callback);\n                }\n            }\n            else {\n                // Execute parent class method with Emitter (or ProxyEmitter) instance.\n                super.stopListening(emitter, event, callback);\n            }\n        }\n        /**\n         * Retrieves ProxyEmitter instance for given DOM Node residing in this Host and given options.\n         *\n         * @param node DOM Node of the ProxyEmitter.\n         * @param options Additional options.\n         * @param options.useCapture Indicates that events of this type will be dispatched to the registered\n         * listener before being dispatched to any EventTarget beneath it in the DOM tree.\n         * @param options.usePassive Indicates that the function specified by listener will never call preventDefault()\n         * and prevents blocking browser's main thread by this event handler.\n         * @returns ProxyEmitter instance bound to the DOM Node.\n         */\n        _getProxyEmitter(node, options) {\n            return _getEmitterListenedTo(this, getProxyEmitterId(node, options));\n        }\n        /**\n         * Retrieves all the ProxyEmitter instances for given DOM Node residing in this Host.\n         *\n         * @param node DOM Node of the ProxyEmitter.\n         */\n        _getAllProxyEmitters(node) {\n            return [\n                { capture: false, passive: false },\n                { capture: false, passive: true },\n                { capture: true, passive: false },\n                { capture: true, passive: true }\n            ].map(options => this._getProxyEmitter(node, options)).filter(proxy => !!proxy);\n        }\n    }\n    return Mixin;\n}\n// Backward compatibility with `mix`\n([\n    '_getProxyEmitter', '_getAllProxyEmitters',\n    'on', 'once', 'off', 'listenTo',\n    'stopListening', 'fire', 'delegate', 'stopDelegating',\n    '_addEventListener', '_removeEventListener'\n]).forEach(key => {\n    DomEmitterMixin[key] = defaultEmitterClass.prototype[key];\n});\n/**\n * Creates a ProxyEmitter instance. Such an instance is a bridge between a DOM Node firing events\n * and any Host listening to them. It is backwards compatible with {@link module:utils/emittermixin~Emitter#on}.\n * There is a separate instance for each combination of modes (useCapture & usePassive). The mode is concatenated with\n * UID stored in HTMLElement to give each instance unique identifier.\n *\n *                                  listenTo( click, ... )\n *                    +-----------------------------------------+\n *                    |              stopListening( ... )       |\n *     +----------------------------+                           |             addEventListener( click, ... )\n *     | Host                       |                           |   +---------------------------------------------+\n *     +----------------------------+                           |   |       removeEventListener( click, ... )     |\n *     | _listeningTo: {            |                +----------v-------------+                                   |\n *     |   UID+mode: {              |                | ProxyEmitter           |                                   |\n *     |     emitter: ProxyEmitter, |                +------------------------+                      +------------v----------+\n *     |     callbacks: {           |                | events: {              |                      | Node (HTMLElement)    |\n *     |       click: [ callbacks ] |                |   click: [ callbacks ] |                      +-----------------------+\n *     |     }                      |                | },                     |                      | data-ck-expando: UID  |\n *     |   }                        |                | _domNode: Node,        |                      +-----------------------+\n *     | }                          |                | _domListeners: {},     |                                   |\n *     | +------------------------+ |                | _emitterId: UID+mode   |                                   |\n *     | | DomEmitterMixin        | |                +--------------^---------+                                   |\n *     | +------------------------+ |                           |   |                                             |\n *     +--------------^-------------+                           |   +---------------------------------------------+\n *                    |                                         |                  click (DOM Event)\n *                    +-----------------------------------------+\n *                                fire( click, DOM Event )\n */\nclass ProxyEmitter extends EmitterMixin() {\n    /**\n     * @param node DOM Node that fires events.\n     * @param options Additional options.\n     * @param options.useCapture Indicates that events of this type will be dispatched to the registered\n     * listener before being dispatched to any EventTarget beneath it in the DOM tree.\n     * @param options.usePassive Indicates that the function specified by listener will never call preventDefault()\n     * and prevents blocking browser's main thread by this event handler.\n     */\n    constructor(node, options) {\n        super();\n        // Set emitter ID to match DOM Node \"expando\" property.\n        _setEmitterId(this, getProxyEmitterId(node, options));\n        // Remember the DOM Node this ProxyEmitter is bound to.\n        this._domNode = node;\n        // And given options.\n        this._options = options;\n    }\n    /**\n     * Registers a callback function to be executed when an event is fired.\n     *\n     * It attaches a native DOM listener to the DOM Node. When fired,\n     * a corresponding Emitter event will also fire with DOM Event object as an argument.\n     *\n     * **Note**: This is automatically called by the\n     * {@link module:utils/emittermixin~Emitter#listenTo `Emitter#listenTo()`}.\n     *\n     * @param event The name of the event.\n     */\n    attach(event) {\n        // If the DOM Listener for given event already exist it is pointless\n        // to attach another one.\n        if (this._domListeners && this._domListeners[event]) {\n            return;\n        }\n        const domListener = this._createDomListener(event);\n        // Attach the native DOM listener to DOM Node.\n        this._domNode.addEventListener(event, domListener, this._options);\n        if (!this._domListeners) {\n            this._domListeners = {};\n        }\n        // Store the native DOM listener in this ProxyEmitter. It will be helpful\n        // when stopping listening to the event.\n        this._domListeners[event] = domListener;\n    }\n    /**\n     * Stops executing the callback on the given event.\n     *\n     * **Note**: This is automatically called by the\n     * {@link module:utils/emittermixin~Emitter#stopListening `Emitter#stopListening()`}.\n     *\n     * @param event The name of the event.\n     */\n    detach(event) {\n        let events;\n        // Remove native DOM listeners which are orphans. If no callbacks\n        // are awaiting given event, detach native DOM listener from DOM Node.\n        // See: {@link attach}.\n        if (this._domListeners[event] && (!(events = this._events[event]) || !events.callbacks.length)) {\n            this._domListeners[event].removeListener();\n        }\n    }\n    /**\n     * Adds callback to emitter for given event.\n     *\n     * @internal\n     * @param event The name of the event.\n     * @param callback The function to be called on event.\n     * @param options Additional options.\n     */\n    _addEventListener(event, callback, options) {\n        this.attach(event);\n        EmitterMixin().prototype._addEventListener.call(this, event, callback, options);\n    }\n    /**\n     * Removes callback from emitter for given event.\n     *\n     * @internal\n     * @param event The name of the event.\n     * @param callback The function to stop being called.\n     */\n    _removeEventListener(event, callback) {\n        EmitterMixin().prototype._removeEventListener.call(this, event, callback);\n        this.detach(event);\n    }\n    /**\n     * Creates a native DOM listener callback. When the native DOM event\n     * is fired it will fire corresponding event on this ProxyEmitter.\n     * Note: A native DOM Event is passed as an argument.\n     *\n     * @param event The name of the event.\n     * @returns The DOM listener callback.\n     */\n    _createDomListener(event) {\n        const domListener = (domEvt) => {\n            this.fire(event, domEvt);\n        };\n        // Supply the DOM listener callback with a function that will help\n        // detach it from the DOM Node, when it is no longer necessary.\n        // See: {@link detach}.\n        domListener.removeListener = () => {\n            this._domNode.removeEventListener(event, domListener, this._options);\n            delete this._domListeners[event];\n        };\n        return domListener;\n    }\n}\n/**\n * Gets an unique DOM Node identifier. The identifier will be set if not defined.\n *\n * @returns UID for given DOM Node.\n */\nfunction getNodeUID(node) {\n    return node['data-ck-expando'] || (node['data-ck-expando'] = uid());\n}\n/**\n * Gets id of the ProxyEmitter for the given node.\n */\nfunction getProxyEmitterId(node, options) {\n    let id = getNodeUID(node);\n    for (const option of Object.keys(options).sort()) {\n        if (options[option]) {\n            id += '-' + option;\n        }\n    }\n    return id;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * A helper (module) giving an access to the global DOM objects such as `window` and\n * `document`. Accessing these objects using this helper allows easy and bulletproof\n * testing, i.e. stubbing native properties:\n *\n * ```ts\n * import { global } from 'ckeditor5/utils';\n *\n * // This stub will work for any code using global module.\n * testUtils.sinon.stub( global, 'window', {\n * \tinnerWidth: 10000\n * } );\n *\n * console.log( global.window.innerWidth );\n * ```\n */\nlet globalVar; // named globalVar instead of global: https://github.com/ckeditor/ckeditor5/issues/12971\n// In some environments window and document API might not be available.\ntry {\n    globalVar = { window, document };\n}\ncatch (e) {\n    // It's not possible to mock a window object to simulate lack of a window object without writing extremely convoluted code.\n    /* istanbul ignore next -- @preserve */\n    // Let's cast it to not change module's API.\n    // We only handle this so loading editor in environments without window and document doesn't fail.\n    // For better DX we shouldn't introduce mixed types and require developers to check the type manually.\n    // This module should not be used on purpose in any environment outside browser.\n    globalVar = { window: {}, document: {} };\n}\nexport default globalVar;\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* globals Node */\n/**\n * @module utils/dom/getancestors\n */\n/**\n * Returns all ancestors of given DOM node, starting from the top-most (root). Includes the given node itself. If the\n * node is a part of `DocumentFragment` that `DocumentFragment` will be returned. In contrary, if the node is\n * appended to a `Document`, that `Document` will not be returned (algorithms operating on DOM tree care for `Document#documentElement`\n * at most, which will be returned).\n *\n * @param node DOM node.\n * @returns Array of given `node` parents.\n */\nexport default function getAncestors(node) {\n    const nodes = [];\n    let currentNode = node;\n    // We are interested in `Node`s `DocumentFragment`s only.\n    while (currentNode && currentNode.nodeType != Node.DOCUMENT_NODE) {\n        nodes.unshift(currentNode);\n        currentNode = currentNode.parentNode;\n    }\n    return nodes;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/dom/istext\n */\n/**\n * Checks if the object is a native DOM Text node.\n */\nexport default function isText(obj) {\n    return Object.prototype.toString.call(obj) == '[object Text]';\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/dom/resizeobserver\n */\nimport global from './global.js';\n/**\n * A helper class which instances allow performing custom actions when native DOM elements are resized.\n *\n * ```ts\n * const editableElement = editor.editing.view.getDomRoot();\n *\n * const observer = new ResizeObserver( editableElement, entry => {\n * \tconsole.log( 'The editable element has been resized in DOM.' );\n * \tconsole.log( entry.target ); // -> editableElement\n * \tconsole.log( entry.contentRect.width ); // -> e.g. '423px'\n * } );\n * ```\n *\n * It uses the [native DOM resize observer](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver)\n * under the hood.\n */\nclass ResizeObserver {\n    /**\n     * Creates an instance of the `ResizeObserver` class.\n     *\n     * @param element A DOM element that is to be observed for resizing. Note that\n     * the element must be visible (i.e. not detached from DOM) for the observer to work.\n     * @param callback A function called when the observed element was resized. It passes\n     * the [`ResizeObserverEntry`](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserverEntry)\n     * object with information about the resize event.\n     */\n    constructor(element, callback) {\n        // **Note**: For the maximum performance, this class ensures only a single instance of the native\n        // observer is used no matter how many instances of this class were created.\n        if (!ResizeObserver._observerInstance) {\n            ResizeObserver._createObserver();\n        }\n        this._element = element;\n        this._callback = callback;\n        ResizeObserver._addElementCallback(element, callback);\n        ResizeObserver._observerInstance.observe(element);\n    }\n    /**\n     * The element observed by this observer.\n     */\n    get element() {\n        return this._element;\n    }\n    /**\n     * Destroys the observer which disables the `callback` passed to the {@link #constructor}.\n     */\n    destroy() {\n        ResizeObserver._deleteElementCallback(this._element, this._callback);\n    }\n    /**\n     * Registers a new resize callback for the DOM element.\n     */\n    static _addElementCallback(element, callback) {\n        if (!ResizeObserver._elementCallbacks) {\n            ResizeObserver._elementCallbacks = new Map();\n        }\n        let callbacks = ResizeObserver._elementCallbacks.get(element);\n        if (!callbacks) {\n            callbacks = new Set();\n            ResizeObserver._elementCallbacks.set(element, callbacks);\n        }\n        callbacks.add(callback);\n    }\n    /**\n     * Removes a resize callback from the DOM element. If no callbacks are left\n     * for the element, it removes the element from the native observer.\n     */\n    static _deleteElementCallback(element, callback) {\n        const callbacks = ResizeObserver._getElementCallbacks(element);\n        // Remove the element callback. Check if exist first in case someone\n        // called destroy() twice.\n        if (callbacks) {\n            callbacks.delete(callback);\n            // If no callbacks left for the element, also remove the element.\n            if (!callbacks.size) {\n                ResizeObserver._elementCallbacks.delete(element);\n                ResizeObserver._observerInstance.unobserve(element);\n            }\n        }\n        if (ResizeObserver._elementCallbacks && !ResizeObserver._elementCallbacks.size) {\n            ResizeObserver._observerInstance = null;\n            ResizeObserver._elementCallbacks = null;\n        }\n    }\n    /**\n     * Returns are registered resize callbacks for the DOM element.\n     */\n    static _getElementCallbacks(element) {\n        if (!ResizeObserver._elementCallbacks) {\n            return null;\n        }\n        return ResizeObserver._elementCallbacks.get(element);\n    }\n    /**\n     * Creates the single native observer shared across all `ResizeObserver` instances.\n     */\n    static _createObserver() {\n        ResizeObserver._observerInstance = new global.window.ResizeObserver(entries => {\n            for (const entry of entries) {\n                const callbacks = ResizeObserver._getElementCallbacks(entry.target);\n                if (callbacks) {\n                    for (const callback of callbacks) {\n                        callback(entry);\n                    }\n                }\n            }\n        });\n    }\n}\n/**\n * The single native observer instance shared across all {@link module:utils/dom/resizeobserver~ResizeObserver} instances.\n */\nResizeObserver._observerInstance = null;\n/**\n * A mapping of native DOM elements and their callbacks shared across all\n * {@link module:utils/dom/resizeobserver~ResizeObserver} instances.\n */\nResizeObserver._elementCallbacks = null;\nexport default ResizeObserver;\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/dom/indexof\n */\n/**\n * Returns index of the node in the parent element.\n *\n * @param node Node which index is tested.\n * @returns Index of the node in the parent element. Returns 0 if node has no parent.\n */\nexport default function indexOf(node) {\n    let index = 0;\n    while (node.previousSibling) {\n        node = node.previousSibling;\n        index++;\n    }\n    return index;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* globals Node */\n/**\n * @module utils/dom/iscomment\n */\n/**\n * Checks whether the object is a native DOM Comment node.\n */\nexport default function isComment(obj) {\n    return obj && obj.nodeType === Node.COMMENT_NODE;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/dom/isvalidattributename\n */\nimport global from './global.js';\n/**\n * Checks if the given attribute name is valid in terms of HTML.\n *\n * @param name Attribute name.\n */\nexport default function isValidAttributeName(name) {\n    try {\n        global.document.createAttribute(name);\n    }\n    catch (error) {\n        return false;\n    }\n    return true;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\nimport CKEditorError from './ckeditorerror.js';\nimport env from './env.js';\nconst modifiersToGlyphsMac = {\n    ctrl: '⌃',\n    cmd: '⌘',\n    alt: '⌥',\n    shift: '⇧'\n};\nconst modifiersToGlyphsNonMac = {\n    ctrl: 'Ctrl+',\n    alt: 'Alt+',\n    shift: 'Shift+'\n};\n/**\n * An object with `keyName => keyCode` pairs for a set of known keys.\n *\n * Contains:\n *\n * * `a-z`,\n * * `0-9`,\n * * `f1-f12`,\n * * `` ` ``, `-`, `=`, `[`, `]`, `;`, `'`, `,`, `.`, `/`, `\\`,\n * * `arrow(left|up|right|bottom)`,\n * * `backspace`, `delete`, `enter`, `esc`, `tab`,\n * * `ctrl`, `cmd`, `shift`, `alt`.\n */\nexport const keyCodes = generateKnownKeyCodes();\nconst keyCodeNames = Object.fromEntries(Object.entries(keyCodes).map(([name, code]) => [code, name.charAt(0).toUpperCase() + name.slice(1)]));\n/**\n * Converts a key name or {@link module:utils/keyboard~KeystrokeInfo keystroke info} into a key code.\n *\n * Note: Key names are matched with {@link module:utils/keyboard#keyCodes} in a case-insensitive way.\n *\n * @param key A key name (see {@link module:utils/keyboard#keyCodes}) or a keystroke data object.\n * @returns Key or keystroke code.\n */\nexport function getCode(key) {\n    let keyCode;\n    if (typeof key == 'string') {\n        keyCode = keyCodes[key.toLowerCase()];\n        if (!keyCode) {\n            /**\n             * Unknown key name. Only key names included in the {@link module:utils/keyboard#keyCodes} can be used.\n             *\n             * @error keyboard-unknown-key\n             * @param {String} key\n             */\n            throw new CKEditorError('keyboard-unknown-key', null, { key });\n        }\n    }\n    else {\n        keyCode = key.keyCode +\n            (key.altKey ? keyCodes.alt : 0) +\n            (key.ctrlKey ? keyCodes.ctrl : 0) +\n            (key.shiftKey ? keyCodes.shift : 0) +\n            (key.metaKey ? keyCodes.cmd : 0);\n    }\n    return keyCode;\n}\n/**\n * Parses the keystroke and returns a keystroke code that will match the code returned by\n * {@link module:utils/keyboard~getCode} for the corresponding {@link module:utils/keyboard~KeystrokeInfo keystroke info}.\n *\n * The keystroke can be passed in two formats:\n *\n * * as a single string – e.g. `ctrl + A`,\n * * as an array of {@link module:utils/keyboard~keyCodes known key names} and key codes – e.g.:\n *   * `[ 'ctrl', 32 ]` (ctrl + space),\n *   * `[ 'ctrl', 'a' ]` (ctrl + A).\n *\n * Note: Key names are matched with {@link module:utils/keyboard#keyCodes} in a case-insensitive way.\n *\n * Note: Only keystrokes with a single non-modifier key are supported (e.g. `ctrl+A` is OK, but `ctrl+A+B` is not).\n *\n * Note: On macOS, keystroke handling is translating the `Ctrl` key to the `Cmd` key and handling only that keystroke.\n * For example, a registered keystroke `Ctrl+A` will be translated to `Cmd+A` on macOS. To disable the translation of some keystroke,\n * use the forced modifier: `Ctrl!+A` (note the exclamation mark).\n *\n * @param keystroke The keystroke definition.\n * @returns Keystroke code.\n */\nexport function parseKeystroke(keystroke) {\n    if (typeof keystroke == 'string') {\n        keystroke = splitKeystrokeText(keystroke);\n    }\n    return keystroke\n        .map(key => (typeof key == 'string') ? getEnvKeyCode(key) : key)\n        .reduce((key, sum) => sum + key, 0);\n}\n/**\n * Translates any keystroke string text like `\"Ctrl+A\"` to an\n * environment–specific keystroke, i.e. `\"⌘A\"` on macOS.\n *\n * @param keystroke The keystroke text.\n * @returns The keystroke text specific for the environment.\n */\nexport function getEnvKeystrokeText(keystroke) {\n    let keystrokeCode = parseKeystroke(keystroke);\n    const modifiersToGlyphs = Object.entries((env.isMac || env.isiOS) ? modifiersToGlyphsMac : modifiersToGlyphsNonMac);\n    const modifiers = modifiersToGlyphs.reduce((modifiers, [name, glyph]) => {\n        // Modifier keys are stored as a bit mask so extract those from the keystroke code.\n        if ((keystrokeCode & keyCodes[name]) != 0) {\n            keystrokeCode &= ~keyCodes[name];\n            modifiers += glyph;\n        }\n        return modifiers;\n    }, '');\n    return modifiers + (keystrokeCode ? keyCodeNames[keystrokeCode] : '');\n}\n/**\n * Returns `true` if the provided key code represents one of the arrow keys.\n *\n * @param keyCode A key code as in {@link module:utils/keyboard~KeystrokeInfo#keyCode}.\n */\nexport function isArrowKeyCode(keyCode) {\n    return keyCode == keyCodes.arrowright ||\n        keyCode == keyCodes.arrowleft ||\n        keyCode == keyCodes.arrowup ||\n        keyCode == keyCodes.arrowdown;\n}\n/**\n * Returns the direction in which the {@link module:engine/model/documentselection~DocumentSelection selection}\n * will move when the provided arrow key code is pressed considering the language direction of the editor content.\n *\n * For instance, in right–to–left (RTL) content languages, pressing the left arrow means moving the selection right (forward)\n * in the model structure. Similarly, pressing the right arrow moves the selection left (backward).\n *\n * @param keyCode A key code as in {@link module:utils/keyboard~KeystrokeInfo#keyCode}.\n * @param contentLanguageDirection The content language direction, corresponding to\n * {@link module:utils/locale~Locale#contentLanguageDirection}.\n * @returns Localized arrow direction or `undefined` for non-arrow key codes.\n */\nexport function getLocalizedArrowKeyCodeDirection(keyCode, contentLanguageDirection) {\n    const isLtrContent = contentLanguageDirection === 'ltr';\n    switch (keyCode) {\n        case keyCodes.arrowleft:\n            return isLtrContent ? 'left' : 'right';\n        case keyCodes.arrowright:\n            return isLtrContent ? 'right' : 'left';\n        case keyCodes.arrowup:\n            return 'up';\n        case keyCodes.arrowdown:\n            return 'down';\n    }\n}\n/**\n * Converts a key name to the key code with mapping based on the env.\n *\n * See: {@link module:utils/keyboard~getCode}.\n *\n * @param key The key name (see {@link module:utils/keyboard#keyCodes}).\n * @returns Key code.\n */\nfunction getEnvKeyCode(key) {\n    // Don't remap modifier key for forced modifiers.\n    if (key.endsWith('!')) {\n        return getCode(key.slice(0, -1));\n    }\n    const code = getCode(key);\n    return (env.isMac || env.isiOS) && code == keyCodes.ctrl ? keyCodes.cmd : code;\n}\n/**\n * Determines if the provided key code moves the {@link module:engine/model/documentselection~DocumentSelection selection}\n * forward or backward considering the language direction of the editor content.\n *\n * For instance, in right–to–left (RTL) languages, pressing the left arrow means moving forward\n * in the model structure. Similarly, pressing the right arrow moves the selection backward.\n *\n * @param keyCode A key code as in {@link module:utils/keyboard~KeystrokeInfo#keyCode}.\n * @param contentLanguageDirection The content language direction, corresponding to\n * {@link module:utils/locale~Locale#contentLanguageDirection}.\n */\nexport function isForwardArrowKeyCode(keyCode, contentLanguageDirection) {\n    const localizedKeyCodeDirection = getLocalizedArrowKeyCodeDirection(keyCode, contentLanguageDirection);\n    return localizedKeyCodeDirection === 'down' || localizedKeyCodeDirection === 'right';\n}\nfunction generateKnownKeyCodes() {\n    const keyCodes = {\n        arrowleft: 37,\n        arrowup: 38,\n        arrowright: 39,\n        arrowdown: 40,\n        backspace: 8,\n        delete: 46,\n        enter: 13,\n        space: 32,\n        esc: 27,\n        tab: 9,\n        // The idea about these numbers is that they do not collide with any real key codes, so we can use them\n        // like bit masks.\n        ctrl: 0x110000,\n        shift: 0x220000,\n        alt: 0x440000,\n        cmd: 0x880000\n    };\n    // a-z\n    for (let code = 65; code <= 90; code++) {\n        const letter = String.fromCharCode(code);\n        keyCodes[letter.toLowerCase()] = code;\n    }\n    // 0-9\n    for (let code = 48; code <= 57; code++) {\n        keyCodes[code - 48] = code;\n    }\n    // F1-F12\n    for (let code = 112; code <= 123; code++) {\n        keyCodes['f' + (code - 111)] = code;\n    }\n    // other characters\n    for (const char of '`-=[];\\',./\\\\') {\n        keyCodes[char] = char.charCodeAt(0);\n    }\n    return keyCodes;\n}\nfunction splitKeystrokeText(keystroke) {\n    return keystroke.split('+').map(key => key.trim());\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\nexport default function toArray(data) {\n    return Array.isArray(data) ? data : [data];\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* eslint-disable no-var */\n/**\n * @module utils/translation-service\n */\nimport CKEditorError from './ckeditorerror.js';\nimport global from './dom/global.js';\n/* istanbul ignore else -- @preserve */\nif (!global.window.CKEDITOR_TRANSLATIONS) {\n    global.window.CKEDITOR_TRANSLATIONS = {};\n}\n/**\n * Adds translations to existing ones or overrides the existing translations. These translations will later\n * be available for the {@link module:utils/locale~Locale#t `t()`} function.\n *\n * The `translations` is an object which consists of `messageId: translation` pairs. Note that the message ID can be\n * either constructed from the message string or from the message ID if it was passed\n * (this happens rarely and mostly for short messages or messages with placeholders).\n * Since the editor displays only the message string, the message ID can be found either in the source code or in the\n * built translations for another language.\n *\n * ```ts\n * add( 'pl', {\n * \t'Cancel': 'Anuluj',\n * \t'IMAGE': 'obraz', // Note that the `IMAGE` comes from the message ID, while the string can be `image`.\n * } );\n * ```\n *\n * If the message is supposed to support various plural forms, make sure to provide an array with the singular form and all plural forms:\n *\n * ```ts\n * add( 'pl', {\n * \t'Add space': [ 'Dodaj spację', 'Dodaj %0 spacje', 'Dodaj %0 spacji' ]\n * } );\n * ```\n *\n * You should also specify the third argument (the `getPluralForm()` function) that will be used to determine the plural form if no\n * language file was loaded for that language. All language files coming from CKEditor 5 sources will have this option set, so\n * these plural form rules will be reused by other translations added to the registered languages. The `getPluralForm()` function\n * can return either a Boolean or a number.\n *\n * ```ts\n * add( 'en', {\n * \t// ... Translations.\n * }, n => n !== 1 );\n * add( 'pl', {\n * \t// ... Translations.\n * }, n => n == 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && ( n % 100 < 10 || n % 100 >= 20 ) ? 1 : 2 );\n * ```\n *\n * All translations extend the global `window.CKEDITOR_TRANSLATIONS` object. An example of this object can be found below:\n *\n * ```ts\n * {\n * \tpl: {\n * \t\tdictionary: {\n * \t\t\t'Cancel': 'Anuluj',\n * \t\t\t'Add space': [ 'Dodaj spację', 'Dodaj %0 spacje', 'Dodaj %0 spacji' ]\n * \t\t},\n * \t\t// A function that returns the plural form index.\n * \t\tgetPluralForm: n => n == 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && ( n % 100 < 10 || n % 100 >= 20 ) ? 1 : 2 );\n * \t}\n * \t// Other languages.\n * \t}\n * ```\n *\n * If you cannot import this function from this module (e.g. because you use a CKEditor 5 build), you can\n * still add translations by extending the global `window.CKEDITOR_TRANSLATIONS` object by using a function like\n * the one below:\n *\n * ```ts\n * function addTranslations( language, translations, getPluralForm ) {\n * \tif ( !global.window.CKEDITOR_TRANSLATIONS ) {\n * \t\tglobal.window.CKEDITOR_TRANSLATIONS = {};\n * \t}\n\n * \tif ( !global.window.CKEDITOR_TRANSLATIONS[ language ] ) {\n * \t\tglobal.window.CKEDITOR_TRANSLATIONS[ language ] = {};\n * \t}\n *\n * \tconst languageTranslations = global.window.CKEDITOR_TRANSLATIONS[ language ];\n *\n * \tlanguageTranslations.dictionary = languageTranslations.dictionary || {};\n * \tlanguageTranslations.getPluralForm = getPluralForm || languageTranslations.getPluralForm;\n *\n * \t// Extend the dictionary for the given language.\n * \tObject.assign( languageTranslations.dictionary, translations );\n * }\n * ```\n *\n * @param language Target language.\n * @param translations An object with translations which will be added to the dictionary.\n * For each message ID the value should be either a translation or an array of translations if the message\n * should support plural forms.\n * @param getPluralForm A function that returns the plural form index (a number).\n */\nexport function add(language, translations, getPluralForm) {\n    if (!global.window.CKEDITOR_TRANSLATIONS[language]) {\n        global.window.CKEDITOR_TRANSLATIONS[language] = {};\n    }\n    const languageTranslations = global.window.CKEDITOR_TRANSLATIONS[language];\n    languageTranslations.dictionary = languageTranslations.dictionary || {};\n    languageTranslations.getPluralForm = getPluralForm || languageTranslations.getPluralForm;\n    Object.assign(languageTranslations.dictionary, translations);\n}\n/**\n * **Note:** This method is internal, use {@link module:utils/locale~Locale#t the `t()` function} instead to translate\n * the editor UI parts.\n *\n * This function is responsible for translating messages to the specified language. It uses translations added perviously\n * by {@link module:utils/translation-service~add} (a translations dictionary and the `getPluralForm()` function\n * to provide accurate translations of plural forms).\n *\n * When no translation is defined in the dictionary or the dictionary does not exist, this function returns\n * the original message string or the message plural depending on the number of elements.\n *\n * ```ts\n * translate( 'pl', { string: 'Cancel' } ); // 'Cancel'\n * ```\n *\n * The third optional argument is the number of elements, based on which the single form or one of the plural forms\n * should be picked when the message is supposed to support various plural forms.\n *\n * ```ts\n * translate( 'en', { string: 'Add a space', plural: 'Add %0 spaces' }, 1 ); // 'Add a space'\n * translate( 'en', { string: 'Add a space', plural: 'Add %0 spaces' }, 3 ); // 'Add %0 spaces'\n * ```\n *\n * The message should provide an ID using the `id` property when the message strings are not unique and their\n * translations should be different.\n *\n * ```ts\n * translate( 'en', { string: 'image', id: 'ADD_IMAGE' } );\n * translate( 'en', { string: 'image', id: 'AN_IMAGE' } );\n * ```\n *\n * @internal\n * @param language Target language.\n * @param message A message that will be translated.\n * @param quantity The number of elements for which a plural form should be picked from the target language dictionary.\n * @returns Translated sentence.\n */\nexport function _translate(language, message, quantity = 1) {\n    if (typeof quantity !== 'number') {\n        /**\n         * An incorrect value was passed to the translation function. This was probably caused\n         * by an incorrect message interpolation of a plural form. Note that for messages supporting plural forms\n         * the second argument of the `t()` function should always be a number or an array with a number as the first element.\n         *\n         * @error translation-service-quantity-not-a-number\n         */\n        throw new CKEditorError('translation-service-quantity-not-a-number', null, { quantity });\n    }\n    const numberOfLanguages = getNumberOfLanguages();\n    if (numberOfLanguages === 1) {\n        // Override the language to the only supported one.\n        // This can't be done in the `Locale` class, because the translations comes after the `Locale` class initialization.\n        language = Object.keys(global.window.CKEDITOR_TRANSLATIONS)[0];\n    }\n    const messageId = message.id || message.string;\n    if (numberOfLanguages === 0 || !hasTranslation(language, messageId)) {\n        if (quantity !== 1) {\n            // Return the default plural form that was passed in the `message.plural` parameter.\n            return message.plural;\n        }\n        return message.string;\n    }\n    const dictionary = global.window.CKEDITOR_TRANSLATIONS[language].dictionary;\n    const getPluralForm = global.window.CKEDITOR_TRANSLATIONS[language].getPluralForm || (n => n === 1 ? 0 : 1);\n    const translation = dictionary[messageId];\n    if (typeof translation === 'string') {\n        return translation;\n    }\n    const pluralFormIndex = Number(getPluralForm(quantity));\n    // Note: The `translate` function is not responsible for replacing `%0, %1, ...` with values.\n    return translation[pluralFormIndex];\n}\n/**\n * Clears dictionaries for test purposes.\n *\n * @internal\n */\nexport function _clear() {\n    global.window.CKEDITOR_TRANSLATIONS = {};\n}\n/**\n * Checks whether the dictionary exists and translation in that dictionary exists.\n */\nfunction hasTranslation(language, messageId) {\n    return (!!global.window.CKEDITOR_TRANSLATIONS[language] &&\n        !!global.window.CKEDITOR_TRANSLATIONS[language].dictionary[messageId]);\n}\nfunction getNumberOfLanguages() {\n    return Object.keys(global.window.CKEDITOR_TRANSLATIONS).length;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/collection\n */\nimport EmitterMixin from './emittermixin.js';\nimport CKEditorError from './ckeditorerror.js';\nimport uid from './uid.js';\nimport isIterable from './isiterable.js';\n/**\n * Collections are ordered sets of objects. Items in the collection can be retrieved by their indexes\n * in the collection (like in an array) or by their ids.\n *\n * If an object without an `id` property is being added to the collection, the `id` property will be generated\n * automatically. Note that the automatically generated id is unique only within this single collection instance.\n *\n * By default an item in the collection is identified by its `id` property. The name of the identifier can be\n * configured through the constructor of the collection.\n *\n * @typeParam T The type of the collection element.\n */\nexport default class Collection extends EmitterMixin() {\n    constructor(initialItemsOrOptions = {}, options = {}) {\n        super();\n        const hasInitialItems = isIterable(initialItemsOrOptions);\n        if (!hasInitialItems) {\n            options = initialItemsOrOptions;\n        }\n        this._items = [];\n        this._itemMap = new Map();\n        this._idProperty = options.idProperty || 'id';\n        this._bindToExternalToInternalMap = new WeakMap();\n        this._bindToInternalToExternalMap = new WeakMap();\n        this._skippedIndexesFromExternal = [];\n        // Set the initial content of the collection (if provided in the constructor).\n        if (hasInitialItems) {\n            for (const item of initialItemsOrOptions) {\n                this._items.push(item);\n                this._itemMap.set(this._getItemIdBeforeAdding(item), item);\n            }\n        }\n    }\n    /**\n     * The number of items available in the collection.\n     */\n    get length() {\n        return this._items.length;\n    }\n    /**\n     * Returns the first item from the collection or null when collection is empty.\n     */\n    get first() {\n        return this._items[0] || null;\n    }\n    /**\n     * Returns the last item from the collection or null when collection is empty.\n     */\n    get last() {\n        return this._items[this.length - 1] || null;\n    }\n    /**\n     * Adds an item into the collection.\n     *\n     * If the item does not have an id, then it will be automatically generated and set on the item.\n     *\n     * @param item\n     * @param index The position of the item in the collection. The item\n     * is pushed to the collection when `index` not specified.\n     * @fires add\n     * @fires change\n     */\n    add(item, index) {\n        return this.addMany([item], index);\n    }\n    /**\n     * Adds multiple items into the collection.\n     *\n     * Any item not containing an id will get an automatically generated one.\n     *\n     * @param items\n     * @param index The position of the insertion. Items will be appended if no `index` is specified.\n     * @fires add\n     * @fires change\n     */\n    addMany(items, index) {\n        if (index === undefined) {\n            index = this._items.length;\n        }\n        else if (index > this._items.length || index < 0) {\n            /**\n             * The `index` passed to {@link module:utils/collection~Collection#addMany `Collection#addMany()`}\n             * is invalid. It must be a number between 0 and the collection's length.\n             *\n             * @error collection-add-item-invalid-index\n             */\n            throw new CKEditorError('collection-add-item-invalid-index', this);\n        }\n        let offset = 0;\n        for (const item of items) {\n            const itemId = this._getItemIdBeforeAdding(item);\n            const currentItemIndex = index + offset;\n            this._items.splice(currentItemIndex, 0, item);\n            this._itemMap.set(itemId, item);\n            this.fire('add', item, currentItemIndex);\n            offset++;\n        }\n        this.fire('change', {\n            added: items,\n            removed: [],\n            index\n        });\n        return this;\n    }\n    /**\n     * Gets an item by its ID or index.\n     *\n     * @param idOrIndex The item ID or index in the collection.\n     * @returns The requested item or `null` if such item does not exist.\n     */\n    get(idOrIndex) {\n        let item;\n        if (typeof idOrIndex == 'string') {\n            item = this._itemMap.get(idOrIndex);\n        }\n        else if (typeof idOrIndex == 'number') {\n            item = this._items[idOrIndex];\n        }\n        else {\n            /**\n             * An index or ID must be given.\n             *\n             * @error collection-get-invalid-arg\n             */\n            throw new CKEditorError('collection-get-invalid-arg', this);\n        }\n        return item || null;\n    }\n    /**\n     * Returns a Boolean indicating whether the collection contains an item.\n     *\n     * @param itemOrId The item or its ID in the collection.\n     * @returns `true` if the collection contains the item, `false` otherwise.\n     */\n    has(itemOrId) {\n        if (typeof itemOrId == 'string') {\n            return this._itemMap.has(itemOrId);\n        }\n        else { // Object\n            const idProperty = this._idProperty;\n            const id = itemOrId[idProperty];\n            return id && this._itemMap.has(id);\n        }\n    }\n    /**\n     * Gets an index of an item in the collection.\n     * When an item is not defined in the collection, the index will equal -1.\n     *\n     * @param itemOrId The item or its ID in the collection.\n     * @returns The index of a given item.\n     */\n    getIndex(itemOrId) {\n        let item;\n        if (typeof itemOrId == 'string') {\n            item = this._itemMap.get(itemOrId);\n        }\n        else {\n            item = itemOrId;\n        }\n        return item ? this._items.indexOf(item) : -1;\n    }\n    /**\n     * Removes an item from the collection.\n     *\n     * @param subject The item to remove, its ID or index in the collection.\n     * @returns The removed item.\n     * @fires remove\n     * @fires change\n     */\n    remove(subject) {\n        const [item, index] = this._remove(subject);\n        this.fire('change', {\n            added: [],\n            removed: [item],\n            index\n        });\n        return item;\n    }\n    /**\n     * Executes the callback for each item in the collection and composes an array or values returned by this callback.\n     *\n     * @typeParam U The result type of the callback.\n     * @param callback\n     * @param ctx Context in which the `callback` will be called.\n     * @returns The result of mapping.\n     */\n    map(callback, ctx) {\n        return this._items.map(callback, ctx);\n    }\n    /**\n     * Performs the specified action for each item in the collection.\n     *\n     * @param ctx Context in which the `callback` will be called.\n     */\n    forEach(callback, ctx) {\n        this._items.forEach(callback, ctx);\n    }\n    /**\n     * Finds the first item in the collection for which the `callback` returns a true value.\n     *\n     * @param callback\n     * @param ctx Context in which the `callback` will be called.\n     * @returns The item for which `callback` returned a true value.\n     */\n    find(callback, ctx) {\n        return this._items.find(callback, ctx);\n    }\n    /**\n     * Returns an array with items for which the `callback` returned a true value.\n     *\n     * @param callback\n     * @param ctx Context in which the `callback` will be called.\n     * @returns The array with matching items.\n     */\n    filter(callback, ctx) {\n        return this._items.filter(callback, ctx);\n    }\n    /**\n     * Removes all items from the collection and destroys the binding created using\n     * {@link #bindTo}.\n     *\n     * @fires remove\n     * @fires change\n     */\n    clear() {\n        if (this._bindToCollection) {\n            this.stopListening(this._bindToCollection);\n            this._bindToCollection = null;\n        }\n        const removedItems = Array.from(this._items);\n        while (this.length) {\n            this._remove(0);\n        }\n        this.fire('change', {\n            added: [],\n            removed: removedItems,\n            index: 0\n        });\n    }\n    /**\n     * Binds and synchronizes the collection with another one.\n     *\n     * The binding can be a simple factory:\n     *\n     * ```ts\n     * class FactoryClass {\n     * \tpublic label: string;\n     *\n     * \tconstructor( data: { label: string } ) {\n     * \t\tthis.label = data.label;\n     * \t}\n     * }\n     *\n     * const source = new Collection<{ label: string }>( { idProperty: 'label' } );\n     * const target = new Collection<FactoryClass>();\n     *\n     * target.bindTo( source ).as( FactoryClass );\n     *\n     * source.add( { label: 'foo' } );\n     * source.add( { label: 'bar' } );\n     *\n     * console.log( target.length ); // 2\n     * console.log( target.get( 1 ).label ); // 'bar'\n     *\n     * source.remove( 0 );\n     * console.log( target.length ); // 1\n     * console.log( target.get( 0 ).label ); // 'bar'\n     * ```\n     *\n     * or the factory driven by a custom callback:\n     *\n     * ```ts\n     * class FooClass {\n     * \tpublic label: string;\n     *\n     * \tconstructor( data: { label: string } ) {\n     * \t\tthis.label = data.label;\n     * \t}\n     * }\n     *\n     * class BarClass {\n     * \tpublic label: string;\n     *\n     * \tconstructor( data: { label: string } ) {\n     * \t\tthis.label = data.label;\n     * \t}\n     * }\n     *\n     * const source = new Collection<{ label: string }>( { idProperty: 'label' } );\n     * const target = new Collection<FooClass | BarClass>();\n     *\n     * target.bindTo( source ).using( ( item ) => {\n     * \tif ( item.label == 'foo' ) {\n     * \t\treturn new FooClass( item );\n     * \t} else {\n     * \t\treturn new BarClass( item );\n     * \t}\n     * } );\n     *\n     * source.add( { label: 'foo' } );\n     * source.add( { label: 'bar' } );\n     *\n     * console.log( target.length ); // 2\n     * console.log( target.get( 0 ) instanceof FooClass ); // true\n     * console.log( target.get( 1 ) instanceof BarClass ); // true\n     * ```\n     *\n     * or the factory out of property name:\n     *\n     * ```ts\n     * const source = new Collection<{ nested: { value: string } }>();\n     * const target = new Collection<{ value: string }>();\n     *\n     * target.bindTo( source ).using( 'nested' );\n     *\n     * source.add( { nested: { value: 'foo' } } );\n     * source.add( { nested: { value: 'bar' } } );\n     *\n     * console.log( target.length ); // 2\n     * console.log( target.get( 0 ).value ); // 'foo'\n     * console.log( target.get( 1 ).value ); // 'bar'\n     * ```\n     *\n     * It's possible to skip specified items by returning null value:\n     *\n     * ```ts\n     * const source = new Collection<{ hidden: boolean }>();\n     * const target = new Collection<{ hidden: boolean }>();\n     *\n     * target.bindTo( source ).using( item => {\n     * \tif ( item.hidden ) {\n     * \t\treturn null;\n     * \t}\n     *\n     * \treturn item;\n     * } );\n     *\n     * source.add( { hidden: true } );\n     * source.add( { hidden: false } );\n     *\n     * console.log( source.length ); // 2\n     * console.log( target.length ); // 1\n     * ```\n     *\n     * **Note**: {@link #clear} can be used to break the binding.\n     *\n     * @typeParam S The type of `externalCollection` element.\n     * @param externalCollection A collection to be bound.\n     * @returns The binding chain object.\n     */\n    bindTo(externalCollection) {\n        if (this._bindToCollection) {\n            /**\n             * The collection cannot be bound more than once.\n             *\n             * @error collection-bind-to-rebind\n             */\n            throw new CKEditorError('collection-bind-to-rebind', this);\n        }\n        this._bindToCollection = externalCollection;\n        return {\n            as: Class => {\n                this._setUpBindToBinding(item => new Class(item));\n            },\n            using: callbackOrProperty => {\n                if (typeof callbackOrProperty == 'function') {\n                    this._setUpBindToBinding(callbackOrProperty);\n                }\n                else {\n                    this._setUpBindToBinding(item => item[callbackOrProperty]);\n                }\n            }\n        };\n    }\n    /**\n     * Finalizes and activates a binding initiated by {@link #bindTo}.\n     *\n     * @param factory A function which produces collection items.\n     */\n    _setUpBindToBinding(factory) {\n        const externalCollection = this._bindToCollection;\n        // Adds the item to the collection once a change has been done to the external collection.\n        const addItem = (evt, externalItem, index) => {\n            const isExternalBoundToThis = externalCollection._bindToCollection == this;\n            const externalItemBound = externalCollection._bindToInternalToExternalMap.get(externalItem);\n            // If an external collection is bound to this collection, which makes it a 2–way binding,\n            // and the particular external collection item is already bound, don't add it here.\n            // The external item has been created **out of this collection's item** and (re)adding it will\n            // cause a loop.\n            if (isExternalBoundToThis && externalItemBound) {\n                this._bindToExternalToInternalMap.set(externalItem, externalItemBound);\n                this._bindToInternalToExternalMap.set(externalItemBound, externalItem);\n            }\n            else {\n                const item = factory(externalItem);\n                // When there is no item we need to remember skipped index first and then we can skip this item.\n                if (!item) {\n                    this._skippedIndexesFromExternal.push(index);\n                    return;\n                }\n                // Lets try to put item at the same index as index in external collection\n                // but when there are a skipped items in one or both collections we need to recalculate this index.\n                let finalIndex = index;\n                // When we try to insert item after some skipped items from external collection we need\n                // to include this skipped items and decrease index.\n                //\n                // For the following example:\n                // external -> [ 'A', 'B - skipped for internal', 'C - skipped for internal' ]\n                // internal -> [ A ]\n                //\n                // Another item is been added at the end of external collection:\n                // external.add( 'D' )\n                // external -> [ 'A', 'B - skipped for internal', 'C - skipped for internal', 'D' ]\n                //\n                // We can't just add 'D' to internal at the same index as index in external because\n                // this will produce empty indexes what is invalid:\n                // internal -> [ 'A', empty, empty, 'D' ]\n                //\n                // So we need to include skipped items and decrease index\n                // internal -> [ 'A', 'D' ]\n                for (const skipped of this._skippedIndexesFromExternal) {\n                    if (index > skipped) {\n                        finalIndex--;\n                    }\n                }\n                // We need to take into consideration that external collection could skip some items from\n                // internal collection.\n                //\n                // For the following example:\n                // internal -> [ 'A', 'B - skipped for external', 'C - skipped for external' ]\n                // external -> [ A ]\n                //\n                // Another item is been added at the end of external collection:\n                // external.add( 'D' )\n                // external -> [ 'A', 'D' ]\n                //\n                // We need to include skipped items and place new item after them:\n                // internal -> [ 'A', 'B - skipped for external', 'C - skipped for external', 'D' ]\n                for (const skipped of externalCollection._skippedIndexesFromExternal) {\n                    if (finalIndex >= skipped) {\n                        finalIndex++;\n                    }\n                }\n                this._bindToExternalToInternalMap.set(externalItem, item);\n                this._bindToInternalToExternalMap.set(item, externalItem);\n                this.add(item, finalIndex);\n                // After adding new element to internal collection we need update indexes\n                // of skipped items in external collection.\n                for (let i = 0; i < externalCollection._skippedIndexesFromExternal.length; i++) {\n                    if (finalIndex <= externalCollection._skippedIndexesFromExternal[i]) {\n                        externalCollection._skippedIndexesFromExternal[i]++;\n                    }\n                }\n            }\n        };\n        // Load the initial content of the collection.\n        for (const externalItem of externalCollection) {\n            addItem(null, externalItem, externalCollection.getIndex(externalItem));\n        }\n        // Synchronize the with collection as new items are added.\n        this.listenTo(externalCollection, 'add', addItem);\n        // Synchronize the with collection as new items are removed.\n        this.listenTo(externalCollection, 'remove', (evt, externalItem, index) => {\n            const item = this._bindToExternalToInternalMap.get(externalItem);\n            if (item) {\n                this.remove(item);\n            }\n            // After removing element from external collection we need update/remove indexes\n            // of skipped items in internal collection.\n            this._skippedIndexesFromExternal = this._skippedIndexesFromExternal.reduce((result, skipped) => {\n                if (index < skipped) {\n                    result.push(skipped - 1);\n                }\n                if (index > skipped) {\n                    result.push(skipped);\n                }\n                return result;\n            }, []);\n        });\n    }\n    /**\n     * Returns an unique id property for a given `item`.\n     *\n     * The method will generate new id and assign it to the `item` if it doesn't have any.\n     *\n     * @param item Item to be added.\n     */\n    _getItemIdBeforeAdding(item) {\n        const idProperty = this._idProperty;\n        let itemId;\n        if ((idProperty in item)) {\n            itemId = item[idProperty];\n            if (typeof itemId != 'string') {\n                /**\n                 * This item's ID should be a string.\n                 *\n                 * @error collection-add-invalid-id\n                 */\n                throw new CKEditorError('collection-add-invalid-id', this);\n            }\n            if (this.get(itemId)) {\n                /**\n                 * This item already exists in the collection.\n                 *\n                 * @error collection-add-item-already-exists\n                 */\n                throw new CKEditorError('collection-add-item-already-exists', this);\n            }\n        }\n        else {\n            item[idProperty] = itemId = uid();\n        }\n        return itemId;\n    }\n    /**\n     * Core {@link #remove} method implementation shared in other functions.\n     *\n     * In contrast this method **does not** fire the {@link #event:change} event.\n     *\n     * @param subject The item to remove, its id or index in the collection.\n     * @returns Returns an array with the removed item and its index.\n     * @fires remove\n     */\n    _remove(subject) {\n        let index, id, item;\n        let itemDoesNotExist = false;\n        const idProperty = this._idProperty;\n        if (typeof subject == 'string') {\n            id = subject;\n            item = this._itemMap.get(id);\n            itemDoesNotExist = !item;\n            if (item) {\n                index = this._items.indexOf(item);\n            }\n        }\n        else if (typeof subject == 'number') {\n            index = subject;\n            item = this._items[index];\n            itemDoesNotExist = !item;\n            if (item) {\n                id = item[idProperty];\n            }\n        }\n        else {\n            item = subject;\n            id = item[idProperty];\n            index = this._items.indexOf(item);\n            itemDoesNotExist = (index == -1 || !this._itemMap.get(id));\n        }\n        if (itemDoesNotExist) {\n            /**\n             * Item not found.\n             *\n             * @error collection-remove-404\n             */\n            throw new CKEditorError('collection-remove-404', this);\n        }\n        this._items.splice(index, 1);\n        this._itemMap.delete(id);\n        const externalItem = this._bindToInternalToExternalMap.get(item);\n        this._bindToInternalToExternalMap.delete(item);\n        this._bindToExternalToInternalMap.delete(externalItem);\n        this.fire('remove', item, index);\n        return [item, index];\n    }\n    /**\n     * Iterable interface.\n     */\n    [Symbol.iterator]() {\n        return this._items[Symbol.iterator]();\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/first\n */\n/**\n * Returns first item of the given `iterator`.\n */\nexport default function first(iterator) {\n    const iteratorItem = iterator.next();\n    if (iteratorItem.done) {\n        return null;\n    }\n    return iteratorItem.value;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* global setTimeout, clearTimeout */\n/**\n * @module utils/focustracker\n */\nimport DomEmitterMixin from './dom/emittermixin.js';\nimport ObservableMixin from './observablemixin.js';\nimport CKEditorError from './ckeditorerror.js';\n/**\n * Allows observing a group of `Element`s whether at least one of them is focused.\n *\n * Used by the {@link module:core/editor/editor~Editor} in order to track whether the focus is still within the application,\n * or were used outside of its UI.\n *\n * **Note** `focus` and `blur` listeners use event capturing, so it is only needed to register wrapper `Element`\n * which contain other `focusable` elements. But note that this wrapper element has to be focusable too\n * (have e.g. `tabindex=\"-1\"`).\n *\n * Check out the {@glink framework/deep-dive/ui/focus-tracking \"Deep dive into focus tracking\"} guide to learn more.\n */\nexport default class FocusTracker extends DomEmitterMixin(ObservableMixin()) {\n    constructor() {\n        super();\n        /**\n         * List of registered elements.\n         *\n         * @internal\n         */\n        this._elements = new Set();\n        /**\n         * Event loop timeout.\n         */\n        this._nextEventLoopTimeout = null;\n        this.set('isFocused', false);\n        this.set('focusedElement', null);\n    }\n    /**\n     * Starts tracking the specified element.\n     */\n    add(element) {\n        if (this._elements.has(element)) {\n            /**\n             * This element is already tracked by {@link module:utils/focustracker~FocusTracker}.\n             *\n             * @error focustracker-add-element-already-exist\n             */\n            throw new CKEditorError('focustracker-add-element-already-exist', this);\n        }\n        this.listenTo(element, 'focus', () => this._focus(element), { useCapture: true });\n        this.listenTo(element, 'blur', () => this._blur(), { useCapture: true });\n        this._elements.add(element);\n    }\n    /**\n     * Stops tracking the specified element and stops listening on this element.\n     */\n    remove(element) {\n        if (element === this.focusedElement) {\n            this._blur();\n        }\n        if (this._elements.has(element)) {\n            this.stopListening(element);\n            this._elements.delete(element);\n        }\n    }\n    /**\n     * Destroys the focus tracker by:\n     * - Disabling all event listeners attached to tracked elements.\n     * - Removing all tracked elements that were previously added.\n     */\n    destroy() {\n        this.stopListening();\n    }\n    /**\n     * Stores currently focused element and set {@link #isFocused} as `true`.\n     */\n    _focus(element) {\n        clearTimeout(this._nextEventLoopTimeout);\n        this.focusedElement = element;\n        this.isFocused = true;\n    }\n    /**\n     * Clears currently focused element and set {@link #isFocused} as `false`.\n     * This method uses `setTimeout` to change order of fires `blur` and `focus` events.\n     */\n    _blur() {\n        clearTimeout(this._nextEventLoopTimeout);\n        this._nextEventLoopTimeout = setTimeout(() => {\n            this.focusedElement = null;\n            this.isFocused = false;\n        }, 0);\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/objecttomap\n */\n/**\n * Transforms object to map.\n *\n * ```ts\n * const map = objectToMap( { 'foo': 1, 'bar': 2 } );\n * map.get( 'foo' ); // 1\n * ```\n *\n * **Note**: For mixed data (`Object` or `Iterable`) there's a dedicated {@link module:utils/tomap~toMap} function.\n *\n * @param obj Object to transform.\n * @returns Map created from object.\n */\nexport default function objectToMap(obj) {\n    const map = new Map();\n    for (const key in obj) {\n        map.set(key, obj[key]);\n    }\n    return map;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/tomap\n */\nimport objectToMap from './objecttomap.js';\nimport isIterable from './isiterable.js';\n/**\n * Transforms object or iterable to map. Iterable needs to be in the format acceptable by the `Map` constructor.\n *\n * ```ts\n * map = toMap( { 'foo': 1, 'bar': 2 } );\n * map = toMap( [ [ 'foo', 1 ], [ 'bar', 2 ] ] );\n * map = toMap( anotherMap );\n * ```\n *\n * @param data Object or iterable to transform.\n * @returns Map created from data.\n */\nexport default function toMap(data) {\n    if (isIterable(data)) {\n        return new Map(data);\n    }\n    else {\n        return objectToMap(data);\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module utils/delay\n */\n/* globals setTimeout, clearTimeout */\n/**\n * Returns a function wrapper that will trigger a function after a specified wait time.\n * The timeout can be canceled by calling the cancel function on the returned wrapped function.\n *\n * @param func The function to wrap.\n * @param wait The timeout in ms.\n */\nexport default function delay(func, wait) {\n    let timer;\n    function delayed(...args) {\n        delayed.cancel();\n        timer = setTimeout(() => func(...args), wait);\n    }\n    delayed.cancel = () => {\n        clearTimeout(timer);\n    };\n    return delayed;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * Set of utils to handle unicode characters.\n *\n * @module utils/unicode\n */\n/**\n * Checks whether given `character` is a combining mark.\n *\n * @param character Character to check.\n */\nexport function isCombiningMark(character) {\n    // eslint-disable-next-line no-misleading-character-class\n    return !!character && character.length == 1 && /[\\u0300-\\u036f\\u1ab0-\\u1aff\\u1dc0-\\u1dff\\u20d0-\\u20ff\\ufe20-\\ufe2f]/.test(character);\n}\n/**\n * Checks whether given `character` is a high half of surrogate pair.\n *\n * Using UTF-16 terminology, a surrogate pair denotes UTF-16 character using two UTF-8 characters. The surrogate pair\n * consist of high surrogate pair character followed by low surrogate pair character.\n *\n * @param character Character to check.\n */\nexport function isHighSurrogateHalf(character) {\n    return !!character && character.length == 1 && /[\\ud800-\\udbff]/.test(character);\n}\n/**\n * Checks whether given `character` is a low half of surrogate pair.\n *\n * Using UTF-16 terminology, a surrogate pair denotes UTF-16 character using two UTF-8 characters. The surrogate pair\n * consist of high surrogate pair character followed by low surrogate pair character.\n *\n * @param character Character to check.\n */\nexport function isLowSurrogateHalf(character) {\n    return !!character && character.length == 1 && /[\\udc00-\\udfff]/.test(character);\n}\n/**\n * Checks whether given offset in a string is inside a surrogate pair (between two surrogate halves).\n *\n * @param string String to check.\n * @param offset Offset to check.\n */\nexport function isInsideSurrogatePair(string, offset) {\n    return isHighSurrogateHalf(string.charAt(offset - 1)) && isLowSurrogateHalf(string.charAt(offset));\n}\n/**\n * Checks whether given offset in a string is between base character and combining mark or between two combining marks.\n *\n * @param string String to check.\n * @param offset Offset to check.\n */\nexport function isInsideCombinedSymbol(string, offset) {\n    return isCombiningMark(string.charAt(offset));\n}\nconst EMOJI_PATTERN = buildEmojiRegexp();\n/**\n * Checks whether given offset in a string is inside multi-character emoji sequence.\n *\n * @param string String to check.\n * @param offset Offset to check.\n */\nexport function isInsideEmojiSequence(string, offset) {\n    const matches = String(string).matchAll(EMOJI_PATTERN);\n    return Array.from(matches).some(match => match.index < offset && offset < match.index + match[0].length);\n}\nfunction buildEmojiRegexp() {\n    const parts = [\n        // Emoji Tag Sequence (ETS)\n        /\\p{Emoji}[\\u{E0020}-\\u{E007E}]+\\u{E007F}/u,\n        // Emoji Keycap Sequence\n        /\\p{Emoji}\\u{FE0F}?\\u{20E3}/u,\n        // Emoji Presentation Sequence\n        /\\p{Emoji}\\u{FE0F}/u,\n        // Single-Character Emoji / Emoji Modifier Sequence\n        /(?=\\p{General_Category=Other_Symbol})\\p{Emoji}\\p{Emoji_Modifier}*/u\n    ];\n    const flagSequence = /\\p{Regional_Indicator}{2}/u.source;\n    const emoji = '(?:' + parts.map(part => part.source).join('|') + ')';\n    const sequence = `${flagSequence}|${emoji}(?:\\u{200D}${emoji})*`;\n    return new RegExp(sequence, 'ug');\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module ui/viewcollection\n */\nimport { CKEditorError, Collection } from '@ckeditor/ckeditor5-utils';\n/**\n * Collects {@link module:ui/view~View} instances.\n *\n * ```ts\n * const parentView = new ParentView( locale );\n * const collection = new ViewCollection( locale );\n *\n * collection.setParent( parentView.element );\n *\n * const viewA = new ChildView( locale );\n * const viewB = new ChildView( locale );\n * ```\n *\n * View collection renders and manages view {@link module:ui/view~View#element elements}:\n *\n * ```ts\n * collection.add( viewA );\n * collection.add( viewB );\n *\n * console.log( parentView.element.firsChild ); // -> viewA.element\n * console.log( parentView.element.lastChild ); // -> viewB.element\n * ```\n *\n * It {@link module:ui/viewcollection~ViewCollection#delegate propagates} DOM events too:\n *\n * ```ts\n * // Delegate #click and #keydown events from viewA and viewB to the parentView.\n * collection.delegate( 'click' ).to( parentView );\n *\n * parentView.on( 'click', ( evt ) => {\n * \tconsole.log( `${ evt.source } has been clicked.` );\n * } );\n *\n * // This event will be delegated to the parentView.\n * viewB.fire( 'click' );\n * ```\n *\n * **Note**: A view collection can be used directly in the {@link module:ui/template~TemplateDefinition definition}\n * of a {@link module:ui/template~Template template}.\n */\nexport default class ViewCollection extends Collection {\n    /**\n     * Creates a new instance of the {@link module:ui/viewcollection~ViewCollection}.\n     *\n     * @param initialItems The initial items of the collection.\n     */\n    constructor(initialItems = []) {\n        super(initialItems, {\n            // An #id Number attribute should be legal and not break the `ViewCollection` instance.\n            // https://github.com/ckeditor/ckeditor5-ui/issues/93\n            idProperty: 'viewUid'\n        });\n        // Handle {@link module:ui/view~View#element} in DOM when a new view is added to the collection.\n        this.on('add', (evt, view, index) => {\n            this._renderViewIntoCollectionParent(view, index);\n        });\n        // Handle {@link module:ui/view~View#element} in DOM when a view is removed from the collection.\n        this.on('remove', (evt, view) => {\n            if (view.element && this._parentElement) {\n                view.element.remove();\n            }\n        });\n        this._parentElement = null;\n    }\n    /**\n     * Destroys the view collection along with child views.\n     * See the view {@link module:ui/view~View#destroy} method.\n     */\n    destroy() {\n        this.map(view => view.destroy());\n    }\n    /**\n     * Sets the parent HTML element of this collection. When parent is set, {@link #add adding} and\n     * {@link #remove removing} views in the collection synchronizes their\n     * {@link module:ui/view~View#element elements} in the parent element.\n     *\n     * @param element A new parent element.\n     */\n    setParent(elementOrDocFragment) {\n        this._parentElement = elementOrDocFragment;\n        // Take care of the initial collection items passed to the constructor.\n        for (const view of this) {\n            this._renderViewIntoCollectionParent(view);\n        }\n    }\n    /**\n     * Delegates selected events coming from within views in the collection to any\n     * {@link module:utils/emittermixin~Emitter}.\n     *\n     * For the following views and collection:\n     *\n     * ```ts\n     * const viewA = new View();\n     * const viewB = new View();\n     * const viewC = new View();\n     *\n     * const views = parentView.createCollection();\n     *\n     * views.delegate( 'eventX' ).to( viewB );\n     * views.delegate( 'eventX', 'eventY' ).to( viewC );\n     *\n     * views.add( viewA );\n     * ```\n     *\n     * the `eventX` is delegated (fired by) `viewB` and `viewC` along with `customData`:\n     *\n     * ```ts\n     * viewA.fire( 'eventX', customData );\n     * ```\n     *\n     * and `eventY` is delegated (fired by) `viewC` along with `customData`:\n     *\n     * ```ts\n     * viewA.fire( 'eventY', customData );\n     * ```\n     *\n     * See {@link module:utils/emittermixin~Emitter#delegate}.\n     *\n     * @param events {@link module:ui/view~View} event names to be delegated to another\n     * {@link module:utils/emittermixin~Emitter}.\n     * @returns Object with `to` property, a function which accepts the destination\n     * of {@link module:utils/emittermixin~Emitter#delegate delegated} events.\n     */\n    delegate(...events) {\n        if (!events.length || !isStringArray(events)) {\n            /**\n             * All event names must be strings.\n             *\n             * @error ui-viewcollection-delegate-wrong-events\n             */\n            throw new CKEditorError('ui-viewcollection-delegate-wrong-events', this);\n        }\n        return {\n            to: dest => {\n                // Activate delegating on existing views in this collection.\n                for (const view of this) {\n                    for (const evtName of events) {\n                        view.delegate(evtName).to(dest);\n                    }\n                }\n                // Activate delegating on future views in this collection.\n                this.on('add', (evt, view) => {\n                    for (const evtName of events) {\n                        view.delegate(evtName).to(dest);\n                    }\n                });\n                // Deactivate delegating when view is removed from this collection.\n                this.on('remove', (evt, view) => {\n                    for (const evtName of events) {\n                        view.stopDelegating(evtName, dest);\n                    }\n                });\n            }\n        };\n    }\n    /**\n     * This method {@link module:ui/view~View#render renders} a new view added to the collection.\n     *\n     * If the {@link #_parentElement parent element} of the collection is set, this method also adds\n     * the view's {@link module:ui/view~View#element} as a child of the parent in DOM at a specified index.\n     *\n     * **Note**: If index is not specified, the view's element is pushed as the last child\n     * of the parent element.\n     *\n     * @param view A new view added to the collection.\n     * @param index An index the view holds in the collection. When not specified,\n     * the view is added at the end.\n     */\n    _renderViewIntoCollectionParent(view, index) {\n        if (!view.isRendered) {\n            view.render();\n        }\n        if (view.element && this._parentElement) {\n            this._parentElement.insertBefore(view.element, this._parentElement.children[index]);\n        }\n    }\n    /**\n     * Removes a child view from the collection. If the {@link #setParent parent element} of the\n     * collection has been set, the {@link module:ui/view~View#element element} of the view is also removed\n     * in DOM, reflecting the order of the collection.\n     *\n     * See the {@link #add} method.\n     *\n     * @param subject The view to remove, its id or index in the collection.\n     * @returns The removed view.\n     */\n    remove(subject) {\n        return super.remove(subject);\n    }\n}\n/**\n * Check if all entries of the array are of `String` type.\n *\n * @param arr An array to be checked.\n */\nfunction isStringArray(arr) {\n    return arr.every(a => typeof a == 'string');\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module ui/template\n */\n/* global document */\nimport View from './view.js';\nimport ViewCollection from './viewcollection.js';\nimport { CKEditorError, EmitterMixin, isNode, toArray } from '@ckeditor/ckeditor5-utils';\nimport { isObject, cloneDeepWith } from 'lodash-es';\nconst xhtmlNs = 'http://www.w3.org/1999/xhtml';\n/**\n * A basic Template class. It renders a DOM HTML element or text from a\n * {@link module:ui/template~TemplateDefinition definition} and supports element attributes, children,\n * bindings to {@link module:utils/observablemixin~Observable observables} and DOM event propagation.\n *\n * A simple template can look like this:\n *\n * ```ts\n * const bind = Template.bind( observable, emitter );\n *\n * new Template( {\n * \ttag: 'p',\n * \tattributes: {\n * \t\tclass: 'foo',\n * \t\tstyle: {\n * \t\t\tbackgroundColor: 'yellow'\n * \t\t}\n * \t},\n * \ton: {\n * \t\tclick: bind.to( 'clicked' )\n * \t},\n * \tchildren: [\n * \t\t'A paragraph.'\n * \t]\n * } ).render();\n * ```\n *\n * and it will render the following HTML element:\n *\n * ```html\n * <p class=\"foo\" style=\"background-color: yellow;\">A paragraph.</p>\n * ```\n *\n * Additionally, the `observable` will always fire `clicked` upon clicking `<p>` in the DOM.\n *\n * See {@link module:ui/template~TemplateDefinition} to know more about templates and complex\n * template definitions.\n */\nexport default class Template extends EmitterMixin() {\n    /**\n     * Creates an instance of the {@link ~Template} class.\n     *\n     * @param def The definition of the template.\n     */\n    constructor(def) {\n        super();\n        Object.assign(this, normalize(clone(def)));\n        this._isRendered = false;\n        this._revertData = null;\n    }\n    /**\n     * Renders a DOM Node (an HTML element or text) out of the template.\n     *\n     * ```ts\n     * const domNode = new Template( { ... } ).render();\n     * ```\n     *\n     * See: {@link #apply}.\n     */\n    render() {\n        const node = this._renderNode({\n            intoFragment: true\n        });\n        this._isRendered = true;\n        return node;\n    }\n    /**\n     * Applies the template to an existing DOM Node, either HTML element or text.\n     *\n     * **Note:** No new DOM nodes will be created. Applying extends:\n     *\n     * {@link module:ui/template~TemplateDefinition attributes},\n     * {@link module:ui/template~TemplateDefinition event listeners}, and\n     * `textContent` of {@link module:ui/template~TemplateDefinition children} only.\n     *\n     * **Note:** Existing `class` and `style` attributes are extended when a template\n     * is applied to an HTML element, while other attributes and `textContent` are overridden.\n     *\n     * **Note:** The process of applying a template can be easily reverted using the\n     * {@link module:ui/template~Template#revert} method.\n     *\n     * ```ts\n     * const element = document.createElement( 'div' );\n     * const observable = new Model( { divClass: 'my-div' } );\n     * const emitter = Object.create( EmitterMixin );\n     * const bind = Template.bind( observable, emitter );\n     *\n     * new Template( {\n     * \tattributes: {\n     * \t\tid: 'first-div',\n     * \t\tclass: bind.to( 'divClass' )\n     * \t},\n     * \ton: {\n     * \t\tclick: bind( 'elementClicked' ) // Will be fired by the observable.\n     * \t},\n     * \tchildren: [\n     * \t\t'Div text.'\n     * \t]\n     * } ).apply( element );\n     *\n     * console.log( element.outerHTML ); // -> '<div id=\"first-div\" class=\"my-div\"></div>'\n     * ```\n     *\n     * @see module:ui/template~Template#render\n     * @see module:ui/template~Template#revert\n     * @param node Root node for the template to apply.\n     */\n    apply(node) {\n        this._revertData = getEmptyRevertData();\n        this._renderNode({\n            node,\n            intoFragment: false,\n            isApplying: true,\n            revertData: this._revertData\n        });\n        return node;\n    }\n    /**\n     * Reverts a template {@link module:ui/template~Template#apply applied} to a DOM node.\n     *\n     * @param node The root node for the template to revert. In most of the cases, it is the\n     * same node used by {@link module:ui/template~Template#apply}.\n     */\n    revert(node) {\n        if (!this._revertData) {\n            /**\n             * Attempting to revert a template which has not been applied yet.\n             *\n             * @error ui-template-revert-not-applied\n             */\n            throw new CKEditorError('ui-template-revert-not-applied', [this, node]);\n        }\n        this._revertTemplateFromNode(node, this._revertData);\n    }\n    /**\n     * Returns an iterator which traverses the template in search of {@link module:ui/view~View}\n     * instances and returns them one by one.\n     *\n     * ```ts\n     * const viewFoo = new View();\n     * const viewBar = new View();\n     * const viewBaz = new View();\n     * const template = new Template( {\n     * \ttag: 'div',\n     * \tchildren: [\n     * \t\tviewFoo,\n     * \t\t{\n     * \t\t\ttag: 'div',\n     * \t\t\tchildren: [\n     * \t\t\t\tviewBar\n     * \t\t\t]\n     * \t\t},\n     * \t\tviewBaz\n     * \t]\n     * } );\n     *\n     * // Logs: viewFoo, viewBar, viewBaz\n     * for ( const view of template.getViews() ) {\n     * \tconsole.log( view );\n     * }\n     * ```\n     */\n    *getViews() {\n        function* search(def) {\n            if (def.children) {\n                for (const child of def.children) {\n                    if (isView(child)) {\n                        yield child;\n                    }\n                    else if (isTemplate(child)) {\n                        yield* search(child);\n                    }\n                }\n            }\n        }\n        yield* search(this);\n    }\n    /**\n     * An entry point to the interface which binds DOM nodes to\n     * {@link module:utils/observablemixin~Observable observables}.\n     * There are two types of bindings:\n     *\n     * * HTML element attributes or text `textContent` synchronized with attributes of an\n     * {@link module:utils/observablemixin~Observable}. Learn more about {@link module:ui/template~BindChain#to}\n     * and {@link module:ui/template~BindChain#if}.\n     *\n     * ```ts\n     * const bind = Template.bind( observable, emitter );\n     *\n     * new Template( {\n     * \tattributes: {\n     * \t\t// Binds the element \"class\" attribute to observable#classAttribute.\n     * \t\tclass: bind.to( 'classAttribute' )\n     * \t}\n     * } ).render();\n     * ```\n     *\n     * * DOM events fired on HTML element propagated through\n     * {@link module:utils/observablemixin~Observable}. Learn more about {@link module:ui/template~BindChain#to}.\n     *\n     * ```ts\n     * const bind = Template.bind( observable, emitter );\n     *\n     * new Template( {\n     * \ton: {\n     * \t\t// Will be fired by the observable.\n     * \t\tclick: bind( 'elementClicked' )\n     * \t}\n     * } ).render();\n     * ```\n     *\n     * Also see {@link module:ui/view~View#bindTemplate}.\n     *\n     * @param observable An observable which provides boundable attributes.\n     * @param emitter An emitter that listens to observable attribute\n     * changes or DOM Events (depending on the kind of the binding). Usually, a {@link module:ui/view~View} instance.\n     */\n    static bind(observable, emitter) {\n        return {\n            to(eventNameOrFunctionOrAttribute, callback) {\n                return new TemplateToBinding({\n                    eventNameOrFunction: eventNameOrFunctionOrAttribute,\n                    attribute: eventNameOrFunctionOrAttribute,\n                    observable, emitter, callback\n                });\n            },\n            if(attribute, valueIfTrue, callback) {\n                return new TemplateIfBinding({\n                    observable, emitter, attribute, valueIfTrue, callback\n                });\n            }\n        };\n    }\n    /**\n     * Extends an existing {@link module:ui/template~Template} instance with some additional content\n     * from another {@link module:ui/template~TemplateDefinition}.\n     *\n     * ```ts\n     * const bind = Template.bind( observable, emitter );\n     *\n     * const template = new Template( {\n     * \ttag: 'p',\n     * \tattributes: {\n     * \t\tclass: 'a',\n     * \t\tdata-x: bind.to( 'foo' )\n     * \t},\n     * \tchildren: [\n     * \t\t{\n     * \t\t\ttag: 'span',\n     * \t\t\tattributes: {\n     * \t\t\t\tclass: 'b'\n     * \t\t\t},\n     * \t\t\tchildren: [\n     * \t\t\t\t'Span'\n     * \t\t\t]\n     * \t\t}\n     * \t]\n     *  } );\n     *\n     * // Instance-level extension.\n     * Template.extend( template, {\n     * \tattributes: {\n     * \t\tclass: 'b',\n     * \t\tdata-x: bind.to( 'bar' )\n     * \t},\n     * \tchildren: [\n     * \t\t{\n     * \t\t\tattributes: {\n     * \t\t\t\tclass: 'c'\n     * \t\t\t}\n     * \t\t}\n     * \t]\n     * } );\n     *\n     * // Child extension.\n     * Template.extend( template.children[ 0 ], {\n     * \tattributes: {\n     * \t\tclass: 'd'\n     * \t}\n     * } );\n     * ```\n     *\n     * the `outerHTML` of `template.render()` is:\n     *\n     * ```html\n     * <p class=\"a b\" data-x=\"{ observable.foo } { observable.bar }\">\n     * \t<span class=\"b c d\">Span</span>\n     * </p>\n     * ```\n     *\n     * @param template An existing template instance to be extended.\n     * @param def Additional definition to be applied to a template.\n     */\n    static extend(template, def) {\n        if (template._isRendered) {\n            /**\n             * Extending a template after rendering may not work as expected. To make sure\n             * the {@link module:ui/template~Template.extend extending} works for an element,\n             * make sure it happens before {@link module:ui/template~Template#render} is called.\n             *\n             * @error template-extend-render\n             */\n            throw new CKEditorError('template-extend-render', [this, template]);\n        }\n        extendTemplate(template, normalize(clone(def)));\n    }\n    /**\n     * Renders a DOM Node (either an HTML element or text) out of the template.\n     *\n     * @param data Rendering data.\n     */\n    _renderNode(data) {\n        let isInvalid;\n        if (data.node) {\n            // When applying, a definition cannot have \"tag\" and \"text\" at the same time.\n            isInvalid = this.tag && this.text;\n        }\n        else {\n            // When rendering, a definition must have either \"tag\" or \"text\": XOR( this.tag, this.text ).\n            isInvalid = this.tag ? this.text : !this.text;\n        }\n        if (isInvalid) {\n            /**\n             * Node definition cannot have the \"tag\" and \"text\" properties at the same time.\n             * Node definition must have either \"tag\" or \"text\" when rendering a new Node.\n             *\n             * @error ui-template-wrong-syntax\n             */\n            throw new CKEditorError('ui-template-wrong-syntax', this);\n        }\n        if (this.text) {\n            return this._renderText(data);\n        }\n        else {\n            return this._renderElement(data);\n        }\n    }\n    /**\n     * Renders an HTML element out of the template.\n     *\n     * @param data Rendering data.\n     */\n    _renderElement(data) {\n        let node = data.node;\n        if (!node) {\n            node = data.node = document.createElementNS(this.ns || xhtmlNs, this.tag);\n        }\n        this._renderAttributes(data);\n        this._renderElementChildren(data);\n        this._setUpListeners(data);\n        return node;\n    }\n    /**\n     * Renders a text node out of {@link module:ui/template~Template#text}.\n     *\n     * @param data Rendering data.\n     */\n    _renderText(data) {\n        let node = data.node;\n        // Save the original textContent to revert it in #revert().\n        if (node) {\n            data.revertData.text = node.textContent;\n        }\n        else {\n            node = data.node = document.createTextNode('');\n        }\n        // Check if this Text Node is bound to Observable. Cases:\n        //\n        //\t\ttext: [ Template.bind( ... ).to( ... ) ]\n        //\n        //\t\ttext: [\n        //\t\t\t'foo',\n        //\t\t\tTemplate.bind( ... ).to( ... ),\n        //\t\t\t...\n        //\t\t]\n        //\n        if (hasTemplateBinding(this.text)) {\n            this._bindToObservable({\n                schema: this.text,\n                updater: getTextUpdater(node),\n                data\n            });\n        }\n        // Simply set text. Cases:\n        //\n        //\t\ttext: [ 'all', 'are', 'static' ]\n        //\n        //\t\ttext: [ 'foo' ]\n        //\n        else {\n            node.textContent = this.text.join('');\n        }\n        return node;\n    }\n    /**\n     * Renders HTML element attributes out of {@link module:ui/template~Template#attributes}.\n     *\n     * @param data Rendering data.\n     */\n    _renderAttributes(data) {\n        if (!this.attributes) {\n            return;\n        }\n        const node = data.node;\n        const revertData = data.revertData;\n        for (const attrName in this.attributes) {\n            // Current attribute value in DOM.\n            const domAttrValue = node.getAttribute(attrName);\n            // The value to be set.\n            const attrValue = this.attributes[attrName];\n            // Save revert data.\n            if (revertData) {\n                revertData.attributes[attrName] = domAttrValue;\n            }\n            // Detect custom namespace:\n            //\n            //\t\tclass: {\n            //\t\t\tns: 'abc',\n            //\t\t\tvalue: Template.bind( ... ).to( ... )\n            //\t\t}\n            //\n            const attrNs = isNamespaced(attrValue) ? attrValue[0].ns : null;\n            // Activate binding if one is found. Cases:\n            //\n            //\t\tclass: [\n            //\t\t\tTemplate.bind( ... ).to( ... )\n            //\t\t]\n            //\n            //\t\tclass: [\n            //\t\t\t'bar',\n            //\t\t\tTemplate.bind( ... ).to( ... ),\n            //\t\t\t'baz'\n            //\t\t]\n            //\n            //\t\tclass: {\n            //\t\t\tns: 'abc',\n            //\t\t\tvalue: Template.bind( ... ).to( ... )\n            //\t\t}\n            //\n            if (hasTemplateBinding(attrValue)) {\n                // Normalize attributes with additional data like namespace:\n                //\n                //\t\tclass: {\n                //\t\t\tns: 'abc',\n                //\t\t\tvalue: [ ... ]\n                //\t\t}\n                //\n                const valueToBind = isNamespaced(attrValue) ? attrValue[0].value : attrValue;\n                // Extend the original value of attributes like \"style\" and \"class\",\n                // don't override them.\n                if (revertData && shouldExtend(attrName)) {\n                    valueToBind.unshift(domAttrValue);\n                }\n                this._bindToObservable({\n                    schema: valueToBind,\n                    updater: getAttributeUpdater(node, attrName, attrNs),\n                    data\n                });\n            }\n            // Style attribute could be an Object so it needs to be parsed in a specific way.\n            //\n            //\t\tstyle: {\n            //\t\t\twidth: '100px',\n            //\t\t\theight: Template.bind( ... ).to( ... )\n            //\t\t}\n            //\n            else if (attrName == 'style' && typeof attrValue[0] !== 'string') {\n                this._renderStyleAttribute(attrValue[0], data);\n            }\n            // Otherwise simply set the static attribute:\n            //\n            //\t\tclass: [ 'foo' ]\n            //\n            //\t\tclass: [ 'all', 'are', 'static' ]\n            //\n            //\t\tclass: [\n            //\t\t\t{\n            //\t\t\t\tns: 'abc',\n            //\t\t\t\tvalue: [ 'foo' ]\n            //\t\t\t}\n            //\t\t]\n            //\n            else {\n                // Extend the original value of attributes like \"style\" and \"class\",\n                // don't override them.\n                if (revertData && domAttrValue && shouldExtend(attrName)) {\n                    attrValue.unshift(domAttrValue);\n                }\n                const value = attrValue\n                    // Retrieve \"values\" from:\n                    //\n                    //\t\tclass: [\n                    //\t\t\t{\n                    //\t\t\t\tns: 'abc',\n                    //\t\t\t\tvalue: [ ... ]\n                    //\t\t\t}\n                    //\t\t]\n                    //\n                    .map((val) => val ? (val.value || val) : val)\n                    // Flatten the array.\n                    .reduce((prev, next) => prev.concat(next), [])\n                    // Convert into string.\n                    .reduce(arrayValueReducer, '');\n                if (!isFalsy(value)) {\n                    node.setAttributeNS(attrNs, attrName, value);\n                }\n            }\n        }\n    }\n    /**\n     * Renders the `style` attribute of an HTML element based on\n     * {@link module:ui/template~Template#attributes}.\n     *\n     * A style attribute is an object with static values:\n     *\n     * ```ts\n     * attributes: {\n     * \tstyle: {\n     * \t\tcolor: 'red'\n     * \t}\n     * }\n     * ```\n     *\n     * or values bound to {@link module:ui/model~Model} properties:\n     *\n     * ```ts\n     * attributes: {\n     * \tstyle: {\n     * \t\tcolor: bind.to( ... )\n     * \t}\n     * }\n     * ```\n     *\n     * Note: The `style` attribute is rendered without setting the namespace. It does not seem to be\n     * needed.\n     *\n     * @param styles Styles located in `attributes.style` of {@link module:ui/template~TemplateDefinition}.\n     * @param data Rendering data.\n     */\n    _renderStyleAttribute(styles, data) {\n        const node = data.node;\n        for (const styleName in styles) {\n            const styleValue = styles[styleName];\n            // Cases:\n            //\n            //\t\tstyle: {\n            //\t\t\tcolor: bind.to( 'attribute' )\n            //\t\t}\n            //\n            if (hasTemplateBinding(styleValue)) {\n                this._bindToObservable({\n                    schema: [styleValue],\n                    updater: getStyleUpdater(node, styleName),\n                    data\n                });\n            }\n            // Cases:\n            //\n            //\t\tstyle: {\n            //\t\t\tcolor: 'red'\n            //\t\t}\n            //\n            else {\n                node.style[styleName] = styleValue;\n            }\n        }\n    }\n    /**\n     * Recursively renders HTML element's children from {@link module:ui/template~Template#children}.\n     *\n     * @param data Rendering data.\n     */\n    _renderElementChildren(data) {\n        const node = data.node;\n        const container = data.intoFragment ? document.createDocumentFragment() : node;\n        const isApplying = data.isApplying;\n        let childIndex = 0;\n        for (const child of this.children) {\n            if (isViewCollection(child)) {\n                if (!isApplying) {\n                    child.setParent(node);\n                    // Note: ViewCollection renders its children.\n                    for (const view of child) {\n                        container.appendChild(view.element);\n                    }\n                }\n            }\n            else if (isView(child)) {\n                if (!isApplying) {\n                    if (!child.isRendered) {\n                        child.render();\n                    }\n                    container.appendChild(child.element);\n                }\n            }\n            else if (isNode(child)) {\n                container.appendChild(child);\n            }\n            else {\n                if (isApplying) {\n                    const revertData = data.revertData;\n                    const childRevertData = getEmptyRevertData();\n                    revertData.children.push(childRevertData);\n                    child._renderNode({\n                        intoFragment: false,\n                        node: container.childNodes[childIndex++],\n                        isApplying: true,\n                        revertData: childRevertData\n                    });\n                }\n                else {\n                    container.appendChild(child.render());\n                }\n            }\n        }\n        if (data.intoFragment) {\n            node.appendChild(container);\n        }\n    }\n    /**\n     * Activates `on` event listeners from the {@link module:ui/template~TemplateDefinition}\n     * on an HTML element.\n     *\n     * @param data Rendering data.\n     */\n    _setUpListeners(data) {\n        if (!this.eventListeners) {\n            return;\n        }\n        for (const key in this.eventListeners) {\n            const revertBindings = this.eventListeners[key].map(schemaItem => {\n                const [domEvtName, domSelector] = key.split('@');\n                return schemaItem.activateDomEventListener(domEvtName, domSelector, data);\n            });\n            if (data.revertData) {\n                data.revertData.bindings.push(revertBindings);\n            }\n        }\n    }\n    /**\n     * For a given {@link module:ui/template~TemplateValueSchema} containing {@link module:ui/template~TemplateBinding}\n     * activates the binding and sets its initial value.\n     *\n     * Note: {@link module:ui/template~TemplateValueSchema} can be for HTML element attributes or\n     * text node `textContent`.\n     *\n     * @param options Binding options.\n     * @param options.updater A function which updates the DOM (like attribute or text).\n     * @param options.data Rendering data.\n     */\n    _bindToObservable({ schema, updater, data }) {\n        const revertData = data.revertData;\n        // Set initial values.\n        syncValueSchemaValue(schema, updater, data);\n        const revertBindings = schema\n            // Filter \"falsy\" (false, undefined, null, '') value schema components out.\n            .filter(item => !isFalsy(item))\n            // Filter inactive bindings from schema, like static strings ('foo'), numbers (42), etc.\n            .filter((item) => item.observable)\n            // Once only the actual binding are left, let the emitter listen to observable change:attribute event.\n            // TODO: Reduce the number of listeners attached as many bindings may listen\n            // to the same observable attribute.\n            .map(templateBinding => templateBinding.activateAttributeListener(schema, updater, data));\n        if (revertData) {\n            revertData.bindings.push(revertBindings);\n        }\n    }\n    /**\n     * Reverts {@link module:ui/template~RenderData#revertData template data} from a node to\n     * return it to the original state.\n     *\n     * @param node A node to be reverted.\n     * @param revertData An object that stores information about what changes have been made by\n     * {@link #apply} to the node. See {@link module:ui/template~RenderData#revertData} for more information.\n     */\n    _revertTemplateFromNode(node, revertData) {\n        for (const binding of revertData.bindings) {\n            // Each binding may consist of several observable+observable#attribute.\n            // like the following has 2:\n            //\n            //\t\tclass: [\n            //\t\t\t'x',\n            //\t\t\tbind.to( 'foo' ),\n            //\t\t\t'y',\n            //\t\t\tbind.to( 'bar' )\n            //\t\t]\n            //\n            for (const revertBinding of binding) {\n                revertBinding();\n            }\n        }\n        if (revertData.text) {\n            node.textContent = revertData.text;\n            return;\n        }\n        const element = node;\n        for (const attrName in revertData.attributes) {\n            const attrValue = revertData.attributes[attrName];\n            // When the attribute has **not** been set before #apply().\n            if (attrValue === null) {\n                element.removeAttribute(attrName);\n            }\n            else {\n                element.setAttribute(attrName, attrValue);\n            }\n        }\n        for (let i = 0; i < revertData.children.length; ++i) {\n            this._revertTemplateFromNode(element.childNodes[i], revertData.children[i]);\n        }\n    }\n}\n/**\n * Describes a binding created by the {@link module:ui/template~Template.bind} interface.\n *\n * @internal\n */\nexport class TemplateBinding {\n    /**\n     * Creates an instance of the {@link module:ui/template~TemplateBinding} class.\n     *\n     * @param def The definition of the binding.\n     */\n    constructor(def) {\n        this.attribute = def.attribute;\n        this.observable = def.observable;\n        this.emitter = def.emitter;\n        this.callback = def.callback;\n    }\n    /**\n     * Returns the value of the binding. It is the value of the {@link module:ui/template~TemplateBinding#attribute} in\n     * {@link module:ui/template~TemplateBinding#observable}. The value may be processed by the\n     * {@link module:ui/template~TemplateBinding#callback}, if such has been passed to the binding.\n     *\n     * @param node A native DOM node, passed to the custom {@link module:ui/template~TemplateBinding#callback}.\n     * @returns The value of {@link module:ui/template~TemplateBinding#attribute} in\n     * {@link module:ui/template~TemplateBinding#observable}.\n     */\n    getValue(node) {\n        const value = this.observable[this.attribute];\n        return this.callback ? this.callback(value, node) : value;\n    }\n    /**\n     * Activates the listener which waits for changes of the {@link module:ui/template~TemplateBinding#attribute} in\n     * {@link module:ui/template~TemplateBinding#observable}, then updates the DOM with the aggregated\n     * value of {@link module:ui/template~TemplateValueSchema}.\n     *\n     * @param schema A full schema to generate an attribute or text in the DOM.\n     * @param updater A DOM updater function used to update the native DOM attribute or text.\n     * @param data Rendering data.\n     * @returns A function to sever the listener binding.\n     */\n    activateAttributeListener(schema, updater, data) {\n        const callback = () => syncValueSchemaValue(schema, updater, data);\n        this.emitter.listenTo(this.observable, `change:${this.attribute}`, callback);\n        // Allows revert of the listener.\n        return () => {\n            this.emitter.stopListening(this.observable, `change:${this.attribute}`, callback);\n        };\n    }\n}\n/**\n * Describes either:\n *\n * * a binding to an {@link module:utils/observablemixin~Observable},\n * * or a native DOM event binding.\n *\n * It is created by the {@link module:ui/template~BindChain#to} method.\n *\n * @internal\n */\nexport class TemplateToBinding extends TemplateBinding {\n    constructor(def) {\n        super(def);\n        this.eventNameOrFunction = def.eventNameOrFunction;\n    }\n    /**\n     * Activates the listener for the native DOM event, which when fired, is propagated by\n     * the {@link module:ui/template~TemplateBinding#emitter}.\n     *\n     * @param domEvtName The name of the native DOM event.\n     * @param domSelector The selector in the DOM to filter delegated events.\n     * @param data Rendering data.\n     * @returns A function to sever the listener binding.\n     */\n    activateDomEventListener(domEvtName, domSelector, data) {\n        const callback = (evt, domEvt) => {\n            if (!domSelector || domEvt.target.matches(domSelector)) {\n                if (typeof this.eventNameOrFunction == 'function') {\n                    this.eventNameOrFunction(domEvt);\n                }\n                else {\n                    this.observable.fire(this.eventNameOrFunction, domEvt);\n                }\n            }\n        };\n        this.emitter.listenTo(data.node, domEvtName, callback);\n        // Allows revert of the listener.\n        return () => {\n            this.emitter.stopListening(data.node, domEvtName, callback);\n        };\n    }\n}\n/**\n * Describes a binding to {@link module:utils/observablemixin~Observable} created by the {@link module:ui/template~BindChain#if}\n * method.\n *\n * @internal\n */\nexport class TemplateIfBinding extends TemplateBinding {\n    constructor(def) {\n        super(def);\n        this.valueIfTrue = def.valueIfTrue;\n    }\n    /**\n     * @inheritDoc\n     */\n    getValue(node) {\n        const value = super.getValue(node);\n        return isFalsy(value) ? false : (this.valueIfTrue || true);\n    }\n}\n/**\n * Checks whether given {@link module:ui/template~TemplateValueSchema} contains a\n * {@link module:ui/template~TemplateBinding}.\n */\nfunction hasTemplateBinding(schema) {\n    if (!schema) {\n        return false;\n    }\n    // Normalize attributes with additional data like namespace:\n    //\n    //\t\tclass: {\n    //\t\t\tns: 'abc',\n    //\t\t\tvalue: [ ... ]\n    //\t\t}\n    //\n    if (schema.value) {\n        schema = schema.value;\n    }\n    if (Array.isArray(schema)) {\n        return schema.some(hasTemplateBinding);\n    }\n    else if (schema instanceof TemplateBinding) {\n        return true;\n    }\n    return false;\n}\n/**\n * Assembles the value using {@link module:ui/template~TemplateValueSchema} and stores it in a form of\n * an Array. Each entry of the Array corresponds to one of {@link module:ui/template~TemplateValueSchema}\n * items.\n *\n * @param node DOM Node updated when {@link module:utils/observablemixin~Observable} changes.\n */\nfunction getValueSchemaValue(schema, node) {\n    return schema.map(schemaItem => {\n        // Process {@link module:ui/template~TemplateBinding} bindings.\n        if (schemaItem instanceof TemplateBinding) {\n            return schemaItem.getValue(node);\n        }\n        // All static values like strings, numbers, and \"falsy\" values (false, null, undefined, '', etc.) just pass.\n        return schemaItem;\n    });\n}\n/**\n * A function executed each time the bound Observable attribute changes, which updates the DOM with a value\n * constructed from {@link module:ui/template~TemplateValueSchema}.\n *\n * @param updater A function which updates the DOM (like attribute or text).\n * @param node DOM Node updated when {@link module:utils/observablemixin~Observable} changes.\n */\nfunction syncValueSchemaValue(schema, updater, { node }) {\n    const values = getValueSchemaValue(schema, node);\n    let value;\n    // Check if schema is a single Template.bind.if, like:\n    //\n    //\t\tclass: Template.bind.if( 'foo' )\n    //\n    if (schema.length == 1 && schema[0] instanceof TemplateIfBinding) {\n        value = values[0];\n    }\n    else {\n        value = values.reduce(arrayValueReducer, '');\n    }\n    if (isFalsy(value)) {\n        updater.remove();\n    }\n    else {\n        updater.set(value);\n    }\n}\n/**\n * Returns an object consisting of `set` and `remove` functions, which\n * can be used in the context of DOM Node to set or reset `textContent`.\n * @see module:ui/view~View#_bindToObservable\n *\n * @param node DOM Node to be modified.\n */\nfunction getTextUpdater(node) {\n    return {\n        set(value) {\n            node.textContent = value;\n        },\n        remove() {\n            node.textContent = '';\n        }\n    };\n}\n/**\n * Returns an object consisting of `set` and `remove` functions, which\n * can be used in the context of DOM Node to set or reset an attribute.\n * @see module:ui/view~View#_bindToObservable\n *\n * @param el DOM Node to be modified.\n * @param attrName Name of the attribute to be modified.\n * @param ns Namespace to use.\n */\nfunction getAttributeUpdater(el, attrName, ns) {\n    return {\n        set(value) {\n            el.setAttributeNS(ns, attrName, value);\n        },\n        remove() {\n            el.removeAttributeNS(ns, attrName);\n        }\n    };\n}\n/**\n * Returns an object consisting of `set` and `remove` functions, which\n * can be used in the context of CSSStyleDeclaration to set or remove a style.\n * @see module:ui/view~View#_bindToObservable\n *\n * @param el DOM Node to be modified.\n * @param styleName Name of the style to be modified.\n */\nfunction getStyleUpdater(el, styleName) {\n    return {\n        set(value) {\n            el.style[styleName] = value;\n        },\n        remove() {\n            el.style[styleName] = null;\n        }\n    };\n}\n/**\n * Clones definition of the template.\n */\nfunction clone(def) {\n    const clone = cloneDeepWith(def, value => {\n        // Don't clone the `Template.bind`* bindings because of the references to Observable\n        // and DomEmitterMixin instances inside, which would also be traversed and cloned by greedy\n        // cloneDeepWith algorithm. There's no point in cloning Observable/DomEmitterMixins\n        // along with the definition.\n        //\n        // Don't clone Template instances if provided as a child. They're simply #render()ed\n        // and nothing should interfere.\n        //\n        // Also don't clone View instances if provided as a child of the Template. The template\n        // instance will be extracted from the View during the normalization and there's no need\n        // to clone it.\n        if (value && (value instanceof TemplateBinding || isTemplate(value) || isView(value) || isViewCollection(value))) {\n            return value;\n        }\n    });\n    return clone;\n}\n/**\n * Normalizes given {@link module:ui/template~TemplateDefinition}.\n *\n * See:\n *  * {@link normalizeAttributes}\n *  * {@link normalizeListeners}\n *  * {@link normalizePlainTextDefinition}\n *  * {@link normalizeTextDefinition}\n *\n * @param def A template definition.\n * @returns Normalized definition.\n */\nfunction normalize(def) {\n    if (typeof def == 'string') {\n        def = normalizePlainTextDefinition(def);\n    }\n    else if (def.text) {\n        normalizeTextDefinition(def);\n    }\n    if (def.on) {\n        def.eventListeners = normalizeListeners(def.on);\n        // Template mixes EmitterMixin, so delete #on to avoid collision.\n        delete def.on;\n    }\n    if (!def.text) {\n        if (def.attributes) {\n            normalizeAttributes(def.attributes);\n        }\n        const children = [];\n        if (def.children) {\n            if (isViewCollection(def.children)) {\n                children.push(def.children);\n            }\n            else {\n                for (const child of def.children) {\n                    if (isTemplate(child) || isView(child) || isNode(child)) {\n                        children.push(child);\n                    }\n                    else {\n                        children.push(new Template(child));\n                    }\n                }\n            }\n        }\n        def.children = children;\n    }\n    return def;\n}\n/**\n * Normalizes \"attributes\" section of {@link module:ui/template~TemplateDefinition}.\n *\n * ```\n * attributes: {\n * \ta: 'bar',\n * \tb: {@link module:ui/template~TemplateBinding},\n * \tc: {\n * \t\tvalue: 'bar'\n * \t}\n * }\n * ```\n *\n * becomes\n *\n * ```\n * attributes: {\n * \ta: [ 'bar' ],\n * \tb: [ {@link module:ui/template~TemplateBinding} ],\n * \tc: {\n * \t\tvalue: [ 'bar' ]\n * \t}\n * }\n * ```\n */\nfunction normalizeAttributes(attributes) {\n    for (const a in attributes) {\n        if (attributes[a].value) {\n            attributes[a].value = toArray(attributes[a].value);\n        }\n        arrayify(attributes, a);\n    }\n}\n/**\n * Normalizes \"on\" section of {@link module:ui/template~TemplateDefinition}.\n *\n * ```\n * on: {\n * \ta: 'bar',\n * \tb: {@link module:ui/template~TemplateBinding},\n * \tc: [ {@link module:ui/template~TemplateBinding}, () => { ... } ]\n * }\n * ```\n *\n * becomes\n *\n * ```\n * on: {\n * \ta: [ 'bar' ],\n * \tb: [ {@link module:ui/template~TemplateBinding} ],\n * \tc: [ {@link module:ui/template~TemplateBinding}, () => { ... } ]\n * }\n * ```\n *\n * @returns Object containing normalized listeners.\n */\nfunction normalizeListeners(listeners) {\n    for (const l in listeners) {\n        arrayify(listeners, l);\n    }\n    return listeners;\n}\n/**\n * Normalizes \"string\" {@link module:ui/template~TemplateDefinition}.\n *\n * ```\n * \"foo\"\n * ```\n *\n * becomes\n *\n * ```\n * { text: [ 'foo' ] },\n * ```\n *\n * @returns Normalized template definition.\n */\nfunction normalizePlainTextDefinition(def) {\n    return {\n        text: [def]\n    };\n}\n/**\n * Normalizes text {@link module:ui/template~TemplateDefinition}.\n *\n * ```\n * children: [\n * \t{ text: 'def' },\n * \t{ text: {@link module:ui/template~TemplateBinding} }\n * ]\n * ```\n *\n * becomes\n *\n * ```\n * children: [\n * \t{ text: [ 'def' ] },\n * \t{ text: [ {@link module:ui/template~TemplateBinding} ] }\n * ]\n * ```\n */\nfunction normalizeTextDefinition(def) {\n    def.text = toArray(def.text);\n}\n/**\n * Wraps an entry in Object in an Array, if not already one.\n *\n * ```\n * {\n * \tx: 'y',\n * \ta: [ 'b' ]\n * }\n * ```\n *\n * becomes\n *\n * ```\n * {\n * \tx: [ 'y' ],\n * \ta: [ 'b' ]\n * }\n * ```\n */\nfunction arrayify(obj, key) {\n    obj[key] = toArray(obj[key]);\n}\n/**\n * A helper which concatenates the value avoiding unwanted\n * leading white spaces.\n */\nfunction arrayValueReducer(prev, cur) {\n    if (isFalsy(cur)) {\n        return prev;\n    }\n    else if (isFalsy(prev)) {\n        return cur;\n    }\n    else {\n        return `${prev} ${cur}`;\n    }\n}\n/**\n * Extends one object defined in the following format:\n *\n * ```\n * {\n * \tkey1: [Array1],\n * \tkey2: [Array2],\n * \t...\n * \tkeyN: [ArrayN]\n * }\n * ```\n *\n * with another object of the same data format.\n *\n * @param obj Base object.\n * @param ext Object extending base.\n */\nfunction extendObjectValueArray(obj, ext) {\n    for (const a in ext) {\n        if (obj[a]) {\n            obj[a].push(...ext[a]);\n        }\n        else {\n            obj[a] = ext[a];\n        }\n    }\n}\n/**\n * A helper for {@link module:ui/template~Template#extend}. Recursively extends {@link module:ui/template~Template} instance\n * with content from {@link module:ui/template~TemplateDefinition}. See {@link module:ui/template~Template#extend} to learn more.\n *\n * @param def A template instance to be extended.\n * @param def A definition which is to extend the template instance.\n * @param Error context.\n */\nfunction extendTemplate(template, def) {\n    if (def.attributes) {\n        if (!template.attributes) {\n            template.attributes = {};\n        }\n        extendObjectValueArray(template.attributes, def.attributes);\n    }\n    if (def.eventListeners) {\n        if (!template.eventListeners) {\n            template.eventListeners = {};\n        }\n        extendObjectValueArray(template.eventListeners, def.eventListeners);\n    }\n    if (def.text) {\n        template.text.push(...def.text);\n    }\n    if (def.children && def.children.length) {\n        if (template.children.length != def.children.length) {\n            /**\n             * The number of children in extended definition does not match.\n             *\n             * @error ui-template-extend-children-mismatch\n             */\n            throw new CKEditorError('ui-template-extend-children-mismatch', template);\n        }\n        let childIndex = 0;\n        for (const childDef of def.children) {\n            extendTemplate(template.children[childIndex++], childDef);\n        }\n    }\n}\n/**\n * Checks if value is \"falsy\".\n * Note: 0 (Number) is not \"falsy\" in this context.\n *\n * @param value Value to be checked.\n */\nfunction isFalsy(value) {\n    return !value && value !== 0;\n}\n/**\n * Checks if the item is an instance of {@link module:ui/view~View}\n *\n * @param value Value to be checked.\n */\nfunction isView(item) {\n    return item instanceof View;\n}\n/**\n * Checks if the item is an instance of {@link module:ui/template~Template}\n *\n * @param value Value to be checked.\n */\nfunction isTemplate(item) {\n    return item instanceof Template;\n}\n/**\n * Checks if the item is an instance of {@link module:ui/viewcollection~ViewCollection}\n *\n * @param value Value to be checked.\n */\nfunction isViewCollection(item) {\n    return item instanceof ViewCollection;\n}\n/**\n * Checks if value array contains the one with namespace.\n */\nfunction isNamespaced(attrValue) {\n    return isObject(attrValue[0]) && attrValue[0].ns;\n}\n/**\n * Creates an empty skeleton for {@link module:ui/template~Template#revert}\n * data.\n */\nfunction getEmptyRevertData() {\n    return {\n        children: [],\n        bindings: [],\n        attributes: {}\n    };\n}\n/**\n * Checks whether an attribute should be extended when\n * {@link module:ui/template~Template#apply} is called.\n *\n * @param attrName Attribute name to check.\n */\nfunction shouldExtend(attrName) {\n    return attrName == 'class' || attrName == 'style';\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* eslint-disable @typescript-eslint/no-invalid-void-type */\n/**\n * @module ui/view\n */\nimport ViewCollection from './viewcollection.js';\nimport Template from './template.js';\nimport { CKEditorError, Collection, DomEmitterMixin, ObservableMixin, isIterable } from '@ckeditor/ckeditor5-utils';\nimport '../theme/globals/globals.css';\n/**\n * The basic view class, which represents an HTML element created out of a\n * {@link module:ui/view~View#template}. Views are building blocks of the user interface and handle\n * interaction\n *\n * Views {@link module:ui/view~View#registerChild aggregate} children in\n * {@link module:ui/view~View#createCollection collections} and manage the life cycle of DOM\n * listeners e.g. by handling rendering and destruction.\n *\n * See the {@link module:ui/template~TemplateDefinition} syntax to learn more about shaping view\n * elements, attributes and listeners.\n *\n * ```ts\n * class SampleView extends View {\n * \tconstructor( locale ) {\n * \t\tsuper( locale );\n *\n * \t\tconst bind = this.bindTemplate;\n *\n * \t\t// Views define their interface (state) using observable attributes.\n * \t\tthis.set( 'elementClass', 'bar' );\n *\n * \t\tthis.setTemplate( {\n * \t\t\ttag: 'p',\n *\n * \t\t\t// The element of the view can be defined with its children.\n * \t\t\tchildren: [\n * \t\t\t\t'Hello',\n * \t\t\t\t{\n * \t\t\t\t\ttag: 'b',\n * \t\t\t\t\tchildren: [ 'world!' ]\n * \t\t\t\t}\n * \t\t\t],\n * \t\t\tattributes: {\n * \t\t\t\tclass: [\n * \t\t\t\t\t'foo',\n *\n * \t\t\t\t\t// Observable attributes control the state of the view in DOM.\n * \t\t\t\t\tbind.to( 'elementClass' )\n * \t\t\t\t]\n * \t\t\t},\n * \t\t\ton: {\n * \t\t\t\t// Views listen to DOM events and propagate them.\n * \t\t\t\tclick: bind.to( 'clicked' )\n * \t\t\t}\n * \t\t} );\n * \t}\n * }\n *\n * const view = new SampleView( locale );\n *\n * view.render();\n *\n * // Append <p class=\"foo bar\">Hello<b>world</b></p> to the <body>\n * document.body.appendChild( view.element );\n *\n * // Change the class attribute to <p class=\"foo baz\">Hello<b>world</b></p>\n * view.elementClass = 'baz';\n *\n * // Respond to the \"click\" event in DOM by executing a custom action.\n * view.on( 'clicked', () => {\n * \tconsole.log( 'The view has been clicked!' );\n * } );\n * ```\n */\nexport default class View extends DomEmitterMixin(ObservableMixin()) {\n    /**\n     * Creates an instance of the {@link module:ui/view~View} class.\n     *\n     * Also see {@link #render}.\n     *\n     * @param locale The localization services instance.\n     */\n    constructor(locale) {\n        super();\n        this.element = null;\n        this.isRendered = false;\n        this.locale = locale;\n        this.t = locale && locale.t;\n        this._viewCollections = new Collection();\n        this._unboundChildren = this.createCollection();\n        // Pass parent locale to its children.\n        this._viewCollections.on('add', (evt, collection) => {\n            collection.locale = locale;\n            collection.t = locale && locale.t;\n        });\n        this.decorate('render');\n    }\n    /**\n     * Shorthand for {@link module:ui/template~Template.bind}, a binding\n     * {@link module:ui/template~BindChain interface} pre–configured for the view instance.\n     *\n     * It provides {@link module:ui/template~BindChain#to `to()`} and\n     * {@link module:ui/template~BindChain#if `if()`} methods that initialize bindings with\n     * observable attributes and attach DOM listeners.\n     *\n     * ```ts\n     * class SampleView extends View {\n     * \tconstructor( locale ) {\n     * \t\tsuper( locale );\n     *\n     * \t\tconst bind = this.bindTemplate;\n     *\n     * \t\t// These {@link module:utils/observablemixin~Observable observable} attributes will control\n     * \t\t// the state of the view in DOM.\n     * \t\tthis.set( {\n     * \t\t\telementClass: 'foo',\n     * \t\t \tisEnabled: true\n     * \t\t } );\n     *\n     * \t\tthis.setTemplate( {\n     * \t\t\ttag: 'p',\n     *\n     * \t\t\tattributes: {\n     * \t\t\t\t// The class HTML attribute will follow elementClass\n     * \t\t\t\t// and isEnabled view attributes.\n     * \t\t\t\tclass: [\n     * \t\t\t\t\tbind.to( 'elementClass' )\n     * \t\t\t\t\tbind.if( 'isEnabled', 'present-when-enabled' )\n     * \t\t\t\t]\n     * \t\t\t},\n     *\n     * \t\t\ton: {\n     * \t\t\t\t// The view will fire the \"clicked\" event upon clicking <p> in DOM.\n     * \t\t\t\tclick: bind.to( 'clicked' )\n     * \t\t\t}\n     * \t\t} );\n     * \t}\n     * }\n     * ```\n     */\n    get bindTemplate() {\n        if (this._bindTemplate) {\n            return this._bindTemplate;\n        }\n        return (this._bindTemplate = Template.bind(this, this));\n    }\n    /**\n     * Creates a new collection of views, which can be used as\n     * {@link module:ui/template~Template#children} of this view.\n     *\n     * ```ts\n     * class SampleView extends View {\n     * \tconstructor( locale ) {\n     * \t\tsuper( locale );\n     *\n     * \t\tconst child = new ChildView( locale );\n     * \t\tthis.items = this.createCollection( [ child ] );\n     *\n     * \t\tthis.setTemplate( {\n     * \t\t\ttag: 'p',\n     *\n     * \t\t\t// `items` collection will render here.\n     * \t\t\tchildren: this.items\n     * \t\t} );\n     * \t}\n     * }\n     *\n     * const view = new SampleView( locale );\n     * view.render();\n     *\n     * // It will append <p><child#element></p> to the <body>.\n     * document.body.appendChild( view.element );\n     * ```\n     *\n     * @param views Initial views of the collection.\n     * @returns A new collection of view instances.\n     */\n    createCollection(views) {\n        const collection = new ViewCollection(views);\n        this._viewCollections.add(collection);\n        return collection;\n    }\n    /**\n     * Registers a new child view under the view instance. Once registered, a child\n     * view is managed by its parent, including {@link #render rendering}\n     * and {@link #destroy destruction}.\n     *\n     * To revert this, use {@link #deregisterChild}.\n     *\n     * ```ts\n     * class SampleView extends View {\n     * \tconstructor( locale ) {\n     * \t\tsuper( locale );\n     *\n     * \t\tthis.childA = new SomeChildView( locale );\n     * \t\tthis.childB = new SomeChildView( locale );\n     *\n     * \t\tthis.setTemplate( { tag: 'p' } );\n     *\n     * \t\t// Register the children.\n     * \t\tthis.registerChild( [ this.childA, this.childB ] );\n     * \t}\n     *\n     * \trender() {\n     * \t\tsuper.render();\n     *\n     * \t\tthis.element.appendChild( this.childA.element );\n     * \t\tthis.element.appendChild( this.childB.element );\n     * \t}\n     * }\n     *\n     * const view = new SampleView( locale );\n     *\n     * view.render();\n     *\n     * // Will append <p><childA#element><b></b><childB#element></p>.\n     * document.body.appendChild( view.element );\n     * ```\n     *\n     * **Note**: There's no need to add child views if they're already referenced in the\n     * {@link #template}:\n     *\n     * ```ts\n     * class SampleView extends View {\n     * \tconstructor( locale ) {\n     * \t\tsuper( locale );\n     *\n     * \t\tthis.childA = new SomeChildView( locale );\n     * \t\tthis.childB = new SomeChildView( locale );\n     *\n     * \t\tthis.setTemplate( {\n     * \t\t\ttag: 'p',\n     *\n     * \t\t\t// These children will be added automatically. There's no\n     * \t\t\t// need to call {@link #registerChild} for any of them.\n     * \t\t\tchildren: [ this.childA, this.childB ]\n     * \t\t} );\n     * \t}\n     *\n     * \t// ...\n     * }\n     * ```\n     *\n     * @param children Children views to be registered.\n     */\n    registerChild(children) {\n        if (!isIterable(children)) {\n            children = [children];\n        }\n        for (const child of children) {\n            this._unboundChildren.add(child);\n        }\n    }\n    /**\n     * The opposite of {@link #registerChild}. Removes a child view from this view instance.\n     * Once removed, the child is no longer managed by its parent, e.g. it can safely\n     * become a child of another parent view.\n     *\n     * @see #registerChild\n     * @param children Child views to be removed.\n     */\n    deregisterChild(children) {\n        if (!isIterable(children)) {\n            children = [children];\n        }\n        for (const child of children) {\n            this._unboundChildren.remove(child);\n        }\n    }\n    /**\n     * Sets the {@link #template} of the view with with given definition.\n     *\n     * A shorthand for:\n     *\n     * ```ts\n     * view.setTemplate( definition );\n     * ```\n     *\n     * @param definition Definition of view's template.\n     */\n    setTemplate(definition) {\n        this.template = new Template(definition);\n    }\n    /**\n     * {@link module:ui/template~Template.extend Extends} the {@link #template} of the view with\n     * with given definition.\n     *\n     * A shorthand for:\n     *\n     * ```ts\n     * Template.extend( view.template, definition );\n     * ```\n     *\n     * **Note**: Is requires the {@link #template} to be already set. See {@link #setTemplate}.\n     *\n     * @param definition Definition which extends the {@link #template}.\n     */\n    extendTemplate(definition) {\n        Template.extend(this.template, definition);\n    }\n    /**\n     * Recursively renders the view.\n     *\n     * Once the view is rendered:\n     * * the {@link #element} becomes an HTML element out of {@link #template},\n     * * the {@link #isRendered} flag is set `true`.\n     *\n     * **Note**: The children of the view:\n     * * defined directly in the {@link #template}\n     * * residing in collections created by the {@link #createCollection} method,\n     * * and added by {@link #registerChild}\n     * are also rendered in the process.\n     *\n     * In general, `render()` method is the right place to keep the code which refers to the\n     * {@link #element} and should be executed at the very beginning of the view's life cycle.\n     *\n     * It is possible to {@link module:ui/template~Template.extend} the {@link #template} before\n     * the view is rendered. To allow an early customization of the view (e.g. by its parent),\n     * such references should be done in `render()`.\n     *\n     * ```ts\n     * class SampleView extends View {\n     * \tconstructor() {\n     * \t\tthis.setTemplate( {\n     * \t\t\t// ...\n     * \t\t} );\n     * \t},\n     *\n     * \trender() {\n     * \t\t// View#element becomes available.\n     * \t\tsuper.render();\n     *\n     * \t\t// The \"scroll\" listener depends on #element.\n     * \t\tthis.listenTo( window, 'scroll', () => {\n     * \t\t\t// A reference to #element would render the #template and make it non-extendable.\n     * \t\t\tif ( window.scrollY > 0 ) {\n     * \t\t\t\tthis.element.scrollLeft = 100;\n     * \t\t\t} else {\n     * \t\t\t\tthis.element.scrollLeft = 0;\n     * \t\t\t}\n     * \t\t} );\n     * \t}\n     * }\n     *\n     * const view = new SampleView();\n     *\n     * // Let's customize the view before it gets rendered.\n     * view.extendTemplate( {\n     * \tattributes: {\n     * \t\tclass: [\n     * \t\t\t'additional-class'\n     * \t\t]\n     * \t}\n     * } );\n     *\n     * // Late rendering allows customization of the view.\n     * view.render();\n     * ```\n     */\n    render() {\n        if (this.isRendered) {\n            /**\n             * This View has already been rendered.\n             *\n             * @error ui-view-render-already-rendered\n             */\n            throw new CKEditorError('ui-view-render-already-rendered', this);\n        }\n        // Render #element of the view.\n        if (this.template) {\n            this.element = this.template.render();\n            // Auto–register view children from #template.\n            this.registerChild(this.template.getViews());\n        }\n        this.isRendered = true;\n    }\n    /**\n     * Recursively destroys the view instance and child views added by {@link #registerChild} and\n     * residing in collections created by the {@link #createCollection}.\n     *\n     * Destruction disables all event listeners:\n     * * created on the view, e.g. `view.on( 'event', () => {} )`,\n     * * defined in the {@link #template} for DOM events.\n     */\n    destroy() {\n        this.stopListening();\n        this._viewCollections.map(c => c.destroy());\n        // Template isn't obligatory for views.\n        if (this.template && this.template._revertData) {\n            this.template.revert(this.element);\n        }\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/* global DOMParser */\n/**\n * @module ui/icon/iconview\n */\nimport View from '../view.js';\nimport '../../theme/components/icon/icon.css';\n/**\n * The icon view class.\n */\nclass IconView extends View {\n    /**\n     * @inheritDoc\n     */\n    constructor() {\n        super();\n        const bind = this.bindTemplate;\n        this.set('content', '');\n        this.set('viewBox', '0 0 20 20');\n        this.set('fillColor', '');\n        this.set('isColorInherited', true);\n        this.set('isVisible', true);\n        this.setTemplate({\n            tag: 'svg',\n            ns: 'http://www.w3.org/2000/svg',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-icon',\n                    bind.if('isVisible', 'ck-hidden', value => !value),\n                    // Exclude icon internals from the CSS reset to allow rich (non-monochromatic) icons\n                    // (https://github.com/ckeditor/ckeditor5/issues/12599).\n                    'ck-reset_all-excluded',\n                    // The class to remove the dynamic color inheritance is toggleable\n                    // (https://github.com/ckeditor/ckeditor5/issues/12599).\n                    bind.if('isColorInherited', 'ck-icon_inherit-color')\n                ],\n                viewBox: bind.to('viewBox')\n            }\n        });\n    }\n    /**\n     * @inheritDoc\n     */\n    render() {\n        super.render();\n        this._updateXMLContent();\n        this._colorFillPaths();\n        // This is a hack for lack of innerHTML binding.\n        // See: https://github.com/ckeditor/ckeditor5-ui/issues/99.\n        this.on('change:content', () => {\n            this._updateXMLContent();\n            this._colorFillPaths();\n        });\n        this.on('change:fillColor', () => {\n            this._colorFillPaths();\n        });\n    }\n    /**\n     * Updates the {@link #element} with the value of {@link #content}.\n     */\n    _updateXMLContent() {\n        if (this.content) {\n            const parsed = new DOMParser().parseFromString(this.content.trim(), 'image/svg+xml');\n            const svg = parsed.querySelector('svg');\n            const viewBox = svg.getAttribute('viewBox');\n            if (viewBox) {\n                this.viewBox = viewBox;\n            }\n            // Preserve presentational attributes of the <svg> element from the source.\n            // They can affect rendering of the entire icon (https://github.com/ckeditor/ckeditor5/issues/12597).\n            for (const { name, value } of Array.from(svg.attributes)) {\n                if (IconView.presentationalAttributeNames.includes(name)) {\n                    this.element.setAttribute(name, value);\n                }\n            }\n            while (this.element.firstChild) {\n                this.element.removeChild(this.element.firstChild);\n            }\n            while (svg.childNodes.length > 0) {\n                this.element.appendChild(svg.childNodes[0]);\n            }\n        }\n    }\n    /**\n     * Fills all child `path.ck-icon__fill` with the `#fillColor`.\n     */\n    _colorFillPaths() {\n        if (this.fillColor) {\n            this.element.querySelectorAll('.ck-icon__fill').forEach(path => {\n                path.style.fill = this.fillColor;\n            });\n        }\n    }\n}\n/**\n * A list of presentational attributes that can be set on the `<svg>` element and should be preserved\n * when the icon {@link module:ui/icon/iconview~IconView#content content} is loaded.\n *\n * See the [specification](https://www.w3.org/TR/SVG/styling.html#TermPresentationAttribute) to learn more.\n */\nIconView.presentationalAttributeNames = [\n    'alignment-baseline', 'baseline-shift', 'clip-path', 'clip-rule', 'color', 'color-interpolation',\n    'color-interpolation-filters', 'color-rendering', 'cursor', 'direction', 'display', 'dominant-baseline', 'fill', 'fill-opacity',\n    'fill-rule', 'filter', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style',\n    'font-variant', 'font-weight', 'image-rendering', 'letter-spacing', 'lighting-color', 'marker-end', 'marker-mid', 'marker-start',\n    'mask', 'opacity', 'overflow', 'paint-order', 'pointer-events', 'shape-rendering', 'stop-color', 'stop-opacity', 'stroke',\n    'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke-width',\n    'text-anchor', 'text-decoration', 'text-overflow', 'text-rendering', 'transform', 'unicode-bidi', 'vector-effect',\n    'visibility', 'white-space', 'word-spacing', 'writing-mode'\n];\nexport default IconView;\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module ui/button/buttonlabelview\n */\nimport View from '../view.js';\n/**\n * A default implementation of the button view's label. It comes with a dynamic text support\n * via {@link module:ui/button/buttonlabelview~ButtonLabelView#text} property.\n */\nexport default class ButtonLabelView extends View {\n    /**\n     * @inheritDoc\n     */\n    constructor() {\n        super();\n        this.set({\n            style: undefined,\n            text: undefined,\n            id: undefined\n        });\n        const bind = this.bindTemplate;\n        this.setTemplate({\n            tag: 'span',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-button__label'\n                ],\n                style: bind.to('style'),\n                id: bind.to('id')\n            },\n            children: [\n                {\n                    text: bind.to('text')\n                }\n            ]\n        });\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module ui/button/buttonview\n */\nimport View from '../view.js';\nimport IconView from '../icon/iconview.js';\nimport ButtonLabelView from './buttonlabelview.js';\nimport { env, getEnvKeystrokeText, uid, delay } from '@ckeditor/ckeditor5-utils';\nimport '../../theme/components/button/button.css';\n/**\n * The button view class.\n *\n * ```ts\n * const view = new ButtonView();\n *\n * view.set( {\n * \tlabel: 'A button',\n * \tkeystroke: 'Ctrl+B',\n * \ttooltip: true,\n * \twithText: true\n * } );\n *\n * view.render();\n *\n * document.body.append( view.element );\n * ```\n */\nexport default class ButtonView extends View {\n    /**\n     * Creates an instance of the button view class.\n     *\n     * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n     * @param labelView The instance of the button's label. If not provided, an instance of\n     * {@link module:ui/button/buttonlabelview~ButtonLabelView} is used.\n     */\n    constructor(locale, labelView = new ButtonLabelView()) {\n        super(locale);\n        /**\n         * Delayed focus function for focus handling in Safari.\n         */\n        this._focusDelayed = null;\n        const bind = this.bindTemplate;\n        const ariaLabelUid = uid();\n        // Implement the Button interface.\n        this.set('ariaLabel', undefined);\n        this.set('ariaLabelledBy', `ck-editor__aria-label_${ariaLabelUid}`);\n        this.set('class', undefined);\n        this.set('labelStyle', undefined);\n        this.set('icon', undefined);\n        this.set('isEnabled', true);\n        this.set('isOn', false);\n        this.set('isVisible', true);\n        this.set('isToggleable', false);\n        this.set('keystroke', undefined);\n        this.set('label', undefined);\n        this.set('role', undefined);\n        this.set('tabindex', -1);\n        this.set('tooltip', false);\n        this.set('tooltipPosition', 's');\n        this.set('type', 'button');\n        this.set('withText', false);\n        this.set('withKeystroke', false);\n        this.children = this.createCollection();\n        this.labelView = this._setupLabelView(labelView);\n        this.iconView = new IconView();\n        this.iconView.extendTemplate({\n            attributes: {\n                class: 'ck-button__icon'\n            }\n        });\n        this.keystrokeView = this._createKeystrokeView();\n        this.bind('_tooltipString').to(this, 'tooltip', this, 'label', this, 'keystroke', this._getTooltipString.bind(this));\n        const template = {\n            tag: 'button',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-button',\n                    bind.to('class'),\n                    bind.if('isEnabled', 'ck-disabled', value => !value),\n                    bind.if('isVisible', 'ck-hidden', value => !value),\n                    bind.to('isOn', value => value ? 'ck-on' : 'ck-off'),\n                    bind.if('withText', 'ck-button_with-text'),\n                    bind.if('withKeystroke', 'ck-button_with-keystroke')\n                ],\n                role: bind.to('role'),\n                type: bind.to('type', value => value ? value : 'button'),\n                tabindex: bind.to('tabindex'),\n                'aria-label': bind.to('ariaLabel'),\n                'aria-labelledby': bind.to('ariaLabelledBy'),\n                'aria-disabled': bind.if('isEnabled', true, value => !value),\n                'aria-pressed': bind.to('isOn', value => this.isToggleable ? String(!!value) : false),\n                'data-cke-tooltip-text': bind.to('_tooltipString'),\n                'data-cke-tooltip-position': bind.to('tooltipPosition')\n            },\n            children: this.children,\n            on: {\n                click: bind.to(evt => {\n                    // We can't make the button disabled using the disabled attribute, because it won't be focusable.\n                    // Though, shouldn't this condition be moved to the button controller?\n                    if (this.isEnabled) {\n                        this.fire('execute');\n                    }\n                    else {\n                        // Prevent the default when button is disabled, to block e.g.\n                        // automatic form submitting. See ckeditor/ckeditor5-link#74.\n                        evt.preventDefault();\n                    }\n                })\n            }\n        };\n        // On Safari we have to force the focus on a button on click as it's the only browser\n        // that doesn't do that automatically. See #12115.\n        if (env.isSafari) {\n            if (!this._focusDelayed) {\n                this._focusDelayed = delay(() => this.focus(), 0);\n            }\n            template.on.mousedown = bind.to(() => {\n                this._focusDelayed();\n            });\n            template.on.mouseup = bind.to(() => {\n                this._focusDelayed.cancel();\n            });\n        }\n        this.setTemplate(template);\n    }\n    /**\n     * @inheritDoc\n     */\n    render() {\n        super.render();\n        if (this.icon) {\n            this.iconView.bind('content').to(this, 'icon');\n            this.children.add(this.iconView);\n        }\n        this.children.add(this.labelView);\n        if (this.withKeystroke && this.keystroke) {\n            this.children.add(this.keystrokeView);\n        }\n    }\n    /**\n     * Focuses the {@link #element} of the button.\n     */\n    focus() {\n        this.element.focus();\n    }\n    /**\n     * @inheritDoc\n     */\n    destroy() {\n        if (this._focusDelayed) {\n            this._focusDelayed.cancel();\n        }\n        super.destroy();\n    }\n    /**\n     * Binds the label view instance it with button attributes.\n     */\n    _setupLabelView(labelView) {\n        labelView.bind('text', 'style', 'id').to(this, 'label', 'labelStyle', 'ariaLabelledBy');\n        return labelView;\n    }\n    /**\n     * Creates a view that displays a keystroke next to a {@link #labelView label }\n     * and binds it with button attributes.\n     */\n    _createKeystrokeView() {\n        const keystrokeView = new View();\n        keystrokeView.setTemplate({\n            tag: 'span',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-button__keystroke'\n                ]\n            },\n            children: [\n                {\n                    text: this.bindTemplate.to('keystroke', text => getEnvKeystrokeText(text))\n                }\n            ]\n        });\n        return keystrokeView;\n    }\n    /**\n     * Gets the text for the tooltip from the combination of\n     * {@link #tooltip}, {@link #label} and {@link #keystroke} attributes.\n     *\n     * @see #tooltip\n     * @see #_tooltipString\n     * @param tooltip Button tooltip.\n     * @param label Button label.\n     * @param keystroke Button keystroke.\n     */\n    _getTooltipString(tooltip, label, keystroke) {\n        if (tooltip) {\n            if (typeof tooltip == 'string') {\n                return tooltip;\n            }\n            else {\n                if (keystroke) {\n                    keystroke = getEnvKeystrokeText(keystroke);\n                }\n                if (tooltip instanceof Function) {\n                    return tooltip(label, keystroke);\n                }\n                else {\n                    return `${label}${keystroke ? ` (${keystroke})` : ''}`;\n                }\n            }\n        }\n        return '';\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/observer/observer\n */\nimport { DomEmitterMixin } from '@ckeditor/ckeditor5-utils';\n/**\n * Abstract base observer class. Observers are classes which listen to DOM events, do the preliminary\n * processing and fire events on the {@link module:engine/view/document~Document} objects.\n * Observers can also add features to the view, for instance by updating its status or marking elements\n * which need a refresh on DOM events.\n */\nexport default class Observer extends DomEmitterMixin() {\n    /**\n     * Creates an instance of the observer.\n     */\n    constructor(view) {\n        super();\n        /**\n         * The state of the observer. If it is disabled, no events will be fired.\n         */\n        this._isEnabled = false;\n        this.view = view;\n        this.document = view.document;\n    }\n    /**\n     * The state of the observer. If it is disabled, no events will be fired.\n     */\n    get isEnabled() {\n        return this._isEnabled;\n    }\n    /**\n     * Enables the observer. This method is called when the observer is registered to the\n     * {@link module:engine/view/view~View} and after {@link module:engine/view/view~View#forceRender rendering}\n     * (all observers are {@link #disable disabled} before rendering).\n     *\n     * A typical use case for disabling observers is that mutation observers need to be disabled for the rendering.\n     * However, a child class may not need to be disabled, so it can implement an empty method.\n     *\n     * @see module:engine/view/observer/observer~Observer#disable\n     */\n    enable() {\n        this._isEnabled = true;\n    }\n    /**\n     * Disables the observer. This method is called before\n     * {@link module:engine/view/view~View#forceRender rendering} to prevent firing events during rendering.\n     *\n     * @see module:engine/view/observer/observer~Observer#enable\n     */\n    disable() {\n        this._isEnabled = false;\n    }\n    /**\n     * Disables and destroys the observer, among others removes event listeners created by the observer.\n     */\n    destroy() {\n        this.disable();\n        this.stopListening();\n    }\n    /**\n     * Checks whether a given DOM event should be ignored (should not be turned into a synthetic view document event).\n     *\n     * Currently, an event will be ignored only if its target or any of its ancestors has the `data-cke-ignore-events` attribute.\n     * This attribute can be used inside the structures generated by\n     * {@link module:engine/view/downcastwriter~DowncastWriter#createUIElement `DowncastWriter#createUIElement()`} to ignore events\n     * fired within a UI that should be excluded from CKEditor 5's realms.\n     *\n     * @param domTarget The DOM event target to check (usually an element, sometimes a text node and\n     * potentially sometimes a document, too).\n     * @returns Whether this event should be ignored by the observer.\n     */\n    checkShouldIgnoreEventFromTarget(domTarget) {\n        if (domTarget && domTarget.nodeType === 3) {\n            domTarget = domTarget.parentNode;\n        }\n        if (!domTarget || domTarget.nodeType !== 1) {\n            return false;\n        }\n        return domTarget.matches('[data-cke-ignore-events], [data-cke-ignore-events] *');\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/observer/domeventdata\n */\nimport { extend } from 'lodash-es';\n/**\n * Information about a DOM event in context of the {@link module:engine/view/document~Document}.\n * It wraps the native event, which usually should not be used as the wrapper contains\n * additional data (like key code for keyboard events).\n *\n * @typeParam TEvent The type of DOM Event that this class represents.\n */\nexport default class DomEventData {\n    /**\n     * @param view The instance of the view controller.\n     * @param domEvent The DOM event.\n     * @param additionalData Additional properties that the instance should contain.\n     */\n    constructor(view, domEvent, additionalData) {\n        this.view = view;\n        this.document = view.document;\n        this.domEvent = domEvent;\n        this.domTarget = domEvent.target;\n        extend(this, additionalData);\n    }\n    /**\n     * The tree view element representing the target.\n     */\n    get target() {\n        return this.view.domConverter.mapDomToView(this.domTarget);\n    }\n    /**\n     * Prevents the native's event default action.\n     */\n    preventDefault() {\n        this.domEvent.preventDefault();\n    }\n    /**\n     * Stops native event propagation.\n     */\n    stopPropagation() {\n        this.domEvent.stopPropagation();\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/observer/domeventobserver\n */\nimport Observer from './observer.js';\nimport DomEventData from './domeventdata.js';\n/**\n * Base class for DOM event observers. This class handles\n * {@link module:engine/view/observer/observer~Observer#observe adding} listeners to DOM elements,\n * {@link module:engine/view/observer/observer~Observer#disable disabling} and\n * {@link module:engine/view/observer/observer~Observer#enable re-enabling} events.\n * Child class needs to define\n * {@link module:engine/view/observer/domeventobserver~DomEventObserver#domEventType DOM event type} and\n * {@link module:engine/view/observer/domeventobserver~DomEventObserver#onDomEvent callback}.\n *\n * For instance:\n *\n * ```ts\n * class ClickObserver extends DomEventObserver<'click'> {\n * \t// It can also be defined as a normal property in the constructor.\n * \tget domEventType(): 'click' {\n * \t\treturn 'click';\n * \t}\n *\n * \tonDomEvent( domEvent: MouseEvent ): void {\n * \t\tthis.fire( 'click', domEvent );\n * \t}\n * }\n * ```\n *\n * @typeParam EventType DOM Event type name or an union of those.\n * @typeParam AdditionalData Additional data passed along with the event.\n */\nexport default class DomEventObserver extends Observer {\n    constructor() {\n        super(...arguments);\n        /**\n         * If set to `true` DOM events will be listened on the capturing phase.\n         * Default value is `false`.\n         */\n        this.useCapture = false;\n    }\n    /**\n     * @inheritDoc\n     */\n    observe(domElement) {\n        const types = typeof this.domEventType == 'string' ? [this.domEventType] : this.domEventType;\n        types.forEach(type => {\n            this.listenTo(domElement, type, (eventInfo, domEvent) => {\n                if (this.isEnabled && !this.checkShouldIgnoreEventFromTarget(domEvent.target)) {\n                    this.onDomEvent(domEvent);\n                }\n            }, { useCapture: this.useCapture });\n        });\n    }\n    /**\n     * @inheritDoc\n     */\n    stopObserving(domElement) {\n        this.stopListening(domElement);\n    }\n    /**\n     * Calls `Document#fire()` if observer {@link #isEnabled is enabled}.\n     *\n     * @see module:utils/emittermixin~Emitter#fire\n     * @param eventType The event type (name).\n     * @param domEvent The DOM event.\n     * @param additionalData The additional data which should extend the\n     * {@link module:engine/view/observer/domeventdata~DomEventData event data} object.\n     */\n    fire(eventType, domEvent, additionalData) {\n        if (this.isEnabled) {\n            this.document.fire(eventType, new DomEventData(this.view, domEvent, additionalData));\n        }\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/observer/clickobserver\n */\nimport DomEventObserver from './domeventobserver.js';\n/**\n * {@link module:engine/view/document~Document#event:click Click} event observer.\n *\n * Note that this observer is not available by default. To make it available it needs to be added to\n * {@link module:engine/view/view~View view controller} by a {@link module:engine/view/view~View#addObserver} method.\n */\nexport default class ClickObserver extends DomEventObserver {\n    constructor() {\n        super(...arguments);\n        /**\n         * @inheritDoc\n         */\n        this.domEventType = 'click';\n    }\n    /**\n     * @inheritDoc\n     */\n    onDomEvent(domEvent) {\n        this.fire(domEvent.type, domEvent);\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\nimport { global } from '@ckeditor/ckeditor5-utils';\n/**\n * Basic HTML writer. It uses the native `innerHTML` property for basic conversion\n * from a document fragment to an HTML string.\n */\nexport default class BasicHtmlWriter {\n    /**\n     * Returns an HTML string created from the document fragment.\n     */\n    getHtml(fragment) {\n        const doc = global.document.implementation.createHTMLDocument('');\n        const container = doc.createElement('div');\n        container.appendChild(fragment);\n        return container.innerHTML;\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/typecheckable\n */\nexport default class TypeCheckable {\n    /* istanbul ignore next -- @preserve */\n    is() {\n        // There are a lot of overloads above.\n        // Overriding method in derived classes remove them and only `is( type: string ): boolean` is visible which we don't want.\n        // One option would be to copy them all to all classes, but that's ugly.\n        // It's best when TypeScript compiler doesn't see those overloads, except the one in the top base class.\n        // To overload a method, but not let the compiler see it, do after class definition:\n        // `MyClass.prototype.is = function( type: string ) {...}`\n        throw new Error('is() method is abstract');\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/node\n */\nimport TypeCheckable from './typecheckable.js';\nimport { CKEditorError, EmitterMixin, compareArrays } from '@ckeditor/ckeditor5-utils';\nimport { clone } from 'lodash-es';\n// To check if component is loaded more than once.\nimport '@ckeditor/ckeditor5-utils/src/version.js';\n/**\n * Abstract view node class.\n *\n * This is an abstract class. Its constructor should not be used directly.\n * Use the {@link module:engine/view/downcastwriter~DowncastWriter} or {@link module:engine/view/upcastwriter~UpcastWriter}\n * to create new instances of view nodes.\n */\nexport default class Node extends EmitterMixin(TypeCheckable) {\n    /**\n     * Creates a tree view node.\n     *\n     * @param document The document instance to which this node belongs.\n     */\n    constructor(document) {\n        super();\n        this.document = document;\n        this.parent = null;\n    }\n    /**\n     * Index of the node in the parent element or null if the node has no parent.\n     *\n     * Accessing this property throws an error if this node's parent element does not contain it.\n     * This means that view tree got broken.\n     */\n    get index() {\n        let pos;\n        if (!this.parent) {\n            return null;\n        }\n        // No parent or child doesn't exist in parent's children.\n        if ((pos = this.parent.getChildIndex(this)) == -1) {\n            /**\n             * The node's parent does not contain this node. It means that the document tree is corrupted.\n             *\n             * @error view-node-not-found-in-parent\n             */\n            throw new CKEditorError('view-node-not-found-in-parent', this);\n        }\n        return pos;\n    }\n    /**\n     * Node's next sibling, or `null` if it is the last child.\n     */\n    get nextSibling() {\n        const index = this.index;\n        return (index !== null && this.parent.getChild(index + 1)) || null;\n    }\n    /**\n     * Node's previous sibling, or `null` if it is the first child.\n     */\n    get previousSibling() {\n        const index = this.index;\n        return (index !== null && this.parent.getChild(index - 1)) || null;\n    }\n    /**\n     * Top-most ancestor of the node. If the node has no parent it is the root itself.\n     */\n    get root() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n        let root = this;\n        while (root.parent) {\n            root = root.parent;\n        }\n        return root;\n    }\n    /**\n     * Returns true if the node is in a tree rooted in the document (is a descendant of one of its roots).\n     */\n    isAttached() {\n        return this.root.is('rootElement');\n    }\n    /**\n     * Gets a path to the node. The path is an array containing indices of consecutive ancestors of this node,\n     * beginning from {@link module:engine/view/node~Node#root root}, down to this node's index.\n     *\n     * ```ts\n     * const abc = downcastWriter.createText( 'abc' );\n     * const foo = downcastWriter.createText( 'foo' );\n     * const h1 = downcastWriter.createElement( 'h1', null, downcastWriter.createText( 'header' ) );\n     * const p = downcastWriter.createElement( 'p', null, [ abc, foo ] );\n     * const div = downcastWriter.createElement( 'div', null, [ h1, p ] );\n     * foo.getPath(); // Returns [ 1, 3 ]. `foo` is in `p` which is in `div`. `p` starts at offset 1, while `foo` at 3.\n     * h1.getPath(); // Returns [ 0 ].\n     * div.getPath(); // Returns [].\n     * ```\n     *\n     * @returns The path.\n     */\n    getPath() {\n        const path = [];\n        // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n        let node = this;\n        while (node.parent) {\n            path.unshift(node.index);\n            node = node.parent;\n        }\n        return path;\n    }\n    /**\n     * Returns ancestors array of this node.\n     *\n     * @param options Options object.\n     * @param options.includeSelf When set to `true` this node will be also included in parent's array.\n     * @param options.parentFirst When set to `true`, array will be sorted from node's parent to root element,\n     * otherwise root element will be the first item in the array.\n     * @returns Array with ancestors.\n     */\n    getAncestors(options = {}) {\n        const ancestors = [];\n        let parent = options.includeSelf ? this : this.parent;\n        while (parent) {\n            ancestors[options.parentFirst ? 'push' : 'unshift'](parent);\n            parent = parent.parent;\n        }\n        return ancestors;\n    }\n    /**\n     * Returns a {@link module:engine/view/element~Element} or {@link module:engine/view/documentfragment~DocumentFragment}\n     * which is a common ancestor of both nodes.\n     *\n     * @param node The second node.\n     * @param options Options object.\n     * @param options.includeSelf When set to `true` both nodes will be considered \"ancestors\" too.\n     * Which means that if e.g. node A is inside B, then their common ancestor will be B.\n     */\n    getCommonAncestor(node, options = {}) {\n        const ancestorsA = this.getAncestors(options);\n        const ancestorsB = node.getAncestors(options);\n        let i = 0;\n        while (ancestorsA[i] == ancestorsB[i] && ancestorsA[i]) {\n            i++;\n        }\n        return i === 0 ? null : ancestorsA[i - 1];\n    }\n    /**\n     * Returns whether this node is before given node. `false` is returned if nodes are in different trees (for example,\n     * in different {@link module:engine/view/documentfragment~DocumentFragment}s).\n     *\n     * @param node Node to compare with.\n     */\n    isBefore(node) {\n        // Given node is not before this node if they are same.\n        if (this == node) {\n            return false;\n        }\n        // Return `false` if it is impossible to compare nodes.\n        if (this.root !== node.root) {\n            return false;\n        }\n        const thisPath = this.getPath();\n        const nodePath = node.getPath();\n        const result = compareArrays(thisPath, nodePath);\n        switch (result) {\n            case 'prefix':\n                return true;\n            case 'extension':\n                return false;\n            default:\n                return thisPath[result] < nodePath[result];\n        }\n    }\n    /**\n     * Returns whether this node is after given node. `false` is returned if nodes are in different trees (for example,\n     * in different {@link module:engine/view/documentfragment~DocumentFragment}s).\n     *\n     * @param node Node to compare with.\n     */\n    isAfter(node) {\n        // Given node is not before this node if they are same.\n        if (this == node) {\n            return false;\n        }\n        // Return `false` if it is impossible to compare nodes.\n        if (this.root !== node.root) {\n            return false;\n        }\n        // In other cases, just check if the `node` is before, and return the opposite.\n        return !this.isBefore(node);\n    }\n    /**\n     * Removes node from parent.\n     *\n     * @internal\n     */\n    _remove() {\n        this.parent._removeChildren(this.index);\n    }\n    /**\n     * @internal\n     * @param type Type of the change.\n     * @param node Changed node.\n     * @fires change\n     */\n    _fireChange(type, node) {\n        this.fire(`change:${type}`, node);\n        if (this.parent) {\n            this.parent._fireChange(type, node);\n        }\n    }\n    /**\n     * Custom toJSON method to solve child-parent circular dependencies.\n     *\n     * @returns Clone of this object with the parent property removed.\n     */\n    toJSON() {\n        const json = clone(this);\n        // Due to circular references we need to remove parent reference.\n        delete json.parent;\n        return json;\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nNode.prototype.is = function (type) {\n    return type === 'node' || type === 'view:node';\n};\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/text\n */\nimport Node from './node.js';\n/**\n * Tree view text node.\n *\n * The constructor of this class should not be used directly. To create a new text node instance\n * use the {@link module:engine/view/downcastwriter~DowncastWriter#createText `DowncastWriter#createText()`}\n * method when working on data downcasted from the model or the\n * {@link module:engine/view/upcastwriter~UpcastWriter#createText `UpcastWriter#createText()`}\n * method when working on non-semantic views.\n */\nexport default class Text extends Node {\n    /**\n     * Creates a tree view text node.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#createText\n     * @internal\n     * @param document The document instance to which this text node belongs.\n     * @param data The text's data.\n     */\n    constructor(document, data) {\n        super(document);\n        this._textData = data;\n    }\n    /**\n     * The text content.\n     */\n    get data() {\n        return this._textData;\n    }\n    /**\n     * The `_data` property is controlled by a getter and a setter.\n     *\n     * The getter is required when using the addition assignment operator on protected property:\n     *\n     * ```ts\n     * const foo = downcastWriter.createText( 'foo' );\n     * const bar = downcastWriter.createText( 'bar' );\n     *\n     * foo._data += bar.data;   // executes: `foo._data = foo._data + bar.data`\n     * console.log( foo.data ); // prints: 'foobar'\n     * ```\n     *\n     * If the protected getter didn't exist, `foo._data` will return `undefined` and result of the merge will be invalid.\n     *\n     * The setter sets data and fires the {@link module:engine/view/node~Node#event:change:text change event}.\n     *\n     * @internal\n     */\n    get _data() {\n        return this.data;\n    }\n    set _data(data) {\n        this._fireChange('text', this);\n        this._textData = data;\n    }\n    /**\n     * Checks if this text node is similar to other text node.\n     * Both nodes should have the same data to be considered as similar.\n     *\n     * @param otherNode Node to check if it is same as this node.\n     */\n    isSimilar(otherNode) {\n        if (!(otherNode instanceof Text)) {\n            return false;\n        }\n        return this === otherNode || this.data === otherNode.data;\n    }\n    /**\n     * Clones this node.\n     *\n     * @internal\n     * @returns Text node that is a clone of this node.\n     */\n    _clone() {\n        return new Text(this.document, this.data);\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nText.prototype.is = function (type) {\n    return type === '$text' || type === 'view:$text' ||\n        // This are legacy values kept for backward compatibility.\n        type === 'text' || type === 'view:text' ||\n        // From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n        type === 'node' || type === 'view:node';\n};\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/textproxy\n */\nimport TypeCheckable from './typecheckable.js';\nimport { CKEditorError } from '@ckeditor/ckeditor5-utils';\n/**\n * TextProxy is a wrapper for substring of {@link module:engine/view/text~Text}. Instance of this class is created by\n * {@link module:engine/view/treewalker~TreeWalker} when only a part of {@link module:engine/view/text~Text} needs to be returned.\n *\n * `TextProxy` has an API similar to {@link module:engine/view/text~Text Text} and allows to do most of the common tasks performed\n * on view nodes.\n *\n * **Note:** Some `TextProxy` instances may represent whole text node, not just a part of it.\n * See {@link module:engine/view/textproxy~TextProxy#isPartial}.\n *\n * **Note:** `TextProxy` is a readonly interface.\n *\n * **Note:** `TextProxy` instances are created on the fly basing on the current state of parent {@link module:engine/view/text~Text}.\n * Because of this it is highly unrecommended to store references to `TextProxy instances because they might get\n * invalidated due to operations on Document. Also TextProxy is not a {@link module:engine/view/node~Node} so it can not be\n * inserted as a child of {@link module:engine/view/element~Element}.\n *\n * `TextProxy` instances are created by {@link module:engine/view/treewalker~TreeWalker view tree walker}. You should not need to create\n * an instance of this class by your own.\n */\nexport default class TextProxy extends TypeCheckable {\n    /**\n     * Creates a text proxy.\n     *\n     * @internal\n     * @param textNode Text node which part is represented by this text proxy.\n     * @param offsetInText Offset in {@link module:engine/view/textproxy~TextProxy#textNode text node}\n     * from which the text proxy starts.\n     * @param length Text proxy length, that is how many text node's characters, starting from `offsetInText` it represents.\n     * @constructor\n     */\n    constructor(textNode, offsetInText, length) {\n        super();\n        this.textNode = textNode;\n        if (offsetInText < 0 || offsetInText > textNode.data.length) {\n            /**\n             * Given offsetInText value is incorrect.\n             *\n             * @error view-textproxy-wrong-offsetintext\n             */\n            throw new CKEditorError('view-textproxy-wrong-offsetintext', this);\n        }\n        if (length < 0 || offsetInText + length > textNode.data.length) {\n            /**\n             * Given length value is incorrect.\n             *\n             * @error view-textproxy-wrong-length\n             */\n            throw new CKEditorError('view-textproxy-wrong-length', this);\n        }\n        this.data = textNode.data.substring(offsetInText, offsetInText + length);\n        this.offsetInText = offsetInText;\n    }\n    /**\n     * Offset size of this node.\n     */\n    get offsetSize() {\n        return this.data.length;\n    }\n    /**\n     * Flag indicating whether `TextProxy` instance covers only part of the original {@link module:engine/view/text~Text text node}\n     * (`true`) or the whole text node (`false`).\n     *\n     * This is `false` when text proxy starts at the very beginning of {@link module:engine/view/textproxy~TextProxy#textNode textNode}\n     * ({@link module:engine/view/textproxy~TextProxy#offsetInText offsetInText} equals `0`) and text proxy sizes is equal to\n     * text node size.\n     */\n    get isPartial() {\n        return this.data.length !== this.textNode.data.length;\n    }\n    /**\n     * Parent of this text proxy, which is same as parent of text node represented by this text proxy.\n     */\n    get parent() {\n        return this.textNode.parent;\n    }\n    /**\n     * Root of this text proxy, which is same as root of text node represented by this text proxy.\n     */\n    get root() {\n        return this.textNode.root;\n    }\n    /**\n     * {@link module:engine/view/document~Document View document} that owns this text proxy, or `null` if the text proxy is inside\n     * {@link module:engine/view/documentfragment~DocumentFragment document fragment}.\n     */\n    get document() {\n        return this.textNode.document;\n    }\n    /**\n     * Returns ancestors array of this text proxy.\n     *\n     * @param options Options object.\n     * @param options.includeSelf When set to `true`, textNode will be also included in parent's array.\n     * @param options.parentFirst When set to `true`, array will be sorted from text proxy parent to\n     * root element, otherwise root element will be the first item in the array.\n     * @returns Array with ancestors.\n     */\n    getAncestors(options = {}) {\n        const ancestors = [];\n        let parent = options.includeSelf ? this.textNode : this.parent;\n        while (parent !== null) {\n            ancestors[options.parentFirst ? 'push' : 'unshift'](parent);\n            parent = parent.parent;\n        }\n        return ancestors;\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nTextProxy.prototype.is = function (type) {\n    return type === '$textProxy' || type === 'view:$textProxy' ||\n        // This are legacy values kept for backward compatibility.\n        type === 'textProxy' || type === 'view:textProxy';\n};\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\nimport { isPlainObject } from 'lodash-es';\nimport { logWarning } from '@ckeditor/ckeditor5-utils';\n/**\n * View matcher class.\n * Instance of this class can be used to find {@link module:engine/view/element~Element elements} that match given pattern.\n */\nexport default class Matcher {\n    /**\n     * Creates new instance of Matcher.\n     *\n     * @param pattern Match patterns. See {@link module:engine/view/matcher~Matcher#add add method} for more information.\n     */\n    constructor(...pattern) {\n        this._patterns = [];\n        this.add(...pattern);\n    }\n    /**\n     * Adds pattern or patterns to matcher instance.\n     *\n     * ```ts\n     * // String.\n     * matcher.add( 'div' );\n     *\n     * // Regular expression.\n     * matcher.add( /^\\w/ );\n     *\n     * // Single class.\n     * matcher.add( {\n     * \tclasses: 'foobar'\n     * } );\n     * ```\n     *\n     * See {@link module:engine/view/matcher~MatcherPattern} for more examples.\n     *\n     * Multiple patterns can be added in one call:\n     *\n     * ```ts\n     * matcher.add( 'div', { classes: 'foobar' } );\n     * ```\n     *\n     * @param pattern Object describing pattern details. If string or regular expression\n     * is provided it will be used to match element's name. Pattern can be also provided in a form\n     * of a function - then this function will be called with each {@link module:engine/view/element~Element element} as a parameter.\n     * Function's return value will be stored under `match` key of the object returned from\n     * {@link module:engine/view/matcher~Matcher#match match} or {@link module:engine/view/matcher~Matcher#matchAll matchAll} methods.\n     */\n    add(...pattern) {\n        for (let item of pattern) {\n            // String or RegExp pattern is used as element's name.\n            if (typeof item == 'string' || item instanceof RegExp) {\n                item = { name: item };\n            }\n            this._patterns.push(item);\n        }\n    }\n    /**\n     * Matches elements for currently stored patterns. Returns match information about first found\n     * {@link module:engine/view/element~Element element}, otherwise returns `null`.\n     *\n     * Example of returned object:\n     *\n     * ```ts\n     * {\n     * \telement: <instance of found element>,\n     * \tpattern: <pattern used to match found element>,\n     * \tmatch: {\n     * \t\tname: true,\n     * \t\tattributes: [ 'title', 'href' ],\n     * \t\tclasses: [ 'foo' ],\n     * \t\tstyles: [ 'color', 'position' ]\n     * \t}\n     * }\n     * ```\n     *\n     * @see module:engine/view/matcher~Matcher#add\n     * @see module:engine/view/matcher~Matcher#matchAll\n     * @param element View element to match against stored patterns.\n     */\n    match(...element) {\n        for (const singleElement of element) {\n            for (const pattern of this._patterns) {\n                const match = isElementMatching(singleElement, pattern);\n                if (match) {\n                    return {\n                        element: singleElement,\n                        pattern,\n                        match\n                    };\n                }\n            }\n        }\n        return null;\n    }\n    /**\n     * Matches elements for currently stored patterns. Returns array of match information with all found\n     * {@link module:engine/view/element~Element elements}. If no element is found - returns `null`.\n     *\n     * @see module:engine/view/matcher~Matcher#add\n     * @see module:engine/view/matcher~Matcher#match\n     * @param element View element to match against stored patterns.\n     * @returns Array with match information about found elements or `null`. For more information\n     * see {@link module:engine/view/matcher~Matcher#match match method} description.\n     */\n    matchAll(...element) {\n        const results = [];\n        for (const singleElement of element) {\n            for (const pattern of this._patterns) {\n                const match = isElementMatching(singleElement, pattern);\n                if (match) {\n                    results.push({\n                        element: singleElement,\n                        pattern,\n                        match\n                    });\n                }\n            }\n        }\n        return results.length > 0 ? results : null;\n    }\n    /**\n     * Returns the name of the element to match if there is exactly one pattern added to the matcher instance\n     * and it matches element name defined by `string` (not `RegExp`). Otherwise, returns `null`.\n     *\n     * @returns Element name trying to match.\n     */\n    getElementName() {\n        if (this._patterns.length !== 1) {\n            return null;\n        }\n        const pattern = this._patterns[0];\n        const name = pattern.name;\n        return (typeof pattern != 'function' && name && !(name instanceof RegExp)) ? name : null;\n    }\n}\n/**\n * Returns match information if {@link module:engine/view/element~Element element} is matching provided pattern.\n * If element cannot be matched to provided pattern - returns `null`.\n *\n * @returns Returns object with match information or null if element is not matching.\n */\nfunction isElementMatching(element, pattern) {\n    // If pattern is provided as function - return result of that function;\n    if (typeof pattern == 'function') {\n        return pattern(element);\n    }\n    const match = {};\n    // Check element's name.\n    if (pattern.name) {\n        match.name = matchName(pattern.name, element.name);\n        if (!match.name) {\n            return null;\n        }\n    }\n    // Check element's attributes.\n    if (pattern.attributes) {\n        match.attributes = matchAttributes(pattern.attributes, element);\n        if (!match.attributes) {\n            return null;\n        }\n    }\n    // Check element's classes.\n    if (pattern.classes) {\n        match.classes = matchClasses(pattern.classes, element);\n        if (!match.classes) {\n            return null;\n        }\n    }\n    // Check element's styles.\n    if (pattern.styles) {\n        match.styles = matchStyles(pattern.styles, element);\n        if (!match.styles) {\n            return null;\n        }\n    }\n    return match;\n}\n/**\n * Checks if name can be matched by provided pattern.\n *\n * @returns Returns `true` if name can be matched, `false` otherwise.\n */\nfunction matchName(pattern, name) {\n    // If pattern is provided as RegExp - test against this regexp.\n    if (pattern instanceof RegExp) {\n        return !!name.match(pattern);\n    }\n    return pattern === name;\n}\n/**\n * Checks if an array of key/value pairs can be matched against provided patterns.\n *\n * Patterns can be provided in a following ways:\n * - a boolean value matches any attribute with any value (or no value):\n *\n * ```ts\n * pattern: true\n * ```\n *\n * - a RegExp expression or object matches any attribute name:\n *\n * ```ts\n * pattern: /h[1-6]/\n * ```\n *\n * - an object matches any attribute that has the same name as the object item's key, where object item's value is:\n * \t- equal to `true`, which matches any attribute value:\n *\n * ```ts\n * pattern: {\n * \trequired: true\n * }\n * ```\n *\n * \t- a string that is equal to attribute value:\n *\n * ```ts\n * pattern: {\n * \trel: 'nofollow'\n * }\n * ```\n *\n * \t- a regular expression that matches attribute value,\n *\n * ```ts\n * pattern: {\n * \tsrc: /^https/\n * }\n * ```\n *\n * - an array with items, where the item is:\n * \t- a string that is equal to attribute value:\n *\n * ```ts\n * pattern: [ 'data-property-1', 'data-property-2' ],\n * ```\n *\n * \t- an object with `key` and `value` property, where `key` is a regular expression matching attribute name and\n * \t\t`value` is either regular expression matching attribute value or a string equal to attribute value:\n *\n * ```ts\n * pattern: [\n * \t{ key: /^data-property-/, value: true },\n * \t// or:\n * \t{ key: /^data-property-/, value: 'foobar' },\n * \t// or:\n * \t{ key: /^data-property-/, value: /^foo/ }\n * ]\n * ```\n *\n * @param patterns Object with information about attributes to match.\n * @param keys Attribute, style or class keys.\n * @param valueGetter A function providing value for a given item key.\n * @returns Returns array with matched attribute names or `null` if no attributes were matched.\n */\nfunction matchPatterns(patterns, keys, valueGetter) {\n    const normalizedPatterns = normalizePatterns(patterns);\n    const normalizedItems = Array.from(keys);\n    const match = [];\n    normalizedPatterns.forEach(([patternKey, patternValue]) => {\n        normalizedItems.forEach(itemKey => {\n            if (isKeyMatched(patternKey, itemKey) &&\n                isValueMatched(patternValue, itemKey, valueGetter)) {\n                match.push(itemKey);\n            }\n        });\n    });\n    // Return matches only if there are at least as many of them as there are patterns.\n    // The RegExp pattern can match more than one item.\n    if (!normalizedPatterns.length || match.length < normalizedPatterns.length) {\n        return undefined;\n    }\n    return match;\n}\n/**\n * Bring all the possible pattern forms to an array of arrays where first item is a key and second is a value.\n *\n * Examples:\n *\n * Boolean pattern value:\n *\n * ```ts\n * true\n * ```\n *\n * to\n *\n * ```ts\n * [ [ true, true ] ]\n * ```\n *\n * Textual pattern value:\n *\n * ```ts\n * 'attribute-name-or-class-or-style'\n * ```\n *\n * to\n *\n * ```ts\n * [ [ 'attribute-name-or-class-or-style', true ] ]\n * ```\n *\n * Regular expression:\n *\n * ```ts\n * /^data-.*$/\n * ```\n *\n * to\n *\n * ```ts\n * [ [ /^data-.*$/, true ] ]\n * ```\n *\n * Objects (plain or with `key` and `value` specified explicitly):\n *\n * ```ts\n * {\n * \tsrc: /^https:.*$/\n * }\n * ```\n *\n * or\n *\n * ```ts\n * [ {\n * \tkey: 'src',\n * \tvalue: /^https:.*$/\n * } ]\n * ```\n *\n * to:\n *\n * ```ts\n * [ [ 'src', /^https:.*$/ ] ]\n * ```\n *\n * @returns Returns an array of objects or null if provided patterns were not in an expected form.\n */\nfunction normalizePatterns(patterns) {\n    if (Array.isArray(patterns)) {\n        return patterns.map((pattern) => {\n            if (isPlainObject(pattern)) {\n                if (pattern.key === undefined || pattern.value === undefined) {\n                    // Documented at the end of matcher.js.\n                    logWarning('matcher-pattern-missing-key-or-value', pattern);\n                }\n                return [pattern.key, pattern.value];\n            }\n            // Assume the pattern is either String or RegExp.\n            return [pattern, true];\n        });\n    }\n    if (isPlainObject(patterns)) {\n        return Object.entries(patterns);\n    }\n    // Other cases (true, string or regexp).\n    return [[patterns, true]];\n}\n/**\n * @param patternKey A pattern representing a key we want to match.\n * @param itemKey An actual item key (e.g. `'src'`, `'background-color'`, `'ck-widget'`) we're testing against pattern.\n */\nfunction isKeyMatched(patternKey, itemKey) {\n    return patternKey === true ||\n        patternKey === itemKey ||\n        patternKey instanceof RegExp && itemKey.match(patternKey);\n}\n/**\n * @param patternValue A pattern representing a value we want to match.\n * @param itemKey An item key, e.g. `background`, `href`, 'rel', etc.\n * @param valueGetter A function used to provide a value for a given `itemKey`.\n */\nfunction isValueMatched(patternValue, itemKey, valueGetter) {\n    if (patternValue === true) {\n        return true;\n    }\n    const itemValue = valueGetter(itemKey);\n    // For now, the reducers are not returning the full tree of properties.\n    // Casting to string preserves the old behavior until the root cause is fixed.\n    // More can be found in https://github.com/ckeditor/ckeditor5/issues/10399.\n    return patternValue === itemValue ||\n        patternValue instanceof RegExp && !!String(itemValue).match(patternValue);\n}\n/**\n * Checks if attributes of provided element can be matched against provided patterns.\n *\n * @param patterns Object with information about attributes to match. Each key of the object will be\n * used as attribute name. Value of each key can be a string or regular expression to match against attribute value.\n * @param  element Element which attributes will be tested.\n * @returns Returns array with matched attribute names or `null` if no attributes were matched.\n */\nfunction matchAttributes(patterns, element) {\n    const attributeKeys = new Set(element.getAttributeKeys());\n    // `style` and `class` attribute keys are deprecated. Only allow them in object pattern\n    // for backward compatibility.\n    if (isPlainObject(patterns)) {\n        if (patterns.style !== undefined) {\n            // Documented at the end of matcher.js.\n            logWarning('matcher-pattern-deprecated-attributes-style-key', patterns);\n        }\n        if (patterns.class !== undefined) {\n            // Documented at the end of matcher.js.\n            logWarning('matcher-pattern-deprecated-attributes-class-key', patterns);\n        }\n    }\n    else {\n        attributeKeys.delete('style');\n        attributeKeys.delete('class');\n    }\n    return matchPatterns(patterns, attributeKeys, key => element.getAttribute(key));\n}\n/**\n * Checks if classes of provided element can be matched against provided patterns.\n *\n * @param patterns Array of strings or regular expressions to match against element's classes.\n * @param element Element which classes will be tested.\n * @returns Returns array with matched class names or `null` if no classes were matched.\n */\nfunction matchClasses(patterns, element) {\n    // We don't need `getter` here because patterns for classes are always normalized to `[ className, true ]`.\n    return matchPatterns(patterns, element.getClassNames(), /* istanbul ignore next -- @preserve */ () => { });\n}\n/**\n * Checks if styles of provided element can be matched against provided patterns.\n *\n * @param patterns Object with information about styles to match. Each key of the object will be\n * used as style name. Value of each key can be a string or regular expression to match against style value.\n * @param element Element which styles will be tested.\n * @returns Returns array with matched style names or `null` if no styles were matched.\n */\nfunction matchStyles(patterns, element) {\n    return matchPatterns(patterns, element.getStyleNames(true), key => element.getStyle(key));\n}\n/**\n * The key-value matcher pattern is missing key or value. Both must be present.\n * Refer the documentation: {@link module:engine/view/matcher~MatcherPattern}.\n *\n * @param pattern Pattern with missing properties.\n * @error matcher-pattern-missing-key-or-value\n */\n/**\n * The key-value matcher pattern for `attributes` option is using deprecated `style` key.\n *\n * Use `styles` matcher pattern option instead:\n *\n * ```ts\n * // Instead of:\n * const pattern = {\n * \tattributes: {\n * \t\tkey1: 'value1',\n * \t\tkey2: 'value2',\n * \t\tstyle: /^border.*$/\n * \t}\n * }\n *\n * // Use:\n * const pattern = {\n * \tattributes: {\n * \t\tkey1: 'value1',\n * \t\tkey2: 'value2'\n * \t},\n * \tstyles: /^border.*$/\n * }\n * ```\n *\n * Refer to the {@glink updating/guides/update-to-29##update-to-ckeditor-5-v2910 Migration to v29.1.0} guide\n * and {@link module:engine/view/matcher~MatcherPattern} documentation.\n *\n * @param pattern Pattern with missing properties.\n * @error matcher-pattern-deprecated-attributes-style-key\n */\n/**\n * The key-value matcher pattern for `attributes` option is using deprecated `class` key.\n *\n * Use `classes` matcher pattern option instead:\n *\n * ```ts\n * // Instead of:\n * const pattern = {\n * \tattributes: {\n * \t\tkey1: 'value1',\n * \t\tkey2: 'value2',\n * \t\tclass: 'foobar'\n * \t}\n * }\n *\n * // Use:\n * const pattern = {\n * \tattributes: {\n * \t\tkey1: 'value1',\n * \t\tkey2: 'value2'\n * \t},\n * \tclasses: 'foobar'\n * }\n * ```\n *\n * Refer to the {@glink updating/guides/update-to-29##update-to-ckeditor-5-v2910 Migration to v29.1.0} guide\n * and the {@link module:engine/view/matcher~MatcherPattern} documentation.\n *\n * @param pattern Pattern with missing properties.\n * @error matcher-pattern-deprecated-attributes-class-key\n */\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/stylesmap\n */\nimport { get, isObject, merge, set, unset } from 'lodash-es';\n/**\n * Styles map. Allows handling (adding, removing, retrieving) a set of style rules (usually, of an element).\n *\n * The styles map is capable of normalizing style names so e.g. the following operations are possible:\n */\nexport default class StylesMap {\n    /**\n     * Creates Styles instance.\n     */\n    constructor(styleProcessor) {\n        this._styles = {};\n        this._styleProcessor = styleProcessor;\n    }\n    /**\n     * Returns true if style map has no styles set.\n     */\n    get isEmpty() {\n        const entries = Object.entries(this._styles);\n        return !entries.length;\n    }\n    /**\n     * Number of styles defined.\n     */\n    get size() {\n        if (this.isEmpty) {\n            return 0;\n        }\n        return this.getStyleNames().length;\n    }\n    /**\n     * Set styles map to a new value.\n     *\n     * ```ts\n     * styles.setTo( 'border:1px solid blue;margin-top:1px;' );\n     * ```\n     */\n    setTo(inlineStyle) {\n        this.clear();\n        const parsedStyles = parseInlineStyles(inlineStyle);\n        for (const [key, value] of parsedStyles) {\n            this._styleProcessor.toNormalizedForm(key, value, this._styles);\n        }\n    }\n    /**\n     * Checks if a given style is set.\n     *\n     * ```ts\n     * styles.setTo( 'margin-left:1px;' );\n     *\n     * styles.has( 'margin-left' );    // -> true\n     * styles.has( 'padding' );        // -> false\n     * ```\n     *\n     * **Note**: This check supports normalized style names.\n     *\n     * ```ts\n     * // Enable 'margin' shorthand processing:\n     * editor.data.addStyleProcessorRules( addMarginRules );\n     *\n     * styles.setTo( 'margin:2px;' );\n     *\n     * styles.has( 'margin' );         // -> true\n     * styles.has( 'margin-top' );     // -> true\n     * styles.has( 'margin-left' );    // -> true\n     *\n     * styles.remove( 'margin-top' );\n     *\n     * styles.has( 'margin' );         // -> false\n     * styles.has( 'margin-top' );     // -> false\n     * styles.has( 'margin-left' );    // -> true\n     * ```\n     *\n     * @param name Style name.\n     */\n    has(name) {\n        if (this.isEmpty) {\n            return false;\n        }\n        const styles = this._styleProcessor.getReducedForm(name, this._styles);\n        const propertyDescriptor = styles.find(([property]) => property === name);\n        // Only return a value if it is set;\n        return Array.isArray(propertyDescriptor);\n    }\n    set(nameOrObject, valueOrObject) {\n        if (isObject(nameOrObject)) {\n            for (const [key, value] of Object.entries(nameOrObject)) {\n                this._styleProcessor.toNormalizedForm(key, value, this._styles);\n            }\n        }\n        else {\n            this._styleProcessor.toNormalizedForm(nameOrObject, valueOrObject, this._styles);\n        }\n    }\n    /**\n     * Removes given style.\n     *\n     * ```ts\n     * styles.setTo( 'background:#f00;margin-right:2px;' );\n     *\n     * styles.remove( 'background' );\n     *\n     * styles.toString();   // -> 'margin-right:2px;'\n     * ```\n     *\n     * ***Note**:* This method uses {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules\n     * enabled style processor rules} to normalize passed values.\n     *\n     * ```ts\n     * // Enable 'margin' shorthand processing:\n     * editor.data.addStyleProcessorRules( addMarginRules );\n     *\n     * styles.setTo( 'margin:1px' );\n     *\n     * styles.remove( 'margin-top' );\n     * styles.remove( 'margin-right' );\n     *\n     * styles.toString(); // -> 'margin-bottom:1px;margin-left:1px;'\n     * ```\n     *\n     * @param name Style name.\n     */\n    remove(name) {\n        const path = toPath(name);\n        unset(this._styles, path);\n        delete this._styles[name];\n        this._cleanEmptyObjectsOnPath(path);\n    }\n    /**\n     * Returns a normalized style object or a single value.\n     *\n     * ```ts\n     * // Enable 'margin' shorthand processing:\n     * editor.data.addStyleProcessorRules( addMarginRules );\n     *\n     * const styles = new Styles();\n     * styles.setTo( 'margin:1px 2px 3em;' );\n     *\n     * styles.getNormalized( 'margin' );\n     * // will log:\n     * // {\n     * //     top: '1px',\n     * //     right: '2px',\n     * //     bottom: '3em',\n     * //     left: '2px'     // normalized value from margin shorthand\n     * // }\n     *\n     * styles.getNormalized( 'margin-left' ); // -> '2px'\n     * ```\n     *\n     * **Note**: This method will only return normalized styles if a style processor was defined.\n     *\n     * @param name Style name.\n     */\n    getNormalized(name) {\n        return this._styleProcessor.getNormalized(name, this._styles);\n    }\n    /**\n     * Returns a normalized style string. Styles are sorted by name.\n     *\n     * ```ts\n     * styles.set( 'margin' , '1px' );\n     * styles.set( 'background', '#f00' );\n     *\n     * styles.toString(); // -> 'background:#f00;margin:1px;'\n     * ```\n     *\n     * **Note**: This method supports normalized styles if defined.\n     *\n     * ```ts\n     * // Enable 'margin' shorthand processing:\n     * editor.data.addStyleProcessorRules( addMarginRules );\n     *\n     * styles.set( 'margin' , '1px' );\n     * styles.set( 'background', '#f00' );\n     * styles.remove( 'margin-top' );\n     * styles.remove( 'margin-right' );\n     *\n     * styles.toString(); // -> 'background:#f00;margin-bottom:1px;margin-left:1px;'\n     * ```\n     */\n    toString() {\n        if (this.isEmpty) {\n            return '';\n        }\n        return this.getStylesEntries()\n            .map(arr => arr.join(':'))\n            .sort()\n            .join(';') + ';';\n    }\n    /**\n     * Returns property as a value string or undefined if property is not set.\n     *\n     * ```ts\n     * // Enable 'margin' shorthand processing:\n     * editor.data.addStyleProcessorRules( addMarginRules );\n     *\n     * const styles = new Styles();\n     * styles.setTo( 'margin:1px;' );\n     * styles.set( 'margin-bottom', '3em' );\n     *\n     * styles.getAsString( 'margin' ); // -> 'margin: 1px 1px 3em;'\n     * ```\n     *\n     * Note, however, that all sub-values must be set for the longhand property name to return a value:\n     *\n     * ```ts\n     * const styles = new Styles();\n     * styles.setTo( 'margin:1px;' );\n     * styles.remove( 'margin-bottom' );\n     *\n     * styles.getAsString( 'margin' ); // -> undefined\n     * ```\n     *\n     * In the above scenario, it is not possible to return a `margin` value, so `undefined` is returned.\n     * Instead, you should use:\n     *\n     * ```ts\n     * const styles = new Styles();\n     * styles.setTo( 'margin:1px;' );\n     * styles.remove( 'margin-bottom' );\n     *\n     * for ( const styleName of styles.getStyleNames() ) {\n     * \tconsole.log( styleName, styles.getAsString( styleName ) );\n     * }\n     * // 'margin-top', '1px'\n     * // 'margin-right', '1px'\n     * // 'margin-left', '1px'\n     * ```\n     *\n     * In general, it is recommend to iterate over style names like in the example above. This way, you will always get all\n     * the currently set style values. So, if all the 4 margin values would be set\n     * the for-of loop above would yield only `'margin'`, `'1px'`:\n     *\n     * ```ts\n     * const styles = new Styles();\n     * styles.setTo( 'margin:1px;' );\n     *\n     * for ( const styleName of styles.getStyleNames() ) {\n     * \tconsole.log( styleName, styles.getAsString( styleName ) );\n     * }\n     * // 'margin', '1px'\n     * ```\n     *\n     * **Note**: To get a normalized version of a longhand property use the {@link #getNormalized `#getNormalized()`} method.\n     */\n    getAsString(propertyName) {\n        if (this.isEmpty) {\n            return;\n        }\n        if (this._styles[propertyName] && !isObject(this._styles[propertyName])) {\n            // Try return styles set directly - values that are not parsed.\n            return this._styles[propertyName];\n        }\n        const styles = this._styleProcessor.getReducedForm(propertyName, this._styles);\n        const propertyDescriptor = styles.find(([property]) => property === propertyName);\n        // Only return a value if it is set;\n        if (Array.isArray(propertyDescriptor)) {\n            return propertyDescriptor[1];\n        }\n    }\n    /**\n     * Returns all style properties names as they would appear when using {@link #toString `#toString()`}.\n     *\n     * When `expand` is set to true and there's a shorthand style property set, it will also return all equivalent styles:\n     *\n     * ```ts\n     * stylesMap.setTo( 'margin: 1em' )\n     * ```\n     *\n     * will be expanded to:\n     *\n     * ```ts\n     * [ 'margin', 'margin-top', 'margin-right', 'margin-bottom', 'margin-left' ]\n     * ```\n     *\n     * @param expand Expand shorthand style properties and all return equivalent style representations.\n     */\n    getStyleNames(expand = false) {\n        if (this.isEmpty) {\n            return [];\n        }\n        if (expand) {\n            return this._styleProcessor.getStyleNames(this._styles);\n        }\n        const entries = this.getStylesEntries();\n        return entries.map(([key]) => key);\n    }\n    /**\n     * Removes all styles.\n     */\n    clear() {\n        this._styles = {};\n    }\n    /**\n     * Returns normalized styles entries for further processing.\n     */\n    getStylesEntries() {\n        const parsed = [];\n        const keys = Object.keys(this._styles);\n        for (const key of keys) {\n            parsed.push(...this._styleProcessor.getReducedForm(key, this._styles));\n        }\n        return parsed;\n    }\n    /**\n     * Removes empty objects upon removing an entry from internal object.\n     */\n    _cleanEmptyObjectsOnPath(path) {\n        const pathParts = path.split('.');\n        const isChildPath = pathParts.length > 1;\n        if (!isChildPath) {\n            return;\n        }\n        const parentPath = pathParts.splice(0, pathParts.length - 1).join('.');\n        const parentObject = get(this._styles, parentPath);\n        if (!parentObject) {\n            return;\n        }\n        const isParentEmpty = !Object.keys(parentObject).length;\n        if (isParentEmpty) {\n            this.remove(parentPath);\n        }\n    }\n}\n/**\n * Style processor is responsible for writing and reading a normalized styles object.\n */\nexport class StylesProcessor {\n    /**\n     * Creates StylesProcessor instance.\n     *\n     * @internal\n     */\n    constructor() {\n        this._normalizers = new Map();\n        this._extractors = new Map();\n        this._reducers = new Map();\n        this._consumables = new Map();\n    }\n    /**\n     * Parse style string value to a normalized object and appends it to styles object.\n     *\n     * ```ts\n     * const styles = {};\n     *\n     * stylesProcessor.toNormalizedForm( 'margin', '1px', styles );\n     *\n     * // styles will consist: { margin: { top: '1px', right: '1px', bottom: '1px', left: '1px; } }\n     * ```\n     *\n     * **Note**: To define normalizer callbacks use {@link #setNormalizer}.\n     *\n     * @param name Name of style property.\n     * @param propertyValue Value of style property.\n     * @param styles Object holding normalized styles.\n     */\n    toNormalizedForm(name, propertyValue, styles) {\n        if (isObject(propertyValue)) {\n            appendStyleValue(styles, toPath(name), propertyValue);\n            return;\n        }\n        if (this._normalizers.has(name)) {\n            const normalizer = this._normalizers.get(name);\n            const { path, value } = normalizer(propertyValue);\n            appendStyleValue(styles, path, value);\n        }\n        else {\n            appendStyleValue(styles, name, propertyValue);\n        }\n    }\n    /**\n     * Returns a normalized version of a style property.\n     *\n     * ```ts\n     * const styles = {\n     * \tmargin: { top: '1px', right: '1px', bottom: '1px', left: '1px; },\n     * \tbackground: { color: '#f00' }\n     * };\n     *\n     * stylesProcessor.getNormalized( 'background' );\n     * // will return: { color: '#f00' }\n     *\n     * stylesProcessor.getNormalized( 'margin-top' );\n     * // will return: '1px'\n     * ```\n     *\n     * **Note**: In some cases extracting single value requires defining an extractor callback {@link #setExtractor}.\n     *\n     * @param name Name of style property.\n     * @param styles Object holding normalized styles.\n     */\n    getNormalized(name, styles) {\n        if (!name) {\n            return merge({}, styles);\n        }\n        // Might be empty string.\n        if (styles[name] !== undefined) {\n            return styles[name];\n        }\n        if (this._extractors.has(name)) {\n            const extractor = this._extractors.get(name);\n            if (typeof extractor === 'string') {\n                return get(styles, extractor);\n            }\n            const value = extractor(name, styles);\n            if (value) {\n                return value;\n            }\n        }\n        return get(styles, toPath(name));\n    }\n    /**\n     * Returns a reduced form of style property form normalized object.\n     *\n     * For default margin reducer, the below code:\n     *\n     * ```ts\n     * stylesProcessor.getReducedForm( 'margin', {\n     * \tmargin: { top: '1px', right: '1px', bottom: '2px', left: '1px; }\n     * } );\n     * ```\n     *\n     * will return:\n     *\n     * ```ts\n     * [\n     * \t[ 'margin', '1px 1px 2px' ]\n     * ]\n     * ```\n     *\n     * because it might be represented as a shorthand 'margin' value. However if one of margin long hand values is missing it should return:\n     *\n     * ```ts\n     * [\n     * \t[ 'margin-top', '1px' ],\n     * \t[ 'margin-right', '1px' ],\n     * \t[ 'margin-bottom', '2px' ]\n     * \t// the 'left' value is missing - cannot use 'margin' shorthand.\n     * ]\n     * ```\n     *\n     * **Note**: To define reducer callbacks use {@link #setReducer}.\n     *\n     * @param name Name of style property.\n     */\n    getReducedForm(name, styles) {\n        const normalizedValue = this.getNormalized(name, styles);\n        // Might be empty string.\n        if (normalizedValue === undefined) {\n            return [];\n        }\n        if (this._reducers.has(name)) {\n            const reducer = this._reducers.get(name);\n            return reducer(normalizedValue);\n        }\n        return [[name, normalizedValue]];\n    }\n    /**\n     * Return all style properties. Also expand shorthand properties (e.g. `margin`, `background`) if respective extractor is available.\n     *\n     * @param styles Object holding normalized styles.\n     */\n    getStyleNames(styles) {\n        // Find all extractable styles that have a value.\n        const expandedStyleNames = Array.from(this._consumables.keys()).filter(name => {\n            const style = this.getNormalized(name, styles);\n            if (style && typeof style == 'object') {\n                return Object.keys(style).length;\n            }\n            return style;\n        });\n        // For simple styles (for example `color`) we don't have a map of those styles\n        // but they are 1 to 1 with normalized object keys.\n        const styleNamesKeysSet = new Set([\n            ...expandedStyleNames,\n            ...Object.keys(styles)\n        ]);\n        return Array.from(styleNamesKeysSet);\n    }\n    /**\n     * Returns related style names.\n     *\n     * ```ts\n     * stylesProcessor.getRelatedStyles( 'margin' );\n     * // will return: [ 'margin-top', 'margin-right', 'margin-bottom', 'margin-left' ];\n     *\n     * stylesProcessor.getRelatedStyles( 'margin-top' );\n     * // will return: [ 'margin' ];\n     * ```\n     *\n     * **Note**: To define new style relations load an existing style processor or use\n     * {@link module:engine/view/stylesmap~StylesProcessor#setStyleRelation `StylesProcessor.setStyleRelation()`}.\n     */\n    getRelatedStyles(name) {\n        return this._consumables.get(name) || [];\n    }\n    /**\n     * Adds a normalizer method for a style property.\n     *\n     * A normalizer returns describing how the value should be normalized.\n     *\n     * For instance 'margin' style is a shorthand for four margin values:\n     *\n     * - 'margin-top'\n     * - 'margin-right'\n     * - 'margin-bottom'\n     * - 'margin-left'\n     *\n     * and can be written in various ways if some values are equal to others. For instance `'margin: 1px 2em;'` is a shorthand for\n     * `'margin-top: 1px;margin-right: 2em;margin-bottom: 1px;margin-left: 2em'`.\n     *\n     * A normalizer should parse various margin notations as a single object:\n     *\n     * ```ts\n     * const styles = {\n     * \tmargin: {\n     * \t\ttop: '1px',\n     * \t\tright: '2em',\n     * \t\tbottom: '1px',\n     * \t\tleft: '2em'\n     * \t}\n     * };\n     * ```\n     *\n     * Thus a normalizer for 'margin' style should return an object defining style path and value to store:\n     *\n     * ```ts\n     * const returnValue = {\n     * \tpath: 'margin',\n     * \tvalue: {\n     * \t\ttop: '1px',\n     * \t\tright: '2em',\n     * \t\tbottom: '1px',\n     * \t\tleft: '2em'\n     * \t}\n     * };\n     * ```\n     *\n     * Additionally to fully support all margin notations there should be also defined 4 normalizers for longhand margin notations. Below\n     * is an example for 'margin-top' style property normalizer:\n     *\n     * ```ts\n     * stylesProcessor.setNormalizer( 'margin-top', valueString => {\n     * \treturn {\n     * \t\tpath: 'margin.top',\n     * \t\tvalue: valueString\n     * \t}\n     * } );\n     * ```\n     */\n    setNormalizer(name, callback) {\n        this._normalizers.set(name, callback);\n    }\n    /**\n     * Adds a extractor callback for a style property.\n     *\n     * Most normalized style values are stored as one level objects. It is assumed that `'margin-top'` style will be stored as:\n     *\n     * ```ts\n     * const styles = {\n     * \tmargin: {\n     * \t\ttop: 'value'\n     * \t}\n     * }\n     * ```\n     *\n     * However, some styles can have conflicting notations and thus it might be harder to extract a style value from shorthand. For instance\n     * the 'border-top-style' can be defined using `'border-top:solid'`, `'border-style:solid none none none'` or by `'border:solid'`\n     * shorthands. The default border styles processors stores styles as:\n     *\n     * ```ts\n     * const styles = {\n     * \tborder: {\n     * \t\tstyle: {\n     * \t\t\ttop: 'solid'\n     * \t\t}\n     * \t}\n     * }\n     * ```\n     *\n     * as it is better to modify border style independently from other values. On the other part the output of the border might be\n     * desired as `border-top`, `border-left`, etc notation.\n     *\n     * In the above example an extractor should return a side border value that combines style, color and width:\n     *\n     * ```ts\n     * styleProcessor.setExtractor( 'border-top', styles => {\n     * \treturn {\n     * \t\tcolor: styles.border.color.top,\n     * \t\tstyle: styles.border.style.top,\n     * \t\twidth: styles.border.width.top\n     * \t}\n     * } );\n     * ```\n     *\n     * @param callbackOrPath Callback that return a requested value or path string for single values.\n     */\n    setExtractor(name, callbackOrPath) {\n        this._extractors.set(name, callbackOrPath);\n    }\n    /**\n     * Adds a reducer callback for a style property.\n     *\n     * Reducer returns a minimal notation for given style name. For longhand properties it is not required to write a reducer as\n     * by default the direct value from style path is taken.\n     *\n     * For shorthand styles a reducer should return minimal style notation either by returning single name-value tuple or multiple tuples\n     * if a shorthand cannot be used. For instance for a margin shorthand a reducer might return:\n     *\n     * ```ts\n     * const marginShortHandTuple = [\n     * \t[ 'margin', '1px 1px 2px' ]\n     * ];\n     * ```\n     *\n     * or a longhand tuples for defined values:\n     *\n     * ```ts\n     * // Considering margin.bottom and margin.left are undefined.\n     * const marginLonghandsTuples = [\n     * \t[ 'margin-top', '1px' ],\n     * \t[ 'margin-right', '1px' ]\n     * ];\n     * ```\n     *\n     * A reducer obtains a normalized style value:\n     *\n     * ```ts\n     * // Simplified reducer that always outputs 4 values which are always present:\n     * stylesProcessor.setReducer( 'margin', margin => {\n     * \treturn [\n     * \t\t[ 'margin', `${ margin.top } ${ margin.right } ${ margin.bottom } ${ margin.left }` ]\n     * \t]\n     * } );\n     * ```\n     */\n    setReducer(name, callback) {\n        this._reducers.set(name, callback);\n    }\n    /**\n     * Defines a style shorthand relation to other style notations.\n     *\n     * ```ts\n     * stylesProcessor.setStyleRelation( 'margin', [\n     * \t'margin-top',\n     * \t'margin-right',\n     * \t'margin-bottom',\n     * \t'margin-left'\n     * ] );\n     * ```\n     *\n     * This enables expanding of style names for shorthands. For instance, if defined,\n     * {@link module:engine/conversion/viewconsumable~ViewConsumable view consumable} items are automatically created\n     * for long-hand margin style notation alongside the `'margin'` item.\n     *\n     * This means that when an element being converted has a style `margin`, a converter for `margin-left` will work just\n     * fine since the view consumable will contain a consumable `margin-left` item (thanks to the relation) and\n     * `element.getStyle( 'margin-left' )` will work as well assuming that the style processor was correctly configured.\n     * However, once `margin-left` is consumed, `margin` will not be consumable anymore.\n     */\n    setStyleRelation(shorthandName, styleNames) {\n        this._mapStyleNames(shorthandName, styleNames);\n        for (const alsoName of styleNames) {\n            this._mapStyleNames(alsoName, [shorthandName]);\n        }\n    }\n    /**\n     * Set two-way binding of style names.\n     */\n    _mapStyleNames(name, styleNames) {\n        if (!this._consumables.has(name)) {\n            this._consumables.set(name, []);\n        }\n        this._consumables.get(name).push(...styleNames);\n    }\n}\n/**\n * Parses inline styles and puts property - value pairs into styles map.\n *\n * @param stylesString Styles to parse.\n * @returns Map of parsed properties and values.\n */\nfunction parseInlineStyles(stylesString) {\n    // `null` if no quote was found in input string or last found quote was a closing quote. See below.\n    let quoteType = null;\n    let propertyNameStart = 0;\n    let propertyValueStart = 0;\n    let propertyName = null;\n    const stylesMap = new Map();\n    // Do not set anything if input string is empty.\n    if (stylesString === '') {\n        return stylesMap;\n    }\n    // Fix inline styles that do not end with `;` so they are compatible with algorithm below.\n    if (stylesString.charAt(stylesString.length - 1) != ';') {\n        stylesString = stylesString + ';';\n    }\n    // Seek the whole string for \"special characters\".\n    for (let i = 0; i < stylesString.length; i++) {\n        const char = stylesString.charAt(i);\n        if (quoteType === null) {\n            // No quote found yet or last found quote was a closing quote.\n            switch (char) {\n                case ':':\n                    // Most of time colon means that property name just ended.\n                    // Sometimes however `:` is found inside property value (for example in background image url).\n                    if (!propertyName) {\n                        // Treat this as end of property only if property name is not already saved.\n                        // Save property name.\n                        propertyName = stylesString.substr(propertyNameStart, i - propertyNameStart);\n                        // Save this point as the start of property value.\n                        propertyValueStart = i + 1;\n                    }\n                    break;\n                case '\"':\n                case '\\'':\n                    // Opening quote found (this is an opening quote, because `quoteType` is `null`).\n                    quoteType = char;\n                    break;\n                case ';': {\n                    // Property value just ended.\n                    // Use previously stored property value start to obtain property value.\n                    const propertyValue = stylesString.substr(propertyValueStart, i - propertyValueStart);\n                    if (propertyName) {\n                        // Save parsed part.\n                        stylesMap.set(propertyName.trim(), propertyValue.trim());\n                    }\n                    propertyName = null;\n                    // Save this point as property name start. Property name starts immediately after previous property value ends.\n                    propertyNameStart = i + 1;\n                    break;\n                }\n            }\n        }\n        else if (char === quoteType) {\n            // If a quote char is found and it is a closing quote, mark this fact by `null`-ing `quoteType`.\n            quoteType = null;\n        }\n    }\n    return stylesMap;\n}\n/**\n * Return lodash compatible path from style name.\n */\nfunction toPath(name) {\n    return name.replace('-', '.');\n}\n/**\n * Appends style definition to the styles object.\n */\nfunction appendStyleValue(stylesObject, nameOrPath, valueOrObject) {\n    let valueToSet = valueOrObject;\n    if (isObject(valueOrObject)) {\n        valueToSet = merge({}, get(stylesObject, nameOrPath), valueOrObject);\n    }\n    set(stylesObject, nameOrPath, valueToSet);\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/element\n */\nimport Node from './node.js';\nimport Text from './text.js';\nimport TextProxy from './textproxy.js';\nimport { isIterable, toArray, toMap } from '@ckeditor/ckeditor5-utils';\nimport { default as Matcher } from './matcher.js';\nimport { default as StylesMap } from './stylesmap.js';\n// @if CK_DEBUG_ENGINE // const { convertMapToTags } = require( '../dev-utils/utils' );\n/**\n * View element.\n *\n * The editing engine does not define a fixed semantics of its elements (it is \"DTD-free\").\n * This is why the type of the {@link module:engine/view/element~Element} need to\n * be defined by the feature developer. When creating an element you should use one of the following methods:\n *\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createContainerElement `downcastWriter#createContainerElement()`}\n * in order to create a {@link module:engine/view/containerelement~ContainerElement},\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createAttributeElement `downcastWriter#createAttributeElement()`}\n * in order to create a {@link module:engine/view/attributeelement~AttributeElement},\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createEmptyElement `downcastWriter#createEmptyElement()`}\n * in order to create a {@link module:engine/view/emptyelement~EmptyElement}.\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createUIElement `downcastWriter#createUIElement()`}\n * in order to create a {@link module:engine/view/uielement~UIElement}.\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createEditableElement `downcastWriter#createEditableElement()`}\n * in order to create a {@link module:engine/view/editableelement~EditableElement}.\n *\n * Note that for view elements which are not created from the model, like elements from mutations, paste or\n * {@link module:engine/controller/datacontroller~DataController#set data.set} it is not possible to define the type of the element.\n * In such cases the {@link module:engine/view/upcastwriter~UpcastWriter#createElement `UpcastWriter#createElement()`} method\n * should be used to create generic view elements.\n */\nexport default class Element extends Node {\n    /**\n     * Creates a view element.\n     *\n     * Attributes can be passed in various formats:\n     *\n     * ```ts\n     * new Element( viewDocument, 'div', { class: 'editor', contentEditable: 'true' } ); // object\n     * new Element( viewDocument, 'div', [ [ 'class', 'editor' ], [ 'contentEditable', 'true' ] ] ); // map-like iterator\n     * new Element( viewDocument, 'div', mapOfAttributes ); // map\n     * ```\n     *\n     * @internal\n     * @param document The document instance to which this element belongs.\n     * @param name Node name.\n     * @param attrs Collection of attributes.\n     * @param children A list of nodes to be inserted into created element.\n     */\n    constructor(document, name, attrs, children) {\n        super(document);\n        /**\n         * A list of attribute names that should be rendered in the editing pipeline even though filtering mechanisms\n         * implemented in the {@link module:engine/view/domconverter~DomConverter} (for instance,\n         * {@link module:engine/view/domconverter~DomConverter#shouldRenderAttribute}) would filter them out.\n         *\n         * These attributes can be specified as an option when the element is created by\n         * the {@link module:engine/view/downcastwriter~DowncastWriter}. To check whether an unsafe an attribute should\n         * be permitted, use the {@link #shouldRenderUnsafeAttribute} method.\n         *\n         * @internal\n         */\n        this._unsafeAttributesToRender = [];\n        /**\n         * Map of custom properties.\n         * Custom properties can be added to element instance, will be cloned but not rendered into DOM.\n         */\n        this._customProperties = new Map();\n        this.name = name;\n        this._attrs = parseAttributes(attrs);\n        this._children = [];\n        if (children) {\n            this._insertChild(0, children);\n        }\n        this._classes = new Set();\n        if (this._attrs.has('class')) {\n            // Remove class attribute and handle it by class set.\n            const classString = this._attrs.get('class');\n            parseClasses(this._classes, classString);\n            this._attrs.delete('class');\n        }\n        this._styles = new StylesMap(this.document.stylesProcessor);\n        if (this._attrs.has('style')) {\n            // Remove style attribute and handle it by styles map.\n            this._styles.setTo(this._attrs.get('style'));\n            this._attrs.delete('style');\n        }\n    }\n    /**\n     * Number of element's children.\n     */\n    get childCount() {\n        return this._children.length;\n    }\n    /**\n     * Is `true` if there are no nodes inside this element, `false` otherwise.\n     */\n    get isEmpty() {\n        return this._children.length === 0;\n    }\n    /**\n     * Gets child at the given index.\n     *\n     * @param index Index of child.\n     * @returns Child node.\n     */\n    getChild(index) {\n        return this._children[index];\n    }\n    /**\n     * Gets index of the given child node. Returns `-1` if child node is not found.\n     *\n     * @param node Child node.\n     * @returns Index of the child node.\n     */\n    getChildIndex(node) {\n        return this._children.indexOf(node);\n    }\n    /**\n     * Gets child nodes iterator.\n     *\n     * @returns Child nodes iterator.\n     */\n    getChildren() {\n        return this._children[Symbol.iterator]();\n    }\n    /**\n     * Returns an iterator that contains the keys for attributes. Order of inserting attributes is not preserved.\n     *\n     * @returns Keys for attributes.\n     */\n    *getAttributeKeys() {\n        if (this._classes.size > 0) {\n            yield 'class';\n        }\n        if (!this._styles.isEmpty) {\n            yield 'style';\n        }\n        yield* this._attrs.keys();\n    }\n    /**\n     * Returns iterator that iterates over this element's attributes.\n     *\n     * Attributes are returned as arrays containing two items. First one is attribute key and second is attribute value.\n     * This format is accepted by native `Map` object and also can be passed in `Node` constructor.\n     */\n    *getAttributes() {\n        yield* this._attrs.entries();\n        if (this._classes.size > 0) {\n            yield ['class', this.getAttribute('class')];\n        }\n        if (!this._styles.isEmpty) {\n            yield ['style', this.getAttribute('style')];\n        }\n    }\n    /**\n     * Gets attribute by key. If attribute is not present - returns undefined.\n     *\n     * @param key Attribute key.\n     * @returns Attribute value.\n     */\n    getAttribute(key) {\n        if (key == 'class') {\n            if (this._classes.size > 0) {\n                return [...this._classes].join(' ');\n            }\n            return undefined;\n        }\n        if (key == 'style') {\n            const inlineStyle = this._styles.toString();\n            return inlineStyle == '' ? undefined : inlineStyle;\n        }\n        return this._attrs.get(key);\n    }\n    /**\n     * Returns a boolean indicating whether an attribute with the specified key exists in the element.\n     *\n     * @param key Attribute key.\n     * @returns `true` if attribute with the specified key exists in the element, `false` otherwise.\n     */\n    hasAttribute(key) {\n        if (key == 'class') {\n            return this._classes.size > 0;\n        }\n        if (key == 'style') {\n            return !this._styles.isEmpty;\n        }\n        return this._attrs.has(key);\n    }\n    /**\n     * Checks if this element is similar to other element.\n     * Both elements should have the same name and attributes to be considered as similar. Two similar elements\n     * can contain different set of children nodes.\n     */\n    isSimilar(otherElement) {\n        if (!(otherElement instanceof Element)) {\n            return false;\n        }\n        // If exactly the same Element is provided - return true immediately.\n        if (this === otherElement) {\n            return true;\n        }\n        // Check element name.\n        if (this.name != otherElement.name) {\n            return false;\n        }\n        // Check number of attributes, classes and styles.\n        if (this._attrs.size !== otherElement._attrs.size || this._classes.size !== otherElement._classes.size ||\n            this._styles.size !== otherElement._styles.size) {\n            return false;\n        }\n        // Check if attributes are the same.\n        for (const [key, value] of this._attrs) {\n            if (!otherElement._attrs.has(key) || otherElement._attrs.get(key) !== value) {\n                return false;\n            }\n        }\n        // Check if classes are the same.\n        for (const className of this._classes) {\n            if (!otherElement._classes.has(className)) {\n                return false;\n            }\n        }\n        // Check if styles are the same.\n        for (const property of this._styles.getStyleNames()) {\n            if (!otherElement._styles.has(property) ||\n                otherElement._styles.getAsString(property) !== this._styles.getAsString(property)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Returns true if class is present.\n     * If more then one class is provided - returns true only when all classes are present.\n     *\n     * ```ts\n     * element.hasClass( 'foo' ); // Returns true if 'foo' class is present.\n     * element.hasClass( 'foo', 'bar' ); // Returns true if 'foo' and 'bar' classes are both present.\n     * ```\n     */\n    hasClass(...className) {\n        for (const name of className) {\n            if (!this._classes.has(name)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Returns iterator that contains all class names.\n     */\n    getClassNames() {\n        return this._classes.keys();\n    }\n    /**\n     * Returns style value for the given property mae.\n     * If the style does not exist `undefined` is returned.\n     *\n     * **Note**: This method can work with normalized style names if\n     * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n     * See {@link module:engine/view/stylesmap~StylesMap#getAsString `StylesMap#getAsString()`} for details.\n     *\n     * For an element with style set to `'margin:1px'`:\n     *\n     * ```ts\n     * // Enable 'margin' shorthand processing:\n     * editor.data.addStyleProcessorRules( addMarginRules );\n     *\n     * const element = view.change( writer => {\n     * \tconst element = writer.createElement();\n     * \twriter.setStyle( 'margin', '1px' );\n     * \twriter.setStyle( 'margin-bottom', '3em' );\n     *\n     * \treturn element;\n     * } );\n     *\n     * element.getStyle( 'margin' ); // -> 'margin: 1px 1px 3em;'\n     * ```\n     */\n    getStyle(property) {\n        return this._styles.getAsString(property);\n    }\n    /**\n     * Returns a normalized style object or single style value.\n     *\n     * For an element with style set to: margin:1px 2px 3em;\n     *\n     * ```ts\n     * element.getNormalizedStyle( 'margin' ) );\n     * ```\n     *\n     * will return:\n     *\n     * ```ts\n     * {\n     * \ttop: '1px',\n     * \tright: '2px',\n     * \tbottom: '3em',\n     * \tleft: '2px'    // a normalized value from margin shorthand\n     * }\n     * ```\n     *\n     * and reading for single style value:\n     *\n     * ```ts\n     * styles.getNormalizedStyle( 'margin-left' );\n     * ```\n     *\n     * Will return a `2px` string.\n     *\n     * **Note**: This method will return normalized values only if\n     * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n     * See {@link module:engine/view/stylesmap~StylesMap#getNormalized `StylesMap#getNormalized()`} for details.\n     *\n     * @param property Name of CSS property\n     */\n    getNormalizedStyle(property) {\n        return this._styles.getNormalized(property);\n    }\n    /**\n     * Returns iterator that contains all style names.\n     *\n     * @param expand Expand shorthand style properties and return all equivalent style representations.\n     */\n    getStyleNames(expand) {\n        return this._styles.getStyleNames(expand);\n    }\n    /**\n     * Returns true if style keys are present.\n     * If more then one style property is provided - returns true only when all properties are present.\n     *\n     * ```ts\n     * element.hasStyle( 'color' ); // Returns true if 'border-top' style is present.\n     * element.hasStyle( 'color', 'border-top' ); // Returns true if 'color' and 'border-top' styles are both present.\n     * ```\n     */\n    hasStyle(...property) {\n        for (const name of property) {\n            if (!this._styles.has(name)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Returns ancestor element that match specified pattern.\n     * Provided patterns should be compatible with {@link module:engine/view/matcher~Matcher Matcher} as it is used internally.\n     *\n     * @see module:engine/view/matcher~Matcher\n     * @param patterns Patterns used to match correct ancestor. See {@link module:engine/view/matcher~Matcher}.\n     * @returns Found element or `null` if no matching ancestor was found.\n     */\n    findAncestor(...patterns) {\n        const matcher = new Matcher(...patterns);\n        let parent = this.parent;\n        while (parent && !parent.is('documentFragment')) {\n            if (matcher.match(parent)) {\n                return parent;\n            }\n            parent = parent.parent;\n        }\n        return null;\n    }\n    /**\n     * Returns the custom property value for the given key.\n     */\n    getCustomProperty(key) {\n        return this._customProperties.get(key);\n    }\n    /**\n     * Returns an iterator which iterates over this element's custom properties.\n     * Iterator provides `[ key, value ]` pairs for each stored property.\n     */\n    *getCustomProperties() {\n        yield* this._customProperties.entries();\n    }\n    /**\n     * Returns identity string based on element's name, styles, classes and other attributes.\n     * Two elements that {@link #isSimilar are similar} will have same identity string.\n     * It has the following format:\n     *\n     * ```ts\n     * 'name class=\"class1,class2\" style=\"style1:value1;style2:value2\" attr1=\"val1\" attr2=\"val2\"'\n     * ```\n     *\n     * For example:\n     *\n     * ```ts\n     * const element = writer.createContainerElement( 'foo', {\n     * \tbanana: '10',\n     * \tapple: '20',\n     * \tstyle: 'color: red; border-color: white;',\n     * \tclass: 'baz'\n     * } );\n     *\n     * // returns 'foo class=\"baz\" style=\"border-color:white;color:red\" apple=\"20\" banana=\"10\"'\n     * element.getIdentity();\n     * ```\n     *\n     * **Note**: Classes, styles and other attributes are sorted alphabetically.\n     */\n    getIdentity() {\n        const classes = Array.from(this._classes).sort().join(',');\n        const styles = this._styles.toString();\n        const attributes = Array.from(this._attrs).map(i => `${i[0]}=\"${i[1]}\"`).sort().join(' ');\n        return this.name +\n            (classes == '' ? '' : ` class=\"${classes}\"`) +\n            (!styles ? '' : ` style=\"${styles}\"`) +\n            (attributes == '' ? '' : ` ${attributes}`);\n    }\n    /**\n     * Decides whether an unsafe attribute is whitelisted and should be rendered in the editing pipeline even though filtering mechanisms\n     * like {@link module:engine/view/domconverter~DomConverter#shouldRenderAttribute} say it should not.\n     *\n     * Unsafe attribute names can be specified when creating an element via {@link module:engine/view/downcastwriter~DowncastWriter}.\n     *\n     * @param attributeName The name of the attribute to be checked.\n     */\n    shouldRenderUnsafeAttribute(attributeName) {\n        return this._unsafeAttributesToRender.includes(attributeName);\n    }\n    /**\n     * Clones provided element.\n     *\n     * @internal\n     * @param deep If set to `true` clones element and all its children recursively. When set to `false`,\n     * element will be cloned without any children.\n     * @returns Clone of this element.\n     */\n    _clone(deep = false) {\n        const childrenClone = [];\n        if (deep) {\n            for (const child of this.getChildren()) {\n                childrenClone.push(child._clone(deep));\n            }\n        }\n        // ContainerElement and AttributeElement should be also cloned properly.\n        const cloned = new this.constructor(this.document, this.name, this._attrs, childrenClone);\n        // Classes and styles are cloned separately - this solution is faster than adding them back to attributes and\n        // parse once again in constructor.\n        cloned._classes = new Set(this._classes);\n        cloned._styles.set(this._styles.getNormalized());\n        // Clone custom properties.\n        cloned._customProperties = new Map(this._customProperties);\n        // Clone filler offset method.\n        // We can't define this method in a prototype because it's behavior which\n        // is changed by e.g. toWidget() function from ckeditor5-widget. Perhaps this should be one of custom props.\n        cloned.getFillerOffset = this.getFillerOffset;\n        // Clone unsafe attributes list.\n        cloned._unsafeAttributesToRender = this._unsafeAttributesToRender;\n        return cloned;\n    }\n    /**\n     * {@link module:engine/view/element~Element#_insertChild Insert} a child node or a list of child nodes at the end of this node\n     * and sets the parent of these nodes to this element.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#insert\n     * @internal\n     * @param items Items to be inserted.\n     * @fires change\n     * @returns Number of appended nodes.\n     */\n    _appendChild(items) {\n        return this._insertChild(this.childCount, items);\n    }\n    /**\n     * Inserts a child node or a list of child nodes on the given index and sets the parent of these nodes to\n     * this element.\n     *\n     * @internal\n     * @see module:engine/view/downcastwriter~DowncastWriter#insert\n     * @param index Position where nodes should be inserted.\n     * @param items Items to be inserted.\n     * @fires change\n     * @returns Number of inserted nodes.\n     */\n    _insertChild(index, items) {\n        this._fireChange('children', this);\n        let count = 0;\n        const nodes = normalize(this.document, items);\n        for (const node of nodes) {\n            // If node that is being added to this element is already inside another element, first remove it from the old parent.\n            if (node.parent !== null) {\n                node._remove();\n            }\n            node.parent = this;\n            node.document = this.document;\n            this._children.splice(index, 0, node);\n            index++;\n            count++;\n        }\n        return count;\n    }\n    /**\n     * Removes number of child nodes starting at the given index and set the parent of these nodes to `null`.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#remove\n     * @internal\n     * @param index Number of the first node to remove.\n     * @param howMany Number of nodes to remove.\n     * @fires change\n     * @returns The array of removed nodes.\n     */\n    _removeChildren(index, howMany = 1) {\n        this._fireChange('children', this);\n        for (let i = index; i < index + howMany; i++) {\n            this._children[i].parent = null;\n        }\n        return this._children.splice(index, howMany);\n    }\n    /**\n     * Adds or overwrite attribute with a specified key and value.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#setAttribute\n     * @internal\n     * @param key Attribute key.\n     * @param value Attribute value.\n     * @fires change\n     */\n    _setAttribute(key, value) {\n        const stringValue = String(value);\n        this._fireChange('attributes', this);\n        if (key == 'class') {\n            parseClasses(this._classes, stringValue);\n        }\n        else if (key == 'style') {\n            this._styles.setTo(stringValue);\n        }\n        else {\n            this._attrs.set(key, stringValue);\n        }\n    }\n    /**\n     * Removes attribute from the element.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#removeAttribute\n     * @internal\n     * @param key Attribute key.\n     * @returns Returns true if an attribute existed and has been removed.\n     * @fires change\n     */\n    _removeAttribute(key) {\n        this._fireChange('attributes', this);\n        // Remove class attribute.\n        if (key == 'class') {\n            if (this._classes.size > 0) {\n                this._classes.clear();\n                return true;\n            }\n            return false;\n        }\n        // Remove style attribute.\n        if (key == 'style') {\n            if (!this._styles.isEmpty) {\n                this._styles.clear();\n                return true;\n            }\n            return false;\n        }\n        // Remove other attributes.\n        return this._attrs.delete(key);\n    }\n    /**\n     * Adds specified class.\n     *\n     * ```ts\n     * element._addClass( 'foo' ); // Adds 'foo' class.\n     * element._addClass( [ 'foo', 'bar' ] ); // Adds 'foo' and 'bar' classes.\n     * ```\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#addClass\n     * @internal\n     * @fires change\n     */\n    _addClass(className) {\n        this._fireChange('attributes', this);\n        for (const name of toArray(className)) {\n            this._classes.add(name);\n        }\n    }\n    /**\n     * Removes specified class.\n     *\n     * ```ts\n     * element._removeClass( 'foo' );  // Removes 'foo' class.\n     * element._removeClass( [ 'foo', 'bar' ] ); // Removes both 'foo' and 'bar' classes.\n     * ```\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#removeClass\n     * @internal\n     * @fires change\n     */\n    _removeClass(className) {\n        this._fireChange('attributes', this);\n        for (const name of toArray(className)) {\n            this._classes.delete(name);\n        }\n    }\n    _setStyle(property, value) {\n        this._fireChange('attributes', this);\n        if (typeof property != 'string') {\n            this._styles.set(property);\n        }\n        else {\n            this._styles.set(property, value);\n        }\n    }\n    /**\n     * Removes specified style.\n     *\n     * ```ts\n     * element._removeStyle( 'color' );  // Removes 'color' style.\n     * element._removeStyle( [ 'color', 'border-top' ] ); // Removes both 'color' and 'border-top' styles.\n     * ```\n     *\n     * **Note**: This method can work with normalized style names if\n     * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n     * See {@link module:engine/view/stylesmap~StylesMap#remove `StylesMap#remove()`} for details.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#removeStyle\n     * @internal\n     * @fires change\n     */\n    _removeStyle(property) {\n        this._fireChange('attributes', this);\n        for (const name of toArray(property)) {\n            this._styles.remove(name);\n        }\n    }\n    /**\n     * Sets a custom property. Unlike attributes, custom properties are not rendered to the DOM,\n     * so they can be used to add special data to elements.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#setCustomProperty\n     * @internal\n     */\n    _setCustomProperty(key, value) {\n        this._customProperties.set(key, value);\n    }\n    /**\n     * Removes the custom property stored under the given key.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#removeCustomProperty\n     * @internal\n     * @returns Returns true if property was removed.\n     */\n    _removeCustomProperty(key) {\n        return this._customProperties.delete(key);\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nElement.prototype.is = function (type, name) {\n    if (!name) {\n        return type === 'element' || type === 'view:element' ||\n            // From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n            type === 'node' || type === 'view:node';\n    }\n    else {\n        return name === this.name && (type === 'element' || type === 'view:element');\n    }\n};\n/**\n * Parses attributes provided to the element constructor before they are applied to an element. If attributes are passed\n * as an object (instead of `Iterable`), the object is transformed to the map. Attributes with `null` value are removed.\n * Attributes with non-`String` value are converted to `String`.\n *\n * @param attrs Attributes to parse.\n * @returns Parsed attributes.\n */\nfunction parseAttributes(attrs) {\n    const attrsMap = toMap(attrs);\n    for (const [key, value] of attrsMap) {\n        if (value === null) {\n            attrsMap.delete(key);\n        }\n        else if (typeof value != 'string') {\n            attrsMap.set(key, String(value));\n        }\n    }\n    return attrsMap;\n}\n/**\n * Parses class attribute and puts all classes into classes set.\n * Classes set s cleared before insertion.\n *\n * @param classesSet Set to insert parsed classes.\n * @param classesString String with classes to parse.\n */\nfunction parseClasses(classesSet, classesString) {\n    const classArray = classesString.split(/\\s+/);\n    classesSet.clear();\n    classArray.forEach(name => classesSet.add(name));\n}\n/**\n * Converts strings to Text and non-iterables to arrays.\n */\nfunction normalize(document, nodes) {\n    // Separate condition because string is iterable.\n    if (typeof nodes == 'string') {\n        return [new Text(document, nodes)];\n    }\n    if (!isIterable(nodes)) {\n        nodes = [nodes];\n    }\n    // Array.from to enable .map() on non-arrays.\n    return Array.from(nodes)\n        .map(node => {\n        if (typeof node == 'string') {\n            return new Text(document, node);\n        }\n        if (node instanceof TextProxy) {\n            return new Text(document, node.data);\n        }\n        return node;\n    });\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/uielement\n */\nimport Element from './element.js';\nimport Node from './node.js';\nimport { CKEditorError, keyCodes } from '@ckeditor/ckeditor5-utils';\n/**\n * UI element class. It should be used to represent editing UI which needs to be injected into the editing view\n * If possible, you should keep your UI outside the editing view. However, if that is not possible,\n * UI elements can be used.\n *\n * How a UI element is rendered is in your control (you pass a callback to\n * {@link module:engine/view/downcastwriter~DowncastWriter#createUIElement `downcastWriter#createUIElement()`}).\n * The editor will ignore your UI element – the selection cannot be placed in it, it is skipped (invisible) when\n * the user modifies the selection by using arrow keys and the editor does not listen to any mutations which\n * happen inside your UI elements.\n *\n * The limitation is that you cannot convert a model element to a UI element. UI elements need to be\n * created for {@link module:engine/model/markercollection~Marker markers} or as additinal elements\n * inside normal {@link module:engine/view/containerelement~ContainerElement container elements}.\n *\n * To create a new UI element use the\n * {@link module:engine/view/downcastwriter~DowncastWriter#createUIElement `downcastWriter#createUIElement()`} method.\n */\nexport default class UIElement extends Element {\n    /**\n     * Creates new instance of UIElement.\n     *\n     * Throws {@link module:utils/ckeditorerror~CKEditorError CKEditorError} `view-uielement-cannot-add` when third parameter is passed,\n     * to inform that usage of UIElement is incorrect (adding child nodes to UIElement is forbidden).\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#createUIElement\n     * @internal\n     * @param document The document instance to which this element belongs.\n     * @param name Node name.\n     * @param attrs Collection of attributes.\n     * @param children A list of nodes to be inserted into created element.\n     */\n    constructor(document, name, attrs, children) {\n        super(document, name, attrs, children);\n        this.getFillerOffset = getFillerOffset;\n    }\n    /**\n     * Overrides {@link module:engine/view/element~Element#_insertChild} method.\n     * Throws {@link module:utils/ckeditorerror~CKEditorError CKEditorError} `view-uielement-cannot-add` to prevent adding any child nodes\n     * to UIElement.\n     *\n     * @internal\n     */\n    _insertChild(index, items) {\n        if (items && (items instanceof Node || Array.from(items).length > 0)) {\n            /**\n             * Cannot add children to {@link module:engine/view/uielement~UIElement}.\n             *\n             * @error view-uielement-cannot-add\n             */\n            throw new CKEditorError('view-uielement-cannot-add', [this, items]);\n        }\n        return 0;\n    }\n    /**\n     * Renders this {@link module:engine/view/uielement~UIElement} to DOM. This method is called by\n     * {@link module:engine/view/domconverter~DomConverter}.\n     * Do not use inheritance to create custom rendering method, replace `render()` method instead:\n     *\n     * ```ts\n     * const myUIElement = downcastWriter.createUIElement( 'span' );\n     * myUIElement.render = function( domDocument, domConverter ) {\n     * \tconst domElement = this.toDomElement( domDocument );\n     *\n     * \tdomConverter.setContentOf( domElement, '<b>this is ui element</b>' );\n     *\n     * \treturn domElement;\n     * };\n     * ```\n     *\n     * If changes in your UI element should trigger some editor UI update you should call\n     * the {@link module:ui/editorui/editorui~EditorUI#update `editor.ui.update()`} method\n     * after rendering your UI element.\n     *\n     * @param domConverter Instance of the DomConverter used to optimize the output.\n     */\n    render(domDocument, domConverter // eslint-disable-line @typescript-eslint/no-unused-vars\n    ) {\n        // Provide basic, default output.\n        return this.toDomElement(domDocument);\n    }\n    /**\n     * Creates DOM element based on this view UIElement.\n     * Note that each time this method is called new DOM element is created.\n     */\n    toDomElement(domDocument) {\n        const domElement = domDocument.createElement(this.name);\n        for (const key of this.getAttributeKeys()) {\n            domElement.setAttribute(key, this.getAttribute(key));\n        }\n        return domElement;\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nUIElement.prototype.is = function (type, name) {\n    if (!name) {\n        return type === 'uiElement' || type === 'view:uiElement' ||\n            // From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n            type === 'element' || type === 'view:element' ||\n            type === 'node' || type === 'view:node';\n    }\n    else {\n        return name === this.name && (type === 'uiElement' || type === 'view:uiElement' ||\n            type === 'element' || type === 'view:element');\n    }\n};\n/**\n * This function injects UI element handling to the given {@link module:engine/view/document~Document document}.\n *\n * A callback is added to {@link module:engine/view/document~Document#event:keydown document keydown event}.\n * The callback handles the situation when right arrow key is pressed and selection is collapsed before a UI element.\n * Without this handler, it would be impossible to \"jump over\" UI element using right arrow key.\n *\n * @param view View controller to which the quirks handling will be injected.\n */\nexport function injectUiElementHandling(view) {\n    view.document.on('arrowKey', (evt, data) => jumpOverUiElement(evt, data, view.domConverter), { priority: 'low' });\n}\n/**\n * Returns `null` because block filler is not needed for UIElements.\n */\nfunction getFillerOffset() {\n    return null;\n}\n/**\n * Selection cannot be placed in a `UIElement`. Whenever it is placed there, it is moved before it. This\n * causes a situation when it is impossible to jump over `UIElement` using right arrow key, because the selection\n * ends up in ui element (in DOM) and is moved back to the left. This handler fixes this situation.\n */\nfunction jumpOverUiElement(evt, data, domConverter) {\n    if (data.keyCode == keyCodes.arrowright) {\n        const domSelection = data.domTarget.ownerDocument.defaultView.getSelection();\n        const domSelectionCollapsed = domSelection.rangeCount == 1 && domSelection.getRangeAt(0).collapsed;\n        // Jump over UI element if selection is collapsed or shift key is pressed. These are the cases when selection would extend.\n        if (domSelectionCollapsed || data.shiftKey) {\n            const domParent = domSelection.focusNode;\n            const domOffset = domSelection.focusOffset;\n            const viewPosition = domConverter.domPositionToView(domParent, domOffset);\n            // In case if dom element is not converted to view or is not mapped or something. Happens for example in some tests.\n            if (viewPosition === null) {\n                return;\n            }\n            // Skip all following ui elements.\n            let jumpedOverAnyUiElement = false;\n            const nextViewPosition = viewPosition.getLastMatchingPosition(value => {\n                if (value.item.is('uiElement')) {\n                    // Remember that there was at least one ui element.\n                    jumpedOverAnyUiElement = true;\n                }\n                // Jump over ui elements, jump over empty attribute elements, move up from inside of attribute element.\n                if (value.item.is('uiElement') || value.item.is('attributeElement')) {\n                    return true;\n                }\n                // Don't jump over text or don't get out of container element.\n                return false;\n            });\n            // If anything has been skipped, fix position.\n            // This `if` could be possibly omitted but maybe it is better not to mess with DOM selection if not needed.\n            if (jumpedOverAnyUiElement) {\n                const newDomPosition = domConverter.viewPositionToDom(nextViewPosition);\n                if (domSelectionCollapsed) {\n                    // Selection was collapsed, so collapse it at further position.\n                    domSelection.collapse(newDomPosition.parent, newDomPosition.offset);\n                }\n                else {\n                    // Selection was not collapse, so extend it instead of collapsing.\n                    domSelection.extend(newDomPosition.parent, newDomPosition.offset);\n                }\n            }\n        }\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/containerelement\n */\nimport Element from './element.js';\n/**\n * Containers are elements which define document structure. They define boundaries for\n * {@link module:engine/view/attributeelement~AttributeElement attributes}. They are mostly used for block elements like `<p>` or `<div>`.\n *\n * Editing engine does not define a fixed HTML DTD. This is why a feature developer needs to choose between various\n * types (container element, {@link module:engine/view/attributeelement~AttributeElement attribute element},\n * {@link module:engine/view/emptyelement~EmptyElement empty element}, etc) when developing a feature.\n *\n * The container element should be your default choice when writing a converter, unless:\n *\n * * this element represents a model text attribute (then use {@link module:engine/view/attributeelement~AttributeElement}),\n * * this is an empty element like `<img>` (then use {@link module:engine/view/emptyelement~EmptyElement}),\n * * this is a root element,\n * * this is a nested editable element (then use  {@link module:engine/view/editableelement~EditableElement}).\n *\n * To create a new container element instance use the\n * {@link module:engine/view/downcastwriter~DowncastWriter#createContainerElement `DowncastWriter#createContainerElement()`}\n * method.\n */\nexport default class ContainerElement extends Element {\n    /**\n     * Creates a container element.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#createContainerElement\n     * @see module:engine/view/element~Element\n     * @internal\n     * @param document The document instance to which this element belongs.\n     * @param name Node name.\n     * @param attrs Collection of attributes.\n     * @param children A list of nodes to be inserted into created element.\n     */\n    constructor(document, name, attrs, children) {\n        super(document, name, attrs, children);\n        this.getFillerOffset = getFillerOffset;\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nContainerElement.prototype.is = function (type, name) {\n    if (!name) {\n        return type === 'containerElement' || type === 'view:containerElement' ||\n            // From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n            type === 'element' || type === 'view:element' ||\n            type === 'node' || type === 'view:node';\n    }\n    else {\n        return name === this.name && (type === 'containerElement' || type === 'view:containerElement' ||\n            // From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n            type === 'element' || type === 'view:element');\n    }\n};\n/**\n * Returns block {@link module:engine/view/filler filler} offset or `null` if block filler is not needed.\n *\n * @returns Block filler offset or `null` if block filler is not needed.\n */\nexport function getFillerOffset() {\n    const children = [...this.getChildren()];\n    const lastChild = children[this.childCount - 1];\n    // Block filler is required after a `<br>` if it's the last element in its container. See #1422.\n    if (lastChild && lastChild.is('element', 'br')) {\n        return this.childCount;\n    }\n    for (const child of children) {\n        // If there's any non-UI element – don't render the bogus.\n        if (!child.is('uiElement')) {\n            return null;\n        }\n    }\n    // If there are only UI elements – render the bogus at the end of the element.\n    return this.childCount;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/editableelement\n */\nimport ContainerElement from './containerelement.js';\nimport { ObservableMixin } from '@ckeditor/ckeditor5-utils';\n/**\n * Editable element which can be a {@link module:engine/view/rooteditableelement~RootEditableElement root}\n * or nested editable area in the editor.\n *\n * Editable is automatically read-only when its {@link module:engine/view/document~Document Document} is read-only.\n *\n * The constructor of this class shouldn't be used directly. To create new `EditableElement` use the\n * {@link module:engine/view/downcastwriter~DowncastWriter#createEditableElement `downcastWriter#createEditableElement()`} method.\n */\nexport default class EditableElement extends ObservableMixin(ContainerElement) {\n    /**\n     * Creates an editable element.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#createEditableElement\n     * @internal\n     * @param document The document instance to which this element belongs.\n     * @param name Node name.\n     * @param attrs Collection of attributes.\n     * @param children A list of nodes to be inserted into created element.\n     */\n    constructor(document, name, attributes, children) {\n        super(document, name, attributes, children);\n        this.set('isReadOnly', false);\n        this.set('isFocused', false);\n        this.set('placeholder', undefined);\n        this.bind('isReadOnly').to(document);\n        this.bind('isFocused').to(document, 'isFocused', isFocused => isFocused && document.selection.editableElement == this);\n        // Update focus state based on selection changes.\n        this.listenTo(document.selection, 'change', () => {\n            this.isFocused = document.isFocused && document.selection.editableElement == this;\n        });\n    }\n    destroy() {\n        this.stopListening();\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nEditableElement.prototype.is = function (type, name) {\n    if (!name) {\n        return type === 'editableElement' || type === 'view:editableElement' ||\n            // From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n            type === 'containerElement' || type === 'view:containerElement' ||\n            type === 'element' || type === 'view:element' ||\n            type === 'node' || type === 'view:node';\n    }\n    else {\n        return name === this.name && (type === 'editableElement' || type === 'view:editableElement' ||\n            // From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n            type === 'containerElement' || type === 'view:containerElement' ||\n            type === 'element' || type === 'view:element');\n    }\n};\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/treewalker\n */\nimport Element from './element.js';\nimport Text from './text.js';\nimport TextProxy from './textproxy.js';\nimport Position from './position.js';\nimport { CKEditorError } from '@ckeditor/ckeditor5-utils';\n/**\n * Position iterator class. It allows to iterate forward and backward over the document.\n */\nexport default class TreeWalker {\n    /**\n     * Creates a range iterator. All parameters are optional, but you have to specify either `boundaries` or `startPosition`.\n     *\n     * @param options Object with configuration.\n     */\n    constructor(options = {}) {\n        if (!options.boundaries && !options.startPosition) {\n            /**\n             * Neither boundaries nor starting position have been defined.\n             *\n             * @error view-tree-walker-no-start-position\n             */\n            throw new CKEditorError('view-tree-walker-no-start-position', null);\n        }\n        if (options.direction && options.direction != 'forward' && options.direction != 'backward') {\n            /**\n             * Only `backward` and `forward` direction allowed.\n             *\n             * @error view-tree-walker-unknown-direction\n             */\n            throw new CKEditorError('view-tree-walker-unknown-direction', options.startPosition, { direction: options.direction });\n        }\n        this.boundaries = options.boundaries || null;\n        if (options.startPosition) {\n            this._position = Position._createAt(options.startPosition);\n        }\n        else {\n            this._position = Position._createAt(options.boundaries[options.direction == 'backward' ? 'end' : 'start']);\n        }\n        this.direction = options.direction || 'forward';\n        this.singleCharacters = !!options.singleCharacters;\n        this.shallow = !!options.shallow;\n        this.ignoreElementEnd = !!options.ignoreElementEnd;\n        this._boundaryStartParent = this.boundaries ? this.boundaries.start.parent : null;\n        this._boundaryEndParent = this.boundaries ? this.boundaries.end.parent : null;\n    }\n    /**\n     * Iterable interface.\n     */\n    [Symbol.iterator]() {\n        return this;\n    }\n    /**\n     * Iterator position. If start position is not defined then position depends on {@link #direction}. If direction is\n     * `'forward'` position starts form the beginning, when direction is `'backward'` position starts from the end.\n     */\n    get position() {\n        return this._position;\n    }\n    /**\n     * Moves {@link #position} in the {@link #direction} skipping values as long as the callback function returns `true`.\n     *\n     * For example:\n     *\n     * ```ts\n     * walker.skip( value => value.type == 'text' ); // <p>{}foo</p> -> <p>foo[]</p>\n     * walker.skip( value => true ); // Move the position to the end: <p>{}foo</p> -> <p>foo</p>[]\n     * walker.skip( value => false ); // Do not move the position.\n     * ```\n     *\n     * @param skip Callback function. Gets {@link module:engine/view/treewalker~TreeWalkerValue} and should\n     * return `true` if the value should be skipped or `false` if not.\n     */\n    skip(skip) {\n        let nextResult;\n        let prevPosition;\n        do {\n            prevPosition = this.position;\n            nextResult = this.next();\n        } while (!nextResult.done && skip(nextResult.value));\n        if (!nextResult.done) {\n            this._position = prevPosition;\n        }\n    }\n    /**\n     * Gets the next tree walker's value.\n     *\n     * @returns Object implementing iterator interface, returning\n     * information about taken step.\n     */\n    next() {\n        if (this.direction == 'forward') {\n            return this._next();\n        }\n        else {\n            return this._previous();\n        }\n    }\n    /**\n     * Makes a step forward in view. Moves the {@link #position} to the next position and returns the encountered value.\n     */\n    _next() {\n        let position = this.position.clone();\n        const previousPosition = this.position;\n        const parent = position.parent;\n        // We are at the end of the root.\n        if (parent.parent === null && position.offset === parent.childCount) {\n            return { done: true, value: undefined };\n        }\n        // We reached the walker boundary.\n        if (parent === this._boundaryEndParent && position.offset == this.boundaries.end.offset) {\n            return { done: true, value: undefined };\n        }\n        // Get node just after current position.\n        let node;\n        // Text is a specific parent because it contains string instead of child nodes.\n        if (parent instanceof Text) {\n            if (position.isAtEnd) {\n                // Prevent returning \"elementEnd\" for Text node. Skip that value and return the next walker step.\n                this._position = Position._createAfter(parent);\n                return this._next();\n            }\n            node = parent.data[position.offset];\n        }\n        else {\n            node = parent.getChild(position.offset);\n        }\n        if (node instanceof Element) {\n            if (!this.shallow) {\n                position = new Position(node, 0);\n            }\n            else {\n                // We are past the walker boundaries.\n                if (this.boundaries && this.boundaries.end.isBefore(position)) {\n                    return { done: true, value: undefined };\n                }\n                position.offset++;\n            }\n            this._position = position;\n            return this._formatReturnValue('elementStart', node, previousPosition, position, 1);\n        }\n        if (node instanceof Text) {\n            if (this.singleCharacters) {\n                position = new Position(node, 0);\n                this._position = position;\n                return this._next();\n            }\n            let charactersCount = node.data.length;\n            let item;\n            // If text stick out of walker range, we need to cut it and wrap in TextProxy.\n            if (node == this._boundaryEndParent) {\n                charactersCount = this.boundaries.end.offset;\n                item = new TextProxy(node, 0, charactersCount);\n                position = Position._createAfter(item);\n            }\n            else {\n                item = new TextProxy(node, 0, node.data.length);\n                // If not just keep moving forward.\n                position.offset++;\n            }\n            this._position = position;\n            return this._formatReturnValue('text', item, previousPosition, position, charactersCount);\n        }\n        if (typeof node == 'string') {\n            let textLength;\n            if (this.singleCharacters) {\n                textLength = 1;\n            }\n            else {\n                // Check if text stick out of walker range.\n                const endOffset = parent === this._boundaryEndParent ? this.boundaries.end.offset : parent.data.length;\n                textLength = endOffset - position.offset;\n            }\n            const textProxy = new TextProxy(parent, position.offset, textLength);\n            position.offset += textLength;\n            this._position = position;\n            return this._formatReturnValue('text', textProxy, previousPosition, position, textLength);\n        }\n        // `node` is not set, we reached the end of current `parent`.\n        position = Position._createAfter(parent);\n        this._position = position;\n        if (this.ignoreElementEnd) {\n            return this._next();\n        }\n        return this._formatReturnValue('elementEnd', parent, previousPosition, position);\n    }\n    /**\n     * Makes a step backward in view. Moves the {@link #position} to the previous position and returns the encountered value.\n     */\n    _previous() {\n        let position = this.position.clone();\n        const previousPosition = this.position;\n        const parent = position.parent;\n        // We are at the beginning of the root.\n        if (parent.parent === null && position.offset === 0) {\n            return { done: true, value: undefined };\n        }\n        // We reached the walker boundary.\n        if (parent == this._boundaryStartParent && position.offset == this.boundaries.start.offset) {\n            return { done: true, value: undefined };\n        }\n        // Get node just before current position.\n        let node;\n        // Text {@link module:engine/view/text~Text} element is a specific parent because contains string instead of child nodes.\n        if (parent instanceof Text) {\n            if (position.isAtStart) {\n                // Prevent returning \"elementStart\" for Text node. Skip that value and return the next walker step.\n                this._position = Position._createBefore(parent);\n                return this._previous();\n            }\n            node = parent.data[position.offset - 1];\n        }\n        else {\n            node = parent.getChild(position.offset - 1);\n        }\n        if (node instanceof Element) {\n            if (this.shallow) {\n                position.offset--;\n                this._position = position;\n                return this._formatReturnValue('elementStart', node, previousPosition, position, 1);\n            }\n            position = new Position(node, node.childCount);\n            this._position = position;\n            if (this.ignoreElementEnd) {\n                return this._previous();\n            }\n            return this._formatReturnValue('elementEnd', node, previousPosition, position);\n        }\n        if (node instanceof Text) {\n            if (this.singleCharacters) {\n                position = new Position(node, node.data.length);\n                this._position = position;\n                return this._previous();\n            }\n            let charactersCount = node.data.length;\n            let item;\n            // If text stick out of walker range, we need to cut it and wrap in TextProxy.\n            if (node == this._boundaryStartParent) {\n                const offset = this.boundaries.start.offset;\n                item = new TextProxy(node, offset, node.data.length - offset);\n                charactersCount = item.data.length;\n                position = Position._createBefore(item);\n            }\n            else {\n                item = new TextProxy(node, 0, node.data.length);\n                // If not just keep moving backward.\n                position.offset--;\n            }\n            this._position = position;\n            return this._formatReturnValue('text', item, previousPosition, position, charactersCount);\n        }\n        if (typeof node == 'string') {\n            let textLength;\n            if (!this.singleCharacters) {\n                // Check if text stick out of walker range.\n                const startOffset = parent === this._boundaryStartParent ? this.boundaries.start.offset : 0;\n                textLength = position.offset - startOffset;\n            }\n            else {\n                textLength = 1;\n            }\n            position.offset -= textLength;\n            const textProxy = new TextProxy(parent, position.offset, textLength);\n            this._position = position;\n            return this._formatReturnValue('text', textProxy, previousPosition, position, textLength);\n        }\n        // `node` is not set, we reached the beginning of current `parent`.\n        position = Position._createBefore(parent);\n        this._position = position;\n        return this._formatReturnValue('elementStart', parent, previousPosition, position, 1);\n    }\n    /**\n     * Format returned data and adjust `previousPosition` and `nextPosition` if reach the bound of the {@link module:engine/view/text~Text}.\n     *\n     * @param type Type of step.\n     * @param item Item between old and new position.\n     * @param previousPosition Previous position of iterator.\n     * @param nextPosition Next position of iterator.\n     * @param length Length of the item.\n     */\n    _formatReturnValue(type, item, previousPosition, nextPosition, length) {\n        // Text is a specific parent, because contains string instead of children.\n        // Walker doesn't enter to the Text except situations when walker is iterating over every single character,\n        // or the bound starts/ends inside the Text. So when the position is at the beginning or at the end of the Text\n        // we move it just before or just after Text.\n        if (item instanceof TextProxy) {\n            // Position is at the end of Text.\n            if (item.offsetInText + item.data.length == item.textNode.data.length) {\n                if (this.direction == 'forward' && !(this.boundaries && this.boundaries.end.isEqual(this.position))) {\n                    nextPosition = Position._createAfter(item.textNode);\n                    // When we change nextPosition of returned value we need also update walker current position.\n                    this._position = nextPosition;\n                }\n                else {\n                    previousPosition = Position._createAfter(item.textNode);\n                }\n            }\n            // Position is at the begining ot the text.\n            if (item.offsetInText === 0) {\n                if (this.direction == 'backward' && !(this.boundaries && this.boundaries.start.isEqual(this.position))) {\n                    nextPosition = Position._createBefore(item.textNode);\n                    // When we change nextPosition of returned value we need also update walker current position.\n                    this._position = nextPosition;\n                }\n                else {\n                    previousPosition = Position._createBefore(item.textNode);\n                }\n            }\n        }\n        return {\n            done: false,\n            value: {\n                type,\n                item,\n                previousPosition,\n                nextPosition,\n                length\n            }\n        };\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/position\n */\nimport TypeCheckable from './typecheckable.js';\nimport { CKEditorError, compareArrays } from '@ckeditor/ckeditor5-utils';\nimport EditableElement from './editableelement.js';\n// To check if component is loaded more than once.\nimport '@ckeditor/ckeditor5-utils/src/version.js';\nimport { default as TreeWalker } from './treewalker.js';\n/**\n * Position in the view tree. Position is represented by its parent node and an offset in this parent.\n *\n * In order to create a new position instance use the `createPosition*()` factory methods available in:\n *\n * * {@link module:engine/view/view~View}\n * * {@link module:engine/view/downcastwriter~DowncastWriter}\n * * {@link module:engine/view/upcastwriter~UpcastWriter}\n */\nexport default class Position extends TypeCheckable {\n    /**\n     * Creates a position.\n     *\n     * @param parent Position parent.\n     * @param offset Position offset.\n     */\n    constructor(parent, offset) {\n        super();\n        this.parent = parent;\n        this.offset = offset;\n    }\n    /**\n     * Node directly after the position. Equals `null` when there is no node after position or position is located\n     * inside text node.\n     */\n    get nodeAfter() {\n        if (this.parent.is('$text')) {\n            return null;\n        }\n        return this.parent.getChild(this.offset) || null;\n    }\n    /**\n     * Node directly before the position. Equals `null` when there is no node before position or position is located\n     * inside text node.\n     */\n    get nodeBefore() {\n        if (this.parent.is('$text')) {\n            return null;\n        }\n        return this.parent.getChild(this.offset - 1) || null;\n    }\n    /**\n     * Is `true` if position is at the beginning of its {@link module:engine/view/position~Position#parent parent}, `false` otherwise.\n     */\n    get isAtStart() {\n        return this.offset === 0;\n    }\n    /**\n     * Is `true` if position is at the end of its {@link module:engine/view/position~Position#parent parent}, `false` otherwise.\n     */\n    get isAtEnd() {\n        const endOffset = this.parent.is('$text') ? this.parent.data.length : this.parent.childCount;\n        return this.offset === endOffset;\n    }\n    /**\n     * Position's root, that is the root of the position's parent element.\n     */\n    get root() {\n        return this.parent.root;\n    }\n    /**\n     * {@link module:engine/view/editableelement~EditableElement EditableElement} instance that contains this position, or `null` if\n     * position is not inside an editable element.\n     */\n    get editableElement() {\n        let editable = this.parent;\n        while (!(editable instanceof EditableElement)) {\n            if (editable.parent) {\n                editable = editable.parent;\n            }\n            else {\n                return null;\n            }\n        }\n        return editable;\n    }\n    /**\n     * Returns a new instance of Position with offset incremented by `shift` value.\n     *\n     * @param shift How position offset should get changed. Accepts negative values.\n     * @returns Shifted position.\n     */\n    getShiftedBy(shift) {\n        const shifted = Position._createAt(this);\n        const offset = shifted.offset + shift;\n        shifted.offset = offset < 0 ? 0 : offset;\n        return shifted;\n    }\n    /**\n     * Gets the farthest position which matches the callback using\n     * {@link module:engine/view/treewalker~TreeWalker TreeWalker}.\n     *\n     * For example:\n     *\n     * ```ts\n     * getLastMatchingPosition( value => value.type == 'text' ); // <p>{}foo</p> -> <p>foo[]</p>\n     * getLastMatchingPosition( value => value.type == 'text', { direction: 'backward' } ); // <p>foo[]</p> -> <p>{}foo</p>\n     * getLastMatchingPosition( value => false ); // Do not move the position.\n     * ```\n     *\n     * @param skip Callback function. Gets {@link module:engine/view/treewalker~TreeWalkerValue} and should\n     * return `true` if the value should be skipped or `false` if not.\n     * @param options Object with configuration options. See {@link module:engine/view/treewalker~TreeWalker}.\n     * @returns The position after the last item which matches the `skip` callback test.\n     */\n    getLastMatchingPosition(skip, options = {}) {\n        options.startPosition = this;\n        const treeWalker = new TreeWalker(options);\n        treeWalker.skip(skip);\n        return treeWalker.position;\n    }\n    /**\n     * Returns ancestors array of this position, that is this position's parent and it's ancestors.\n     *\n     * @returns Array with ancestors.\n     */\n    getAncestors() {\n        if (this.parent.is('documentFragment')) {\n            return [this.parent];\n        }\n        else {\n            return this.parent.getAncestors({ includeSelf: true });\n        }\n    }\n    /**\n     * Returns a {@link module:engine/view/node~Node} or {@link module:engine/view/documentfragment~DocumentFragment}\n     * which is a common ancestor of both positions.\n     */\n    getCommonAncestor(position) {\n        const ancestorsA = this.getAncestors();\n        const ancestorsB = position.getAncestors();\n        let i = 0;\n        while (ancestorsA[i] == ancestorsB[i] && ancestorsA[i]) {\n            i++;\n        }\n        return i === 0 ? null : ancestorsA[i - 1];\n    }\n    /**\n     * Checks whether this position equals given position.\n     *\n     * @param otherPosition Position to compare with.\n     * @returns True if positions are same.\n     */\n    isEqual(otherPosition) {\n        return (this.parent == otherPosition.parent && this.offset == otherPosition.offset);\n    }\n    /**\n     * Checks whether this position is located before given position. When method returns `false` it does not mean that\n     * this position is after give one. Two positions may be located inside separate roots and in that situation this\n     * method will still return `false`.\n     *\n     * @see module:engine/view/position~Position#isAfter\n     * @see module:engine/view/position~Position#compareWith\n     * @param otherPosition Position to compare with.\n     * @returns Returns `true` if this position is before given position.\n     */\n    isBefore(otherPosition) {\n        return this.compareWith(otherPosition) == 'before';\n    }\n    /**\n     * Checks whether this position is located after given position. When method returns `false` it does not mean that\n     * this position is before give one. Two positions may be located inside separate roots and in that situation this\n     * method will still return `false`.\n     *\n     * @see module:engine/view/position~Position#isBefore\n     * @see module:engine/view/position~Position#compareWith\n     * @param otherPosition Position to compare with.\n     * @returns Returns `true` if this position is after given position.\n     */\n    isAfter(otherPosition) {\n        return this.compareWith(otherPosition) == 'after';\n    }\n    /**\n     * Checks whether this position is before, after or in same position that other position. Two positions may be also\n     * different when they are located in separate roots.\n     *\n     * @param otherPosition Position to compare with.\n     */\n    compareWith(otherPosition) {\n        if (this.root !== otherPosition.root) {\n            return 'different';\n        }\n        if (this.isEqual(otherPosition)) {\n            return 'same';\n        }\n        // Get path from root to position's parent element.\n        const thisPath = this.parent.is('node') ? this.parent.getPath() : [];\n        const otherPath = otherPosition.parent.is('node') ? otherPosition.parent.getPath() : [];\n        // Add the positions' offsets to the parents offsets.\n        thisPath.push(this.offset);\n        otherPath.push(otherPosition.offset);\n        // Compare both path arrays to find common ancestor.\n        const result = compareArrays(thisPath, otherPath);\n        switch (result) {\n            case 'prefix':\n                return 'before';\n            case 'extension':\n                return 'after';\n            default:\n                // Cast to number to avoid having 'same' as a type of `result`.\n                return thisPath[result] < otherPath[result] ? 'before' : 'after';\n        }\n    }\n    /**\n     * Creates a {@link module:engine/view/treewalker~TreeWalker TreeWalker} instance with this positions as a start position.\n     *\n     * @param options Object with configuration options. See {@link module:engine/view/treewalker~TreeWalker}\n     */\n    getWalker(options = {}) {\n        options.startPosition = this;\n        return new TreeWalker(options);\n    }\n    /**\n     * Clones this position.\n     */\n    clone() {\n        return new Position(this.parent, this.offset);\n    }\n    /**\n     * Creates position at the given location. The location can be specified as:\n     *\n     * * a {@link module:engine/view/position~Position position},\n     * * parent element and offset (offset defaults to `0`),\n     * * parent element and `'end'` (sets position at the end of that element),\n     * * {@link module:engine/view/item~Item view item} and `'before'` or `'after'` (sets position before or after given view item).\n     *\n     * This method is a shortcut to other constructors such as:\n     *\n     * * {@link module:engine/view/position~Position._createBefore},\n     * * {@link module:engine/view/position~Position._createAfter}.\n     *\n     * @internal\n     * @param offset Offset or one of the flags. Used only when first parameter is a {@link module:engine/view/item~Item view item}.\n     */\n    static _createAt(itemOrPosition, offset) {\n        if (itemOrPosition instanceof Position) {\n            return new this(itemOrPosition.parent, itemOrPosition.offset);\n        }\n        else {\n            const node = itemOrPosition;\n            if (offset == 'end') {\n                offset = node.is('$text') ? node.data.length : node.childCount;\n            }\n            else if (offset == 'before') {\n                return this._createBefore(node);\n            }\n            else if (offset == 'after') {\n                return this._createAfter(node);\n            }\n            else if (offset !== 0 && !offset) {\n                /**\n                 * {@link module:engine/view/view~View#createPositionAt `View#createPositionAt()`}\n                 * requires the offset to be specified when the first parameter is a view item.\n                 *\n                 * @error view-createpositionat-offset-required\n                 */\n                throw new CKEditorError('view-createpositionat-offset-required', node);\n            }\n            return new Position(node, offset);\n        }\n    }\n    /**\n     * Creates a new position after given view item.\n     *\n     * @internal\n     * @param item View item after which the position should be located.\n     */\n    static _createAfter(item) {\n        // TextProxy is not a instance of Node so we need do handle it in specific way.\n        if (item.is('$textProxy')) {\n            return new Position(item.textNode, item.offsetInText + item.data.length);\n        }\n        if (!item.parent) {\n            /**\n             * You can not make a position after a root.\n             *\n             * @error view-position-after-root\n             * @param {module:engine/view/node~Node} root\n             */\n            throw new CKEditorError('view-position-after-root', item, { root: item });\n        }\n        return new Position(item.parent, item.index + 1);\n    }\n    /**\n     * Creates a new position before given view item.\n     *\n     * @internal\n     * @param item View item before which the position should be located.\n     */\n    static _createBefore(item) {\n        // TextProxy is not a instance of Node so we need do handle it in specific way.\n        if (item.is('$textProxy')) {\n            return new Position(item.textNode, item.offsetInText);\n        }\n        if (!item.parent) {\n            /**\n             * You cannot make a position before a root.\n             *\n             * @error view-position-before-root\n             * @param {module:engine/view/node~Node} root\n             */\n            throw new CKEditorError('view-position-before-root', item, { root: item });\n        }\n        return new Position(item.parent, item.index);\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nPosition.prototype.is = function (type) {\n    return type === 'position' || type === 'view:position';\n};\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/range\n */\nimport TypeCheckable from './typecheckable.js';\nimport Position from './position.js';\nimport { default as TreeWalker } from './treewalker.js';\n/**\n * Range in the view tree. A range is represented by its start and end {@link module:engine/view/position~Position positions}.\n *\n * In order to create a new position instance use the `createPosition*()` factory methods available in:\n *\n * * {@link module:engine/view/view~View}\n * * {@link module:engine/view/downcastwriter~DowncastWriter}\n * * {@link module:engine/view/upcastwriter~UpcastWriter}\n */\nexport default class Range extends TypeCheckable {\n    /**\n     * Creates a range spanning from `start` position to `end` position.\n     *\n     * **Note:** Constructor creates it's own {@link module:engine/view/position~Position} instances basing on passed values.\n     *\n     * @param start Start position.\n     * @param end End position. If not set, range will be collapsed at the `start` position.\n     */\n    constructor(start, end = null) {\n        super();\n        this.start = start.clone();\n        this.end = end ? end.clone() : start.clone();\n    }\n    /**\n     * Iterable interface.\n     *\n     * Iterates over all {@link module:engine/view/item~Item view items} that are in this range and returns\n     * them together with additional information like length or {@link module:engine/view/position~Position positions},\n     * grouped as {@link module:engine/view/treewalker~TreeWalkerValue}.\n     *\n     * This iterator uses {@link module:engine/view/treewalker~TreeWalker TreeWalker} with `boundaries` set to this range and\n     * `ignoreElementEnd` option\n     * set to `true`.\n     */\n    *[Symbol.iterator]() {\n        yield* new TreeWalker({ boundaries: this, ignoreElementEnd: true });\n    }\n    /**\n     * Returns whether the range is collapsed, that is it start and end positions are equal.\n     */\n    get isCollapsed() {\n        return this.start.isEqual(this.end);\n    }\n    /**\n     * Returns whether this range is flat, that is if {@link module:engine/view/range~Range#start start} position and\n     * {@link module:engine/view/range~Range#end end} position are in the same {@link module:engine/view/position~Position#parent parent}.\n     */\n    get isFlat() {\n        return this.start.parent === this.end.parent;\n    }\n    /**\n     * Range root element.\n     */\n    get root() {\n        return this.start.root;\n    }\n    /**\n     * Creates a maximal range that has the same content as this range but is expanded in both ways (at the beginning\n     * and at the end).\n     *\n     * For example:\n     *\n     * ```html\n     * <p>Foo</p><p><b>{Bar}</b></p> -> <p>Foo</p>[<p><b>Bar</b>]</p>\n     * <p><b>foo</b>{bar}<span></span></p> -> <p><b>foo[</b>bar<span></span>]</p>\n     * ```\n     *\n     * Note that in the sample above:\n     *\n     * - `<p>` have type of {@link module:engine/view/containerelement~ContainerElement},\n     * - `<b>` have type of {@link module:engine/view/attributeelement~AttributeElement},\n     * - `<span>` have type of {@link module:engine/view/uielement~UIElement}.\n     *\n     * @returns Enlarged range.\n     */\n    getEnlarged() {\n        let start = this.start.getLastMatchingPosition(enlargeTrimSkip, { direction: 'backward' });\n        let end = this.end.getLastMatchingPosition(enlargeTrimSkip);\n        // Fix positions, in case if they are in Text node.\n        if (start.parent.is('$text') && start.isAtStart) {\n            start = Position._createBefore(start.parent);\n        }\n        if (end.parent.is('$text') && end.isAtEnd) {\n            end = Position._createAfter(end.parent);\n        }\n        return new Range(start, end);\n    }\n    /**\n     * Creates a minimum range that has the same content as this range but is trimmed in both ways (at the beginning\n     * and at the end).\n     *\n     * For example:\n     *\n     * ```html\n     * <p>Foo</p>[<p><b>Bar</b>]</p> -> <p>Foo</p><p><b>{Bar}</b></p>\n     * <p><b>foo[</b>bar<span></span>]</p> -> <p><b>foo</b>{bar}<span></span></p>\n     * ```\n     *\n     * Note that in the sample above:\n     *\n     * - `<p>` have type of {@link module:engine/view/containerelement~ContainerElement},\n     * - `<b>` have type of {@link module:engine/view/attributeelement~AttributeElement},\n     * - `<span>` have type of {@link module:engine/view/uielement~UIElement}.\n     *\n     * @returns Shrunk range.\n     */\n    getTrimmed() {\n        let start = this.start.getLastMatchingPosition(enlargeTrimSkip);\n        if (start.isAfter(this.end) || start.isEqual(this.end)) {\n            return new Range(start, start);\n        }\n        let end = this.end.getLastMatchingPosition(enlargeTrimSkip, { direction: 'backward' });\n        const nodeAfterStart = start.nodeAfter;\n        const nodeBeforeEnd = end.nodeBefore;\n        // Because TreeWalker prefers positions next to text node, we need to move them manually into these text nodes.\n        if (nodeAfterStart && nodeAfterStart.is('$text')) {\n            start = new Position(nodeAfterStart, 0);\n        }\n        if (nodeBeforeEnd && nodeBeforeEnd.is('$text')) {\n            end = new Position(nodeBeforeEnd, nodeBeforeEnd.data.length);\n        }\n        return new Range(start, end);\n    }\n    /**\n     * Two ranges are equal if their start and end positions are equal.\n     *\n     * @param otherRange Range to compare with.\n     * @returns `true` if ranges are equal, `false` otherwise\n     */\n    isEqual(otherRange) {\n        return this == otherRange || (this.start.isEqual(otherRange.start) && this.end.isEqual(otherRange.end));\n    }\n    /**\n     * Checks whether this range contains given {@link module:engine/view/position~Position position}.\n     *\n     * @param position Position to check.\n     * @returns `true` if given {@link module:engine/view/position~Position position} is contained in this range, `false` otherwise.\n     */\n    containsPosition(position) {\n        return position.isAfter(this.start) && position.isBefore(this.end);\n    }\n    /**\n     * Checks whether this range contains given {@link module:engine/view/range~Range range}.\n     *\n     * @param otherRange Range to check.\n     * @param loose Whether the check is loose or strict. If the check is strict (`false`), compared range cannot\n     * start or end at the same position as this range boundaries. If the check is loose (`true`), compared range can start, end or\n     * even be equal to this range. Note that collapsed ranges are always compared in strict mode.\n     * @returns `true` if given {@link module:engine/view/range~Range range} boundaries are contained by this range, `false`\n     * otherwise.\n     */\n    containsRange(otherRange, loose = false) {\n        if (otherRange.isCollapsed) {\n            loose = false;\n        }\n        const containsStart = this.containsPosition(otherRange.start) || (loose && this.start.isEqual(otherRange.start));\n        const containsEnd = this.containsPosition(otherRange.end) || (loose && this.end.isEqual(otherRange.end));\n        return containsStart && containsEnd;\n    }\n    /**\n     * Computes which part(s) of this {@link module:engine/view/range~Range range} is not a part of given\n     * {@link module:engine/view/range~Range range}.\n     * Returned array contains zero, one or two {@link module:engine/view/range~Range ranges}.\n     *\n     * Examples:\n     *\n     * ```ts\n     * let foo = downcastWriter.createText( 'foo' );\n     * let img = downcastWriter.createContainerElement( 'img' );\n     * let bar = downcastWriter.createText( 'bar' );\n     * let p = downcastWriter.createContainerElement( 'p', null, [ foo, img, bar ] );\n     *\n     * let range = view.createRange( view.createPositionAt( foo, 2 ), view.createPositionAt( bar, 1 ); // \"o\", img, \"b\" are in range.\n     * let otherRange = view.createRange( // \"oo\", img, \"ba\" are in range.\n     * \tview.createPositionAt( foo, 1 ),\n     * \tview.createPositionAt( bar, 2 )\n     * );\n     * let transformed = range.getDifference( otherRange );\n     * // transformed array has no ranges because `otherRange` contains `range`\n     *\n     * otherRange = view.createRange( view.createPositionAt( foo, 1 ), view.createPositionAt( p, 2 ); // \"oo\", img are in range.\n     * transformed = range.getDifference( otherRange );\n     * // transformed array has one range: from ( p, 2 ) to ( bar, 1 )\n     *\n     * otherRange = view.createRange( view.createPositionAt( p, 1 ), view.createPositionAt( p, 2 ) ); // img is in range.\n     * transformed = range.getDifference( otherRange );\n     * // transformed array has two ranges: from ( foo, 1 ) to ( p, 1 ) and from ( p, 2 ) to ( bar, 1 )\n     * ```\n     *\n     * @param otherRange Range to differentiate against.\n     * @returns The difference between ranges.\n     */\n    getDifference(otherRange) {\n        const ranges = [];\n        if (this.isIntersecting(otherRange)) {\n            // Ranges intersect.\n            if (this.containsPosition(otherRange.start)) {\n                // Given range start is inside this range. This means that we have to\n                // add shrunken range - from the start to the middle of this range.\n                ranges.push(new Range(this.start, otherRange.start));\n            }\n            if (this.containsPosition(otherRange.end)) {\n                // Given range end is inside this range. This means that we have to\n                // add shrunken range - from the middle of this range to the end.\n                ranges.push(new Range(otherRange.end, this.end));\n            }\n        }\n        else {\n            // Ranges do not intersect, return the original range.\n            ranges.push(this.clone());\n        }\n        return ranges;\n    }\n    /**\n     * Returns an intersection of this {@link module:engine/view/range~Range range} and given {@link module:engine/view/range~Range range}.\n     * Intersection is a common part of both of those ranges. If ranges has no common part, returns `null`.\n     *\n     * Examples:\n     *\n     * ```ts\n     * let foo = downcastWriter.createText( 'foo' );\n     * let img = downcastWriter.createContainerElement( 'img' );\n     * let bar = downcastWriter.createText( 'bar' );\n     * let p = downcastWriter.createContainerElement( 'p', null, [ foo, img, bar ] );\n     *\n     * let range = view.createRange( view.createPositionAt( foo, 2 ), view.createPositionAt( bar, 1 ); // \"o\", img, \"b\" are in range.\n     * let otherRange = view.createRange( view.createPositionAt( foo, 1 ), view.createPositionAt( p, 2 ); // \"oo\", img are in range.\n     * let transformed = range.getIntersection( otherRange ); // range from ( foo, 1 ) to ( p, 2 ).\n     *\n     * otherRange = view.createRange( view.createPositionAt( bar, 1 ), view.createPositionAt( bar, 3 ); \"ar\" is in range.\n     * transformed = range.getIntersection( otherRange ); // null - no common part.\n     * ```\n     *\n     * @param otherRange Range to check for intersection.\n     * @returns A common part of given ranges or `null` if ranges have no common part.\n     */\n    getIntersection(otherRange) {\n        if (this.isIntersecting(otherRange)) {\n            // Ranges intersect, so a common range will be returned.\n            // At most, it will be same as this range.\n            let commonRangeStart = this.start;\n            let commonRangeEnd = this.end;\n            if (this.containsPosition(otherRange.start)) {\n                // Given range start is inside this range. This means thaNt we have to\n                // shrink common range to the given range start.\n                commonRangeStart = otherRange.start;\n            }\n            if (this.containsPosition(otherRange.end)) {\n                // Given range end is inside this range. This means that we have to\n                // shrink common range to the given range end.\n                commonRangeEnd = otherRange.end;\n            }\n            return new Range(commonRangeStart, commonRangeEnd);\n        }\n        // Ranges do not intersect, so they do not have common part.\n        return null;\n    }\n    /**\n     * Creates a {@link module:engine/view/treewalker~TreeWalker TreeWalker} instance with this range as a boundary.\n     *\n     * @param options Object with configuration options. See {@link module:engine/view/treewalker~TreeWalker}.\n     */\n    getWalker(options = {}) {\n        options.boundaries = this;\n        return new TreeWalker(options);\n    }\n    /**\n     * Returns a {@link module:engine/view/node~Node} or {@link module:engine/view/documentfragment~DocumentFragment}\n     * which is a common ancestor of range's both ends (in which the entire range is contained).\n     */\n    getCommonAncestor() {\n        return this.start.getCommonAncestor(this.end);\n    }\n    /**\n     * Returns an {@link module:engine/view/element~Element Element} contained by the range.\n     * The element will be returned when it is the **only** node within the range and **fully–contained**\n     * at the same time.\n     */\n    getContainedElement() {\n        if (this.isCollapsed) {\n            return null;\n        }\n        let nodeAfterStart = this.start.nodeAfter;\n        let nodeBeforeEnd = this.end.nodeBefore;\n        // Handle the situation when the range position is at the beginning / at the end of a text node.\n        // In such situation `.nodeAfter` and `.nodeBefore` are `null` but the range still might be spanning\n        // over one element.\n        //\n        // <p>Foo{<span class=\"widget\"></span>}bar</p> vs <p>Foo[<span class=\"widget\"></span>]bar</p>\n        //\n        // These are basically the same range, only the difference is if the range position is at\n        // at the end/at the beginning of a text node or just before/just after the text node.\n        //\n        if (this.start.parent.is('$text') && this.start.isAtEnd && this.start.parent.nextSibling) {\n            nodeAfterStart = this.start.parent.nextSibling;\n        }\n        if (this.end.parent.is('$text') && this.end.isAtStart && this.end.parent.previousSibling) {\n            nodeBeforeEnd = this.end.parent.previousSibling;\n        }\n        if (nodeAfterStart && nodeAfterStart.is('element') && nodeAfterStart === nodeBeforeEnd) {\n            return nodeAfterStart;\n        }\n        return null;\n    }\n    /**\n     * Clones this range.\n     */\n    clone() {\n        return new Range(this.start, this.end);\n    }\n    /**\n     * Returns an iterator that iterates over all {@link module:engine/view/item~Item view items} that are in this range and returns\n     * them.\n     *\n     * This method uses {@link module:engine/view/treewalker~TreeWalker} with `boundaries` set to this range and `ignoreElementEnd` option\n     * set to `true`. However it returns only {@link module:engine/view/item~Item items},\n     * not {@link module:engine/view/treewalker~TreeWalkerValue}.\n     *\n     * You may specify additional options for the tree walker. See {@link module:engine/view/treewalker~TreeWalker} for\n     * a full list of available options.\n     *\n     * @param options Object with configuration options. See {@link module:engine/view/treewalker~TreeWalker}.\n     */\n    *getItems(options = {}) {\n        options.boundaries = this;\n        options.ignoreElementEnd = true;\n        const treeWalker = new TreeWalker(options);\n        for (const value of treeWalker) {\n            yield value.item;\n        }\n    }\n    /**\n     * Returns an iterator that iterates over all {@link module:engine/view/position~Position positions} that are boundaries or\n     * contained in this range.\n     *\n     * This method uses {@link module:engine/view/treewalker~TreeWalker} with `boundaries` set to this range. However it returns only\n     * {@link module:engine/view/position~Position positions}, not {@link module:engine/view/treewalker~TreeWalkerValue}.\n     *\n     * You may specify additional options for the tree walker. See {@link module:engine/view/treewalker~TreeWalker} for\n     * a full list of available options.\n     *\n     * @param options Object with configuration options. See {@link module:engine/view/treewalker~TreeWalker}.\n     */\n    *getPositions(options = {}) {\n        options.boundaries = this;\n        const treeWalker = new TreeWalker(options);\n        yield treeWalker.position;\n        for (const value of treeWalker) {\n            yield value.nextPosition;\n        }\n    }\n    /**\n     * Checks and returns whether this range intersects with the given range.\n     *\n     * @param otherRange Range to compare with.\n     * @returns True if ranges intersect.\n     */\n    isIntersecting(otherRange) {\n        return this.start.isBefore(otherRange.end) && this.end.isAfter(otherRange.start);\n    }\n    /**\n     * Creates a range from the given parents and offsets.\n     *\n     * @internal\n     * @param startElement Start position parent element.\n     * @param startOffset Start position offset.\n     * @param endElement End position parent element.\n     * @param endOffset End position offset.\n     * @returns Created range.\n     */\n    static _createFromParentsAndOffsets(startElement, startOffset, endElement, endOffset) {\n        return new this(new Position(startElement, startOffset), new Position(endElement, endOffset));\n    }\n    /**\n     * Creates a new range, spreading from specified {@link module:engine/view/position~Position position} to a position moved by\n     * given `shift`. If `shift` is a negative value, shifted position is treated as the beginning of the range.\n     *\n     * @internal\n     * @param position Beginning of the range.\n     * @param shift How long the range should be.\n     */\n    static _createFromPositionAndShift(position, shift) {\n        const start = position;\n        const end = position.getShiftedBy(shift);\n        return shift > 0 ? new this(start, end) : new this(end, start);\n    }\n    /**\n     * Creates a range inside an {@link module:engine/view/element~Element element} which starts before the first child of\n     * that element and ends after the last child of that element.\n     *\n     * @internal\n     * @param element Element which is a parent for the range.\n     */\n    static _createIn(element) {\n        return this._createFromParentsAndOffsets(element, 0, element, element.childCount);\n    }\n    /**\n     * Creates a range that starts before given {@link module:engine/view/item~Item view item} and ends after it.\n     *\n     * @internal\n     */\n    static _createOn(item) {\n        const size = item.is('$textProxy') ? item.offsetSize : 1;\n        return this._createFromPositionAndShift(Position._createBefore(item), size);\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nRange.prototype.is = function (type) {\n    return type === 'range' || type === 'view:range';\n};\n/**\n * Function used by getEnlarged and getTrimmed methods.\n */\nfunction enlargeTrimSkip(value) {\n    if (value.item.is('attributeElement') || value.item.is('uiElement')) {\n        return true;\n    }\n    return false;\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/documentselection\n */\nimport TypeCheckable from './typecheckable.js';\nimport Selection from './selection.js';\nimport { EmitterMixin } from '@ckeditor/ckeditor5-utils';\n/**\n * Class representing the document selection in the view.\n *\n * Its instance is available in {@link module:engine/view/document~Document#selection `Document#selection`}.\n *\n * It is similar to {@link module:engine/view/selection~Selection} but\n * it has a read-only API and can be modified only by the writer available in\n * the {@link module:engine/view/view~View#change `View#change()`} block\n * (so via {@link module:engine/view/downcastwriter~DowncastWriter#setSelection `DowncastWriter#setSelection()`}).\n */\nexport default class DocumentSelection extends EmitterMixin(TypeCheckable) {\n    constructor(...args) {\n        super();\n        this._selection = new Selection();\n        // Delegate change event to be fired on DocumentSelection instance.\n        this._selection.delegate('change').to(this);\n        // Set selection data.\n        if (args.length) {\n            this._selection.setTo(...args);\n        }\n    }\n    /**\n     * Returns true if selection instance is marked as `fake`.\n     *\n     * @see #_setTo\n     */\n    get isFake() {\n        return this._selection.isFake;\n    }\n    /**\n     * Returns fake selection label.\n     *\n     * @see #_setTo\n     */\n    get fakeSelectionLabel() {\n        return this._selection.fakeSelectionLabel;\n    }\n    /**\n     * Selection anchor. Anchor may be described as a position where the selection starts. Together with\n     * {@link #focus focus} they define the direction of selection, which is important\n     * when expanding/shrinking selection. Anchor is always the start or end of the most recent added range.\n     * It may be a bit unintuitive when there are multiple ranges in selection.\n     *\n     * @see #focus\n     */\n    get anchor() {\n        return this._selection.anchor;\n    }\n    /**\n     * Selection focus. Focus is a position where the selection ends.\n     *\n     * @see #anchor\n     */\n    get focus() {\n        return this._selection.focus;\n    }\n    /**\n     * Returns whether the selection is collapsed. Selection is collapsed when there is exactly one range which is\n     * collapsed.\n     */\n    get isCollapsed() {\n        return this._selection.isCollapsed;\n    }\n    /**\n     * Returns number of ranges in selection.\n     */\n    get rangeCount() {\n        return this._selection.rangeCount;\n    }\n    /**\n     * Specifies whether the {@link #focus} precedes {@link #anchor}.\n     */\n    get isBackward() {\n        return this._selection.isBackward;\n    }\n    /**\n     * {@link module:engine/view/editableelement~EditableElement EditableElement} instance that contains this selection, or `null`\n     * if the selection is not inside an editable element.\n     */\n    get editableElement() {\n        return this._selection.editableElement;\n    }\n    /**\n     * Used for the compatibility with the {@link module:engine/view/selection~Selection#isEqual} method.\n     *\n     * @internal\n     */\n    get _ranges() {\n        return this._selection._ranges;\n    }\n    /**\n     * Returns an iterable that contains copies of all ranges added to the selection.\n     */\n    *getRanges() {\n        yield* this._selection.getRanges();\n    }\n    /**\n     * Returns copy of the first range in the selection. First range is the one which\n     * {@link module:engine/view/range~Range#start start} position {@link module:engine/view/position~Position#isBefore is before} start\n     * position of all other ranges (not to confuse with the first range added to the selection).\n     * Returns `null` if no ranges are added to selection.\n     */\n    getFirstRange() {\n        return this._selection.getFirstRange();\n    }\n    /**\n     * Returns copy of the last range in the selection. Last range is the one which {@link module:engine/view/range~Range#end end}\n     * position {@link module:engine/view/position~Position#isAfter is after} end position of all other ranges (not to confuse\n     * with the last range added to the selection). Returns `null` if no ranges are added to selection.\n     */\n    getLastRange() {\n        return this._selection.getLastRange();\n    }\n    /**\n     * Returns copy of the first position in the selection. First position is the position that\n     * {@link module:engine/view/position~Position#isBefore is before} any other position in the selection ranges.\n     * Returns `null` if no ranges are added to selection.\n     */\n    getFirstPosition() {\n        return this._selection.getFirstPosition();\n    }\n    /**\n     * Returns copy of the last position in the selection. Last position is the position that\n     * {@link module:engine/view/position~Position#isAfter is after} any other position in the selection ranges.\n     * Returns `null` if no ranges are added to selection.\n     */\n    getLastPosition() {\n        return this._selection.getLastPosition();\n    }\n    /**\n     * Returns the selected element. {@link module:engine/view/element~Element Element} is considered as selected if there is only\n     * one range in the selection, and that range contains exactly one element.\n     * Returns `null` if there is no selected element.\n     */\n    getSelectedElement() {\n        return this._selection.getSelectedElement();\n    }\n    /**\n     * Checks whether, this selection is equal to given selection. Selections are equal if they have same directions,\n     * same number of ranges and all ranges from one selection equal to a range from other selection.\n     *\n     * @param otherSelection Selection to compare with.\n     * @returns `true` if selections are equal, `false` otherwise.\n     */\n    isEqual(otherSelection) {\n        return this._selection.isEqual(otherSelection);\n    }\n    /**\n     * Checks whether this selection is similar to given selection. Selections are similar if they have same directions, same\n     * number of ranges, and all {@link module:engine/view/range~Range#getTrimmed trimmed} ranges from one selection are\n     * equal to any trimmed range from other selection.\n     *\n     * @param otherSelection Selection to compare with.\n     * @returns `true` if selections are similar, `false` otherwise.\n     */\n    isSimilar(otherSelection) {\n        return this._selection.isSimilar(otherSelection);\n    }\n    /**\n     * Sets this selection's ranges and direction to the specified location based on the given\n     * {@link module:engine/view/selection~Selectable selectable}.\n     *\n     * ```ts\n     * // Sets selection to the given range.\n     * const range = writer.createRange( start, end );\n     * documentSelection._setTo( range );\n     *\n     * // Sets selection to given ranges.\n     * const ranges = [ writer.createRange( start1, end2 ), writer.createRange( start2, end2 ) ];\n     * documentSelection._setTo( range );\n     *\n     * // Sets selection to the other selection.\n     * const otherSelection = writer.createSelection();\n     * documentSelection._setTo( otherSelection );\n     *\n     * // Sets collapsed selection at the given position.\n     * const position = writer.createPositionAt( root, offset );\n     * documentSelection._setTo( position );\n     *\n     * // Sets collapsed selection at the position of given item and offset.\n     * documentSelection._setTo( paragraph, offset );\n     * ```\n     *\n     * Creates a range inside an {@link module:engine/view/element~Element element} which starts before the first child of\n     * that element and ends after the last child of that element.\n     *\n     * ```ts\n     * documentSelection._setTo( paragraph, 'in' );\n     * ```\n     *\n     * Creates a range on an {@link module:engine/view/item~Item item} which starts before the item and ends just after the item.\n     *\n     * ```ts\n     * documentSelection._setTo( paragraph, 'on' );\n     *\n     * // Clears selection. Removes all ranges.\n     * documentSelection._setTo( null );\n     * ```\n     *\n     * `Selection#_setTo()` method allow passing additional options (`backward`, `fake` and `label`) as the last argument.\n     *\n     * ```ts\n     * // Sets selection as backward.\n     * documentSelection._setTo( range, { backward: true } );\n     * ```\n     *\n     * Fake selection does not render as browser native selection over selected elements and is hidden to the user.\n     * This way, no native selection UI artifacts are displayed to the user and selection over elements can be\n     * represented in other way, for example by applying proper CSS class.\n     *\n     * Additionally fake's selection label can be provided. It will be used to des cribe fake selection in DOM\n     * (and be  properly handled by screen readers).\n     *\n     * ```ts\n     * // Creates fake selection with label.\n     * documentSelection._setTo( range, { fake: true, label: 'foo' } );\n     * ```\n     *\n     * @internal\n     * @fires change\n     */\n    _setTo(...args) {\n        this._selection.setTo(...args);\n    }\n    /**\n     * Moves {@link #focus} to the specified location.\n     *\n     * The location can be specified in the same form as {@link module:engine/view/view~View#createPositionAt view.createPositionAt()}\n     * parameters.\n     *\n     * @internal\n     * @fires change\n     * @param offset Offset or one of the flags. Used only when first parameter is a {@link module:engine/view/item~Item view item}.\n     */\n    _setFocus(itemOrPosition, offset) {\n        this._selection.setFocus(itemOrPosition, offset);\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nDocumentSelection.prototype.is = function (type) {\n    return type === 'selection' ||\n        type == 'documentSelection' ||\n        type == 'view:selection' ||\n        type == 'view:documentSelection';\n};\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/selection\n */\nimport TypeCheckable from './typecheckable.js';\nimport Range from './range.js';\nimport Position from './position.js';\nimport Node from './node.js';\nimport DocumentSelection from './documentselection.js';\nimport { CKEditorError, EmitterMixin, count, isIterable } from '@ckeditor/ckeditor5-utils';\n/**\n * Class representing an arbirtary selection in the view.\n * See also {@link module:engine/view/documentselection~DocumentSelection}.\n *\n * New selection instances can be created via the constructor or one these methods:\n *\n * * {@link module:engine/view/view~View#createSelection `View#createSelection()`},\n * * {@link module:engine/view/upcastwriter~UpcastWriter#createSelection `UpcastWriter#createSelection()`}.\n *\n * A selection can consist of {@link module:engine/view/range~Range ranges} that can be set by using\n * the {@link module:engine/view/selection~Selection#setTo `Selection#setTo()`} method.\n */\nexport default class Selection extends EmitterMixin(TypeCheckable) {\n    /**\n     * Creates new selection instance.\n     *\n     * **Note**: The selection constructor is available as a factory method:\n     *\n     * * {@link module:engine/view/view~View#createSelection `View#createSelection()`},\n     * * {@link module:engine/view/upcastwriter~UpcastWriter#createSelection `UpcastWriter#createSelection()`}.\n     *\n     * ```ts\n     * // Creates empty selection without ranges.\n     * const selection = writer.createSelection();\n     *\n     * // Creates selection at the given range.\n     * const range = writer.createRange( start, end );\n     * const selection = writer.createSelection( range );\n     *\n     * // Creates selection at the given ranges\n     * const ranges = [ writer.createRange( start1, end2 ), writer.createRange( star2, end2 ) ];\n     * const selection = writer.createSelection( ranges );\n     *\n     * // Creates selection from the other selection.\n     * const otherSelection = writer.createSelection();\n     * const selection = writer.createSelection( otherSelection );\n     *\n     * // Creates selection from the document selection.\n     * const selection = writer.createSelection( editor.editing.view.document.selection );\n     *\n     * // Creates selection at the given position.\n     * const position = writer.createPositionFromPath( root, path );\n     * const selection = writer.createSelection( position );\n     *\n     * // Creates collapsed selection at the position of given item and offset.\n     * const paragraph = writer.createContainerElement( 'paragraph' );\n     * const selection = writer.createSelection( paragraph, offset );\n     *\n     * // Creates a range inside an {@link module:engine/view/element~Element element} which starts before the\n     * // first child of that element and ends after the last child of that element.\n     * const selection = writer.createSelection( paragraph, 'in' );\n     *\n     * // Creates a range on an {@link module:engine/view/item~Item item} which starts before the item and ends\n     * // just after the item.\n     * const selection = writer.createSelection( paragraph, 'on' );\n     * ```\n     *\n     * `Selection`'s constructor allow passing additional options (`backward`, `fake` and `label`) as the last argument.\n     *\n     * ```ts\n     * // Creates backward selection.\n     * const selection = writer.createSelection( range, { backward: true } );\n     * ```\n     *\n     * Fake selection does not render as browser native selection over selected elements and is hidden to the user.\n     * This way, no native selection UI artifacts are displayed to the user and selection over elements can be\n     * represented in other way, for example by applying proper CSS class.\n     *\n     * Additionally fake's selection label can be provided. It will be used to describe fake selection in DOM\n     * (and be  properly handled by screen readers).\n     *\n     * ```ts\n     * // Creates fake selection with label.\n     * const selection = writer.createSelection( range, { fake: true, label: 'foo' } );\n     * ```\n     *\n     * @internal\n     */\n    constructor(...args) {\n        super();\n        this._ranges = [];\n        this._lastRangeBackward = false;\n        this._isFake = false;\n        this._fakeSelectionLabel = '';\n        if (args.length) {\n            this.setTo(...args);\n        }\n    }\n    /**\n     * Returns true if selection instance is marked as `fake`.\n     *\n     * @see #setTo\n     */\n    get isFake() {\n        return this._isFake;\n    }\n    /**\n     * Returns fake selection label.\n     *\n     * @see #setTo\n     */\n    get fakeSelectionLabel() {\n        return this._fakeSelectionLabel;\n    }\n    /**\n     * Selection anchor. Anchor may be described as a position where the selection starts. Together with\n     * {@link #focus focus} they define the direction of selection, which is important\n     * when expanding/shrinking selection. Anchor is always the start or end of the most recent added range.\n     * It may be a bit unintuitive when there are multiple ranges in selection.\n     *\n     * @see #focus\n     */\n    get anchor() {\n        if (!this._ranges.length) {\n            return null;\n        }\n        const range = this._ranges[this._ranges.length - 1];\n        const anchor = this._lastRangeBackward ? range.end : range.start;\n        return anchor.clone();\n    }\n    /**\n     * Selection focus. Focus is a position where the selection ends.\n     *\n     * @see #anchor\n     */\n    get focus() {\n        if (!this._ranges.length) {\n            return null;\n        }\n        const range = this._ranges[this._ranges.length - 1];\n        const focus = this._lastRangeBackward ? range.start : range.end;\n        return focus.clone();\n    }\n    /**\n     * Returns whether the selection is collapsed. Selection is collapsed when there is exactly one range which is\n     * collapsed.\n     */\n    get isCollapsed() {\n        return this.rangeCount === 1 && this._ranges[0].isCollapsed;\n    }\n    /**\n     * Returns number of ranges in selection.\n     */\n    get rangeCount() {\n        return this._ranges.length;\n    }\n    /**\n     * Specifies whether the {@link #focus} precedes {@link #anchor}.\n     */\n    get isBackward() {\n        return !this.isCollapsed && this._lastRangeBackward;\n    }\n    /**\n     * {@link module:engine/view/editableelement~EditableElement EditableElement} instance that contains this selection, or `null`\n     * if the selection is not inside an editable element.\n     */\n    get editableElement() {\n        if (this.anchor) {\n            return this.anchor.editableElement;\n        }\n        return null;\n    }\n    /**\n     * Returns an iterable that contains copies of all ranges added to the selection.\n     */\n    *getRanges() {\n        for (const range of this._ranges) {\n            yield range.clone();\n        }\n    }\n    /**\n     * Returns copy of the first range in the selection. First range is the one which\n     * {@link module:engine/view/range~Range#start start} position {@link module:engine/view/position~Position#isBefore is before} start\n     * position of all other ranges (not to confuse with the first range added to the selection).\n     * Returns `null` if no ranges are added to selection.\n     */\n    getFirstRange() {\n        let first = null;\n        for (const range of this._ranges) {\n            if (!first || range.start.isBefore(first.start)) {\n                first = range;\n            }\n        }\n        return first ? first.clone() : null;\n    }\n    /**\n     * Returns copy of the last range in the selection. Last range is the one which {@link module:engine/view/range~Range#end end}\n     * position {@link module:engine/view/position~Position#isAfter is after} end position of all other ranges (not to confuse\n     * with the last range added to the selection). Returns `null` if no ranges are added to selection.\n     */\n    getLastRange() {\n        let last = null;\n        for (const range of this._ranges) {\n            if (!last || range.end.isAfter(last.end)) {\n                last = range;\n            }\n        }\n        return last ? last.clone() : null;\n    }\n    /**\n     * Returns copy of the first position in the selection. First position is the position that\n     * {@link module:engine/view/position~Position#isBefore is before} any other position in the selection ranges.\n     * Returns `null` if no ranges are added to selection.\n     */\n    getFirstPosition() {\n        const firstRange = this.getFirstRange();\n        return firstRange ? firstRange.start.clone() : null;\n    }\n    /**\n     * Returns copy of the last position in the selection. Last position is the position that\n     * {@link module:engine/view/position~Position#isAfter is after} any other position in the selection ranges.\n     * Returns `null` if no ranges are added to selection.\n     */\n    getLastPosition() {\n        const lastRange = this.getLastRange();\n        return lastRange ? lastRange.end.clone() : null;\n    }\n    /**\n     * Checks whether, this selection is equal to given selection. Selections are equal if they have same directions,\n     * same number of ranges and all ranges from one selection equal to a range from other selection.\n     *\n     * @param otherSelection Selection to compare with.\n     * @returns `true` if selections are equal, `false` otherwise.\n     */\n    isEqual(otherSelection) {\n        if (this.isFake != otherSelection.isFake) {\n            return false;\n        }\n        if (this.isFake && this.fakeSelectionLabel != otherSelection.fakeSelectionLabel) {\n            return false;\n        }\n        if (this.rangeCount != otherSelection.rangeCount) {\n            return false;\n        }\n        else if (this.rangeCount === 0) {\n            return true;\n        }\n        if (!this.anchor.isEqual(otherSelection.anchor) || !this.focus.isEqual(otherSelection.focus)) {\n            return false;\n        }\n        for (const thisRange of this._ranges) {\n            let found = false;\n            for (const otherRange of otherSelection._ranges) {\n                if (thisRange.isEqual(otherRange)) {\n                    found = true;\n                    break;\n                }\n            }\n            if (!found) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Checks whether this selection is similar to given selection. Selections are similar if they have same directions, same\n     * number of ranges, and all {@link module:engine/view/range~Range#getTrimmed trimmed} ranges from one selection are\n     * equal to any trimmed range from other selection.\n     *\n     * @param otherSelection Selection to compare with.\n     * @returns `true` if selections are similar, `false` otherwise.\n     */\n    isSimilar(otherSelection) {\n        if (this.isBackward != otherSelection.isBackward) {\n            return false;\n        }\n        const numOfRangesA = count(this.getRanges());\n        const numOfRangesB = count(otherSelection.getRanges());\n        // If selections have different number of ranges, they cannot be similar.\n        if (numOfRangesA != numOfRangesB) {\n            return false;\n        }\n        // If both selections have no ranges, they are similar.\n        if (numOfRangesA == 0) {\n            return true;\n        }\n        // Check if each range in one selection has a similar range in other selection.\n        for (let rangeA of this.getRanges()) {\n            rangeA = rangeA.getTrimmed();\n            let found = false;\n            for (let rangeB of otherSelection.getRanges()) {\n                rangeB = rangeB.getTrimmed();\n                if (rangeA.start.isEqual(rangeB.start) && rangeA.end.isEqual(rangeB.end)) {\n                    found = true;\n                    break;\n                }\n            }\n            // For `rangeA`, neither range in `otherSelection` was similar. So selections are not similar.\n            if (!found) {\n                return false;\n            }\n        }\n        // There were no ranges that weren't matched. Selections are similar.\n        return true;\n    }\n    /**\n     * Returns the selected element. {@link module:engine/view/element~Element Element} is considered as selected if there is only\n     * one range in the selection, and that range contains exactly one element.\n     * Returns `null` if there is no selected element.\n     */\n    getSelectedElement() {\n        if (this.rangeCount !== 1) {\n            return null;\n        }\n        return this.getFirstRange().getContainedElement();\n    }\n    /**\n     * Sets this selection's ranges and direction to the specified location based on the given\n     * {@link module:engine/view/selection~Selectable selectable}.\n     *\n     * ```ts\n     * // Sets selection to the given range.\n     * const range = writer.createRange( start, end );\n     * selection.setTo( range );\n     *\n     * // Sets selection to given ranges.\n     * const ranges = [ writer.createRange( start1, end2 ), writer.createRange( star2, end2 ) ];\n     * selection.setTo( range );\n     *\n     * // Sets selection to the other selection.\n     * const otherSelection = writer.createSelection();\n     * selection.setTo( otherSelection );\n     *\n     * // Sets selection to contents of DocumentSelection.\n     * selection.setTo( editor.editing.view.document.selection );\n     *\n     * // Sets collapsed selection at the given position.\n     * const position = writer.createPositionAt( root, path );\n     * selection.setTo( position );\n     *\n     * // Sets collapsed selection at the position of given item and offset.\n     * selection.setTo( paragraph, offset );\n     * ```\n     *\n     * Creates a range inside an {@link module:engine/view/element~Element element} which starts before the first child of\n     * that element and ends after the last child of that element.\n     *\n     * ```ts\n     * selection.setTo( paragraph, 'in' );\n     * ```\n     *\n     * Creates a range on an {@link module:engine/view/item~Item item} which starts before the item and ends just after the item.\n     *\n     * ```ts\n     * selection.setTo( paragraph, 'on' );\n     *\n     * // Clears selection. Removes all ranges.\n     * selection.setTo( null );\n     * ```\n     *\n     * `Selection#setTo()` method allow passing additional options (`backward`, `fake` and `label`) as the last argument.\n     *\n     * ```ts\n     * // Sets selection as backward.\n     * selection.setTo( range, { backward: true } );\n     * ```\n     *\n     * Fake selection does not render as browser native selection over selected elements and is hidden to the user.\n     * This way, no native selection UI artifacts are displayed to the user and selection over elements can be\n     * represented in other way, for example by applying proper CSS class.\n     *\n     * Additionally fake's selection label can be provided. It will be used to describe fake selection in DOM\n     * (and be  properly handled by screen readers).\n     *\n     * ```ts\n     * // Creates fake selection with label.\n     * selection.setTo( range, { fake: true, label: 'foo' } );\n     * ```\n     *\n     * @fires change\n     */\n    setTo(...args) {\n        let [selectable, placeOrOffset, options] = args;\n        if (typeof placeOrOffset == 'object') {\n            options = placeOrOffset;\n            placeOrOffset = undefined;\n        }\n        if (selectable === null) {\n            this._setRanges([]);\n            this._setFakeOptions(options);\n        }\n        else if (selectable instanceof Selection || selectable instanceof DocumentSelection) {\n            this._setRanges(selectable.getRanges(), selectable.isBackward);\n            this._setFakeOptions({ fake: selectable.isFake, label: selectable.fakeSelectionLabel });\n        }\n        else if (selectable instanceof Range) {\n            this._setRanges([selectable], options && options.backward);\n            this._setFakeOptions(options);\n        }\n        else if (selectable instanceof Position) {\n            this._setRanges([new Range(selectable)]);\n            this._setFakeOptions(options);\n        }\n        else if (selectable instanceof Node) {\n            const backward = !!options && !!options.backward;\n            let range;\n            if (placeOrOffset === undefined) {\n                /**\n                 * selection.setTo requires the second parameter when the first parameter is a node.\n                 *\n                 * @error view-selection-setto-required-second-parameter\n                 */\n                throw new CKEditorError('view-selection-setto-required-second-parameter', this);\n            }\n            else if (placeOrOffset == 'in') {\n                range = Range._createIn(selectable);\n            }\n            else if (placeOrOffset == 'on') {\n                range = Range._createOn(selectable);\n            }\n            else {\n                range = new Range(Position._createAt(selectable, placeOrOffset));\n            }\n            this._setRanges([range], backward);\n            this._setFakeOptions(options);\n        }\n        else if (isIterable(selectable)) {\n            // We assume that the selectable is an iterable of ranges.\n            // Array.from() is used to prevent setting ranges to the old iterable\n            this._setRanges(selectable, options && options.backward);\n            this._setFakeOptions(options);\n        }\n        else {\n            /**\n             * Cannot set selection to given place.\n             *\n             * @error view-selection-setto-not-selectable\n             */\n            throw new CKEditorError('view-selection-setto-not-selectable', this);\n        }\n        this.fire('change');\n    }\n    /**\n     * Moves {@link #focus} to the specified location.\n     *\n     * The location can be specified in the same form as {@link module:engine/view/view~View#createPositionAt view.createPositionAt()}\n     * parameters.\n     *\n     * @fires change\n     * @param offset Offset or one of the flags. Used only when first parameter is a {@link module:engine/view/item~Item view item}.\n     */\n    setFocus(itemOrPosition, offset) {\n        if (this.anchor === null) {\n            /**\n             * Cannot set selection focus if there are no ranges in selection.\n             *\n             * @error view-selection-setfocus-no-ranges\n             */\n            throw new CKEditorError('view-selection-setfocus-no-ranges', this);\n        }\n        const newFocus = Position._createAt(itemOrPosition, offset);\n        if (newFocus.compareWith(this.focus) == 'same') {\n            return;\n        }\n        const anchor = this.anchor;\n        this._ranges.pop();\n        if (newFocus.compareWith(anchor) == 'before') {\n            this._addRange(new Range(newFocus, anchor), true);\n        }\n        else {\n            this._addRange(new Range(anchor, newFocus));\n        }\n        this.fire('change');\n    }\n    /**\n     * Replaces all ranges that were added to the selection with given array of ranges. Last range of the array\n     * is treated like the last added range and is used to set {@link #anchor anchor} and {@link #focus focus}.\n     * Accepts a flag describing in which way the selection is made.\n     *\n     * @param newRanges Iterable object of ranges to set.\n     * @param isLastBackward Flag describing if last added range was selected forward - from start to end\n     * (`false`) or backward - from end to start (`true`). Defaults to `false`.\n     */\n    _setRanges(newRanges, isLastBackward = false) {\n        // New ranges should be copied to prevent removing them by setting them to `[]` first.\n        // Only applies to situations when selection is set to the same selection or same selection's ranges.\n        newRanges = Array.from(newRanges);\n        this._ranges = [];\n        for (const range of newRanges) {\n            this._addRange(range);\n        }\n        this._lastRangeBackward = !!isLastBackward;\n    }\n    /**\n     * Sets this selection instance to be marked as `fake`. A fake selection does not render as browser native selection\n     * over selected elements and is hidden to the user. This way, no native selection UI artifacts are displayed to\n     * the user and selection over elements can be represented in other way, for example by applying proper CSS class.\n     *\n     * Additionally fake's selection label can be provided. It will be used to describe fake selection in DOM (and be\n     * properly handled by screen readers).\n     */\n    _setFakeOptions(options = {}) {\n        this._isFake = !!options.fake;\n        this._fakeSelectionLabel = options.fake ? options.label || '' : '';\n    }\n    /**\n     * Adds a range to the selection. Added range is copied. This means that passed range is not saved in the\n     * selection instance and you can safely operate on it.\n     *\n     * Accepts a flag describing in which way the selection is made - passed range might be selected from\n     * {@link module:engine/view/range~Range#start start} to {@link module:engine/view/range~Range#end end}\n     * or from {@link module:engine/view/range~Range#end end} to {@link module:engine/view/range~Range#start start}.\n     * The flag is used to set {@link #anchor anchor} and {@link #focus focus} properties.\n     *\n     * Throws {@link module:utils/ckeditorerror~CKEditorError CKEditorError} `view-selection-range-intersects` if added range intersects\n     * with ranges already stored in Selection instance.\n     */\n    _addRange(range, isBackward = false) {\n        if (!(range instanceof Range)) {\n            /**\n             * Selection range set to an object that is not an instance of {@link module:engine/view/range~Range}.\n             *\n             * @error view-selection-add-range-not-range\n             */\n            throw new CKEditorError('view-selection-add-range-not-range', this);\n        }\n        this._pushRange(range);\n        this._lastRangeBackward = !!isBackward;\n    }\n    /**\n     * Adds range to selection - creates copy of given range so it can be safely used and modified.\n     *\n     * Throws {@link module:utils/ckeditorerror~CKEditorError CKEditorError} `view-selection-range-intersects` if added range intersects\n     * with ranges already stored in selection instance.\n     */\n    _pushRange(range) {\n        for (const storedRange of this._ranges) {\n            if (range.isIntersecting(storedRange)) {\n                /**\n                 * Trying to add a range that intersects with another range from selection.\n                 *\n                 * @error view-selection-range-intersects\n                 * @param {module:engine/view/range~Range} addedRange Range that was added to the selection.\n                 * @param {module:engine/view/range~Range} intersectingRange Range from selection that intersects with `addedRange`.\n                 */\n                throw new CKEditorError('view-selection-range-intersects', this, { addedRange: range, intersectingRange: storedRange });\n            }\n        }\n        this._ranges.push(new Range(range.start, range.end));\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nSelection.prototype.is = function (type) {\n    return type === 'selection' || type === 'view:selection';\n};\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/documentfragment\n */\nimport TypeCheckable from './typecheckable.js';\nimport Text from './text.js';\nimport TextProxy from './textproxy.js';\nimport { EmitterMixin, isIterable } from '@ckeditor/ckeditor5-utils';\n/**\n * Document fragment.\n *\n * To create a new document fragment instance use the\n * {@link module:engine/view/upcastwriter~UpcastWriter#createDocumentFragment `UpcastWriter#createDocumentFragment()`}\n * method.\n */\nexport default class DocumentFragment extends EmitterMixin(TypeCheckable) {\n    /**\n     * Creates new DocumentFragment instance.\n     *\n     * @internal\n     * @param document The document to which this document fragment belongs.\n     * @param children A list of nodes to be inserted into the created document fragment.\n     */\n    constructor(document, children) {\n        super();\n        /**\n         * Array of child nodes.\n         */\n        this._children = [];\n        /**\n         * Map of custom properties.\n         * Custom properties can be added to document fragment instance.\n         */\n        this._customProperties = new Map();\n        this.document = document;\n        if (children) {\n            this._insertChild(0, children);\n        }\n    }\n    /**\n     * Iterable interface.\n     *\n     * Iterates over nodes added to this document fragment.\n     */\n    [Symbol.iterator]() {\n        return this._children[Symbol.iterator]();\n    }\n    /**\n     * Number of child nodes in this document fragment.\n     */\n    get childCount() {\n        return this._children.length;\n    }\n    /**\n     * Is `true` if there are no nodes inside this document fragment, `false` otherwise.\n     */\n    get isEmpty() {\n        return this.childCount === 0;\n    }\n    /**\n     * Artificial root of `DocumentFragment`. Returns itself. Added for compatibility reasons.\n     */\n    get root() {\n        return this;\n    }\n    /**\n     * Artificial parent of `DocumentFragment`. Returns `null`. Added for compatibility reasons.\n     */\n    get parent() {\n        return null;\n    }\n    /**\n     * Artificial element name. Returns `undefined`. Added for compatibility reasons.\n     */\n    get name() {\n        return undefined;\n    }\n    /**\n     * Artificial element getFillerOffset. Returns `undefined`. Added for compatibility reasons.\n     */\n    get getFillerOffset() {\n        return undefined;\n    }\n    /**\n     * Returns the custom property value for the given key.\n     */\n    getCustomProperty(key) {\n        return this._customProperties.get(key);\n    }\n    /**\n     * Returns an iterator which iterates over this document fragment's custom properties.\n     * Iterator provides `[ key, value ]` pairs for each stored property.\n     */\n    *getCustomProperties() {\n        yield* this._customProperties.entries();\n    }\n    /**\n     * {@link module:engine/view/documentfragment~DocumentFragment#_insertChild Insert} a child node or a list of child nodes at the end\n     * and sets the parent of these nodes to this fragment.\n     *\n     * @internal\n     * @param items Items to be inserted.\n     * @returns Number of appended nodes.\n     */\n    _appendChild(items) {\n        return this._insertChild(this.childCount, items);\n    }\n    /**\n     * Gets child at the given index.\n     *\n     * @param index Index of child.\n     * @returns Child node.\n     */\n    getChild(index) {\n        return this._children[index];\n    }\n    /**\n     * Gets index of the given child node. Returns `-1` if child node is not found.\n     *\n     * @param node Child node.\n     * @returns Index of the child node.\n     */\n    getChildIndex(node) {\n        return this._children.indexOf(node);\n    }\n    /**\n     * Gets child nodes iterator.\n     *\n     * @returns Child nodes iterator.\n     */\n    getChildren() {\n        return this._children[Symbol.iterator]();\n    }\n    /**\n     * Inserts a child node or a list of child nodes on the given index and sets the parent of these nodes to\n     * this fragment.\n     *\n     * @internal\n     * @param index Position where nodes should be inserted.\n     * @param items Items to be inserted.\n     * @returns Number of inserted nodes.\n     */\n    _insertChild(index, items) {\n        this._fireChange('children', this);\n        let count = 0;\n        const nodes = normalize(this.document, items);\n        for (const node of nodes) {\n            // If node that is being added to this element is already inside another element, first remove it from the old parent.\n            if (node.parent !== null) {\n                node._remove();\n            }\n            node.parent = this;\n            this._children.splice(index, 0, node);\n            index++;\n            count++;\n        }\n        return count;\n    }\n    /**\n     * Removes number of child nodes starting at the given index and set the parent of these nodes to `null`.\n     *\n     * @internal\n     * @param index Number of the first node to remove.\n     * @param howMany Number of nodes to remove.\n     * @returns The array of removed nodes.\n     */\n    _removeChildren(index, howMany = 1) {\n        this._fireChange('children', this);\n        for (let i = index; i < index + howMany; i++) {\n            this._children[i].parent = null;\n        }\n        return this._children.splice(index, howMany);\n    }\n    /**\n     * Fires `change` event with given type of the change.\n     *\n     * @internal\n     * @param type Type of the change.\n     * @param node Changed node.\n     */\n    _fireChange(type, node) {\n        this.fire('change:' + type, node);\n    }\n    /**\n     * Sets a custom property. They can be used to add special data to elements.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#setCustomProperty\n     * @internal\n     */\n    _setCustomProperty(key, value) {\n        this._customProperties.set(key, value);\n    }\n    /**\n     * Removes the custom property stored under the given key.\n     *\n     * @see module:engine/view/downcastwriter~DowncastWriter#removeCustomProperty\n     * @internal\n     * @returns Returns true if property was removed.\n     */\n    _removeCustomProperty(key) {\n        return this._customProperties.delete(key);\n    }\n}\n// The magic of type inference using `is` method is centralized in `TypeCheckable` class.\n// Proper overload would interfere with that.\nDocumentFragment.prototype.is = function (type) {\n    return type === 'documentFragment' || type === 'view:documentFragment';\n};\n/**\n * Converts strings to Text and non-iterables to arrays.\n */\nfunction normalize(document, nodes) {\n    // Separate condition because string is iterable.\n    if (typeof nodes == 'string') {\n        return [new Text(document, nodes)];\n    }\n    if (!isIterable(nodes)) {\n        nodes = [nodes];\n    }\n    // Array.from to enable .map() on non-arrays.\n    return Array.from(nodes)\n        .map(node => {\n        if (typeof node == 'string') {\n            return new Text(document, node);\n        }\n        if (node instanceof TextProxy) {\n            return new Text(document, node.data);\n        }\n        return node;\n    });\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\nimport { keyCodes, isText } from '@ckeditor/ckeditor5-utils';\n/**\n * Set of utilities related to handling block and inline fillers.\n *\n * Browsers do not allow to put caret in elements which does not have height. Because of it, we need to fill all\n * empty elements which should be selectable with elements or characters called \"fillers\". Unfortunately there is no one\n * universal filler, this is why two types are uses:\n *\n * * Block filler is an element which fill block elements, like `<p>`. CKEditor uses `<br>` as a block filler during the editing,\n * as browsers do natively. So instead of an empty `<p>` there will be `<p><br></p>`. The advantage of block filler is that\n * it is transparent for the selection, so when the caret is before the `<br>` and user presses right arrow he will be\n * moved to the next paragraph, not after the `<br>`. The disadvantage is that it breaks a block, so it can not be used\n * in the middle of a line of text. The {@link module:engine/view/filler~BR_FILLER `<br>` filler} can be replaced with any other\n * character in the data output, for instance {@link module:engine/view/filler~NBSP_FILLER non-breaking space} or\n * {@link module:engine/view/filler~MARKED_NBSP_FILLER marked non-breaking space}.\n *\n * * Inline filler is a filler which does not break a line of text, so it can be used inside the text, for instance in the empty\n * `<b>` surrendered by text: `foo<b></b>bar`, if we want to put the caret there. CKEditor uses a sequence of the zero-width\n * spaces as an {@link module:engine/view/filler~INLINE_FILLER inline filler} having the predetermined\n * {@link module:engine/view/filler~INLINE_FILLER_LENGTH length}. A sequence is used, instead of a single character to\n * avoid treating random zero-width spaces as the inline filler. Disadvantage of the inline filler is that it is not\n * transparent for the selection. The arrow key moves the caret between zero-width spaces characters, so the additional\n * code is needed to handle the caret.\n *\n * Both inline and block fillers are handled by the {@link module:engine/view/renderer~Renderer renderer} and are not present in the\n * view.\n *\n * @module engine/view/filler\n */\n/**\n * Non-breaking space filler creator. This function creates the `&nbsp;` text node.\n * It defines how the filler is created.\n *\n * @see module:engine/view/filler~MARKED_NBSP_FILLER\n * @see module:engine/view/filler~BR_FILLER\n */\nexport const NBSP_FILLER = (domDocument) => domDocument.createTextNode('\\u00A0');\n/**\n * Marked non-breaking space filler creator. This function creates the `<span data-cke-filler=\"true\">&nbsp;</span>` element.\n * It defines how the filler is created.\n *\n * @see module:engine/view/filler~NBSP_FILLER\n * @see module:engine/view/filler~BR_FILLER\n */\nexport const MARKED_NBSP_FILLER = (domDocument) => {\n    const span = domDocument.createElement('span');\n    span.dataset.ckeFiller = 'true';\n    span.innerText = '\\u00A0';\n    return span;\n};\n/**\n * `<br>` filler creator. This function creates the `<br data-cke-filler=\"true\">` element.\n * It defines how the filler is created.\n *\n * @see module:engine/view/filler~NBSP_FILLER\n * @see module:engine/view/filler~MARKED_NBSP_FILLER\n */\nexport const BR_FILLER = (domDocument) => {\n    const fillerBr = domDocument.createElement('br');\n    fillerBr.dataset.ckeFiller = 'true';\n    return fillerBr;\n};\n/**\n * Length of the {@link module:engine/view/filler~INLINE_FILLER INLINE_FILLER}.\n */\nexport const INLINE_FILLER_LENGTH = 7;\n/**\n * Inline filler which is a sequence of the word joiners.\n */\nexport const INLINE_FILLER = '\\u2060'.repeat(INLINE_FILLER_LENGTH);\n/**\n * Checks if the node is a text node which starts with the {@link module:engine/view/filler~INLINE_FILLER inline filler}.\n *\n * ```ts\n * startsWithFiller( document.createTextNode( INLINE_FILLER ) ); // true\n * startsWithFiller( document.createTextNode( INLINE_FILLER + 'foo' ) ); // true\n * startsWithFiller( document.createTextNode( 'foo' ) ); // false\n * startsWithFiller( document.createElement( 'p' ) ); // false\n * ```\n *\n * @param domNode DOM node.\n * @returns True if the text node starts with the {@link module:engine/view/filler~INLINE_FILLER inline filler}.\n */\nexport function startsWithFiller(domNode) {\n    if (typeof domNode == 'string') {\n        return domNode.substr(0, INLINE_FILLER_LENGTH) === INLINE_FILLER;\n    }\n    return isText(domNode) && (domNode.data.substr(0, INLINE_FILLER_LENGTH) === INLINE_FILLER);\n}\n/**\n * Checks if the text node contains only the {@link module:engine/view/filler~INLINE_FILLER inline filler}.\n *\n * ```ts\n * isInlineFiller( document.createTextNode( INLINE_FILLER ) ); // true\n * isInlineFiller( document.createTextNode( INLINE_FILLER + 'foo' ) ); // false\n * ```\n *\n * @param domText DOM text node.\n * @returns True if the text node contains only the {@link module:engine/view/filler~INLINE_FILLER inline filler}.\n */\nexport function isInlineFiller(domText) {\n    return domText.data.length == INLINE_FILLER_LENGTH && startsWithFiller(domText);\n}\n/**\n * Get string data from the text node, removing an {@link module:engine/view/filler~INLINE_FILLER inline filler} from it,\n * if text node contains it.\n *\n * ```ts\n * getDataWithoutFiller( document.createTextNode( INLINE_FILLER + 'foo' ) ) == 'foo' // true\n * getDataWithoutFiller( document.createTextNode( 'foo' ) ) == 'foo' // true\n * ```\n *\n * @param domText DOM text node, possible with inline filler.\n * @returns Data without filler.\n */\nexport function getDataWithoutFiller(domText) {\n    const data = typeof domText == 'string' ? domText : domText.data;\n    if (startsWithFiller(domText)) {\n        return data.slice(INLINE_FILLER_LENGTH);\n    }\n    return data;\n}\n/**\n * Assign key observer which move cursor from the end of the inline filler to the beginning of it when\n * the left arrow is pressed, so the filler does not break navigation.\n *\n * @param view View controller instance we should inject quirks handling on.\n */\nexport function injectQuirksHandling(view) {\n    view.document.on('arrowKey', jumpOverInlineFiller, { priority: 'low' });\n}\n/**\n * Move cursor from the end of the inline filler to the beginning of it when, so the filler does not break navigation.\n */\nfunction jumpOverInlineFiller(evt, data) {\n    if (data.keyCode == keyCodes.arrowleft) {\n        const domSelection = data.domTarget.ownerDocument.defaultView.getSelection();\n        if (domSelection.rangeCount == 1 && domSelection.getRangeAt(0).collapsed) {\n            const domParent = domSelection.getRangeAt(0).startContainer;\n            const domOffset = domSelection.getRangeAt(0).startOffset;\n            if (startsWithFiller(domParent) && domOffset <= INLINE_FILLER_LENGTH) {\n                domSelection.collapse(domParent, 0);\n            }\n        }\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/domconverter\n */\n/* globals Node, NodeFilter, DOMParser */\nimport ViewText from './text.js';\nimport ViewElement from './element.js';\nimport ViewUIElement from './uielement.js';\nimport ViewPosition from './position.js';\nimport ViewRange from './range.js';\nimport ViewSelection from './selection.js';\nimport ViewDocumentFragment from './documentfragment.js';\nimport ViewTreeWalker from './treewalker.js';\nimport { default as Matcher } from './matcher.js';\nimport { BR_FILLER, INLINE_FILLER_LENGTH, NBSP_FILLER, MARKED_NBSP_FILLER, getDataWithoutFiller, isInlineFiller, startsWithFiller } from './filler.js';\nimport { global, logWarning, indexOf, getAncestors, isText, isComment, isValidAttributeName, first, env } from '@ckeditor/ckeditor5-utils';\nconst BR_FILLER_REF = BR_FILLER(global.document); // eslint-disable-line new-cap\nconst NBSP_FILLER_REF = NBSP_FILLER(global.document); // eslint-disable-line new-cap\nconst MARKED_NBSP_FILLER_REF = MARKED_NBSP_FILLER(global.document); // eslint-disable-line new-cap\nconst UNSAFE_ATTRIBUTE_NAME_PREFIX = 'data-ck-unsafe-attribute-';\nconst UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE = 'data-ck-unsafe-element';\n/**\n * `DomConverter` is a set of tools to do transformations between DOM nodes and view nodes. It also handles\n * {@link module:engine/view/domconverter~DomConverter#bindElements bindings} between these nodes.\n *\n * An instance of the DOM converter is available under\n * {@link module:engine/view/view~View#domConverter `editor.editing.view.domConverter`}.\n *\n * The DOM converter does not check which nodes should be rendered (use {@link module:engine/view/renderer~Renderer}), does not keep the\n * state of a tree nor keeps the synchronization between the tree view and the DOM tree (use {@link module:engine/view/document~Document}).\n *\n * The DOM converter keeps DOM elements to view element bindings, so when the converter gets destroyed, the bindings are lost.\n * Two converters will keep separate binding maps, so one tree view can be bound with two DOM trees.\n */\nexport default class DomConverter {\n    /**\n     * Creates a DOM converter.\n     *\n     * @param document The view document instance.\n     * @param options An object with configuration options.\n     * @param options.blockFillerMode The type of the block filler to use.\n     * Default value depends on the options.renderingMode:\n     *  'nbsp' when options.renderingMode == 'data',\n     *  'br' when options.renderingMode == 'editing'.\n     * @param options.renderingMode Whether to leave the View-to-DOM conversion result unchanged\n     * or improve editing experience by filtering out interactive data.\n     */\n    constructor(document, { blockFillerMode, renderingMode = 'editing' } = {}) {\n        /**\n         * The DOM-to-view mapping.\n         */\n        this._domToViewMapping = new WeakMap();\n        /**\n         * The view-to-DOM mapping.\n         */\n        this._viewToDomMapping = new WeakMap();\n        /**\n         * Holds the mapping between fake selection containers and corresponding view selections.\n         */\n        this._fakeSelectionMapping = new WeakMap();\n        /**\n         * Matcher for view elements whose content should be treated as raw data\n         * and not processed during the conversion from DOM nodes to view elements.\n         */\n        this._rawContentElementMatcher = new Matcher();\n        /**\n         * Matcher for inline object view elements. This is an extension of a simple {@link #inlineObjectElements} array of element names.\n         */\n        this._inlineObjectElementMatcher = new Matcher();\n        /**\n         * Set of elements with temporary custom properties that require clearing after render.\n         */\n        this._elementsWithTemporaryCustomProperties = new Set();\n        this.document = document;\n        this.renderingMode = renderingMode;\n        this.blockFillerMode = blockFillerMode || (renderingMode === 'editing' ? 'br' : 'nbsp');\n        this.preElements = ['pre'];\n        this.blockElements = [\n            'address', 'article', 'aside', 'blockquote', 'caption', 'center', 'dd', 'details', 'dir', 'div',\n            'dl', 'dt', 'fieldset', 'figcaption', 'figure', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'header',\n            'hgroup', 'legend', 'li', 'main', 'menu', 'nav', 'ol', 'p', 'pre', 'section', 'summary', 'table', 'tbody',\n            'td', 'tfoot', 'th', 'thead', 'tr', 'ul'\n        ];\n        this.inlineObjectElements = [\n            'object', 'iframe', 'input', 'button', 'textarea', 'select', 'option', 'video', 'embed', 'audio', 'img', 'canvas'\n        ];\n        this.unsafeElements = ['script', 'style'];\n        this._domDocument = this.renderingMode === 'editing' ? global.document : global.document.implementation.createHTMLDocument('');\n    }\n    /**\n     * Binds a given DOM element that represents fake selection to a **position** of a\n     * {@link module:engine/view/documentselection~DocumentSelection document selection}.\n     * Document selection copy is stored and can be retrieved by the\n     * {@link module:engine/view/domconverter~DomConverter#fakeSelectionToView} method.\n     */\n    bindFakeSelection(domElement, viewDocumentSelection) {\n        this._fakeSelectionMapping.set(domElement, new ViewSelection(viewDocumentSelection));\n    }\n    /**\n     * Returns a {@link module:engine/view/selection~Selection view selection} instance corresponding to a given\n     * DOM element that represents fake selection. Returns `undefined` if binding to the given DOM element does not exist.\n     */\n    fakeSelectionToView(domElement) {\n        return this._fakeSelectionMapping.get(domElement);\n    }\n    /**\n     * Binds DOM and view elements, so it will be possible to get corresponding elements using\n     * {@link module:engine/view/domconverter~DomConverter#mapDomToView} and\n     * {@link module:engine/view/domconverter~DomConverter#mapViewToDom}.\n     *\n     * @param domElement The DOM element to bind.\n     * @param viewElement The view element to bind.\n     */\n    bindElements(domElement, viewElement) {\n        this._domToViewMapping.set(domElement, viewElement);\n        this._viewToDomMapping.set(viewElement, domElement);\n    }\n    /**\n     * Unbinds a given DOM element from the view element it was bound to. Unbinding is deep, meaning that all children of\n     * the DOM element will be unbound too.\n     *\n     * @param domElement The DOM element to unbind.\n     */\n    unbindDomElement(domElement) {\n        const viewElement = this._domToViewMapping.get(domElement);\n        if (viewElement) {\n            this._domToViewMapping.delete(domElement);\n            this._viewToDomMapping.delete(viewElement);\n            for (const child of Array.from(domElement.children)) {\n                this.unbindDomElement(child);\n            }\n        }\n    }\n    /**\n     * Binds DOM and view document fragments, so it will be possible to get corresponding document fragments using\n     * {@link module:engine/view/domconverter~DomConverter#mapDomToView} and\n     * {@link module:engine/view/domconverter~DomConverter#mapViewToDom}.\n     *\n     * @param domFragment The DOM document fragment to bind.\n     * @param viewFragment The view document fragment to bind.\n     */\n    bindDocumentFragments(domFragment, viewFragment) {\n        this._domToViewMapping.set(domFragment, viewFragment);\n        this._viewToDomMapping.set(viewFragment, domFragment);\n    }\n    /**\n     * Decides whether a given pair of attribute key and value should be passed further down the pipeline.\n     *\n     * @param elementName Element name in lower case.\n     */\n    shouldRenderAttribute(attributeKey, attributeValue, elementName) {\n        if (this.renderingMode === 'data') {\n            return true;\n        }\n        attributeKey = attributeKey.toLowerCase();\n        if (attributeKey.startsWith('on')) {\n            return false;\n        }\n        if (attributeKey === 'srcdoc' &&\n            attributeValue.match(/\\bon\\S+\\s*=|javascript:|<\\s*\\/*script/i)) {\n            return false;\n        }\n        if (elementName === 'img' &&\n            (attributeKey === 'src' || attributeKey === 'srcset')) {\n            return true;\n        }\n        if (elementName === 'source' && attributeKey === 'srcset') {\n            return true;\n        }\n        if (attributeValue.match(/^\\s*(javascript:|data:(image\\/svg|text\\/x?html))/i)) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Set `domElement`'s content using provided `html` argument. Apply necessary filtering for the editing pipeline.\n     *\n     * @param domElement DOM element that should have `html` set as its content.\n     * @param html Textual representation of the HTML that will be set on `domElement`.\n     */\n    setContentOf(domElement, html) {\n        // For data pipeline we pass the HTML as-is.\n        if (this.renderingMode === 'data') {\n            domElement.innerHTML = html;\n            return;\n        }\n        const document = new DOMParser().parseFromString(html, 'text/html');\n        const fragment = document.createDocumentFragment();\n        const bodyChildNodes = document.body.childNodes;\n        while (bodyChildNodes.length > 0) {\n            fragment.appendChild(bodyChildNodes[0]);\n        }\n        const treeWalker = document.createTreeWalker(fragment, NodeFilter.SHOW_ELEMENT);\n        const nodes = [];\n        let currentNode;\n        // eslint-disable-next-line no-cond-assign\n        while (currentNode = treeWalker.nextNode()) {\n            nodes.push(currentNode);\n        }\n        for (const currentNode of nodes) {\n            // Go through nodes to remove those that are prohibited in editing pipeline.\n            for (const attributeName of currentNode.getAttributeNames()) {\n                this.setDomElementAttribute(currentNode, attributeName, currentNode.getAttribute(attributeName));\n            }\n            const elementName = currentNode.tagName.toLowerCase();\n            // There are certain nodes, that should be renamed to <span> in editing pipeline.\n            if (this._shouldRenameElement(elementName)) {\n                _logUnsafeElement(elementName);\n                currentNode.replaceWith(this._createReplacementDomElement(elementName, currentNode));\n            }\n        }\n        // Empty the target element.\n        while (domElement.firstChild) {\n            domElement.firstChild.remove();\n        }\n        domElement.append(fragment);\n    }\n    /**\n     * Converts the view to the DOM. For all text nodes, not bound elements and document fragments new items will\n     * be created. For bound elements and document fragments the method will return corresponding items.\n     *\n     * @param viewNode View node or document fragment to transform.\n     * @param options Conversion options.\n     * @param options.bind Determines whether new elements will be bound.\n     * @param options.withChildren If `false`, node's and document fragment's children will not be converted.\n     * @returns Converted node or DocumentFragment.\n     */\n    viewToDom(viewNode, options = {}) {\n        if (viewNode.is('$text')) {\n            const textData = this._processDataFromViewText(viewNode);\n            return this._domDocument.createTextNode(textData);\n        }\n        else {\n            const viewElementOrFragment = viewNode;\n            if (this.mapViewToDom(viewElementOrFragment)) {\n                // Do not reuse element that is marked to not reuse (for example an IMG element\n                // so it can immediately display a placeholder background instead of waiting for the new src to load).\n                if (viewElementOrFragment.getCustomProperty('editingPipeline:doNotReuseOnce')) {\n                    this._elementsWithTemporaryCustomProperties.add(viewElementOrFragment);\n                }\n                else {\n                    return this.mapViewToDom(viewElementOrFragment);\n                }\n            }\n            let domElement;\n            if (viewElementOrFragment.is('documentFragment')) {\n                // Create DOM document fragment.\n                domElement = this._domDocument.createDocumentFragment();\n                if (options.bind) {\n                    this.bindDocumentFragments(domElement, viewElementOrFragment);\n                }\n            }\n            else if (viewElementOrFragment.is('uiElement')) {\n                if (viewElementOrFragment.name === '$comment') {\n                    domElement = this._domDocument.createComment(viewElementOrFragment.getCustomProperty('$rawContent'));\n                }\n                else {\n                    // UIElement has its own render() method (see #799).\n                    domElement = viewElementOrFragment.render(this._domDocument, this);\n                }\n                if (options.bind) {\n                    this.bindElements(domElement, viewElementOrFragment);\n                }\n                return domElement;\n            }\n            else {\n                // Create DOM element.\n                if (this._shouldRenameElement(viewElementOrFragment.name)) {\n                    _logUnsafeElement(viewElementOrFragment.name);\n                    domElement = this._createReplacementDomElement(viewElementOrFragment.name);\n                }\n                else if (viewElementOrFragment.hasAttribute('xmlns')) {\n                    domElement = this._domDocument.createElementNS(viewElementOrFragment.getAttribute('xmlns'), viewElementOrFragment.name);\n                }\n                else {\n                    domElement = this._domDocument.createElement(viewElementOrFragment.name);\n                }\n                // RawElement take care of their children in RawElement#render() method which can be customized\n                // (see https://github.com/ckeditor/ckeditor5/issues/4469).\n                if (viewElementOrFragment.is('rawElement')) {\n                    viewElementOrFragment.render(domElement, this);\n                }\n                if (options.bind) {\n                    this.bindElements(domElement, viewElementOrFragment);\n                }\n                // Copy element's attributes.\n                for (const key of viewElementOrFragment.getAttributeKeys()) {\n                    this.setDomElementAttribute(domElement, key, viewElementOrFragment.getAttribute(key), viewElementOrFragment);\n                }\n            }\n            if (options.withChildren !== false) {\n                for (const child of this.viewChildrenToDom(viewElementOrFragment, options)) {\n                    domElement.appendChild(child);\n                }\n            }\n            return domElement;\n        }\n    }\n    /**\n     * Sets the attribute on a DOM element.\n     *\n     * **Note**: To remove the attribute, use {@link #removeDomElementAttribute}.\n     *\n     * @param domElement The DOM element the attribute should be set on.\n     * @param key The name of the attribute.\n     * @param value The value of the attribute.\n     * @param relatedViewElement The view element related to the `domElement` (if there is any).\n     * It helps decide whether the attribute set is unsafe. For instance, view elements created via the\n     * {@link module:engine/view/downcastwriter~DowncastWriter} methods can allow certain attributes that would normally be filtered out.\n     */\n    setDomElementAttribute(domElement, key, value, relatedViewElement) {\n        const shouldRenderAttribute = this.shouldRenderAttribute(key, value, domElement.tagName.toLowerCase()) ||\n            relatedViewElement && relatedViewElement.shouldRenderUnsafeAttribute(key);\n        if (!shouldRenderAttribute) {\n            logWarning('domconverter-unsafe-attribute-detected', { domElement, key, value });\n        }\n        if (!isValidAttributeName(key)) {\n            /**\n             * Invalid attribute name was ignored during rendering.\n             *\n             * @error domconverter-invalid-attribute-detected\n             */\n            logWarning('domconverter-invalid-attribute-detected', { domElement, key, value });\n            return;\n        }\n        // The old value was safe but the new value is unsafe.\n        if (domElement.hasAttribute(key) && !shouldRenderAttribute) {\n            domElement.removeAttribute(key);\n        }\n        // The old value was unsafe (but prefixed) but the new value will be safe (will be unprefixed).\n        else if (domElement.hasAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX + key) && shouldRenderAttribute) {\n            domElement.removeAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX + key);\n        }\n        // If the attribute should not be rendered, rename it (instead of removing) to give developers some idea of what\n        // is going on (https://github.com/ckeditor/ckeditor5/issues/10801).\n        domElement.setAttribute(shouldRenderAttribute ? key : UNSAFE_ATTRIBUTE_NAME_PREFIX + key, value);\n    }\n    /**\n     * Removes an attribute from a DOM element.\n     *\n     * **Note**: To set the attribute, use {@link #setDomElementAttribute}.\n     *\n     * @param domElement The DOM element the attribute should be removed from.\n     * @param key The name of the attribute.\n     */\n    removeDomElementAttribute(domElement, key) {\n        // See #_createReplacementDomElement() to learn what this is.\n        if (key == UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE) {\n            return;\n        }\n        domElement.removeAttribute(key);\n        // See setDomElementAttribute() to learn what this is.\n        domElement.removeAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX + key);\n    }\n    /**\n     * Converts children of the view element to DOM using the\n     * {@link module:engine/view/domconverter~DomConverter#viewToDom} method.\n     * Additionally, this method adds block {@link module:engine/view/filler filler} to the list of children, if needed.\n     *\n     * @param viewElement Parent view element.\n     * @param options See {@link module:engine/view/domconverter~DomConverter#viewToDom} options parameter.\n     * @returns DOM nodes.\n     */\n    *viewChildrenToDom(viewElement, options = {}) {\n        const fillerPositionOffset = viewElement.getFillerOffset && viewElement.getFillerOffset();\n        let offset = 0;\n        for (const childView of viewElement.getChildren()) {\n            if (fillerPositionOffset === offset) {\n                yield this._getBlockFiller();\n            }\n            const transparentRendering = childView.is('element') &&\n                !!childView.getCustomProperty('dataPipeline:transparentRendering') &&\n                !first(childView.getAttributes());\n            if (transparentRendering && this.renderingMode == 'data') {\n                yield* this.viewChildrenToDom(childView, options);\n            }\n            else {\n                if (transparentRendering) {\n                    /**\n                     * The `dataPipeline:transparentRendering` flag is supported only in the data pipeline.\n                     *\n                     * @error domconverter-transparent-rendering-unsupported-in-editing-pipeline\n                     */\n                    logWarning('domconverter-transparent-rendering-unsupported-in-editing-pipeline', { viewElement: childView });\n                }\n                yield this.viewToDom(childView, options);\n            }\n            offset++;\n        }\n        if (fillerPositionOffset === offset) {\n            yield this._getBlockFiller();\n        }\n    }\n    /**\n     * Converts view {@link module:engine/view/range~Range} to DOM range.\n     * Inline and block {@link module:engine/view/filler fillers} are handled during the conversion.\n     *\n     * @param viewRange View range.\n     * @returns DOM range.\n     */\n    viewRangeToDom(viewRange) {\n        const domStart = this.viewPositionToDom(viewRange.start);\n        const domEnd = this.viewPositionToDom(viewRange.end);\n        const domRange = this._domDocument.createRange();\n        domRange.setStart(domStart.parent, domStart.offset);\n        domRange.setEnd(domEnd.parent, domEnd.offset);\n        return domRange;\n    }\n    /**\n     * Converts view {@link module:engine/view/position~Position} to DOM parent and offset.\n     *\n     * Inline and block {@link module:engine/view/filler fillers} are handled during the conversion.\n     * If the converted position is directly before inline filler it is moved inside the filler.\n     *\n     * @param viewPosition View position.\n     * @returns DOM position or `null` if view position could not be converted to DOM.\n     * DOM position has two properties:\n     * * `parent` - DOM position parent.\n     * * `offset` - DOM position offset.\n     */\n    viewPositionToDom(viewPosition) {\n        const viewParent = viewPosition.parent;\n        if (viewParent.is('$text')) {\n            const domParent = this.findCorrespondingDomText(viewParent);\n            if (!domParent) {\n                // Position is in a view text node that has not been rendered to DOM yet.\n                return null;\n            }\n            let offset = viewPosition.offset;\n            if (startsWithFiller(domParent)) {\n                offset += INLINE_FILLER_LENGTH;\n            }\n            return { parent: domParent, offset };\n        }\n        else {\n            // viewParent is instance of ViewElement.\n            let domParent, domBefore, domAfter;\n            if (viewPosition.offset === 0) {\n                domParent = this.mapViewToDom(viewParent);\n                if (!domParent) {\n                    // Position is in a view element that has not been rendered to DOM yet.\n                    return null;\n                }\n                domAfter = domParent.childNodes[0];\n            }\n            else {\n                const nodeBefore = viewPosition.nodeBefore;\n                domBefore = nodeBefore.is('$text') ?\n                    this.findCorrespondingDomText(nodeBefore) :\n                    this.mapViewToDom(nodeBefore);\n                if (!domBefore) {\n                    // Position is after a view element that has not been rendered to DOM yet.\n                    return null;\n                }\n                domParent = domBefore.parentNode;\n                domAfter = domBefore.nextSibling;\n            }\n            // If there is an inline filler at position return position inside the filler. We should never return\n            // the position before the inline filler.\n            if (isText(domAfter) && startsWithFiller(domAfter)) {\n                return { parent: domAfter, offset: INLINE_FILLER_LENGTH };\n            }\n            const offset = domBefore ? indexOf(domBefore) + 1 : 0;\n            return { parent: domParent, offset };\n        }\n    }\n    /**\n     * Converts DOM to view. For all text nodes, not bound elements and document fragments new items will\n     * be created. For bound elements and document fragments function will return corresponding items. For\n     * {@link module:engine/view/filler fillers} `null` will be returned.\n     * For all DOM elements rendered by {@link module:engine/view/uielement~UIElement} that UIElement will be returned.\n     *\n     * @param domNode DOM node or document fragment to transform.\n     * @param options Conversion options.\n     * @param options.bind Determines whether new elements will be bound. False by default.\n     * @param options.withChildren If `true`, node's and document fragment's children will be converted too. True by default.\n     * @param options.keepOriginalCase If `false`, node's tag name will be converted to lower case. False by default.\n     * @param options.skipComments If `false`, comment nodes will be converted to `$comment`\n     * {@link module:engine/view/uielement~UIElement view UI elements}. False by default.\n     * @returns Converted node or document fragment or `null` if DOM node is a {@link module:engine/view/filler filler}\n     * or the given node is an empty text node.\n     */\n    domToView(domNode, options = {}) {\n        const inlineNodes = [];\n        const generator = this._domToView(domNode, options, inlineNodes);\n        // Get the first yielded value or a returned value.\n        const node = generator.next().value;\n        if (!node) {\n            return null;\n        }\n        // Trigger children handling.\n        generator.next();\n        // Whitespace cleaning.\n        this._processDomInlineNodes(null, inlineNodes, options);\n        // Text not got trimmed to an empty string so there is no result node.\n        if (node.is('$text') && node.data.length == 0) {\n            return null;\n        }\n        return node;\n    }\n    /**\n     * Converts children of the DOM element to view nodes using\n     * the {@link module:engine/view/domconverter~DomConverter#domToView} method.\n     * Additionally this method omits block {@link module:engine/view/filler filler}, if it exists in the DOM parent.\n     *\n     * @param domElement Parent DOM element.\n     * @param options See {@link module:engine/view/domconverter~DomConverter#domToView} options parameter.\n     * @param inlineNodes An array that will be populated with inline nodes. It's used internally for whitespace processing.\n     * @returns View nodes.\n     */\n    *domChildrenToView(domElement, options = {}, inlineNodes = []) {\n        for (let i = 0; i < domElement.childNodes.length; i++) {\n            const domChild = domElement.childNodes[i];\n            const generator = this._domToView(domChild, options, inlineNodes);\n            // Get the first yielded value or a returned value.\n            const viewChild = generator.next().value;\n            if (viewChild !== null) {\n                // Whitespace cleaning before entering a block element (between block elements).\n                if (this._isBlockViewElement(viewChild)) {\n                    this._processDomInlineNodes(domElement, inlineNodes, options);\n                }\n                yield viewChild;\n                // Trigger children handling.\n                generator.next();\n            }\n        }\n        // Whitespace cleaning before leaving a block element (content of block element).\n        this._processDomInlineNodes(domElement, inlineNodes, options);\n    }\n    /**\n     * Converts DOM selection to view {@link module:engine/view/selection~Selection}.\n     * Ranges which cannot be converted will be omitted.\n     *\n     * @param domSelection DOM selection.\n     * @returns View selection.\n     */\n    domSelectionToView(domSelection) {\n        // See: https://github.com/ckeditor/ckeditor5/issues/9635.\n        if (isGeckoRestrictedDomSelection(domSelection)) {\n            return new ViewSelection([]);\n        }\n        // DOM selection might be placed in fake selection container.\n        // If container contains fake selection - return corresponding view selection.\n        if (domSelection.rangeCount === 1) {\n            let container = domSelection.getRangeAt(0).startContainer;\n            // The DOM selection might be moved to the text node inside the fake selection container.\n            if (isText(container)) {\n                container = container.parentNode;\n            }\n            const viewSelection = this.fakeSelectionToView(container);\n            if (viewSelection) {\n                return viewSelection;\n            }\n        }\n        const isBackward = this.isDomSelectionBackward(domSelection);\n        const viewRanges = [];\n        for (let i = 0; i < domSelection.rangeCount; i++) {\n            // DOM Range have correct start and end, no matter what is the DOM Selection direction. So we don't have to fix anything.\n            const domRange = domSelection.getRangeAt(i);\n            const viewRange = this.domRangeToView(domRange);\n            if (viewRange) {\n                viewRanges.push(viewRange);\n            }\n        }\n        return new ViewSelection(viewRanges, { backward: isBackward });\n    }\n    /**\n     * Converts DOM Range to view {@link module:engine/view/range~Range}.\n     * If the start or end position can not be converted `null` is returned.\n     *\n     * @param domRange DOM range.\n     * @returns View range.\n     */\n    domRangeToView(domRange) {\n        const viewStart = this.domPositionToView(domRange.startContainer, domRange.startOffset);\n        const viewEnd = this.domPositionToView(domRange.endContainer, domRange.endOffset);\n        if (viewStart && viewEnd) {\n            return new ViewRange(viewStart, viewEnd);\n        }\n        return null;\n    }\n    /**\n     * Converts DOM parent and offset to view {@link module:engine/view/position~Position}.\n     *\n     * If the position is inside a {@link module:engine/view/filler filler} which has no corresponding view node,\n     * position of the filler will be converted and returned.\n     *\n     * If the position is inside DOM element rendered by {@link module:engine/view/uielement~UIElement}\n     * that position will be converted to view position before that UIElement.\n     *\n     * If structures are too different and it is not possible to find corresponding position then `null` will be returned.\n     *\n     * @param domParent DOM position parent.\n     * @param domOffset DOM position offset. You can skip it when converting the inline filler node.\n     * @returns View position.\n     */\n    domPositionToView(domParent, domOffset = 0) {\n        if (this.isBlockFiller(domParent)) {\n            return this.domPositionToView(domParent.parentNode, indexOf(domParent));\n        }\n        // If position is somewhere inside UIElement or a RawElement - return position before that element.\n        const viewElement = this.mapDomToView(domParent);\n        if (viewElement && (viewElement.is('uiElement') || viewElement.is('rawElement'))) {\n            return ViewPosition._createBefore(viewElement);\n        }\n        if (isText(domParent)) {\n            if (isInlineFiller(domParent)) {\n                return this.domPositionToView(domParent.parentNode, indexOf(domParent));\n            }\n            const viewParent = this.findCorrespondingViewText(domParent);\n            let offset = domOffset;\n            if (!viewParent) {\n                return null;\n            }\n            if (startsWithFiller(domParent)) {\n                offset -= INLINE_FILLER_LENGTH;\n                offset = offset < 0 ? 0 : offset;\n            }\n            return new ViewPosition(viewParent, offset);\n        }\n        // domParent instanceof HTMLElement.\n        else {\n            if (domOffset === 0) {\n                const viewParent = this.mapDomToView(domParent);\n                if (viewParent) {\n                    return new ViewPosition(viewParent, 0);\n                }\n            }\n            else {\n                const domBefore = domParent.childNodes[domOffset - 1];\n                // Jump over an inline filler (and also on Firefox jump over a block filler while pressing backspace in an empty paragraph).\n                if (isText(domBefore) && isInlineFiller(domBefore) || domBefore && this.isBlockFiller(domBefore)) {\n                    return this.domPositionToView(domBefore.parentNode, indexOf(domBefore));\n                }\n                const viewBefore = isText(domBefore) ?\n                    this.findCorrespondingViewText(domBefore) :\n                    this.mapDomToView(domBefore);\n                // TODO #663\n                if (viewBefore && viewBefore.parent) {\n                    return new ViewPosition(viewBefore.parent, viewBefore.index + 1);\n                }\n            }\n            return null;\n        }\n    }\n    /**\n     * Returns corresponding view {@link module:engine/view/element~Element Element} or\n     * {@link module:engine/view/documentfragment~DocumentFragment} for provided DOM element or\n     * document fragment. If there is no view item {@link module:engine/view/domconverter~DomConverter#bindElements bound}\n     * to the given DOM - `undefined` is returned.\n     *\n     * For all DOM elements rendered by a {@link module:engine/view/uielement~UIElement} or\n     * a {@link module:engine/view/rawelement~RawElement}, the parent `UIElement` or `RawElement` will be returned.\n     *\n     * @param domElementOrDocumentFragment DOM element or document fragment.\n     * @returns Corresponding view element, document fragment or `undefined` if no element was bound.\n     */\n    mapDomToView(domElementOrDocumentFragment) {\n        const hostElement = this.getHostViewElement(domElementOrDocumentFragment);\n        return hostElement || this._domToViewMapping.get(domElementOrDocumentFragment);\n    }\n    /**\n     * Finds corresponding text node. Text nodes are not {@link module:engine/view/domconverter~DomConverter#bindElements bound},\n     * corresponding text node is returned based on the sibling or parent.\n     *\n     * If the directly previous sibling is a {@link module:engine/view/domconverter~DomConverter#bindElements bound} element, it is used\n     * to find the corresponding text node.\n     *\n     * If this is a first child in the parent and the parent is a {@link module:engine/view/domconverter~DomConverter#bindElements bound}\n     * element, it is used to find the corresponding text node.\n     *\n     * For all text nodes rendered by a {@link module:engine/view/uielement~UIElement} or\n     * a {@link module:engine/view/rawelement~RawElement}, the parent `UIElement` or `RawElement` will be returned.\n     *\n     * Otherwise `null` is returned.\n     *\n     * Note that for the block or inline {@link module:engine/view/filler filler} this method returns `null`.\n     *\n     * @param domText DOM text node.\n     * @returns Corresponding view text node or `null`, if it was not possible to find a corresponding node.\n     */\n    findCorrespondingViewText(domText) {\n        if (isInlineFiller(domText)) {\n            return null;\n        }\n        // If DOM text was rendered by a UIElement or a RawElement - return this parent element.\n        const hostElement = this.getHostViewElement(domText);\n        if (hostElement) {\n            return hostElement;\n        }\n        const previousSibling = domText.previousSibling;\n        // Try to use previous sibling to find the corresponding text node.\n        if (previousSibling) {\n            if (!(this.isElement(previousSibling))) {\n                // The previous is text or comment.\n                return null;\n            }\n            const viewElement = this.mapDomToView(previousSibling);\n            if (viewElement) {\n                const nextSibling = viewElement.nextSibling;\n                // It might be filler which has no corresponding view node.\n                if (nextSibling instanceof ViewText) {\n                    return nextSibling;\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        // Try to use parent to find the corresponding text node.\n        else {\n            const viewElement = this.mapDomToView(domText.parentNode);\n            if (viewElement) {\n                const firstChild = viewElement.getChild(0);\n                // It might be filler which has no corresponding view node.\n                if (firstChild instanceof ViewText) {\n                    return firstChild;\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        return null;\n    }\n    mapViewToDom(documentFragmentOrElement) {\n        return this._viewToDomMapping.get(documentFragmentOrElement);\n    }\n    /**\n     * Finds corresponding text node. Text nodes are not {@link module:engine/view/domconverter~DomConverter#bindElements bound},\n     * corresponding text node is returned based on the sibling or parent.\n     *\n     * If the directly previous sibling is a {@link module:engine/view/domconverter~DomConverter#bindElements bound} element, it is used\n     * to find the corresponding text node.\n     *\n     * If this is a first child in the parent and the parent is a {@link module:engine/view/domconverter~DomConverter#bindElements bound}\n     * element, it is used to find the corresponding text node.\n     *\n     * Otherwise `null` is returned.\n     *\n     * @param viewText View text node.\n     * @returns Corresponding DOM text node or `null`, if it was not possible to find a corresponding node.\n     */\n    findCorrespondingDomText(viewText) {\n        const previousSibling = viewText.previousSibling;\n        // Try to use previous sibling to find the corresponding text node.\n        if (previousSibling && this.mapViewToDom(previousSibling)) {\n            return this.mapViewToDom(previousSibling).nextSibling;\n        }\n        // If this is a first node, try to use parent to find the corresponding text node.\n        if (!previousSibling && viewText.parent && this.mapViewToDom(viewText.parent)) {\n            return this.mapViewToDom(viewText.parent).childNodes[0];\n        }\n        return null;\n    }\n    /**\n     * Focuses DOM editable that is corresponding to provided {@link module:engine/view/editableelement~EditableElement}.\n     */\n    focus(viewEditable) {\n        const domEditable = this.mapViewToDom(viewEditable);\n        if (domEditable && domEditable.ownerDocument.activeElement !== domEditable) {\n            // Save the scrollX and scrollY positions before the focus.\n            const { scrollX, scrollY } = global.window;\n            const scrollPositions = [];\n            // Save all scrollLeft and scrollTop values starting from domEditable up to\n            // document#documentElement.\n            forEachDomElementAncestor(domEditable, node => {\n                const { scrollLeft, scrollTop } = node;\n                scrollPositions.push([scrollLeft, scrollTop]);\n            });\n            domEditable.focus();\n            // Restore scrollLeft and scrollTop values starting from domEditable up to\n            // document#documentElement.\n            // https://github.com/ckeditor/ckeditor5-engine/issues/951\n            // https://github.com/ckeditor/ckeditor5-engine/issues/957\n            forEachDomElementAncestor(domEditable, node => {\n                const [scrollLeft, scrollTop] = scrollPositions.shift();\n                node.scrollLeft = scrollLeft;\n                node.scrollTop = scrollTop;\n            });\n            // Restore the scrollX and scrollY positions after the focus.\n            // https://github.com/ckeditor/ckeditor5-engine/issues/951\n            global.window.scrollTo(scrollX, scrollY);\n        }\n    }\n    /**\n     * Remove DOM selection from blurred editable, so it won't interfere with clicking on dropdowns (especially on iOS).\n     *\n     * @internal\n     */\n    _clearDomSelection() {\n        const domEditable = this.mapViewToDom(this.document.selection.editableElement);\n        if (!domEditable) {\n            return;\n        }\n        // Check if DOM selection is inside editor editable element.\n        const domSelection = domEditable.ownerDocument.defaultView.getSelection();\n        const newViewSelection = this.domSelectionToView(domSelection);\n        const selectionInEditable = newViewSelection && newViewSelection.rangeCount > 0;\n        if (selectionInEditable) {\n            domSelection.removeAllRanges();\n        }\n    }\n    /**\n     * Returns `true` when `node.nodeType` equals `Node.ELEMENT_NODE`.\n     *\n     * @param node Node to check.\n     */\n    isElement(node) {\n        return node && node.nodeType == Node.ELEMENT_NODE;\n    }\n    /**\n     * Returns `true` when `node.nodeType` equals `Node.DOCUMENT_FRAGMENT_NODE`.\n     *\n     * @param node Node to check.\n     */\n    isDocumentFragment(node) {\n        return node && node.nodeType == Node.DOCUMENT_FRAGMENT_NODE;\n    }\n    /**\n     * Checks if the node is an instance of the block filler for this DOM converter.\n     *\n     * ```ts\n     * const converter = new DomConverter( viewDocument, { blockFillerMode: 'br' } );\n     *\n     * converter.isBlockFiller( BR_FILLER( document ) ); // true\n     * converter.isBlockFiller( NBSP_FILLER( document ) ); // false\n     * ```\n     *\n     * **Note:**: For the `'nbsp'` mode the method also checks context of a node so it cannot be a detached node.\n     *\n     * **Note:** A special case in the `'nbsp'` mode exists where the `<br>` in `<p><br></p>` is treated as a block filler.\n     *\n     * @param domNode DOM node to check.\n     * @returns True if a node is considered a block filler for given mode.\n     */\n    isBlockFiller(domNode) {\n        if (this.blockFillerMode == 'br') {\n            return domNode.isEqualNode(BR_FILLER_REF);\n        }\n        // Special case for <p><br></p> in which <br> should be treated as filler even when we are not in the 'br' mode. See ckeditor5#5564.\n        if (domNode.tagName === 'BR' &&\n            hasBlockParent(domNode, this.blockElements) &&\n            domNode.parentNode.childNodes.length === 1) {\n            return true;\n        }\n        // If not in 'br' mode, try recognizing both marked and regular nbsp block fillers.\n        return domNode.isEqualNode(MARKED_NBSP_FILLER_REF) || isNbspBlockFiller(domNode, this.blockElements);\n    }\n    /**\n     * Returns `true` if given selection is a backward selection, that is, if it's `focus` is before `anchor`.\n     *\n     * @param DOM Selection instance to check.\n     */\n    isDomSelectionBackward(selection) {\n        if (selection.isCollapsed) {\n            return false;\n        }\n        // Since it takes multiple lines of code to check whether a \"DOM Position\" is before/after another \"DOM Position\",\n        // we will use the fact that range will collapse if it's end is before it's start.\n        const range = this._domDocument.createRange();\n        try {\n            range.setStart(selection.anchorNode, selection.anchorOffset);\n            range.setEnd(selection.focusNode, selection.focusOffset);\n        }\n        catch (e) {\n            // Safari sometimes gives us a selection that makes Range.set{Start,End} throw.\n            // See https://github.com/ckeditor/ckeditor5/issues/12375.\n            return false;\n        }\n        const backward = range.collapsed;\n        range.detach();\n        return backward;\n    }\n    /**\n     * Returns a parent {@link module:engine/view/uielement~UIElement} or {@link module:engine/view/rawelement~RawElement}\n     * that hosts the provided DOM node. Returns `null` if there is no such parent.\n     */\n    getHostViewElement(domNode) {\n        const ancestors = getAncestors(domNode);\n        // Remove domNode from the list.\n        ancestors.pop();\n        while (ancestors.length) {\n            const domNode = ancestors.pop();\n            const viewNode = this._domToViewMapping.get(domNode);\n            if (viewNode && (viewNode.is('uiElement') || viewNode.is('rawElement'))) {\n                return viewNode;\n            }\n        }\n        return null;\n    }\n    /**\n     * Checks if the given selection's boundaries are at correct places.\n     *\n     * The following places are considered as incorrect for selection boundaries:\n     *\n     * * before or in the middle of an inline filler sequence,\n     * * inside a DOM element which represents {@link module:engine/view/uielement~UIElement a view UI element},\n     * * inside a DOM element which represents {@link module:engine/view/rawelement~RawElement a view raw element}.\n     *\n     * @param domSelection The DOM selection object to be checked.\n     * @returns `true` if the given selection is at a correct place, `false` otherwise.\n     */\n    isDomSelectionCorrect(domSelection) {\n        return this._isDomSelectionPositionCorrect(domSelection.anchorNode, domSelection.anchorOffset) &&\n            this._isDomSelectionPositionCorrect(domSelection.focusNode, domSelection.focusOffset);\n    }\n    /**\n     * Registers a {@link module:engine/view/matcher~MatcherPattern} for view elements whose content should be treated as raw data\n     * and not processed during the conversion from DOM nodes to view elements.\n     *\n     * This is affecting how {@link module:engine/view/domconverter~DomConverter#domToView} and\n     * {@link module:engine/view/domconverter~DomConverter#domChildrenToView} process DOM nodes.\n     *\n     * The raw data can be later accessed by a\n     * {@link module:engine/view/element~Element#getCustomProperty custom property of a view element} called `\"$rawContent\"`.\n     *\n     * @param pattern Pattern matching a view element whose content should\n     * be treated as raw data.\n     */\n    registerRawContentMatcher(pattern) {\n        this._rawContentElementMatcher.add(pattern);\n    }\n    /**\n     * Registers a {@link module:engine/view/matcher~MatcherPattern} for inline object view elements.\n     *\n     * This is affecting how {@link module:engine/view/domconverter~DomConverter#domToView} and\n     * {@link module:engine/view/domconverter~DomConverter#domChildrenToView} process DOM nodes.\n     *\n     * This is an extension of a simple {@link #inlineObjectElements} array of element names.\n     *\n     * @param pattern Pattern matching a view element which should be treated as an inline object.\n     */\n    registerInlineObjectMatcher(pattern) {\n        this._inlineObjectElementMatcher.add(pattern);\n    }\n    /**\n     * Clear temporary custom properties.\n     *\n     * @internal\n     */\n    _clearTemporaryCustomProperties() {\n        for (const element of this._elementsWithTemporaryCustomProperties) {\n            element._removeCustomProperty('editingPipeline:doNotReuseOnce');\n        }\n        this._elementsWithTemporaryCustomProperties.clear();\n    }\n    /**\n     * Returns the block {@link module:engine/view/filler filler} node based on the current {@link #blockFillerMode} setting.\n     */\n    _getBlockFiller() {\n        switch (this.blockFillerMode) {\n            case 'nbsp':\n                return NBSP_FILLER(this._domDocument); // eslint-disable-line new-cap\n            case 'markedNbsp':\n                return MARKED_NBSP_FILLER(this._domDocument); // eslint-disable-line new-cap\n            case 'br':\n                return BR_FILLER(this._domDocument); // eslint-disable-line new-cap\n        }\n    }\n    /**\n     * Checks if the given DOM position is a correct place for selection boundary. See {@link #isDomSelectionCorrect}.\n     *\n     * @param domParent Position parent.\n     * @param offset Position offset.\n     * @returns `true` if given position is at a correct place for selection boundary, `false` otherwise.\n     */\n    _isDomSelectionPositionCorrect(domParent, offset) {\n        // If selection is before or in the middle of inline filler string, it is incorrect.\n        if (isText(domParent) && startsWithFiller(domParent) && offset < INLINE_FILLER_LENGTH) {\n            // Selection in a text node, at wrong position (before or in the middle of filler).\n            return false;\n        }\n        if (this.isElement(domParent) && startsWithFiller(domParent.childNodes[offset])) {\n            // Selection in an element node, before filler text node.\n            return false;\n        }\n        const viewParent = this.mapDomToView(domParent);\n        // The position is incorrect when anchored inside a UIElement or a RawElement.\n        // Note: In case of UIElement and RawElement, mapDomToView() returns a parent element for any DOM child\n        // so there's no need to perform any additional checks.\n        if (viewParent && (viewParent.is('uiElement') || viewParent.is('rawElement'))) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Internal generator for {@link #domToView}. Also used by {@link #domChildrenToView}.\n     * Separates DOM nodes conversion from whitespaces processing.\n     *\n     * @param domNode DOM node or document fragment to transform.\n     * @param inlineNodes An array of recently encountered inline nodes truncated to the block element boundaries.\n     * Used later to process whitespaces.\n     */\n    *_domToView(domNode, options, inlineNodes) {\n        if (this.isBlockFiller(domNode)) {\n            return null;\n        }\n        // When node is inside a UIElement or a RawElement return that parent as it's view representation.\n        const hostElement = this.getHostViewElement(domNode);\n        if (hostElement) {\n            return hostElement;\n        }\n        if (isComment(domNode) && options.skipComments) {\n            return null;\n        }\n        if (isText(domNode)) {\n            if (isInlineFiller(domNode)) {\n                return null;\n            }\n            else {\n                const textData = domNode.data;\n                if (textData === '') {\n                    return null;\n                }\n                const textNode = new ViewText(this.document, textData);\n                inlineNodes.push(textNode);\n                return textNode;\n            }\n        }\n        else {\n            let viewElement = this.mapDomToView(domNode);\n            if (viewElement) {\n                if (this._isInlineObjectElement(viewElement)) {\n                    inlineNodes.push(viewElement);\n                }\n                return viewElement;\n            }\n            if (this.isDocumentFragment(domNode)) {\n                // Create view document fragment.\n                viewElement = new ViewDocumentFragment(this.document);\n                if (options.bind) {\n                    this.bindDocumentFragments(domNode, viewElement);\n                }\n            }\n            else {\n                // Create view element.\n                viewElement = this._createViewElement(domNode, options);\n                if (options.bind) {\n                    this.bindElements(domNode, viewElement);\n                }\n                // Copy element's attributes.\n                const attrs = domNode.attributes;\n                if (attrs) {\n                    for (let l = attrs.length, i = 0; i < l; i++) {\n                        viewElement._setAttribute(attrs[i].name, attrs[i].value);\n                    }\n                }\n                // Treat this element's content as a raw data if it was registered as such.\n                if (this._isViewElementWithRawContent(viewElement, options)) {\n                    viewElement._setCustomProperty('$rawContent', domNode.innerHTML);\n                    if (!this._isBlockViewElement(viewElement)) {\n                        inlineNodes.push(viewElement);\n                    }\n                    return viewElement;\n                }\n                // Comment node is also treated as an element with raw data.\n                if (isComment(domNode)) {\n                    viewElement._setCustomProperty('$rawContent', domNode.data);\n                    return viewElement;\n                }\n            }\n            // Yield the element first so the flow of nested inline nodes is not reversed inside elements.\n            yield viewElement;\n            const nestedInlineNodes = [];\n            if (options.withChildren !== false) {\n                for (const child of this.domChildrenToView(domNode, options, nestedInlineNodes)) {\n                    viewElement._appendChild(child);\n                }\n            }\n            // Check if this is an inline object after processing child nodes so matcher\n            // for inline objects can verify if the element is empty.\n            if (this._isInlineObjectElement(viewElement)) {\n                inlineNodes.push(viewElement);\n            }\n            else {\n                // It's an inline element that is not an object (like <b>, <i>) or a block element.\n                for (const inlineNode of nestedInlineNodes) {\n                    inlineNodes.push(inlineNode);\n                }\n            }\n        }\n    }\n    /**\n     * Internal helper that walks the list of inline view nodes already generated from DOM nodes\n     * and handles whitespaces and NBSPs.\n     *\n     * @param domParent The DOM parent of the given inline nodes. This should be a document fragment or\n     * a block element to whitespace processing start cleaning.\n     * @param inlineNodes An array of recently encountered inline nodes truncated to the block element boundaries.\n     */\n    _processDomInlineNodes(domParent, inlineNodes, options) {\n        if (!inlineNodes.length) {\n            return;\n        }\n        // Process text nodes only after reaching a block or document fragment,\n        // do not alter whitespaces while processing an inline element like <b> or <i>.\n        if (domParent && !this.isDocumentFragment(domParent) && !this._isBlockDomElement(domParent)) {\n            return;\n        }\n        let prevNodeEndsWithSpace = false;\n        for (let i = 0; i < inlineNodes.length; i++) {\n            const node = inlineNodes[i];\n            if (!node.is('$text')) {\n                prevNodeEndsWithSpace = false;\n                continue;\n            }\n            let data;\n            let nodeEndsWithSpace = false;\n            if (_hasViewParentOfType(node, this.preElements)) {\n                data = getDataWithoutFiller(node.data);\n            }\n            else {\n                // Change all consecutive whitespace characters (from the [ \\n\\t\\r] set –\n                // see https://github.com/ckeditor/ckeditor5-engine/issues/822#issuecomment-311670249) to a single space character.\n                // That's how multiple whitespaces are treated when rendered, so we normalize those whitespaces.\n                // We're replacing 1+ (and not 2+) to also normalize singular \\n\\t\\r characters (#822).\n                data = node.data.replace(/[ \\n\\t\\r]{1,}/g, ' ');\n                nodeEndsWithSpace = /[^\\S\\u00A0]/.test(data.charAt(data.length - 1));\n                const prevNode = i > 0 ? inlineNodes[i - 1] : null;\n                const nextNode = i + 1 < inlineNodes.length ? inlineNodes[i + 1] : null;\n                const shouldLeftTrim = !prevNode || prevNode.is('element') && prevNode.name == 'br' || prevNodeEndsWithSpace;\n                const shouldRightTrim = nextNode ? false : !startsWithFiller(node.data);\n                // Do not try to clear whitespaces if this is flat mapping for the purpose of mutation observer and differ in rendering.\n                if (options.withChildren !== false) {\n                    // If the previous dom text node does not exist or it ends by whitespace character, remove space character from the\n                    // beginning of this text node. Such space character is treated as a whitespace.\n                    if (shouldLeftTrim) {\n                        data = data.replace(/^ /, '');\n                    }\n                    // If the next text node does not exist remove space character from the end of this text node.\n                    if (shouldRightTrim) {\n                        data = data.replace(/ $/, '');\n                    }\n                }\n                // At the beginning and end of a block element, Firefox inserts normal space + <br> instead of non-breaking space.\n                // This means that the text node starts/end with normal space instead of non-breaking space.\n                // This causes a problem because the normal space would be removed in `.replace` calls above. To prevent that,\n                // the inline filler is removed only after the data is initially processed (by the `.replace` above). See ckeditor5#692.\n                data = getDataWithoutFiller(data);\n                // At this point we should have removed all whitespaces from DOM text data.\n                //\n                // Now, We will reverse the process that happens in `_processDataFromViewText`.\n                //\n                // We have to change &nbsp; chars, that were in DOM text data because of rendering reasons, to spaces.\n                // First, change all ` \\u00A0` pairs (space + &nbsp;) to two spaces. DOM converter changes two spaces from model/view to\n                // ` \\u00A0` to ensure proper rendering. Since here we convert back, we recognize those pairs and change them back to `  `.\n                data = data.replace(/ \\u00A0/g, '  ');\n                const isNextNodeInlineObjectElement = nextNode && nextNode.is('element') && nextNode.name != 'br';\n                const isNextNodeStartingWithSpace = nextNode && nextNode.is('$text') && nextNode.data.charAt(0) == ' ';\n                // Then, let's change the last nbsp to a space.\n                if (/[ \\u00A0]\\u00A0$/.test(data) || !nextNode || isNextNodeInlineObjectElement || isNextNodeStartingWithSpace) {\n                    data = data.replace(/\\u00A0$/, ' ');\n                }\n                // Then, change &nbsp; character that is at the beginning of the text node to space character.\n                // We do that replacement only if this is the first node or the previous node ends on whitespace character.\n                if (shouldLeftTrim || prevNode && prevNode.is('element') && prevNode.name != 'br') {\n                    data = data.replace(/^\\u00A0/, ' ');\n                }\n            }\n            // At this point, all whitespaces should be removed and all &nbsp; created for rendering reasons should be\n            // changed to normal space. All left &nbsp; are &nbsp; inserted intentionally.\n            if (data.length == 0 && node.parent) {\n                node._remove();\n                inlineNodes.splice(i, 1);\n                i--;\n            }\n            else {\n                node._data = data;\n                prevNodeEndsWithSpace = nodeEndsWithSpace;\n            }\n        }\n        inlineNodes.length = 0;\n    }\n    /**\n     * Takes text data from a given {@link module:engine/view/text~Text#data} and processes it so\n     * it is correctly displayed in the DOM.\n     *\n     * Following changes are done:\n     *\n     * * a space at the beginning is changed to `&nbsp;` if this is the first text node in its container\n     * element or if a previous text node ends with a space character,\n     * * space at the end of the text node is changed to `&nbsp;` if there are two spaces at the end of a node or if next node\n     * starts with a space or if it is the last text node in its container,\n     * * remaining spaces are replaced to a chain of spaces and `&nbsp;` (e.g. `'x   x'` becomes `'x &nbsp; x'`).\n     *\n     * Content of {@link #preElements} is not processed.\n     *\n     * @param node View text node to process.\n     * @returns Processed text data.\n     */\n    _processDataFromViewText(node) {\n        let data = node.data;\n        // If any of node ancestors has a name which is in `preElements` array, then currently processed\n        // view text node is (will be) in preformatted element. We should not change whitespaces then.\n        if (node.getAncestors().some(parent => this.preElements.includes(parent.name))) {\n            return data;\n        }\n        // 1. Replace the first space with a nbsp if the previous node ends with a space or there is no previous node\n        // (container element boundary).\n        if (data.charAt(0) == ' ') {\n            const prevNode = this._getTouchingInlineViewNode(node, false);\n            const prevEndsWithSpace = prevNode && prevNode.is('$textProxy') && this._nodeEndsWithSpace(prevNode);\n            if (prevEndsWithSpace || !prevNode) {\n                data = '\\u00A0' + data.substr(1);\n            }\n        }\n        // 2. Replace the last space with nbsp if there are two spaces at the end or if the next node starts with space or there is no\n        // next node (container element boundary).\n        //\n        // Keep in mind that Firefox prefers $nbsp; before tag, not inside it:\n        //\n        // Foo <span>&nbsp;bar</span>  <-- bad.\n        // Foo&nbsp;<span> bar</span>  <-- good.\n        //\n        // More here: https://github.com/ckeditor/ckeditor5-engine/issues/1747.\n        if (data.charAt(data.length - 1) == ' ') {\n            const nextNode = this._getTouchingInlineViewNode(node, true);\n            const nextStartsWithSpace = nextNode && nextNode.is('$textProxy') && nextNode.data.charAt(0) == ' ';\n            if (data.charAt(data.length - 2) == ' ' || !nextNode || nextStartsWithSpace) {\n                data = data.substr(0, data.length - 1) + '\\u00A0';\n            }\n        }\n        // 3. Create space+nbsp pairs.\n        return data.replace(/ {2}/g, ' \\u00A0');\n    }\n    /**\n     * Checks whether given node ends with a space character after changing appropriate space characters to `&nbsp;`s.\n     *\n     * @param  node Node to check.\n     * @returns `true` if given `node` ends with space, `false` otherwise.\n     */\n    _nodeEndsWithSpace(node) {\n        if (node.getAncestors().some(parent => this.preElements.includes(parent.name))) {\n            return false;\n        }\n        const data = this._processDataFromViewText(node);\n        return data.charAt(data.length - 1) == ' ';\n    }\n    /**\n     * Helper function. For given {@link module:engine/view/text~Text view text node}, it finds previous or next sibling\n     * that is contained in the same container element. If there is no such sibling, `null` is returned.\n     *\n     * @param node Reference node.\n     * @returns Touching text node, an inline object\n     * or `null` if there is no next or previous touching text node.\n     */\n    _getTouchingInlineViewNode(node, getNext) {\n        const treeWalker = new ViewTreeWalker({\n            startPosition: getNext ? ViewPosition._createAfter(node) : ViewPosition._createBefore(node),\n            direction: getNext ? 'forward' : 'backward'\n        });\n        for (const value of treeWalker) {\n            // <br> found – it works like a block boundary, so do not scan further.\n            if (value.item.is('element', 'br')) {\n                return null;\n            }\n            // Found an inline object (for example an image).\n            else if (this._isInlineObjectElement(value.item)) {\n                return value.item;\n            }\n            // ViewContainerElement is found on a way to next ViewText node, so given `node` was first/last\n            // text node in its container element.\n            else if (value.item.is('containerElement')) {\n                return null;\n            }\n            // Found a text node in the same container element.\n            else if (value.item.is('$textProxy')) {\n                return value.item;\n            }\n        }\n        return null;\n    }\n    /**\n     * Returns `true` if a DOM node belongs to {@link #blockElements}. `false` otherwise.\n     */\n    _isBlockDomElement(node) {\n        return this.isElement(node) && this.blockElements.includes(node.tagName.toLowerCase());\n    }\n    /**\n     * Returns `true` if a view node belongs to {@link #blockElements}. `false` otherwise.\n     */\n    _isBlockViewElement(node) {\n        return node.is('element') && this.blockElements.includes(node.name);\n    }\n    /**\n     * Returns `true` if a DOM node belongs to {@link #inlineObjectElements}. `false` otherwise.\n     */\n    _isInlineObjectElement(node) {\n        if (!node.is('element')) {\n            return false;\n        }\n        return node.name == 'br' ||\n            this.inlineObjectElements.includes(node.name) ||\n            !!this._inlineObjectElementMatcher.match(node);\n    }\n    /**\n     * Creates view element basing on the node type.\n     *\n     * @param node DOM node to check.\n     * @param options Conversion options. See {@link module:engine/view/domconverter~DomConverter#domToView} options parameter.\n     */\n    _createViewElement(node, options) {\n        if (isComment(node)) {\n            return new ViewUIElement(this.document, '$comment');\n        }\n        const viewName = options.keepOriginalCase ? node.tagName : node.tagName.toLowerCase();\n        return new ViewElement(this.document, viewName);\n    }\n    /**\n     * Checks if view element's content should be treated as a raw data.\n     *\n     * @param viewElement View element to check.\n     * @param options Conversion options. See {@link module:engine/view/domconverter~DomConverter#domToView} options parameter.\n     */\n    _isViewElementWithRawContent(viewElement, options) {\n        return options.withChildren !== false && viewElement.is('element') && !!this._rawContentElementMatcher.match(viewElement);\n    }\n    /**\n     * Checks whether a given element name should be renamed in a current rendering mode.\n     *\n     * @param elementName The name of view element.\n     */\n    _shouldRenameElement(elementName) {\n        const name = elementName.toLowerCase();\n        return this.renderingMode === 'editing' && this.unsafeElements.includes(name);\n    }\n    /**\n     * Return a <span> element with a special attribute holding the name of the original element.\n     * Optionally, copy all the attributes of the original element if that element is provided.\n     *\n     * @param elementName The name of view element.\n     * @param originalDomElement The original DOM element to copy attributes and content from.\n     */\n    _createReplacementDomElement(elementName, originalDomElement) {\n        const newDomElement = this._domDocument.createElement('span');\n        // Mark the span replacing a script as hidden.\n        newDomElement.setAttribute(UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE, elementName);\n        if (originalDomElement) {\n            while (originalDomElement.firstChild) {\n                newDomElement.appendChild(originalDomElement.firstChild);\n            }\n            for (const attributeName of originalDomElement.getAttributeNames()) {\n                newDomElement.setAttribute(attributeName, originalDomElement.getAttribute(attributeName));\n            }\n        }\n        return newDomElement;\n    }\n}\n/**\n * Helper function.\n * Used to check if given native `Element` or `Text` node has parent with tag name from `types` array.\n *\n * @returns`true` if such parent exists or `false` if it does not.\n */\nfunction _hasViewParentOfType(node, types) {\n    return node.getAncestors().some(parent => parent.is('element') && types.includes(parent.name));\n}\n/**\n * A helper that executes given callback for each DOM node's ancestor, starting from the given node\n * and ending in document#documentElement.\n *\n * @param callback A callback to be executed for each ancestor.\n */\nfunction forEachDomElementAncestor(element, callback) {\n    let node = element;\n    while (node) {\n        callback(node);\n        node = node.parentElement;\n    }\n}\n/**\n * Checks if given node is a nbsp block filler.\n *\n * A &nbsp; is a block filler only if it is a single child of a block element.\n *\n * @param domNode DOM node.\n */\nfunction isNbspBlockFiller(domNode, blockElements) {\n    const isNBSP = domNode.isEqualNode(NBSP_FILLER_REF);\n    return isNBSP && hasBlockParent(domNode, blockElements) && domNode.parentNode.childNodes.length === 1;\n}\n/**\n * Checks if domNode has block parent.\n *\n * @param domNode DOM node.\n */\nfunction hasBlockParent(domNode, blockElements) {\n    const parent = domNode.parentNode;\n    return !!parent && !!parent.tagName && blockElements.includes(parent.tagName.toLowerCase());\n}\n/**\n * Log to console the information about element that was replaced.\n * Check UNSAFE_ELEMENTS for all recognized unsafe elements.\n *\n * @param elementName The name of the view element.\n */\nfunction _logUnsafeElement(elementName) {\n    if (elementName === 'script') {\n        logWarning('domconverter-unsafe-script-element-detected');\n    }\n    if (elementName === 'style') {\n        logWarning('domconverter-unsafe-style-element-detected');\n    }\n}\n/**\n * In certain cases, Firefox mysteriously assigns so called \"restricted objects\" to native DOM Range properties.\n * Any attempt at accessing restricted object's properties causes errors.\n * See: https://github.com/ckeditor/ckeditor5/issues/9635.\n */\nfunction isGeckoRestrictedDomSelection(domSelection) {\n    if (!env.isGecko) {\n        return false;\n    }\n    if (!domSelection.rangeCount) {\n        return false;\n    }\n    const container = domSelection.getRangeAt(0).startContainer;\n    try {\n        Object.prototype.toString.call(container);\n    }\n    catch (error) {\n        return true;\n    }\n    return false;\n}\n/**\n * While rendering the editor content, the {@link module:engine/view/domconverter~DomConverter} detected a `<script>` element that may\n * disrupt the editing experience. To avoid this, the `<script>` element was replaced with `<span data-ck-unsafe-element=\"script\"></span>`.\n *\n * @error domconverter-unsafe-script-element-detected\n */\n/**\n * While rendering the editor content, the {@link module:engine/view/domconverter~DomConverter} detected a `<style>` element that may affect\n * the editing experience. To avoid this, the `<style>` element was replaced with `<span data-ck-unsafe-element=\"style\"></span>`.\n *\n * @error domconverter-unsafe-style-element-detected\n */\n/**\n * The {@link module:engine/view/domconverter~DomConverter} detected an interactive attribute in the\n * {@glink framework/architecture/editing-engine#editing-pipeline editing pipeline}. For the best\n * editing experience, the attribute was renamed to `data-ck-unsafe-attribute-[original attribute name]`.\n *\n * If you are the author of the plugin that generated this attribute and you want it to be preserved\n * in the editing pipeline, you can configure this when creating the element\n * using {@link module:engine/view/downcastwriter~DowncastWriter} during the\n * {@glink framework/architecture/editing-engine#conversion model–view conversion}. Methods such as\n * {@link module:engine/view/downcastwriter~DowncastWriter#createContainerElement},\n * {@link module:engine/view/downcastwriter~DowncastWriter#createAttributeElement}, or\n * {@link module:engine/view/downcastwriter~DowncastWriter#createEmptyElement}\n * accept an option that will disable filtering of specific attributes:\n *\n * ```ts\n * const paragraph = writer.createContainerElement( 'p',\n * \t{\n * \t\tclass: 'clickable-paragraph',\n * \t\tonclick: 'alert( \"Paragraph clicked!\" )'\n * \t},\n * \t{\n * \t\t// Make sure the \"onclick\" attribute will pass through.\n * \t\trenderUnsafeAttributes: [ 'onclick' ]\n * \t}\n * );\n * ```\n *\n * @error domconverter-unsafe-attribute-detected\n * @param domElement The DOM element the attribute was set on.\n * @param key The original name of the attribute\n * @param value The value of the original attribute\n */\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/dataprocessor/htmldataprocessor\n */\n/* globals DOMParser */\nimport BasicHtmlWriter from './basichtmlwriter.js';\nimport DomConverter from '../view/domconverter.js';\n/**\n * The HTML data processor class.\n * This data processor implementation uses HTML as input and output data.\n */\nexport default class HtmlDataProcessor {\n    /**\n     * Creates a new instance of the HTML data processor class.\n     *\n     * @param document The view document instance.\n     */\n    constructor(document) {\n        this.skipComments = true;\n        this.domParser = new DOMParser();\n        this.domConverter = new DomConverter(document, { renderingMode: 'data' });\n        this.htmlWriter = new BasicHtmlWriter();\n    }\n    /**\n     * Converts a provided {@link module:engine/view/documentfragment~DocumentFragment document fragment}\n     * to data format &ndash; in this case to an HTML string.\n     *\n     * @returns HTML string.\n     */\n    toData(viewFragment) {\n        // Convert view DocumentFragment to DOM DocumentFragment.\n        const domFragment = this.domConverter.viewToDom(viewFragment);\n        // Convert DOM DocumentFragment to HTML output.\n        return this.htmlWriter.getHtml(domFragment);\n    }\n    /**\n     * Converts the provided HTML string to a view tree.\n     *\n     * @param data An HTML string.\n     * @returns A converted view element.\n     */\n    toView(data) {\n        // Convert input HTML data to DOM DocumentFragment.\n        const domFragment = this._toDom(data);\n        // Convert DOM DocumentFragment to view DocumentFragment.\n        return this.domConverter.domToView(domFragment, { skipComments: this.skipComments });\n    }\n    /**\n     * Registers a {@link module:engine/view/matcher~MatcherPattern} for view elements whose content should be treated as raw data\n     * and not processed during the conversion from the DOM to the view elements.\n     *\n     * The raw data can be later accessed by a\n     * {@link module:engine/view/element~Element#getCustomProperty custom property of a view element} called `\"$rawContent\"`.\n     *\n     * @param pattern Pattern matching all view elements whose content should be treated as raw data.\n     */\n    registerRawContentMatcher(pattern) {\n        this.domConverter.registerRawContentMatcher(pattern);\n    }\n    /**\n     * If the processor is set to use marked fillers, it will insert `&nbsp;` fillers wrapped in `<span>` elements\n     * (`<span data-cke-filler=\"true\">&nbsp;</span>`) instead of regular `&nbsp;` characters.\n     *\n     * This mode allows for a more precise handling of the block fillers (so they do not leak into the editor content) but\n     * bloats the editor data with additional markup.\n     *\n     * This mode may be required by some features and will be turned on by them automatically.\n     *\n     * @param type Whether to use the default or the marked `&nbsp;` block fillers.\n     */\n    useFillerType(type) {\n        this.domConverter.blockFillerMode = type == 'marked' ? 'markedNbsp' : 'nbsp';\n    }\n    /**\n     * Converts an HTML string to its DOM representation. Returns a document fragment containing nodes parsed from\n     * the provided data.\n     */\n    _toDom(data) {\n        // Wrap data with a <body> tag so leading non-layout nodes (like <script>, <style>, HTML comment)\n        // will be preserved in the body collection.\n        // Do it only for data that is not a full HTML document.\n        if (!data.match(/<(?:html|body|head|meta)(?:\\s[^>]*)?>/i)) {\n            data = `<body>${data}</body>`;\n        }\n        const document = this.domParser.parseFromString(data, 'text/html');\n        const fragment = document.createDocumentFragment();\n        const bodyChildNodes = document.body.childNodes;\n        while (bodyChildNodes.length > 0) {\n            fragment.appendChild(bodyChildNodes[0]);\n        }\n        return fragment;\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/dataprocessor/xmldataprocessor\n */\n/* globals DOMParser */\nimport BasicHtmlWriter from './basichtmlwriter.js';\nimport DomConverter from '../view/domconverter.js';\n/**\n * The XML data processor class.\n * This data processor implementation uses XML as input and output data.\n * This class is needed because unlike HTML, XML allows to use any tag with any value.\n * For example, `<link>Text</link>` is a valid XML but invalid HTML.\n */\nexport default class XmlDataProcessor {\n    /**\n     * Creates a new instance of the XML data processor class.\n     *\n     * @param document The view document instance.\n     * @param options Configuration options.\n     * @param options.namespaces A list of namespaces allowed to use in the XML input.\n     */\n    constructor(document, options = {}) {\n        this.skipComments = true;\n        this.namespaces = options.namespaces || [];\n        this.domParser = new DOMParser();\n        this.domConverter = new DomConverter(document, { renderingMode: 'data' });\n        this.htmlWriter = new BasicHtmlWriter();\n    }\n    /**\n     * Converts the provided {@link module:engine/view/documentfragment~DocumentFragment document fragment}\n     * to data format &ndash; in this case an XML string.\n     *\n     * @returns An XML string.\n     */\n    toData(viewFragment) {\n        // Convert view DocumentFragment to DOM DocumentFragment.\n        const domFragment = this.domConverter.viewToDom(viewFragment);\n        // Convert DOM DocumentFragment to XML output.\n        // There is no need to use dedicated for XML serializing method because BasicHtmlWriter works well in this case.\n        return this.htmlWriter.getHtml(domFragment);\n    }\n    /**\n     * Converts the provided XML string to a view tree.\n     *\n     * @param data An XML string.\n     * @returns A converted view element.\n     */\n    toView(data) {\n        // Convert input XML data to DOM DocumentFragment.\n        const domFragment = this._toDom(data);\n        // Convert DOM DocumentFragment to view DocumentFragment.\n        return this.domConverter.domToView(domFragment, {\n            keepOriginalCase: true,\n            skipComments: this.skipComments\n        });\n    }\n    /**\n     * Registers a {@link module:engine/view/matcher~MatcherPattern} for view elements whose content should be treated as raw data\n     * and not processed during the conversion from XML to view elements.\n     *\n     * The raw data can be later accessed by a\n     * {@link module:engine/view/element~Element#getCustomProperty custom property of a view element} called `\"$rawContent\"`.\n     *\n     * @param pattern Pattern matching all view elements whose content should be treated as raw data.\n     */\n    registerRawContentMatcher(pattern) {\n        this.domConverter.registerRawContentMatcher(pattern);\n    }\n    /**\n     * If the processor is set to use marked fillers, it will insert `&nbsp;` fillers wrapped in `<span>` elements\n     * (`<span data-cke-filler=\"true\">&nbsp;</span>`) instead of regular `&nbsp;` characters.\n     *\n     * This mode allows for a more precise handling of block fillers (so they do not leak into editor content) but\n     * bloats the editor data with additional markup.\n     *\n     * This mode may be required by some features and will be turned on by them automatically.\n     *\n     * @param type Whether to use the default or the marked `&nbsp;` block fillers.\n     */\n    useFillerType(type) {\n        this.domConverter.blockFillerMode = type == 'marked' ? 'markedNbsp' : 'nbsp';\n    }\n    /**\n     * Converts an XML string to its DOM representation. Returns a document fragment containing nodes parsed from\n     * the provided data.\n     */\n    _toDom(data) {\n        // Stringify namespaces.\n        const namespaces = this.namespaces.map(nsp => `xmlns:${nsp}=\"nsp\"`).join(' ');\n        // Wrap data into root element with optional namespace definitions.\n        data = `<xml ${namespaces}>${data}</xml>`;\n        const parsedDocument = this.domParser.parseFromString(data, 'text/xml');\n        // Parse validation.\n        const parserError = parsedDocument.querySelector('parsererror');\n        if (parserError) {\n            throw new Error('Parse error - ' + parserError.textContent);\n        }\n        const fragment = parsedDocument.createDocumentFragment();\n        const nodes = parsedDocument.documentElement.childNodes;\n        while (nodes.length > 0) {\n            fragment.appendChild(nodes[0]);\n        }\n        return fragment;\n    }\n}\n", "/**\n * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n/**\n * @module engine/view/upcastwriter\n */\nimport DocumentFragment from './documentfragment.js';\nimport Element from './element.js';\nimport Text from './text.js';\nimport { isPlainObject } from 'lodash-es';\nimport Position from './position.js';\nimport Range from './range.js';\nimport Selection from './selection.js';\n/**\n * View upcast writer. It provides a set of methods used to manipulate non-semantic view trees.\n *\n * It should be used only while working on a non-semantic view\n * (e.g. a view created from HTML string on paste).\n * To manipulate a view which was or is being downcasted from the the model use the\n * {@link module:engine/view/downcastwriter~DowncastWriter downcast writer}.\n *\n * Read more about changing the view in the {@glink framework/architecture/editing-engine#changing-the-view Changing the view}\n * section of the {@glink framework/architecture/editing-engine Editing engine architecture} guide.\n *\n * Unlike `DowncastWriter`, which is available in the {@link module:engine/view/view~View#change `View#change()`} block,\n * `UpcastWriter` can be created wherever you need it:\n *\n * ```ts\n * const writer = new UpcastWriter( viewDocument );\n * const text = writer.createText( 'foo!' );\n *\n * writer.appendChild( text, someViewElement );\n * ```\n */\nexport default class UpcastWriter {\n    /**\n     * @param document The view document instance in which this upcast writer operates.\n     */\n    constructor(document) {\n        this.document = document;\n    }\n    /**\n     * Creates a new {@link module:engine/view/documentfragment~DocumentFragment} instance.\n     *\n     * @param children A list of nodes to be inserted into the created document fragment.\n     * @returns The created document fragment.\n     */\n    createDocumentFragment(children) {\n        return new DocumentFragment(this.document, children);\n    }\n    /**\n     * Creates a new {@link module:engine/view/element~Element} instance.\n     *\n     * Attributes can be passed in various formats:\n     *\n     * ```ts\n     * upcastWriter.createElement( 'div', { class: 'editor', contentEditable: 'true' } ); // object\n     * upcastWriter.createElement( 'div', [ [ 'class', 'editor' ], [ 'contentEditable', 'true' ] ] ); // map-like iterator\n     * upcastWriter.createElement( 'div', mapOfAttributes ); // map\n     * ```\n     *\n     * @param name Node name.\n     * @param attrs Collection of attributes.\n     * @param children A list of nodes to be inserted into created element.\n     * @returns Created element.\n     */\n    createElement(name, attrs, children) {\n        return new Element(this.document, name, attrs, children);\n    }\n    /**\n     * Creates a new {@link module:engine/view/text~Text} instance.\n     *\n     * @param data The text's data.\n     * @returns The created text node.\n     */\n    createText(data) {\n        return new Text(this.document, data);\n    }\n    /**\n     * Clones the provided element.\n     *\n     * @see module:engine/view/element~Element#_clone\n     * @param element Element to be cloned.\n     * @param deep If set to `true` clones element and all its children recursively. When set to `false`,\n     * element will be cloned without any children.\n     * @returns Clone of this element.\n     */\n    clone(element, deep = false) {\n        return element._clone(deep);\n    }\n    /**\n     * Appends a child node or a list of child nodes at the end of this node\n     * and sets the parent of these nodes to this element.\n     *\n     * @see module:engine/view/element~Element#_appendChild\n     * @param items Items to be inserted.\n     * @param element Element to which items will be appended.\n     * @returns Number of appended nodes.\n     */\n    appendChild(items, element) {\n        return element._appendChild(items);\n    }\n    /**\n     * Inserts a child node or a list of child nodes on the given index and sets the parent of these nodes to\n     * this element.\n     *\n     * @see module:engine/view/element~Element#_insertChild\n     * @param index Offset at which nodes should be inserted.\n     * @param items Items to be inserted.\n     * @param element Element to which items will be inserted.\n     * @returns Number of inserted nodes.\n     */\n    insertChild(index, items, element) {\n        return element._insertChild(index, items);\n    }\n    /**\n     * Removes the given number of child nodes starting at the given index and set the parent of these nodes to `null`.\n     *\n     * @see module:engine/view/element~Element#_removeChildren\n     * @param index Offset from which nodes will be removed.\n     * @param howMany Number of nodes to remove.\n     * @param element Element which children will be removed.\n     * @returns The array containing removed nodes.\n     */\n    removeChildren(index, howMany, element) {\n        return element._removeChildren(index, howMany);\n    }\n    /**\n     * Removes given element from the view structure. Will not have effect on detached elements.\n     *\n     * @param element Element which will be removed.\n     * @returns The array containing removed nodes.\n     */\n    remove(element) {\n        const parent = element.parent;\n        if (parent) {\n            return this.removeChildren(parent.getChildIndex(element), 1, parent);\n        }\n        return [];\n    }\n    /**\n     * Replaces given element with the new one in the view structure. Will not have effect on detached elements.\n     *\n     * @param oldElement Element which will be replaced.\n     * @param newElement Element which will be inserted in the place of the old element.\n     * @returns Whether old element was successfully replaced.\n     */\n    replace(oldElement, newElement) {\n        const parent = oldElement.parent;\n        if (parent) {\n            const index = parent.getChildIndex(oldElement);\n            this.removeChildren(index, 1, parent);\n            this.insertChild(index, newElement, parent);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Removes given element from view structure and places its children in its position.\n     * It does nothing if element has no parent.\n     *\n     * @param element Element to unwrap.\n     */\n    unwrapElement(element) {\n        const parent = element.parent;\n        if (parent) {\n            const index = parent.getChildIndex(element);\n            this.remove(element);\n            this.insertChild(index, element.getChildren(), parent);\n        }\n    }\n    /**\n     * Renames element by creating a copy of a given element but with its name changed and then moving contents of the\n     * old element to the new one.\n     *\n     * Since this function creates a new element and removes the given one, the new element is returned to keep reference.\n     *\n     * @param newName New element name.\n     * @param  element Element to be renamed.\n     * @returns New element or null if the old element was not replaced (happens for detached elements).\n     */\n    rename(newName, element) {\n        const newElement = new Element(this.document, newName, element.getAttributes(), element.getChildren());\n        return this.replace(element, newElement) ? newElement : null;\n    }\n    /**\n     * Adds or overwrites element's attribute with a specified key and value.\n     *\n     * ```ts\n     * writer.setAttribute( 'href', 'http://ckeditor.com', linkElement );\n     * ```\n     *\n     * @see module:engine/view/element~Element#_setAttribute\n     * @param key Attribute key.\n     * @param value Attribute value.\n     * @param element Element for which attribute will be set.\n     */\n    setAttribute(key, value, element) {\n        element._setAttribute(key, value);\n    }\n    /**\n     * Removes attribute from the element.\n     *\n     * ```ts\n     * writer.removeAttribute( 'href', linkElement );\n     * ```\n     *\n     * @see module:engine/view/element~Element#_removeAttribute\n     * @param key Attribute key.\n     * @param element Element from which attribute will be removed.\n     */\n    removeAttribute(key, element) {\n        element._removeAttribute(key);\n    }\n    /**\n     * Adds specified class to the element.\n     *\n     * ```ts\n     * writer.addClass( 'foo', linkElement );\n     * writer.addClass( [ 'foo', 'bar' ], linkElement );\n     * ```\n     *\n     * @see module:engine/view/element~Element#_addClass\n     * @param className Single class name or array of class names which will be added.\n     * @param element Element for which class will be added.\n     */\n    addClass(className, element) {\n        element._addClass(className);\n    }\n    /**\n     * Removes specified class from the element.\n     *\n     * ```ts\n     * writer.removeClass( 'foo', linkElement );\n     * writer.removeClass( [ 'foo', 'bar' ], linkElement );\n     * ```\n     *\n     * @see module:engine/view/element~Element#_removeClass\n     * @param className Single class name or array of class names which will be removed.\n     * @param element Element from which class will be removed.\n     */\n    removeClass(className, element) {\n        element._removeClass(className);\n    }\n    setStyle(property, valueOrElement, element) {\n        if (isPlainObject(property) && element === undefined) {\n            valueOrElement._setStyle(property);\n        }\n        else {\n            element._setStyle(property, valueOrElement);\n        }\n    }\n    /**\n     * Removes specified style from the element.\n     *\n     * ```ts\n     * writer.removeStyle( 'color', element );  // Removes 'color' style.\n     * writer.removeStyle( [ 'color', 'border-top' ], element ); // Removes both 'color' and 'border-top' styles.\n     * ```\n     *\n     * **Note**: This method can work with normalized style names if\n     * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n     * See {@link module:engine/view/stylesmap~StylesMap#remove `StylesMap#remove()`} for details.\n     *\n     * @see module:engine/view/element~Element#_removeStyle\n     * @param property Style property name or names to be removed.\n     * @param element Element from which style will be removed.\n     */\n    removeStyle(property, element) {\n        element._removeStyle(property);\n    }\n    /**\n     * Sets a custom property on element. Unlike attributes, custom properties are not rendered to the DOM,\n     * so they can be used to add special data to elements.\n     *\n     * @see module:engine/view/element~Element#_setCustomProperty\n     * @param key Custom property name/key.\n     * @param value Custom property value to be stored.\n     * @param element Element for which custom property will be set.\n     */\n    setCustomProperty(key, value, element) {\n        element._setCustomProperty(key, value);\n    }\n    /**\n     * Removes a custom property stored under the given key.\n     *\n     * @see module:engine/view/element~Element#_removeCustomProperty\n     * @param key Name/key of the custom property to be removed.\n     * @param element Element from which the custom property will be removed.\n     * @returns Returns true if property was removed.\n     */\n    removeCustomProperty(key, element) {\n        return element._removeCustomProperty(key);\n    }\n    /**\n     * Creates position at the given location. The location can be specified as:\n     *\n     * * a {@link module:engine/view/position~Position position},\n     * * parent element and offset (offset defaults to `0`),\n     * * parent element and `'end'` (sets position at the end of that element),\n     * * {@link module:engine/view/item~Item view item} and `'before'` or `'after'` (sets position before or after given view item).\n     *\n     * This method is a shortcut to other constructors such as:\n     *\n     * * {@link #createPositionBefore},\n     * * {@link #createPositionAfter},\n     *\n     * @param offset Offset or one of the flags. Used only when first parameter is a {@link module:engine/view/item~Item view item}.\n     */\n    createPositionAt(itemOrPosition, offset) {\n        return Position._createAt(itemOrPosition, offset);\n    }\n    /**\n     * Creates a new position after given view item.\n     *\n     * @param item View item after which the position should be located.\n     */\n    createPositionAfter(item) {\n        return Position._createAfter(item);\n    }\n    /**\n     * Creates a new position before given view item.\n     *\n     * @param item View item before which the position should be located.\n     */\n    createPositionBefore(item) {\n        return Position._createBefore(item);\n    }\n    /**\n     * Creates a range spanning from `start` position to `end` position.\n     *\n     * **Note:** This factory method creates it's own {@link module:engine/view/position~Position} instances basing on passed values.\n     *\n     * @param start Start position.\n     * @param end End position. If not set, range will be collapsed at `start` position.\n     */\n    createRange(start, end) {\n        return new Range(start, end);\n    }\n    /**\n     * Creates a range that starts before given {@link module:engine/view/item~Item view item} and ends after it.\n     */\n    createRangeOn(item) {\n        return Range._createOn(item);\n    }\n    /**\n     * Creates a range inside an {@link module:engine/view/element~Element element} which starts before the first child of\n     * that element and ends after the last child of that element.\n     *\n     * @param element Element which is a parent for the range.\n     */\n    createRangeIn(element) {\n        return Range._createIn(element);\n    }\n    createSelection(...args) {\n        return new Selection(...args);\n    }\n}\n", "const {\n  hasOwnProperty,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n} = Object;\n\nlet { freeze, seal, create } = Object; // eslint-disable-line import/no-mutable-exports\nlet { apply, construct } = typeof Reflect !== 'undefined' && Reflect;\n\nif (!apply) {\n  apply = function (fun, thisValue, args) {\n    return fun.apply(thisValue, args);\n  };\n}\n\nif (!freeze) {\n  freeze = function (x) {\n    return x;\n  };\n}\n\nif (!seal) {\n  seal = function (x) {\n    return x;\n  };\n}\n\nif (!construct) {\n  construct = function (Func, args) {\n    return new Func(...args);\n  };\n}\n\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayIndexOf = unapply(Array.prototype.indexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySlice = unapply(Array.prototype.slice);\n\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\n\nconst regExpTest = unapply(RegExp.prototype.test);\n\nconst typeErrorCreate = unconstruct(TypeError);\n\nexport function unapply(func) {\n  return (thisArg, ...args) => apply(func, thisArg, args);\n}\n\nexport function unconstruct(func) {\n  return (...args) => construct(func, args);\n}\n\n/* Add properties to a lookup table */\nexport function addToSet(set, array, transformCaseFunc) {\n  transformCaseFunc = transformCaseFunc ?? stringToLowerCase;\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n\n        element = lcElement;\n      }\n    }\n\n    set[element] = true;\n  }\n\n  return set;\n}\n\n/* Shallow clone an object */\nexport function clone(object) {\n  const newObject = create(null);\n\n  let property;\n  for (property in object) {\n    if (apply(hasOwnProperty, object, [property]) === true) {\n      newObject[property] = object[property];\n    }\n  }\n\n  return newObject;\n}\n\n/* IE10 doesn't support __lookupGetter__ so lets'\n * simulate it. It also automatically checks\n * if the prop is function or getter and behaves\n * accordingly. */\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n\n    object = getPrototypeOf(object);\n  }\n\n  function fallbackValue(element) {\n    console.warn('fallback value for', element);\n    return null;\n  }\n\n  return fallbackValue;\n}\n\nexport {\n  // Array\n  arrayForEach,\n  arrayIndexOf,\n  arrayPop,\n  arrayPush,\n  arraySlice,\n  // Object\n  freeze,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n  hasOwnProperty,\n  isFrozen,\n  setPrototypeOf,\n  seal,\n  // RegExp\n  regExpTest,\n  // String\n  stringIndexOf,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringTrim,\n  // Errors\n  typeErrorCreate,\n  // Other\n  lookupGetter,\n};\n", "import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'a',\n  'abbr',\n  'acronym',\n  'address',\n  'area',\n  'article',\n  'aside',\n  'audio',\n  'b',\n  'bdi',\n  'bdo',\n  'big',\n  'blink',\n  'blockquote',\n  'body',\n  'br',\n  'button',\n  'canvas',\n  'caption',\n  'center',\n  'cite',\n  'code',\n  'col',\n  'colgroup',\n  'content',\n  'data',\n  'datalist',\n  'dd',\n  'decorator',\n  'del',\n  'details',\n  'dfn',\n  'dialog',\n  'dir',\n  'div',\n  'dl',\n  'dt',\n  'element',\n  'em',\n  'fieldset',\n  'figcaption',\n  'figure',\n  'font',\n  'footer',\n  'form',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'head',\n  'header',\n  'hgroup',\n  'hr',\n  'html',\n  'i',\n  'img',\n  'input',\n  'ins',\n  'kbd',\n  'label',\n  'legend',\n  'li',\n  'main',\n  'map',\n  'mark',\n  'marquee',\n  'menu',\n  'menuitem',\n  'meter',\n  'nav',\n  'nobr',\n  'ol',\n  'optgroup',\n  'option',\n  'output',\n  'p',\n  'picture',\n  'pre',\n  'progress',\n  'q',\n  'rp',\n  'rt',\n  'ruby',\n  's',\n  'samp',\n  'section',\n  'select',\n  'shadow',\n  'small',\n  'source',\n  'spacer',\n  'span',\n  'strike',\n  'strong',\n  'style',\n  'sub',\n  'summary',\n  'sup',\n  'table',\n  'tbody',\n  'td',\n  'template',\n  'textarea',\n  'tfoot',\n  'th',\n  'thead',\n  'time',\n  'tr',\n  'track',\n  'tt',\n  'u',\n  'ul',\n  'var',\n  'video',\n  'wbr',\n]);\n\n// SVG\nexport const svg = freeze([\n  'svg',\n  'a',\n  'altglyph',\n  'altglyphdef',\n  'altglyphitem',\n  'animatecolor',\n  'animatemotion',\n  'animatetransform',\n  'circle',\n  'clippath',\n  'defs',\n  'desc',\n  'ellipse',\n  'filter',\n  'font',\n  'g',\n  'glyph',\n  'glyphref',\n  'hkern',\n  'image',\n  'line',\n  'lineargradient',\n  'marker',\n  'mask',\n  'metadata',\n  'mpath',\n  'path',\n  'pattern',\n  'polygon',\n  'polyline',\n  'radialgradient',\n  'rect',\n  'stop',\n  'style',\n  'switch',\n  'symbol',\n  'text',\n  'textpath',\n  'title',\n  'tref',\n  'tspan',\n  'view',\n  'vkern',\n]);\n\nexport const svgFilters = freeze([\n  'feBlend',\n  'feColorMatrix',\n  'feComponentTransfer',\n  'feComposite',\n  'feConvolveMatrix',\n  'feDiffuseLighting',\n  'feDisplacementMap',\n  'feDistantLight',\n  'feFlood',\n  'feFuncA',\n  'feFuncB',\n  'feFuncG',\n  'feFuncR',\n  'feGaussianBlur',\n  'feImage',\n  'feMerge',\n  'feMergeNode',\n  'feMorphology',\n  'feOffset',\n  'fePointLight',\n  'feSpecularLighting',\n  'feSpotLight',\n  'feTile',\n  'feTurbulence',\n]);\n\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nexport const svgDisallowed = freeze([\n  'animate',\n  'color-profile',\n  'cursor',\n  'discard',\n  'fedropshadow',\n  'font-face',\n  'font-face-format',\n  'font-face-name',\n  'font-face-src',\n  'font-face-uri',\n  'foreignobject',\n  'hatch',\n  'hatchpath',\n  'mesh',\n  'meshgradient',\n  'meshpatch',\n  'meshrow',\n  'missing-glyph',\n  'script',\n  'set',\n  'solidcolor',\n  'unknown',\n  'use',\n]);\n\nexport const mathMl = freeze([\n  'math',\n  'menclose',\n  'merror',\n  'mfenced',\n  'mfrac',\n  'mglyph',\n  'mi',\n  'mlabeledtr',\n  'mmultiscripts',\n  'mn',\n  'mo',\n  'mover',\n  'mpadded',\n  'mphantom',\n  'mroot',\n  'mrow',\n  'ms',\n  'mspace',\n  'msqrt',\n  'mstyle',\n  'msub',\n  'msup',\n  'msubsup',\n  'mtable',\n  'mtd',\n  'mtext',\n  'mtr',\n  'munder',\n  'munderover',\n]);\n\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nexport const mathMlDisallowed = freeze([\n  'maction',\n  'maligngroup',\n  'malignmark',\n  'mlongdiv',\n  'mscarries',\n  'mscarry',\n  'msgroup',\n  'mstack',\n  'msline',\n  'msrow',\n  'semantics',\n  'annotation',\n  'annotation-xml',\n  'mprescripts',\n  'none',\n]);\n\nexport const text = freeze(['#text']);\n", "import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'accept',\n  'action',\n  'align',\n  'alt',\n  'autocapitalize',\n  'autocomplete',\n  'autopictureinpicture',\n  'autoplay',\n  'background',\n  'bgcolor',\n  'border',\n  'capture',\n  'cellpadding',\n  'cellspacing',\n  'checked',\n  'cite',\n  'class',\n  'clear',\n  'color',\n  'cols',\n  'colspan',\n  'controls',\n  'controlslist',\n  'coords',\n  'crossorigin',\n  'datetime',\n  'decoding',\n  'default',\n  'dir',\n  'disabled',\n  'disablepictureinpicture',\n  'disableremoteplayback',\n  'download',\n  'draggable',\n  'enctype',\n  'enterkeyhint',\n  'face',\n  'for',\n  'headers',\n  'height',\n  'hidden',\n  'high',\n  'href',\n  'hreflang',\n  'id',\n  'inputmode',\n  'integrity',\n  'ismap',\n  'kind',\n  'label',\n  'lang',\n  'list',\n  'loading',\n  'loop',\n  'low',\n  'max',\n  'maxlength',\n  'media',\n  'method',\n  'min',\n  'minlength',\n  'multiple',\n  'muted',\n  'name',\n  'nonce',\n  'noshade',\n  'novalidate',\n  'nowrap',\n  'open',\n  'optimum',\n  'pattern',\n  'placeholder',\n  'playsinline',\n  'poster',\n  'preload',\n  'pubdate',\n  'radiogroup',\n  'readonly',\n  'rel',\n  'required',\n  'rev',\n  'reversed',\n  'role',\n  'rows',\n  'rowspan',\n  'spellcheck',\n  'scope',\n  'selected',\n  'shape',\n  'size',\n  'sizes',\n  'span',\n  'srclang',\n  'start',\n  'src',\n  'srcset',\n  'step',\n  'style',\n  'summary',\n  'tabindex',\n  'title',\n  'translate',\n  'type',\n  'usemap',\n  'valign',\n  'value',\n  'width',\n  'xmlns',\n  'slot',\n]);\n\nexport const svg = freeze([\n  'accent-height',\n  'accumulate',\n  'additive',\n  'alignment-baseline',\n  'ascent',\n  'attributename',\n  'attributetype',\n  'azimuth',\n  'basefrequency',\n  'baseline-shift',\n  'begin',\n  'bias',\n  'by',\n  'class',\n  'clip',\n  'clippathunits',\n  'clip-path',\n  'clip-rule',\n  'color',\n  'color-interpolation',\n  'color-interpolation-filters',\n  'color-profile',\n  'color-rendering',\n  'cx',\n  'cy',\n  'd',\n  'dx',\n  'dy',\n  'diffuseconstant',\n  'direction',\n  'display',\n  'divisor',\n  'dur',\n  'edgemode',\n  'elevation',\n  'end',\n  'fill',\n  'fill-opacity',\n  'fill-rule',\n  'filter',\n  'filterunits',\n  'flood-color',\n  'flood-opacity',\n  'font-family',\n  'font-size',\n  'font-size-adjust',\n  'font-stretch',\n  'font-style',\n  'font-variant',\n  'font-weight',\n  'fx',\n  'fy',\n  'g1',\n  'g2',\n  'glyph-name',\n  'glyphref',\n  'gradientunits',\n  'gradienttransform',\n  'height',\n  'href',\n  'id',\n  'image-rendering',\n  'in',\n  'in2',\n  'k',\n  'k1',\n  'k2',\n  'k3',\n  'k4',\n  'kerning',\n  'keypoints',\n  'keysplines',\n  'keytimes',\n  'lang',\n  'lengthadjust',\n  'letter-spacing',\n  'kernelmatrix',\n  'kernelunitlength',\n  'lighting-color',\n  'local',\n  'marker-end',\n  'marker-mid',\n  'marker-start',\n  'markerheight',\n  'markerunits',\n  'markerwidth',\n  'maskcontentunits',\n  'maskunits',\n  'max',\n  'mask',\n  'media',\n  'method',\n  'mode',\n  'min',\n  'name',\n  'numoctaves',\n  'offset',\n  'operator',\n  'opacity',\n  'order',\n  'orient',\n  'orientation',\n  'origin',\n  'overflow',\n  'paint-order',\n  'path',\n  'pathlength',\n  'patterncontentunits',\n  'patterntransform',\n  'patternunits',\n  'points',\n  'preservealpha',\n  'preserveaspectratio',\n  'primitiveunits',\n  'r',\n  'rx',\n  'ry',\n  'radius',\n  'refx',\n  'refy',\n  'repeatcount',\n  'repeatdur',\n  'restart',\n  'result',\n  'rotate',\n  'scale',\n  'seed',\n  'shape-rendering',\n  'specularconstant',\n  'specularexponent',\n  'spreadmethod',\n  'startoffset',\n  'stddeviation',\n  'stitchtiles',\n  'stop-color',\n  'stop-opacity',\n  'stroke-dasharray',\n  'stroke-dashoffset',\n  'stroke-linecap',\n  'stroke-linejoin',\n  'stroke-miterlimit',\n  'stroke-opacity',\n  'stroke',\n  'stroke-width',\n  'style',\n  'surfacescale',\n  'systemlanguage',\n  'tabindex',\n  'targetx',\n  'targety',\n  'transform',\n  'transform-origin',\n  'text-anchor',\n  'text-decoration',\n  'text-rendering',\n  'textlength',\n  'type',\n  'u1',\n  'u2',\n  'unicode',\n  'values',\n  'viewbox',\n  'visibility',\n  'version',\n  'vert-adv-y',\n  'vert-origin-x',\n  'vert-origin-y',\n  'width',\n  'word-spacing',\n  'wrap',\n  'writing-mode',\n  'xchannelselector',\n  'ychannelselector',\n  'x',\n  'x1',\n  'x2',\n  'xmlns',\n  'y',\n  'y1',\n  'y2',\n  'z',\n  'zoomandpan',\n]);\n\nexport const mathMl = freeze([\n  'accent',\n  'accentunder',\n  'align',\n  'bevelled',\n  'close',\n  'columnsalign',\n  'columnlines',\n  'columnspan',\n  'denomalign',\n  'depth',\n  'dir',\n  'display',\n  'displaystyle',\n  'encoding',\n  'fence',\n  'frame',\n  'height',\n  'href',\n  'id',\n  'largeop',\n  'length',\n  'linethickness',\n  'lspace',\n  'lquote',\n  'mathbackground',\n  'mathcolor',\n  'mathsize',\n  'mathvariant',\n  'maxsize',\n  'minsize',\n  'movablelimits',\n  'notation',\n  'numalign',\n  'open',\n  'rowalign',\n  'rowlines',\n  'rowspacing',\n  'rowspan',\n  'rspace',\n  'rquote',\n  'scriptlevel',\n  'scriptminsize',\n  'scriptsizemultiplier',\n  'selection',\n  'separator',\n  'separators',\n  'stretchy',\n  'subscriptshift',\n  'supscriptshift',\n  'symmetric',\n  'voffset',\n  'width',\n  'xmlns',\n]);\n\nexport const xml = freeze([\n  'xlink:href',\n  'xml:id',\n  'xlink:title',\n  'xml:space',\n  'xmlns:xlink',\n]);\n", "import { seal } from './utils.js';\n\n// eslint-disable-next-line unicorn/better-regex\nexport const MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nexport const ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nexport const TMPLIT_EXPR = seal(/\\${[\\w\\W]*}/gm);\nexport const DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]/); // eslint-disable-line no-useless-escape\nexport const ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nexport const IS_ALLOWED_URI = seal(\n  /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nexport const IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nexport const ATTR_WHITESPACE = seal(\n  /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nexport const DOCTYPE_NAME = seal(/^html$/i);\n", "import * as TAGS from './tags.js';\nimport * as ATTRS from './attrs.js';\nimport * as EXPRESSIONS from './regexp.js';\nimport {\n  addToSet,\n  clone,\n  freeze,\n  arrayForEach,\n  arrayPop,\n  arrayPush,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringIndexOf,\n  stringTrim,\n  regExpTest,\n  typeErrorCreate,\n  lookupGetter,\n} from './utils.js';\n\nconst getGlobal = () => (typeof window === 'undefined' ? null : window);\n\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param {?TrustedTypePolicyFactory} trustedTypes The policy factory.\n * @param {Document} document The document object (to determine policy name suffix)\n * @return {?TrustedTypePolicy} The policy created (or null, if Trusted Types\n * are not supported).\n */\nconst _createTrustedTypesPolicy = function (trustedTypes, document) {\n  if (\n    typeof trustedTypes !== 'object' ||\n    typeof trustedTypes.createPolicy !== 'function'\n  ) {\n    return null;\n  }\n\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (\n    document.currentScript &&\n    document.currentScript.hasAttribute(ATTR_NAME)\n  ) {\n    suffix = document.currentScript.getAttribute(ATTR_NAME);\n  }\n\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      },\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn(\n      'TrustedTypes policy ' + policyName + ' could not be created.'\n    );\n    return null;\n  }\n};\n\nfunction createDOMPurify(window = getGlobal()) {\n  const DOMPurify = (root) => createDOMPurify(root);\n\n  /**\n   * Version label, exposed for easier checks\n   * if DOMPurify is up to date or not\n   */\n  DOMPurify.version = VERSION;\n\n  /**\n   * Array of elements that DOMPurify removed during sanitation.\n   * Empty if nothing was removed.\n   */\n  DOMPurify.removed = [];\n\n  if (!window || !window.document || window.document.nodeType !== 9) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n\n    return DOMPurify;\n  }\n\n  const originalDocument = window.document;\n\n  let { document } = window;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes,\n  } = window;\n\n  const ElementPrototype = Element.prototype;\n\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n\n  const trustedTypesPolicy = _createTrustedTypesPolicy(\n    trustedTypes,\n    originalDocument\n  );\n  const emptyHTML = trustedTypesPolicy ? trustedTypesPolicy.createHTML('') : '';\n\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName,\n  } = document;\n  const { importNode } = originalDocument;\n\n  let documentMode = {};\n  try {\n    documentMode = clone(document).documentMode ? document.documentMode : {};\n  } catch (_) {}\n\n  let hooks = {};\n\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported =\n    typeof getParentNode === 'function' &&\n    implementation &&\n    implementation.createHTMLDocument !== undefined &&\n    documentMode !== 9;\n\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n  } = EXPRESSIONS;\n\n  let { IS_ALLOWED_URI } = EXPRESSIONS;\n\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [\n    ...TAGS.html,\n    ...TAGS.svg,\n    ...TAGS.svgFilters,\n    ...TAGS.mathMl,\n    ...TAGS.text,\n  ]);\n\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [\n    ...ATTRS.html,\n    ...ATTRS.svg,\n    ...ATTRS.mathMl,\n    ...ATTRS.xml,\n  ]);\n\n  /*\n   * Configure how DOMPUrify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(\n    Object.create(null, {\n      tagNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      attributeNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      allowCustomizedBuiltInElements: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: false,\n      },\n    })\n  );\n\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES = {};\n\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, [\n    'annotation-xml',\n    'audio',\n    'colgroup',\n    'desc',\n    'foreignobject',\n    'head',\n    'iframe',\n    'math',\n    'mi',\n    'mn',\n    'mo',\n    'ms',\n    'mtext',\n    'noembed',\n    'noframes',\n    'noscript',\n    'plaintext',\n    'script',\n    'style',\n    'svg',\n    'template',\n    'thead',\n    'title',\n    'video',\n    'xmp',\n  ]);\n\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, [\n    'audio',\n    'video',\n    'img',\n    'source',\n    'image',\n    'track',\n  ]);\n\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, [\n    'alt',\n    'class',\n    'for',\n    'id',\n    'label',\n    'name',\n    'pattern',\n    'placeholder',\n    'role',\n    'summary',\n    'title',\n    'value',\n    'style',\n    'xmlns',\n  ]);\n\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet(\n    {},\n    [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE],\n    stringToString\n  );\n\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc;\n\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG = null;\n\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n\n  const formElement = document.createElement('form');\n\n  const isRegexOrFunction = function (testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n\n  /**\n   * _parseConfig\n   *\n   * @param  {Object} cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function (cfg) {\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n\n    PARSER_MEDIA_TYPE =\n      // eslint-disable-next-line unicorn/prefer-includes\n      SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1\n        ? (PARSER_MEDIA_TYPE = DEFAULT_PARSER_MEDIA_TYPE)\n        : (PARSER_MEDIA_TYPE = cfg.PARSER_MEDIA_TYPE);\n\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc =\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml'\n        ? stringToString\n        : stringToLowerCase;\n\n    /* Set configuration parameters */\n    ALLOWED_TAGS =\n      'ALLOWED_TAGS' in cfg\n        ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc)\n        : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR =\n      'ALLOWED_ATTR' in cfg\n        ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc)\n        : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES =\n      'ALLOWED_NAMESPACES' in cfg\n        ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString)\n        : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES =\n      'ADD_URI_SAFE_ATTR' in cfg\n        ? addToSet(\n            clone(DEFAULT_URI_SAFE_ATTRIBUTES), // eslint-disable-line indent\n            cfg.ADD_URI_SAFE_ATTR, // eslint-disable-line indent\n            transformCaseFunc // eslint-disable-line indent\n          ) // eslint-disable-line indent\n        : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS =\n      'ADD_DATA_URI_TAGS' in cfg\n        ? addToSet(\n            clone(DEFAULT_DATA_URI_TAGS), // eslint-disable-line indent\n            cfg.ADD_DATA_URI_TAGS, // eslint-disable-line indent\n            transformCaseFunc // eslint-disable-line indent\n          ) // eslint-disable-line indent\n        : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS =\n      'FORBID_CONTENTS' in cfg\n        ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc)\n        : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS =\n      'FORBID_TAGS' in cfg\n        ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc)\n        : {};\n    FORBID_ATTR =\n      'FORBID_ATTR' in cfg\n        ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc)\n        : {};\n    USE_PROFILES = 'USE_PROFILES' in cfg ? cfg.USE_PROFILES : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements ===\n        'boolean'\n    ) {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements =\n        cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, [...TAGS.text]);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, TAGS.html);\n        addToSet(ALLOWED_ATTR, ATTRS.html);\n      }\n\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svgFilters);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, TAGS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n    }\n\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n        ALLOWED_TAGS = clone(ALLOWED_TAGS);\n      }\n\n      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n    }\n\n    if (cfg.ADD_ATTR) {\n      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n        ALLOWED_ATTR = clone(ALLOWED_ATTR);\n      }\n\n      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n\n    CONFIG = cfg;\n  };\n\n  const MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, [\n    'mi',\n    'mo',\n    'mn',\n    'ms',\n    'mtext',\n  ]);\n\n  const HTML_INTEGRATION_POINTS = addToSet({}, [\n    'foreignobject',\n    'desc',\n    'title',\n    'annotation-xml',\n  ]);\n\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, [\n    'title',\n    'style',\n    'font',\n    'a',\n    'script',\n  ]);\n\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, TAGS.svg);\n  addToSet(ALL_SVG_TAGS, TAGS.svgFilters);\n  addToSet(ALL_SVG_TAGS, TAGS.svgDisallowed);\n\n  const ALL_MATHML_TAGS = addToSet({}, TAGS.mathMl);\n  addToSet(ALL_MATHML_TAGS, TAGS.mathMlDisallowed);\n\n  /**\n   *\n   *\n   * @param  {Element} element a DOM element whose namespace is being checked\n   * @returns {boolean} Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function (element) {\n    let parent = getParentNode(element);\n\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template',\n      };\n    }\n\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return (\n          tagName === 'svg' &&\n          (parentTagName === 'annotation-xml' ||\n            MATHML_TEXT_INTEGRATION_POINTS[parentTagName])\n        );\n      }\n\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (\n        parent.namespaceURI === SVG_NAMESPACE &&\n        !HTML_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      if (\n        parent.namespaceURI === MATHML_NAMESPACE &&\n        !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return (\n        !ALL_MATHML_TAGS[tagName] &&\n        (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName])\n      );\n    }\n\n    // For XHTML and XML documents that support custom namespaces\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      ALLOWED_NAMESPACES[element.namespaceURI]\n    ) {\n      return true;\n    }\n\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n\n  /**\n   * _forceRemove\n   *\n   * @param  {Node} node a DOM node\n   */\n  const _forceRemove = function (node) {\n    arrayPush(DOMPurify.removed, { element: node });\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      node.parentNode.removeChild(node);\n    } catch (_) {\n      try {\n        node.outerHTML = emptyHTML;\n      } catch (_) {\n        node.remove();\n      }\n    }\n  };\n\n  /**\n   * _removeAttribute\n   *\n   * @param  {String} name an Attribute name\n   * @param  {Node} node a DOM node\n   */\n  const _removeAttribute = function (name, node) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: node.getAttributeNode(name),\n        from: node,\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: node,\n      });\n    }\n\n    node.removeAttribute(name);\n\n    // We void attribute values for unremovable \"is\"\" attributes\n    if (name === 'is' && !ALLOWED_ATTR[name]) {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(node);\n        } catch (_) {}\n      } else {\n        try {\n          node.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n\n  /**\n   * _initDocument\n   *\n   * @param  {String} dirty a string of dirty markup\n   * @return {Document} a DOM, filled with the dirty markup\n   */\n  const _initDocument = function (dirty) {\n    /* Create a HTML document */\n    let doc;\n    let leadingWhitespace;\n\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      NAMESPACE === HTML_NAMESPACE\n    ) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty =\n        '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' +\n        dirty +\n        '</body></html>';\n    }\n\n    const dirtyPayload = trustedTypesPolicy\n      ? trustedTypesPolicy.createHTML(dirty)\n      : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT\n          ? emptyHTML\n          : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n\n    const body = doc.body || doc.documentElement;\n\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(\n        document.createTextNode(leadingWhitespace),\n        body.childNodes[0] || null\n      );\n    }\n\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(\n        doc,\n        WHOLE_DOCUMENT ? 'html' : 'body'\n      )[0];\n    }\n\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n\n  /**\n   * _createIterator\n   *\n   * @param  {Document} root document/fragment to create iterator for\n   * @return {Iterator} iterator instance\n   */\n  const _createIterator = function (root) {\n    return createNodeIterator.call(\n      root.ownerDocument || root,\n      root,\n      // eslint-disable-next-line no-bitwise\n      NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT,\n      null,\n      false\n    );\n  };\n\n  /**\n   * _isClobbered\n   *\n   * @param  {Node} elm element to check for clobbering attacks\n   * @return {Boolean} true if clobbered, false if safe\n   */\n  const _isClobbered = function (elm) {\n    return (\n      elm instanceof HTMLFormElement &&\n      (typeof elm.nodeName !== 'string' ||\n        typeof elm.textContent !== 'string' ||\n        typeof elm.removeChild !== 'function' ||\n        !(elm.attributes instanceof NamedNodeMap) ||\n        typeof elm.removeAttribute !== 'function' ||\n        typeof elm.setAttribute !== 'function' ||\n        typeof elm.namespaceURI !== 'string' ||\n        typeof elm.insertBefore !== 'function' ||\n        typeof elm.hasChildNodes !== 'function')\n    );\n  };\n\n  /**\n   * _isNode\n   *\n   * @param  {Node} obj object to check whether it's a DOM node\n   * @return {Boolean} true is object is a DOM node\n   */\n  const _isNode = function (object) {\n    return typeof Node === 'object'\n      ? object instanceof Node\n      : object &&\n          typeof object === 'object' &&\n          typeof object.nodeType === 'number' &&\n          typeof object.nodeName === 'string';\n  };\n\n  /**\n   * _executeHook\n   * Execute user configurable hooks\n   *\n   * @param  {String} entryPoint  Name of the hook's entry point\n   * @param  {Node} currentNode node to work on with the hook\n   * @param  {Object} data additional hook parameters\n   */\n  const _executeHook = function (entryPoint, currentNode, data) {\n    if (!hooks[entryPoint]) {\n      return;\n    }\n\n    arrayForEach(hooks[entryPoint], (hook) => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  };\n\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   *\n   * @param   {Node} currentNode to check for permission to exist\n   * @return  {Boolean} true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function (currentNode) {\n    let content;\n\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeElements', currentNode, null);\n\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Check if tagname contains Unicode */\n    if (regExpTest(/[\\u0080-\\uFFFF]/, currentNode.nodeName)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n\n    /* Execute a hook if present */\n    _executeHook('uponSanitizeElement', currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS,\n    });\n\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (\n      currentNode.hasChildNodes() &&\n      !_isNode(currentNode.firstElementChild) &&\n      (!_isNode(currentNode.content) ||\n        !_isNode(currentNode.content.firstElementChild)) &&\n      regExpTest(/<[/\\w]/g, currentNode.innerHTML) &&\n      regExpTest(/<[/\\w]/g, currentNode.textContent)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Mitigate a problem with templates inside select */\n    if (\n      tagName === 'select' &&\n      regExpTest(/<template/i, currentNode.innerHTML)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove element if anything forbids its presence */\n    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _basicCustomElementTest(tagName)) {\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n          regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)\n        )\n          return false;\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)\n        )\n          return false;\n      }\n\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n\n          for (let i = childCount - 1; i >= 0; --i) {\n            parentNode.insertBefore(\n              cloneNode(childNodes[i], true),\n              getNextSibling(currentNode)\n            );\n          }\n        }\n      }\n\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if (\n      (tagName === 'noscript' ||\n        tagName === 'noembed' ||\n        tagName === 'noframes') &&\n      regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n      content = stringReplace(content, MUSTACHE_EXPR, ' ');\n      content = stringReplace(content, ERB_EXPR, ' ');\n      content = stringReplace(content, TMPLIT_EXPR, ' ');\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, { element: currentNode.cloneNode() });\n        currentNode.textContent = content;\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeElements', currentNode, null);\n\n    return false;\n  };\n\n  /**\n   * _isValidAttribute\n   *\n   * @param  {string} lcTag Lowercase tag name of containing element.\n   * @param  {string} lcName Lowercase attribute name.\n   * @param  {string} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function (lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (\n      SANITIZE_DOM &&\n      (lcName === 'id' || lcName === 'name') &&\n      (value in document || value in formElement)\n    ) {\n      return false;\n    }\n\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (\n      ALLOW_DATA_ATTR &&\n      !FORBID_ATTR[lcName] &&\n      regExpTest(DATA_ATTR, lcName)\n    ) {\n      // This attribute is safe\n    } else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) {\n      // This attribute is safe\n      /* Otherwise, check the name is permitted */\n    } else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n        // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n        // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n        (_basicCustomElementTest(lcTag) &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))) &&\n          ((CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName)) ||\n            (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)))) ||\n        // Alternative, second condition checks if it's an `is`-attribute, AND\n        // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        (lcName === 'is' &&\n          CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))))\n      ) {\n        // If user has supplied a regexp or function in CUSTOM_ELEMENT_HANDLING.tagNameCheck, we need to also allow derived custom elements using the same tagName test.\n        // Additionally, we need to allow attributes passing the CUSTOM_ELEMENT_HANDLING.attributeNameCheck user has configured, as custom elements can define these at their own discretion.\n      } else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) {\n      // This attribute is safe\n      /* Check no script, data or unknown possibly unsafe URI\n        unless we know URI values are safe for that attribute */\n    } else if (\n      regExpTest(IS_ALLOWED_URI, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Keep image data URIs alive if src/xlink:href is allowed */\n      /* Further prevent gadget XSS for dynamically built script tags */\n    } else if (\n      (lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') &&\n      lcTag !== 'script' &&\n      stringIndexOf(value, 'data:') === 0 &&\n      DATA_URI_TAGS[lcTag]\n    ) {\n      // This attribute is safe\n      /* Allow unknown protocols: This provides support for links that\n        are handled by protocol handlers which may be unknown ahead of\n        time, e.g. fb:, spotify: */\n    } else if (\n      ALLOW_UNKNOWN_PROTOCOLS &&\n      !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Check for binary attributes */\n    } else if (value) {\n      return false;\n    } else {\n      // Binary attributes are safe at this point\n      /* Anything else, presume unsafe, do not add it back */\n    }\n\n    return true;\n  };\n\n  /**\n   * _basicCustomElementCheck\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   * @param {string} tagName name of the tag of the node to sanitize\n   */\n  const _basicCustomElementTest = function (tagName) {\n    return tagName.indexOf('-') > 0;\n  };\n\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param  {Node} currentNode to sanitize\n   */\n  const _sanitizeAttributes = function (currentNode) {\n    let attr;\n    let value;\n    let lcName;\n    let l;\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeAttributes', currentNode, null);\n\n    const { attributes } = currentNode;\n\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes) {\n      return;\n    }\n\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n    };\n    l = attributes.length;\n\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      attr = attributes[l];\n      const { name, namespaceURI } = attr;\n      value = name === 'value' ? attr.value : stringTrim(attr.value);\n      lcName = transformCaseFunc(name);\n\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHook('uponSanitizeAttribute', currentNode, hookEvent);\n      value = hookEvent.attrValue;\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n\n      /* Remove attribute */\n      _removeAttribute(name, currentNode);\n\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        continue;\n      }\n\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        value = stringReplace(value, MUSTACHE_EXPR, ' ');\n        value = stringReplace(value, ERB_EXPR, ' ');\n        value = stringReplace(value, TMPLIT_EXPR, ' ');\n      }\n\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        continue;\n      }\n\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n\n      /* Handle attributes that require Trusted Types */\n      if (\n        trustedTypesPolicy &&\n        typeof trustedTypes === 'object' &&\n        typeof trustedTypes.getAttributeType === 'function'\n      ) {\n        if (namespaceURI) {\n          /* Namespaces are not yet supported, see https://bugs.chromium.org/p/chromium/issues/detail?id=1305293 */\n        } else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML': {\n              value = trustedTypesPolicy.createHTML(value);\n              break;\n            }\n\n            case 'TrustedScriptURL': {\n              value = trustedTypesPolicy.createScriptURL(value);\n              break;\n            }\n\n            default: {\n              break;\n            }\n          }\n        }\n      }\n\n      /* Handle invalid data-* attribute set by try-catching it */\n      try {\n        if (namespaceURI) {\n          currentNode.setAttributeNS(namespaceURI, name, value);\n        } else {\n          /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n          currentNode.setAttribute(name, value);\n        }\n\n        arrayPop(DOMPurify.removed);\n      } catch (_) {}\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeAttributes', currentNode, null);\n  };\n\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param  {DocumentFragment} fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function (fragment) {\n    let shadowNode;\n    const shadowIterator = _createIterator(fragment);\n\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeShadowDOM', fragment, null);\n\n    while ((shadowNode = shadowIterator.nextNode())) {\n      /* Execute a hook if present */\n      _executeHook('uponSanitizeShadowNode', shadowNode, null);\n\n      /* Sanitize tags and elements */\n      if (_sanitizeElements(shadowNode)) {\n        continue;\n      }\n\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n\n      /* Check attributes, sanitize if necessary */\n      _sanitizeAttributes(shadowNode);\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeShadowDOM', fragment, null);\n  };\n\n  /**\n   * Sanitize\n   * Public method providing core sanitation functionality\n   *\n   * @param {String|Node} dirty string or DOM node\n   * @param {Object} configuration object\n   */\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty, cfg = {}) {\n    let body;\n    let importedNode;\n    let currentNode;\n    let oldNode;\n    let returnNode;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n\n    /* Check we can run. Otherwise fall back or ignore */\n    if (!DOMPurify.isSupported) {\n      if (\n        typeof window.toStaticHTML === 'object' ||\n        typeof window.toStaticHTML === 'function'\n      ) {\n        if (typeof dirty === 'string') {\n          return window.toStaticHTML(dirty);\n        }\n\n        if (_isNode(dirty)) {\n          return window.toStaticHTML(dirty.outerHTML);\n        }\n      }\n\n      return dirty;\n    }\n\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        const tagName = transformCaseFunc(dirty.nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate(\n            'root node is forbidden and cannot be sanitized in-place'\n          );\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (\n        !RETURN_DOM &&\n        !SAFE_FOR_TEMPLATES &&\n        !WHOLE_DOCUMENT &&\n        // eslint-disable-next-line unicorn/prefer-includes\n        dirty.indexOf('<') === -1\n      ) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n          ? trustedTypesPolicy.createHTML(dirty)\n          : dirty;\n      }\n\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n\n    /* Get node iterator */\n    const nodeIterator = _createIterator(IN_PLACE ? dirty : body);\n\n    /* Now start iterating over the created document */\n    while ((currentNode = nodeIterator.nextNode())) {\n      /* Fix IE's strange behavior with manipulated textNodes #89 */\n      if (currentNode.nodeType === 3 && currentNode === oldNode) {\n        continue;\n      }\n\n      /* Sanitize tags and elements */\n      if (_sanitizeElements(currentNode)) {\n        continue;\n      }\n\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n\n      /* Check attributes, sanitize if necessary */\n      _sanitizeAttributes(currentNode);\n\n      oldNode = currentNode;\n    }\n\n    oldNode = null;\n\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmod) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n\n      return returnNode;\n    }\n\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n\n    /* Serialize doctype if allowed */\n    if (\n      WHOLE_DOCUMENT &&\n      ALLOWED_TAGS['!doctype'] &&\n      body.ownerDocument &&\n      body.ownerDocument.doctype &&\n      body.ownerDocument.doctype.name &&\n      regExpTest(EXPRESSIONS.DOCTYPE_NAME, body.ownerDocument.doctype.name)\n    ) {\n      serializedHTML =\n        '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      serializedHTML = stringReplace(serializedHTML, MUSTACHE_EXPR, ' ');\n      serializedHTML = stringReplace(serializedHTML, ERB_EXPR, ' ');\n      serializedHTML = stringReplace(serializedHTML, TMPLIT_EXPR, ' ');\n    }\n\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n      ? trustedTypesPolicy.createHTML(serializedHTML)\n      : serializedHTML;\n  };\n\n  /**\n   * Public method to set the configuration once\n   * setConfig\n   *\n   * @param {Object} cfg configuration object\n   */\n  DOMPurify.setConfig = function (cfg) {\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n\n  /**\n   * Public method to remove the configuration\n   * clearConfig\n   *\n   */\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n\n  /**\n   * Public method to check if an attribute value is valid.\n   * Uses last set config, if any. Otherwise, uses config defaults.\n   * isValidAttribute\n   *\n   * @param  {string} tag Tag name of containing element.\n   * @param  {string} attr Attribute name.\n   * @param  {string} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.\n   */\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n\n  /**\n   * AddHook\n   * Public method to add DOMPurify hooks\n   *\n   * @param {String} entryPoint entry point for the hook to add\n   * @param {Function} hookFunction function to execute\n   */\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n\n    hooks[entryPoint] = hooks[entryPoint] || [];\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n\n  /**\n   * RemoveHook\n   * Public method to remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if more are present)\n   *\n   * @param {String} entryPoint entry point for the hook to remove\n   * @return {Function} removed(popped) hook\n   */\n  DOMPurify.removeHook = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      return arrayPop(hooks[entryPoint]);\n    }\n  };\n\n  /**\n   * RemoveHooks\n   * Public method to remove all DOMPurify hooks at a given entryPoint\n   *\n   * @param  {String} entryPoint entry point for the hooks to remove\n   */\n  DOMPurify.removeHooks = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      hooks[entryPoint] = [];\n    }\n  };\n\n  /**\n   * RemoveAllHooks\n   * Public method to remove all DOMPurify hooks\n   *\n   */\n  DOMPurify.removeAllHooks = function () {\n    hooks = {};\n  };\n\n  return DOMPurify;\n}\n\nexport default createDOMPurify();\n", "/**\n * This class represents all the constants needed in a MathType integration among different classes.\n * If a constant should be used across different classes should be defined using attribute\n * accessors.\n */\nexport default class Constants {\n  /**\n   * Safe XML entities.\n   * @type {Object}\n   */\n  static get safeXmlCharactersEntities() {\n    return {\n      tagOpener: '&laquo;',\n      tagCloser: '&raquo;',\n      doubleQuote: '&uml;',\n      realDoubleQuote: '&quot;',\n    };\n  }\n\n  /**\n   * Blackboard invalid safe characters.\n   * @type {Object}\n   */\n  static get safeBadBlackboardCharacters() {\n    return {\n      ltElement: '«mo»<«/mo»',\n      gtElement: '«mo»>«/mo»',\n      ampElement: '«mo»&«/mo»',\n    };\n  }\n\n  /**\n   * Blackboard valid safe characters.\n   * @type{Object}\n   */\n  static get safeGoodBlackboardCharacters() {\n    return {\n      ltElement: '«mo»§lt;«/mo»',\n      gtElement: '«mo»§gt;«/mo»',\n      ampElement: '«mo»§amp;«/mo»',\n    };\n  }\n\n  /**\n   * Standard XML special characters.\n   * @type {Object}\n   */\n  static get xmlCharacters() {\n    return {\n      id: 'xmlCharacters',\n      tagOpener: '<', // Hex: \\x3C.\n      tagCloser: '>', // Hex: \\x3E.\n      doubleQuote: '\"', // Hex: \\x22.\n      ampersand: '&', // Hex: \\x26.\n      quote: '\\'', // Hex: \\x27.\n    };\n  }\n\n  /**\n  * Safe XML special characters. This characters are used instead the standard\n  * the standard to parse the  MathML if safeXML save mode is enable. Each XML\n  * special character have a UTF-8 representation.\n  * @type {Object}\n  */\n  static get safeXmlCharacters() {\n    return {\n      id: 'safeXmlCharacters',\n      tagOpener: '«', // Hex: \\xAB.\n      tagCloser: '»', // Hex: \\xBB.\n      doubleQuote: '¨', // Hex: \\xA8.\n      ampersand: '§', // Hex: \\xA7.\n      quote: '`', // Hex: \\x60.\n      realDoubleQuote: '¨',\n    };\n  }\n}\n", "import Constants from './constants';\nimport Util from './util';\n\n/**\n * @classdesc\n * This class represents a class to manage MathML objects.\n */\nexport default class MathML {\n  /**\n   * Checks if the mathml at position i is inside an HTML attribute or not.\n   * @param {string} content - a string containing MathML code.\n   * @param {number} i -  search index.\n   * @return {boolean} true if is inside an HTML attribute. false otherwise.\n   */\n  static isMathmlInAttribute(content, i) {\n    // Regex =\n    // '^[\\'\"][\\\\s]*=[\\\\s]*[\\\\w-]+([\\\\s]*(\"[^\"]*\"|\\'[^\\']*\\')[\\\\s]*\n    // =[\\\\s]*[\\\\w-]+[\\\\s]*)*[\\\\s]+gmi<';\n    const mathAtt = '[\\'\"][\\\\s]*=[\\\\s]*[\\\\w-]+'; // \"=att OR '=att\n    const attContent = '\"[^\"]*\"|\\'[^\\']*\\''; // \"blabla\" OR 'blabla'\n    const att = `[\\\\s]*(${attContent})[\\\\s]*=[\\\\s]*[\\\\w-]+[\\\\s]*`; // \"blabla\"=att OR 'blabla'=att\n    const atts = `('${att}')*`; // \"blabla\"=att1 \"blabla\"=att2\n    const regex = `^${mathAtt}${atts}[\\\\s]+gmi<`; // \"=att \"blabla\"=att1 \"blabla\"=att2 gmi< .\n    const expression = new RegExp(regex);\n\n    const actualContent = content.substring(0, i);\n    const reversed = actualContent.split('').reverse().join('');\n    const exists = expression.test(reversed);\n\n    return exists;\n  }\n\n  /**\n   * Decodes an encoded MathML with standard XML tags.\n   * We use these entities because IE doesn't support html entities\n   * on its attributes sometimes. Yes, sometimes.\n   * @param {string} input - string to be decoded.\n   * @return {string} decoded string.\n   */\n  static safeXmlDecode(input) {\n    let { tagOpener } = Constants.safeXmlCharactersEntities;\n    let { tagCloser } = Constants.safeXmlCharactersEntities;\n    let { doubleQuote } = Constants.safeXmlCharactersEntities;\n    let { realDoubleQuote } = Constants.safeXmlCharactersEntities;\n    // Decoding entities.\n    input = input.split(tagOpener).join(Constants.safeXmlCharacters.tagOpener);\n    input = input.split(tagCloser).join(Constants.safeXmlCharacters.tagCloser);\n    input = input.split(doubleQuote).join(Constants.safeXmlCharacters.doubleQuote);\n    // Added to fix problem due to import from 1.9.x.\n    input = input.split(realDoubleQuote).join(Constants.safeXmlCharacters.realDoubleQuote);\n\n    // Blackboard.\n    const { ltElement } = Constants.safeBadBlackboardCharacters;\n    const { gtElement } = Constants.safeBadBlackboardCharacters;\n    const { ampElement } = Constants.safeBadBlackboardCharacters;\n    if ('_wrs_blackboard' in window && window._wrs_blackboard) {\n      input = input.split(ltElement).join(Constants.safeGoodBlackboardCharacters.ltElement);\n      input = input.split(gtElement).join(Constants.safeGoodBlackboardCharacters.gtElement);\n      input = input.split(ampElement).join(Constants.safeGoodBlackboardCharacters.ampElement);\n    }\n\n    ({ tagOpener } = Constants.safeXmlCharacters);\n    ({ tagCloser } = Constants.safeXmlCharacters);\n    ({ doubleQuote } = Constants.safeXmlCharacters);\n    ({ realDoubleQuote } = Constants.safeXmlCharacters);\n    const { ampersand } = Constants.safeXmlCharacters;\n    const { quote } = Constants.safeXmlCharacters;\n\n    // Decoding characters.\n    input = input.split(tagOpener).join(Constants.xmlCharacters.tagOpener);\n    input = input.split(tagCloser).join(Constants.xmlCharacters.tagCloser);\n    input = input.split(doubleQuote).join(Constants.xmlCharacters.doubleQuote);\n    input = input.split(ampersand).join(Constants.xmlCharacters.ampersand);\n    input = input.split(quote).join(Constants.xmlCharacters.quote);\n\n    // We are replacing $ by & when its part of an entity for retro-compatibility.\n    // Now, the standard is replace § by &.\n    let returnValue = '';\n    let currentEntity = null;\n\n    for (let i = 0; i < input.length; i += 1) {\n      const character = input.charAt(i);\n      if (currentEntity == null) {\n        if (character === '$') {\n          currentEntity = '';\n        } else {\n          returnValue += character;\n        }\n      } else if (character === ';') {\n        returnValue += `&${currentEntity}`;\n        currentEntity = null;\n      } else if (character.match(/([a-zA-Z0-9#._-] | '-')/)) { // Character is part of an entity.\n        currentEntity += character;\n      } else {\n        returnValue += `$${currentEntity}`; // Is not an entity.\n        currentEntity = null;\n        i -= 1; // Parse again the current character.\n      }\n    }\n\n    return returnValue;\n  }\n\n  /**\n   * Encodes a MathML with standard XML tags to a MMathML encoded with safe XML tags.\n   * We use these entities because IE doesn't support html entities on its attributes sometimes.\n   * @param {string} input - input string to be encoded\n   * @returns {string} encoded string.\n   */\n  static safeXmlEncode(input) {\n    const { tagOpener } = Constants.xmlCharacters;\n    const { tagCloser } = Constants.xmlCharacters;\n    const { doubleQuote } = Constants.xmlCharacters;\n    const { ampersand } = Constants.xmlCharacters;\n    const { quote } = Constants.xmlCharacters;\n\n    input = input.split(tagOpener).join(Constants.safeXmlCharacters.tagOpener);\n    input = input.split(tagCloser).join(Constants.safeXmlCharacters.tagCloser);\n    input = input.split(doubleQuote).join(Constants.safeXmlCharacters.doubleQuote);\n    input = input.split(ampersand).join(Constants.safeXmlCharacters.ampersand);\n    input = input.split(quote).join(Constants.safeXmlCharacters.quote);\n\n    return input;\n  }\n\n  /**\n   * Converts special symbols (> 128) to entities and replaces all textual\n   * entities by its number entities.\n   * @param {string} mathml - MathML string containing - or not - special symbols\n   * @returns {string} MathML with all textual entities replaced.\n   */\n  static mathMLEntities(mathml) {\n    let toReturn = '';\n\n    for (let i = 0; i < mathml.length; i += 1) {\n      const character = mathml.charAt(i);\n\n      // Parsing > 128 characters.\n      if (mathml.codePointAt(i) > 128) {\n        toReturn += `&#${mathml.codePointAt(i)};`;\n        // For UTF-32 characters we need to move the index one position.\n        if (mathml.codePointAt(i) > 0xffff) {\n          i += 1;\n        }\n      } else if (character === '&') {\n        const end = mathml.indexOf(';', i + 1);\n        if (end >= 0) {\n          const container = document.createElement('span');\n          container.innerHTML = mathml.substring(i, end + 1);\n          toReturn += `&#${Util.fixedCharCodeAt((container.textContent || container.innerText), 0)};`;\n          i = end;\n        } else {\n          toReturn += character;\n        }\n      } else {\n        toReturn += character;\n      }\n    }\n\n    return toReturn;\n  }\n\n  /**\n   * Add a custom editor name with the prefix wrs_ to a MathML class attribute.\n   * @param {string} mathml - a MathML string created with a custom editor, like chemistry.\n   * @param {string} customEditor - custom editor name.\n   * @returns {string} MathML string with his class containing the editor toolbar string.\n   */\n  static addCustomEditorClassAttribute(mathml, customEditor) {\n    let toReturn = '';\n\n    const start = mathml.indexOf('<math');\n    if (start === 0) {\n      const end = mathml.indexOf('>');\n      if (mathml.indexOf('class') === -1) {\n        // Adding custom editor type.\n        toReturn = `${mathml.substr(start, end)} class=\"wrs_${customEditor}\">`;\n        toReturn += mathml.substr(end + 1, mathml.length);\n        return toReturn;\n      }\n    }\n    return mathml;\n  }\n\n  /**\n   * Remove a custom editor name from the MathML class attribute.\n   * @param {string} mathml - a MathML string.\n   * @param {string} customEditor - custom editor name.\n   * @returns {string} The input MathML without customEditor name in his class.\n   */\n  static removeCustomEditorClassAttribute(mathml, customEditor) {\n    // Discard MathML without the specified class.\n    if (mathml.indexOf('class') === -1 || mathml.indexOf(`wrs_${customEditor}`) === -1) {\n      return mathml;\n    }\n\n    // Trivial case: class attribute value equal to editor name. Then\n    // class attribute is removed.\n    // First try to remove it with a space before if there is one\n    // Otherwise without the space\n    if (mathml.indexOf(` class=\"wrs_${customEditor}\"`) !== -1) {\n      return mathml.replace(` class=\"wrs_${customEditor}\"`, '');\n    } else if (mathml.indexOf(`class=\"wrs_${customEditor}\"`) !== -1) {\n      return mathml.replace(`class=\"wrs_${customEditor}\"`, '');\n    }\n\n    // Non Trivial case: class attribute contains editor name.\n    return mathml.replace(`wrs_${customEditor}`, '');\n  }\n\n  /**\n   * Adds annotation tag in MathML element.\n   * @param {String} mathml - valid MathML.\n   * @param {String} content - value to put inside annotation tag.\n   * @param {String} annotationEncoding - annotation encoding.\n   * @returns {String} - 'mathml' with an annotation that contains\n   * 'content' and encoding 'encoding'.\n   */\n  static addAnnotation(mathml, content, annotationEncoding) {\n    // If contains annotation, also contains semantics tag.\n    const containsAnnotation = mathml.indexOf('<annotation');\n\n    let mathmlWithAnnotation = '';\n    if (containsAnnotation !== -1) {\n      const closeSemanticsIndex = mathml.indexOf('</semantics>');\n      mathmlWithAnnotation = `${mathml.substring(0, closeSemanticsIndex)}<annotation encoding=\"${annotationEncoding}\">${content}</annotation>${mathml.substring(closeSemanticsIndex)}`;\n    } else if (MathML.isEmpty(mathml)) {\n      const endIndexInline = mathml.indexOf('/>');\n      const endIndexNonInline = mathml.indexOf('>');\n      const endIndex = endIndexNonInline === endIndexInline ? endIndexInline : endIndexNonInline;\n      mathmlWithAnnotation = `${mathml.substring(0, endIndex)}><semantics><annotation encoding=\"${annotationEncoding}\">${content}</annotation></semantics></math>`;\n    } else {\n      const beginMathMLContent = mathml.indexOf('>') + 1;\n      const endMathmlContent = mathml.lastIndexOf('</math>');\n      const mathmlContent = mathml.substring(beginMathMLContent, endMathmlContent);\n      mathmlWithAnnotation = `${mathml.substring(0, beginMathMLContent)}<semantics><mrow>${mathmlContent}</mrow><annotation encoding=\"${annotationEncoding}\">${content}</annotation></semantics></math>`; // eslint-disable-line max-len\n    }\n\n    return mathmlWithAnnotation;\n  }\n\n  /**\n   * Removes specific annotation tag in MathML element.\n   * In case of remove the unique annotation, also is removed semantics tag.\n   * @param {String} mathml - valid MathML.\n   * @param {String} annotationEncoding - annotation encoding to remove.\n   * @returns {String} - 'mathml' without the annotation encoding specified.\n   */\n  static removeAnnotation(mathml, annotationEncoding) {\n    let mathmlWithoutAnnotation = mathml;\n    const openAnnotationTag = `<annotation encoding=\"${annotationEncoding}\">`;\n    const closeAnnotationTag = '</annotation>';\n    const startAnnotationIndex = mathml.indexOf(openAnnotationTag);\n    if (startAnnotationIndex !== -1) {\n      let differentAnnotationFound = false;\n      let differentAnnotationIndex = mathml.indexOf('<annotation');\n      while (differentAnnotationIndex !== -1) {\n        if (differentAnnotationIndex !== startAnnotationIndex) {\n          differentAnnotationFound = true;\n        }\n        differentAnnotationIndex = mathml.indexOf('<annotation', differentAnnotationIndex + 1);\n      }\n\n      if (differentAnnotationFound) {\n        const closeIndex = mathml.indexOf(closeAnnotationTag, startAnnotationIndex);\n        const endAnnotationIndex = closeIndex + closeAnnotationTag.length;\n        const startIndex = mathml.substring(0, startAnnotationIndex);\n        mathmlWithoutAnnotation = startIndex + mathml.substring(endAnnotationIndex);\n      } else {\n        mathmlWithoutAnnotation = MathML.removeSemantics(mathml);\n      }\n    }\n\n    return mathmlWithoutAnnotation;\n  }\n\n  /**\n   * Removes semantics tag to mathml.\n   * When using Hand to create formulas, it adds the mrow tag due to the semantics one, this one is also removed.\n   * @param {string} mathml - MathML string.\n   * @returns {string} - 'mathml' without semantics tag.\n   */\n  static removeSemantics(mathml) {\n    // If `mrow` is found right before the `semantics` starting tag, it's removed as well \n    const semanticsStartingTagRegex = /<semantics>\\s*?(<mrow>)?/gm;\n\n    // If `mrow` is found right after the `annotation` ending tag, it's removed as well\n    // alongside `semantics` closing tag and the whole `annotation` tag and its contents.\n    const semanticsEndingTagRegex = /(<\\/mrow>)?\\s*<annotation[\\W\\w]*?<\\/semantics>/gm;\n\n    return mathml\n    .replace(semanticsStartingTagRegex, '')\n    .replace(semanticsEndingTagRegex, '');\n  }\n\n  /**\n   * Transforms all xml mathml occurrences that contain semantics to the same\n   * xml mathml occurrences without semantics.\n   * @param {string} text - string that can contain xml mathml occurrences.\n   * @param {Constants} [characters] - Constant object containing xmlCharacters\n   * or safeXmlCharacters relation.\n   * xmlCharacters by default.\n   * @returns {string} - 'text' with all xml mathml occurrences without annotation tag.\n   */\n  static removeSemanticsOcurrences(text, characters = Constants.xmlCharacters) {\n    const mathTagStart = `${characters.tagOpener}math`;\n    const mathTagEnd = `${characters.tagOpener}/math${characters.tagCloser}`;\n    const mathTagEndline = `/${characters.tagCloser}`;\n    const { tagCloser } = characters;\n    const semanticsTagStart = `${characters.tagOpener}semantics${characters.tagCloser}`;\n    const annotationTagStart = `${characters.tagOpener}annotation encoding=`;\n\n    let output = '';\n    let start = text.indexOf(mathTagStart);\n    let end = 0;\n    while (start !== -1) {\n      output += text.substring(end, start);\n\n      // MathML can be written as '<math></math>' or '<math />'.\n      const mathTagEndIndex = text.indexOf(mathTagEnd, start);\n      const mathTagEndlineIndex = text.indexOf(mathTagEndline, start);\n      const firstTagCloser = text.indexOf(tagCloser, start);\n      if (mathTagEndIndex !== -1) {\n        end = mathTagEndIndex;\n      } else if (mathTagEndlineIndex === firstTagCloser - 1) {\n        end = mathTagEndlineIndex;\n      }\n\n      const semanticsIndex = text.indexOf(semanticsTagStart, start);\n      if (semanticsIndex !== -1) {\n        const mmlTagStart = text.substring(start, semanticsIndex);\n        const annotationIndex = text.indexOf(annotationTagStart, start);\n        if (annotationIndex !== -1) {\n          const startIndex = semanticsIndex + semanticsTagStart.length;\n          const mmlContent = text.substring(startIndex, annotationIndex);\n          output += mmlTagStart + mmlContent + mathTagEnd;\n          start = text.indexOf(mathTagStart, start + mathTagStart.length);\n          end += mathTagEnd.length;\n        } else {\n          end = start;\n          start = text.indexOf(mathTagStart, start + mathTagStart.length);\n        }\n      } else {\n        end = start;\n        start = text.indexOf(mathTagStart, start + mathTagStart.length);\n      }\n    }\n\n    output += text.substring(end, text.length);\n    return output;\n  }\n\n  /**\n   * Returns true if a MathML contains a certain class.\n   * @param {string} mathML - input MathML.\n   * @param {string} className - className.\n   * @returns {boolean} true if the input MathML contains the input class.\n   * false otherwise.\n   * @static\n   */\n  static containClass(mathML, className) {\n    const classIndex = mathML.indexOf('class');\n    if (classIndex === -1) {\n      return false;\n    }\n    const classTagEndIndex = mathML.indexOf('>', classIndex);\n    const classTag = mathML.substring(classIndex, classTagEndIndex);\n    if (classTag.indexOf(className) !== -1) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns true if mathml is empty. Otherwise, false.\n   * @param {string} mathml - valid MathML with standard XML tags.\n   * @returns {boolean} - true if mathml is empty. Otherwise, false.\n   */\n  static isEmpty(mathml) {\n    // MathML can have the shape <math></math> or '<math />'.\n    const closeTag = '>';\n    const closeTagInline = '/>';\n    const firstCloseTagIndex = mathml.indexOf(closeTag);\n    const firstCloseTagInlineIndex = mathml.indexOf(closeTagInline);\n    let empty = false;\n    // MathML is always empty in the second shape.\n    if (firstCloseTagInlineIndex !== -1) {\n      if (firstCloseTagInlineIndex === firstCloseTagIndex - 1) {\n        empty = true;\n      }\n    }\n\n    // MathML is always empty in the first shape when there aren't elements\n    // between math tags.\n    if (!empty) {\n      const mathTagEndRegex = new RegExp('</(.+:)?math>');\n      const mathTagEndArray = mathTagEndRegex.exec(mathml);\n      if (mathTagEndArray) {\n        empty = firstCloseTagIndex + 1 === mathTagEndArray.index;\n      }\n    }\n\n    return empty;\n  }\n\n  /**\n   * Encodes html entities inside properties.\n   * @param {String} mathml - valid MathML with standard XML tags.\n   * @returns {String} - 'mathml' with property entities encoded.\n   */\n  static encodeProperties(mathml) {\n    // Search all the properties.\n    const regex = /\\w+=\".*?\"/g;\n    // Encode html entities.\n    const replacer = (match) => {\n      // It has the shape:\n      // <math propertyOne=\"somethingOne\"><children propertyTwo=\"somethingTwo\"></children></math>.\n      const quoteIndex = match.indexOf('\"');\n      const propertyValue = match.substring(quoteIndex + 1, match.length - 1);\n      const propertyValueEncoded = Util.htmlEntities(propertyValue);\n      const matchEncoded = `${match.substring(0, quoteIndex + 1)}${propertyValueEncoded}\"`;\n      return matchEncoded;\n    };\n\n    const mathmlEncoded = mathml.replace(regex, replacer);\n    return mathmlEncoded;\n  }\n}\n", "/**\n * This class represents the configuration class.\n * Usually used to retrieve configuration properties generated in the backend into the frontend.\n */\nexport default class Configuration {\n  /**\n   * Adds a properties object to {@link Configuration.properties}.\n   * @param {Object} properties - properties to append to current properties.\n   */\n  static addConfiguration(properties) {\n    Object.assign(Configuration.properties, properties);\n  }\n\n  /**\n  * Static property.\n  * The configuration properties object.\n  * @private\n  * @type {Object}\n  */\n  static get properties() {\n    return Configuration._properties;\n  }\n\n  /**\n   * Static property setter.\n   * Set configuration properties.\n   * @param {Object} value - The property value.\n   * @ignore\n   */\n  static set properties(value) {\n    Configuration._properties = value;\n  }\n\n  /**\n   * Returns the value of a property key.\n   * @param {String} key - Property key\n   * @returns {String} Property value\n   */\n  static get(key) {\n    if (!Object.prototype.hasOwnProperty.call(Configuration.properties, key)) {\n      // Backwards compatibility.\n      if (Object.prototype.hasOwnProperty.call(Configuration.properties, '_wrs_conf_')) {\n        return Configuration.properties[`_wrs_conf_${key}`];\n      }\n      return false;\n    }\n    return Configuration.properties[key];\n  }\n\n  /**\n   * Adds a new property to Configuration class.\n   * @param {String} key - Property key.\n   * @param {Object} value - Property value.\n   */\n  static set(key, value) {\n    Configuration.properties[key] = value;\n  }\n\n  /**\n   * Updates a property object value with new values.\n   * @param {String} key - The property key to be updated.\n   * @param {Object} propertyValue - Object containing the new values.\n   */\n  static update(key, propertyValue) {\n    if (!Configuration.get(key)) {\n      Configuration.set(key, propertyValue);\n    } else {\n      const updateProperty = Object.assign(Configuration.get(key), propertyValue);\n      Configuration.set(key, updateProperty);\n    }\n  }\n}\n\n/**\n * Static properties object. Stores all configuration properties.\n * Needed to attribute accessors.\n * @private\n * @type {Object}\n */\nConfiguration._properties = {};\n", "export default class TextCache {\n  /**\n   * @classdesc\n   * This class represent a client-side text cache class. Contains pairs of\n   * strings (key/value) which can be retrieved in any moment. Usually used\n   * to store AJAX responses for text services like mathml2latex\n   * (c.f {@link Latex} class) or mathml2accessible (c.f {@link Accessibility} class).\n   * @constructs\n   */\n  constructor() {\n    /**\n     * Cache array property storing the cache entries.\n     * @type {Array.<String>}\n     */\n    this.cache = [];\n  }\n\n  /**\n   * This method populates a key/value pair into the {@link this.cache} property.\n   * @param {String} key - Cache key, usually the service string parameter.\n   * @param {String} value - Cache value, usually the service response.\n   */\n  populate(key, value) {\n    this.cache[key] = value;\n  }\n\n  /**\n   * Returns the cache value associated to certain cache key.\n   * @param {String} key - Cache key, usually the service string parameter.\n   * @return {String} value - Cache value, if exists. False otherwise.\n   */\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.cache, key)) {\n      return this.cache[key];\n    }\n    return false;\n  }\n}\n", "/**\n * This object represents a custom listener.\n * @typedef {Object} Listener\n * @property {String} Listener.eventName - The listener name.\n * @property {Function} Listener.callback - The listener callback function.\n */\n\nexport default class Listeners {\n  /**\n   * @classdesc\n   * This class represents a custom listeners manager.\n   * @constructs\n   */\n  constructor() {\n    /**\n     * Array containing all custom listeners.\n     * @type {Object[]}\n     */\n    this.listeners = [];\n  }\n\n  /**\n   * Add a listener to Listener class.\n   * @param {Object} listener - A listener object.\n   */\n  add(listener) {\n    this.listeners.push(listener);\n  }\n\n  /**\n   * Fires MathType event listeners\n   * @param {String} eventName - event name\n   * @param {Event} event - event object.\n   * @return {boolean} false if event has been prevented. true otherwise.\n   */\n  fire(eventName, event) {\n    for (let i = 0; i < this.listeners.length && !event.cancelled; i += 1) {\n      if (this.listeners[i].eventName === eventName) {\n        // Calling listener.\n        this.listeners[i].callback(event);\n      }\n    }\n    return event.defaultPrevented;\n  }\n\n  /**\n   * Creates a new listener object.\n   * @param {string} eventName - Event name.\n   * @param {Object} callback - Callback function.\n   * @returns {object} the listener object.\n   */\n  static newListener(eventName, callback) {\n    const listener = {};\n    listener.eventName = eventName;\n    listener.callback = callback;\n    return listener;\n  }\n}\n", "import Util from './util';\nimport Listeners from './listeners';\nimport Configuration from './configuration';\n\n/**\n * @typedef {Object} ServiceProviderProperties\n * @property {String} URI - Service URI.\n * @property {String} server - Service server language.\n */\n\n/**\n * @classdesc\n * Class representing a serviceProvider. A serviceProvider is a class containing\n * an arbitrary number of services with the correspondent path.\n */\nexport default class ServiceProvider {\n  /**\n   * Returns Service Provider listeners.\n   * @type {Listeners}\n   */\n  static get listeners() {\n    return ServiceProvider._listeners;\n  }\n\n  /**\n   * Adds a {@link Listener} instance to {@link ServiceProvider} class.\n   * @param {Listener} listener - Instance of {@link Listener}.\n   */\n  static addListener(listener) {\n    ServiceProvider.listeners.add(listener);\n  }\n\n  /**\n   * Fires events in Service Provider.\n   * @param {String} eventName - Event name.\n   * @param {Event} event - Event object.\n   */\n  static fireEvent(eventName, event) {\n    ServiceProvider.listeners.fire(eventName, event);\n  }\n\n  /**\n   * Service parameters.\n   * @type {ServiceProviderProperties}\n   *\n   */\n  static get parameters() {\n    return ServiceProvider._parameters;\n  }\n\n  /**\n   * Service parameters.\n   * @private\n   * @type {ServiceProviderProperties}\n   */\n  static set parameters(parameters) {\n    ServiceProvider._parameters = parameters;\n  }\n\n  /**\n   * Static property.\n   * Return service provider paths.\n   * @private\n   * @type {String}\n   */\n  static get servicePaths() {\n    return ServiceProvider._servicePaths;\n  }\n\n  /**\n   * Static property setter.\n   * Set service paths.\n   * @param {String} value - The property value.\n   * @ignore\n   */\n  static set servicePaths(value) {\n    ServiceProvider._servicePaths = value;\n  }\n\n  /**\n   * Adds a new service to the ServiceProvider.\n   * @param {String} service - Service name.\n   * @param {String} path - Service path.\n   * @static\n   */\n  static setServicePath(service, path) {\n    ServiceProvider.servicePaths[service] = path;\n  }\n\n  /**\n   * Returns the service path for a certain service.\n   * @param {String} serviceName - Service name.\n   * @returns {String} The service path.\n   * @static\n   */\n  static getServicePath(serviceName) {\n    return ServiceProvider.servicePaths[serviceName];\n  }\n\n  /**\n   * Static property.\n   * Service provider integration path.\n   * @type {String}\n   */\n  static get integrationPath() {\n    return ServiceProvider._integrationPath;\n  }\n\n  /**\n   * Static property setter.\n   * Set service provider integration path.\n   * @param {String} value - The property value.\n   * @ignore\n   */\n  static set integrationPath(value) {\n    ServiceProvider._integrationPath = value;\n  }\n\n  /**\n   * Returns the server URL in the form protocol://serverName:serverPort.\n   * @return {String} The client side server path.\n   */\n  static getServerURL() {\n    const url = window.location.href;\n    const arr = url.split('/');\n    const result = `${arr[0]}//${arr[2]}`;\n    return result;\n  }\n\n  /**\n   * Inits {@link this} class. Uses {@link this.integrationPath} as\n   * base path to generate all backend services paths.\n   * @param {Object} parameters - Function parameters.\n   * @param {String} parameters.integrationPath - Service path.\n   */\n  static init(parameters) {\n    ServiceProvider.parameters = parameters;\n    // Services path (tech dependant).\n    let configurationURI = ServiceProvider.createServiceURI('configurationjs');\n    let createImageURI = ServiceProvider.createServiceURI('createimage');\n    let showImageURI = ServiceProvider.createServiceURI('showimage');\n    let getMathMLURI = ServiceProvider.createServiceURI('getmathml');\n    let serviceURI = ServiceProvider.createServiceURI('service');\n\n    // Some backend integrations (like Java o Ruby) have an absolute backend path,\n    // for example: /app/service. For them we calculate the absolute URL path, i.e\n    // protocol://domain:port/app/service\n    if (ServiceProvider.parameters.URI.indexOf('/') === 0) {\n      const serverPath = ServiceProvider.getServerURL();\n      configurationURI = serverPath + configurationURI;\n      showImageURI = serverPath + showImageURI;\n      createImageURI = serverPath + createImageURI;\n      getMathMLURI = serverPath + getMathMLURI;\n      serviceURI = serverPath + serviceURI;\n    }\n\n    ServiceProvider.setServicePath('configurationjs', configurationURI);\n    ServiceProvider.setServicePath('showimage', showImageURI);\n    ServiceProvider.setServicePath('createimage', createImageURI);\n    ServiceProvider.setServicePath('service', serviceURI);\n    ServiceProvider.setServicePath('getmathml', getMathMLURI);\n    ServiceProvider.setServicePath('configurationjs', configurationURI);\n\n    ServiceProvider.listeners.fire('onInit', {});\n  }\n\n  /**\n   * Gets the content from an URL.\n   * @param {String} url - Target URL.\n   * @param {Object} [postVariables] - Object containing post variables.\n   * null if a GET query should be done.\n   * @returns {String} Content of the target URL.\n   * @private\n   * @static\n   */\n  static getUrl(url, postVariables) {\n    const currentPath = window.location.toString().substr(0, window.location.toString().lastIndexOf('/') + 1);\n    const httpRequest = Util.createHttpRequest();\n\n    if (httpRequest) {\n      if (typeof postVariables === 'undefined' || typeof postVariables === 'undefined') {\n        httpRequest.open('GET', url, false);\n      } else if (url.substr(0, 1) === '/' || url.substr(0, 7) === 'http://' || url.substr(0, 8) === 'https://') {\n        httpRequest.open('POST', url, false);\n      } else {\n        httpRequest.open('POST', currentPath + url, false);\n      }\n\n      let header = Configuration.get('customHeaders');\n      if (header) {\n        header = header.toString()\n        header.split(\",\")\n          .map(element => element.trim().split('='))\n          .forEach(([key, val]) => httpRequest.setRequestHeader(key, val));\n      }\n\n      if (typeof postVariables !== 'undefined' && postVariables) {\n        httpRequest.setRequestHeader('Content-type', 'application/x-www-form-urlencoded; charset=UTF-8');\n        httpRequest.send(Util.httpBuildQuery(postVariables));\n      } else {\n        httpRequest.send(null);\n      }\n   \n      return httpRequest.responseText;\n    }\n    return '';\n  }\n\n  /**\n   * Returns the response text of a certain service.\n   * @param {String} service - Service name.\n   * @param {String} postVariables - Post variables.\n   * @param {Boolean} get - True if the request is GET instead of POST. false otherwise.\n   * @returns {String} Service response text.\n   */\n  static getService(service, postVariables, get) {\n    let response;\n    if (get === true) {\n      const getVariables = postVariables ? `?${postVariables}` : '';\n      const serviceUrl = `${ServiceProvider.getServicePath(service)}${getVariables}`;\n      response = ServiceProvider.getUrl(serviceUrl);\n    } else {\n      const serviceUrl = ServiceProvider.getServicePath(service);\n      response = ServiceProvider.getUrl(serviceUrl, postVariables);\n    }\n    return response;\n  }\n\n  /**\n   * Returns the server language of a certain service. The possible values\n   * are: php, aspx, java and ruby.\n   * This method has backward compatibility purposes.\n   * @param {String} service - The configuration service.\n   * @returns {String} - The server technology associated with the configuration service.\n   */\n  static getServerLanguageFromService(service) {\n    if (service.indexOf('.php') !== -1) {\n      return 'php';\n    }\n    if (service.indexOf('.aspx') !== -1) {\n      return 'aspx';\n    }\n    if (service.indexOf('wirispluginengine') !== -1) {\n      return 'ruby';\n    }\n    return 'java';\n  }\n\n  /**\n   * Returns the URI associated with a certain service.\n   * @param {String} service - The service name.\n   * @return {String} The service path.\n   */\n  static createServiceURI(service) {\n    const extension = ServiceProvider.serverExtension();\n    return Util.concatenateUrl(ServiceProvider.parameters.URI, service) + extension;\n  }\n\n  static serverExtension() {\n    if (ServiceProvider.parameters.server.indexOf('php') !== -1) {\n      return '.php';\n    }\n    if (ServiceProvider.parameters.server.indexOf('aspx') !== -1) {\n      return '.aspx';\n    }\n    return '';\n  }\n}\n\n/**\n * @property {String} service - The service name.\n * @property {String} path - The service path.\n * @static\n */\nServiceProvider._servicePaths = {};\n\n/**\n * The integration path. Contains the path of the configuration service.\n * Used to define the path for all services.\n * @type {String}\n * @private\n */\nServiceProvider._integrationPath = '';\n\n/**\n * ServiceProvider static listeners.\n * @type {Listeners}\n * @private\n */\nServiceProvider._listeners = new Listeners();\n\n/**\n * Service provider parameters.\n * @type {ServiceProviderParameters}\n */\nServiceProvider._parameters = {};\n", "import TextCache from './textcache';\nimport MathML from './mathml';\nimport ServiceProvider from './serviceprovider';\nimport Constants from './constants';\nimport Util from './util';\n\n/**\n * @classdesc\n * This class represents a LaTeX parser. Manages the services which allows to convert\n * LaTeX into MathML and MathML into LaTeX.\n */\nexport default class Latex {\n  /**\n   * Static property.\n   * Return latex cache.\n   * @private\n   * @type {Cache}\n   */\n  static get cache() {\n    return Latex._cache;\n  }\n\n  /**\n   * Static property setter.\n   * Set latex cache.\n   * @param {Cache} value - The property value.\n   * @ignore\n  */\n  static set cache(value) {\n    Latex._cache = value;\n  }\n\n  /**\n   * Converts MathML to LaTeX by calling mathml2latex service. For text services\n   * we call a text service with the param mathml2latex.\n   * @param {String} mathml - MathML String.\n   * @return {String} LaTeX string generated by the MathML argument.\n   */\n  static getLatexFromMathML(mathml) {\n    const mathmlWithoutSemantics = MathML.removeSemantics(mathml);\n    /**\n     * @type {TextCache}\n     */\n    const { cache } = Latex;\n\n    const data = {\n      service: 'mathml2latex',\n      mml: mathmlWithoutSemantics,\n    };\n\n    const jsonResponse = JSON.parse(ServiceProvider.getService('service', data));\n\n    // TODO: Error handling.\n    let latex = '';\n\n    if (jsonResponse.status === 'ok') {\n      latex = jsonResponse.result.text;\n      const latexHtmlEntitiesEncoded = Util.htmlEntities(latex);\n      // Inserting LaTeX semantics.\n      const mathmlWithSemantics = MathML.addAnnotation(mathml, latexHtmlEntitiesEncoded, 'LaTeX');\n      cache.populate(latex, mathmlWithSemantics);\n    }\n\n    return latex;\n  }\n\n  /**\n   * Converts LaTeX to MathML by calling latex2mathml service. For text services\n   * we call a text service with the param latex2mathml.\n   * @param {String} latex - String containing a LaTeX formula.\n   * @param {Boolean} includeLatexOnSemantics\n   * - If true LaTeX would me included into MathML semantics.\n   * @return {String} MathML string generated by the LaTeX argument.\n   */\n  static getMathMLFromLatex(latex, includeLatexOnSemantics) {\n    /**\n     * @type {TextCache}\n     */\n    const latexCache = Latex.cache;\n\n    if (Latex.cache.get(latex)) {\n      return Latex.cache.get(latex);\n    }\n    const data = {\n      service: 'latex2mathml',\n      latex,\n    };\n\n    if (includeLatexOnSemantics) {\n      data.saveLatex = '';\n    }\n\n    const jsonResponse = JSON.parse(ServiceProvider.getService('service', data));\n\n    let output;\n    if (jsonResponse.status === 'ok') {\n      let mathml = jsonResponse.result.text;\n      mathml = mathml.split('\\r').join('').split('\\n').join(' ');\n\n      // Populate LatexCache.\n      if (mathml.indexOf('semantics') === -1 && mathml.indexOf('annotation') === -1) {\n        const content = Util.htmlEntities(latex);\n        mathml = MathML.addAnnotation(mathml, content, 'LaTeX');\n        output = mathml;\n      } else {\n        output = mathml;\n      }\n      if (!latexCache.get(latex)) {\n        latexCache.populate(latex, mathml);\n      }\n    } else {\n      output = `$$${latex}$$`;\n    }\n    return output;\n  }\n\n  /**\n   * Converts all occurrences of MathML code to LaTeX.\n   * The MathML code should containing <annotation encoding=\"LaTeX\"/> to be converted.\n   * @param {String} content - A string containing MathML valid code.\n   * @param {Object} characters - An object containing special characters.\n   * @return {String} A string containing all MathML annotated occurrences\n   * replaced by the corresponding LaTeX code.\n   */\n  static parseMathmlToLatex(content, characters) {\n    let output = '';\n    const mathTagBegin = `${characters.tagOpener}math`;\n    const mathTagEnd = `${characters.tagOpener}/math${characters.tagCloser}`;\n    const openTarget = `${characters.tagOpener}annotation encoding=${characters.doubleQuote}LaTeX${characters.doubleQuote}${characters.tagCloser}`;\n    const closeTarget = `${characters.tagOpener}/annotation${characters.tagCloser}`;\n    let start = content.indexOf(mathTagBegin);\n    let end = 0;\n    let mathml;\n    let startAnnotation;\n    let closeAnnotation;\n\n    while (start !== -1) {\n      output += content.substring(end, start);\n      end = content.indexOf(mathTagEnd, start);\n\n      if (end === -1) {\n        end = content.length - 1;\n      } else {\n        end += mathTagEnd.length;\n      }\n\n      mathml = content.substring(start, end);\n\n      startAnnotation = mathml.indexOf(openTarget);\n      if (startAnnotation !== -1) {\n        startAnnotation += openTarget.length;\n        closeAnnotation = mathml.indexOf(closeTarget);\n        let latex = mathml.substring(startAnnotation, closeAnnotation);\n        if (characters === Constants.safeXmlCharacters) {\n          latex = MathML.safeXmlDecode(latex);\n        }\n        output += `$$${latex}$$`;\n        // Populate latex into cache.\n\n        Latex.cache.populate(latex, mathml);\n      } else {\n        output += mathml;\n      }\n      start = content.indexOf(mathTagBegin, end);\n    }\n\n    output += content.substring(end, content.length);\n    return output;\n  }\n\n  /**\n   * Extracts the latex of a determined position in a text.\n   * @param {Node} textNode - textNode to extract the LaTeX\n   * @param {Number} caretPosition - Starting position to find LaTeX.\n   * @param {Object} latexTags - Optional parameter representing tags between latex is inserted.\n   * It has the 'open' attribute for the open tag and the 'close' attribute for the close tag.\n   * \"$$\" by default.\n   * @return {Object} An object with 3 keys: 'latex', 'start' and 'end'. Null if latex is not found.\n   * @static\n   */\n  static getLatexFromTextNode(textNode, caretPosition, latexTags) {\n    // TODO: Set LaTeX Tags as Core variable. Fix the call to this function (third argument).\n    // Tags used for LaTeX formulas.\n    const defaultLatexTags = {\n      open: '$$',\n      close: '$$',\n    };\n    // latexTags is an optional parameter. If is not set, use default latexTags.\n    if (typeof latexTags === 'undefined' || latexTags == null) {\n      latexTags = defaultLatexTags;\n    }\n    // Looking for the first textNode.\n    let startNode = textNode;\n\n    while (startNode.previousSibling && startNode.previousSibling.nodeType === 3) { // TEXT_NODE.\n      startNode = startNode.previousSibling;\n    }\n\n    /**\n     * Returns the next latex position and node from a specific node and position.\n     * @param {Node} currentNode - Node where searching latex.\n     * @param {Number} currentPosition - Current position inside the currentNode.\n     * @param {Object} latexTagsToUse - Tags used at latex beginning and latex final.\n     * \"$$\" by default.\n     * @param {Boolean} tag - Tag containing the current search.\n     * @returns {Object} Object containing the current node and the position.\n     */\n    function getNextLatexPosition(currentNode, currentPosition, tag) {\n      let position = currentNode.nodeValue.indexOf(tag, currentPosition);\n\n      while (position === -1) {\n        currentNode = currentNode.nextSibling;\n\n        if (!currentNode) { // TEXT_NODE.\n          return null; // Not found.\n        }\n\n        position = currentNode.nodeValue ? currentNode.nodeValue.indexOf(latexTags.close) : -1;\n      }\n\n      return {\n        node: currentNode,\n        position,\n      };\n    }\n\n    /**\n     * Determines if a node is previous, or not, to a second one.\n     * @param {Node} node - Start node.\n     * @param {Number} position - Start node position.\n     * @param {Node} endNode - End node.\n     * @param {Number} endPosition - End node position.\n     * @returns {Boolean} True if the starting node is previous thant the en node. false otherwise.\n     */\n    function isPrevious(node, position, endNode, endPosition) {\n      if (node === endNode) {\n        return (position <= endPosition);\n      }\n      while (node && node !== endNode) {\n        node = node.nextSibling;\n      }\n\n      return (node === endNode);\n    }\n\n    let start;\n    let end = {\n      node: startNode,\n      position: 0,\n    };\n    // Is supposed that open and close tags has the same length.\n    const tagLength = latexTags.open.length;\n    do {\n      start = getNextLatexPosition(end.node, end.position, latexTags.open);\n\n      if (start == null || isPrevious(textNode, caretPosition, start.node, start.position)) {\n        return null;\n      }\n\n      end = getNextLatexPosition(start.node, start.position + tagLength, latexTags.close);\n\n      if (end == null) {\n        return null;\n      }\n\n      end.position += tagLength;\n    } while (isPrevious(end.node, end.position, textNode, caretPosition));\n\n    // Isolating latex.\n    let latex;\n\n    if (start.node === end.node) {\n      latex = start.node.nodeValue.substring(start.position + tagLength, end.position - tagLength);\n    } else {\n      const index = start.position + tagLength;\n      latex = start.node.nodeValue.substring(index, start.node.nodeValue.length);\n      let currentNode = start.node;\n\n      do {\n        currentNode = currentNode.nextSibling;\n        if (currentNode === end.node) {\n          latex += end.node.nodeValue.substring(0, end.position - tagLength);\n        } else {\n          latex += currentNode.nodeValue ? currentNode.nodeValue : '';\n        }\n      } while (currentNode !== end.node);\n    }\n\n    return {\n      latex,\n      startNode: start.node,\n      startPosition: start.position,\n      endNode: end.node,\n      endPosition: end.position,\n    };\n  }\n}\n\n/**\n * Text cache. Stores all processed LaTeX strings and it's correspondent MathML string.\n * @type {Cache}\n * @static\n */\nLatex._cache = new TextCache();\n", "{\n\n    \"ar\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"إلغاء\",\n        \"accept\": \"إدراج\",\n        \"manual\": \"الدليل\",\n        \"insert_math\": \"إدراج صيغة رياضية - MathType\",\n        \"insert_chem\": \"إدراج صيغة كيميائية - ChemType\",\n        \"minimize\": \"تصغير\",\n        \"maximize\": \"تكبير\",\n        \"fullscreen\": \"ملء الشاشة\",\n        \"exit_fullscreen\": \"الخروج من ملء الشاشة\",\n        \"close\": \"إغلاق\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"نافذة MathType مشروطة\",\n        \"close_modal_warning\": \"هل تريد المغادرة بالتأكيد؟ ستُفقد التغييرات التي أجريتها.\",\n        \"latex_name_label\": \"صيغة Latex\",\n        \"browser_no_compatible\": \"المستعرض غير متوافق مع تقنية AJAX. الرجاء استخدام أحدث إصدار من Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"حدث خطأ أثناء التحويل من MathML إلى نص قابل للاستخدام.\",\n        \"exception_cross_site\": \"البرمجة النصية للمواقع المشتركة مسموح بها لـ HTTP فقط.\",\n        \"exception_high_surrogate\": \"المركّب المرتفع غير متبوع بمركّب منخفض في fixedCharCodeAt()‎\",\n        \"exception_string_length\": \"سلسلة غير صالحة. يجب أن يكون الطول من مضاعفات العدد 4\",\n        \"exception_key_nonobject\": \"Object.keys مستدعاة على غير كائن\",\n        \"exception_null_or_undefined\": \" هذا فارغ أو غير محدد\",\n        \"exception_not_function\": \" ليست دالة\",\n        \"exception_invalid_date_format\": \"تنسيق تاريخ غير صالح: \",\n        \"exception_casting\": \"لا يمكن الصياغة \",\n        \"exception_casting_to\": \" إلى \"\n    },\n    \"ca\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Cancel·lar\",\n        \"accept\": \"Inserir\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Inserir fórmula matemàtica - MathType\",\n        \"insert_chem\": \"Inserir fórmula química - ChemType\",\n        \"minimize\": \"Minimitza\",\n        \"maximize\": \"Maximitza\",\n        \"fullscreen\": \"Pantalla completa\",\n        \"exit_fullscreen\": \"Sortir de la pantalla complera\",\n        \"close\": \"Tanca\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \" Finestra modal de MathType\",\n        \"close_modal_warning\": \"N'estàs segur que vols sortir? Es perdran els canvis que has fet.\",\n        \"latex_name_label\": \"Fórmula en Latex\",\n        \"browser_no_compatible\": \"El teu navegador no és compatible amb AJAX. Si us plau, usa la darrera versió de Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Error en convertir de MathML a text accessible.\",\n        \"exception_cross_site\": \"Els scripts de llocs creuats només estan permesos per HTTP.\",\n        \"exception_high_surrogate\": \"Subrogat alt no seguit de subrogat baix a fixedCharCodeAt()\",\n        \"exception_string_length\": \"Cadena invàlida. La longitud ha de ser un múltiple de 4\",\n        \"exception_key_nonobject\": \"Object.keys anomenat a non-object\",\n        \"exception_null_or_undefined\": \" això és null o no definit\",\n        \"exception_not_function\": \" no és una funció\",\n        \"exception_invalid_date_format\": \"Format de data invàlid : \",\n        \"exception_casting\": \"No es pot emetre \",\n        \"exception_casting_to\": \" a \"\n    },\n    \"cs\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Storno\",\n        \"accept\": \"Vložit\",\n        \"manual\": \"Příručka\",\n        \"insert_math\": \"Vložit matematický vzorec - MathType\",\n        \"insert_chem\": \"Vložení chemického vzorce – ChemType\",\n        \"minimize\": \"Minimalizovat\",\n        \"maximize\": \"Maximalizovat\",\n        \"fullscreen\": \"Celá obrazovka\",\n        \"exit_fullscreen\": \"Opustit režim celé obrazovky\",\n        \"close\": \"Zavřít\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Modální okno MathType\",\n        \"close_modal_warning\": \"Opravdu chcete okno zavřít? Provedené změny budou ztraceny.\",\n        \"latex_name_label\": \"Vzorec v LaTeXu\",\n        \"browser_no_compatible\": \"Váš prohlížeč nepodporuje technologii AJAX. Použijte nejnovější verzi prohlížeče Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Při převodu kódu MathML na čitelný text došlo k chybě.\",\n        \"exception_cross_site\": \"Skriptování mezi více servery je povoleno jen v HTTP.\",\n        \"exception_high_surrogate\": \"Ve funkci fixedCharCodeAt() nenásleduje po první části kódu znaku druhá část\",\n        \"exception_string_length\": \"Neplatný řetězec. Délka musí být násobkem 4.\",\n        \"exception_key_nonobject\": \"Funkce Object.keys byla použita pro prvek, který není objektem\",\n        \"exception_null_or_undefined\": \" hodnota je null nebo není definovaná\",\n        \"exception_not_function\": \" není funkce\",\n        \"exception_invalid_date_format\": \"Neplatný formát data: \",\n        \"exception_casting\": \"Nelze přetypovat \",\n        \"exception_casting_to\": \" na \"\n    },\n    \"da\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Annuller\",\n        \"accept\": \"Indsæt\",\n        \"manual\": \"Brugervejledning\",\n        \"insert_math\": \"Indsæt matematisk formel - MathType\",\n        \"insert_chem\": \"Indsæt en kemisk formel - ChemType\",\n        \"minimize\": \"Minimer\",\n        \"maximize\": \"Maksimer\",\n        \"fullscreen\": \"Fuld skærm\",\n        \"exit_fullscreen\": \"Afslut Fuld skærm\",\n        \"close\": \"Luk\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType-modalvindue\",\n        \"close_modal_warning\": \"Er du sikker på, du vil lukke? Dine ændringer går tabt.\",\n        \"latex_name_label\": \"LaTex-formel\",\n        \"browser_no_compatible\": \"Din browser er ikke kompatibel med AJAX-teknologi. Brug den nyeste version af Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Fejl under konvertering fra MathML til tilgængelig tekst.\",\n        \"exception_cross_site\": \"Scripts på tværs af websteder er kun tilladt for HTTP.\",\n        \"exception_high_surrogate\": \"Et højt erstatningstegn er ikke fulgt af et lavt erstatningstegn i fixedCharCodeAt()\",\n        \"exception_string_length\": \"Ugyldig streng. Længden skal være et multiplum af 4\",\n        \"exception_key_nonobject\": \"Object.keys kaldet ved ikke-objekt\",\n        \"exception_null_or_undefined\": \" dette er nul eller ikke defineret\",\n        \"exception_not_function\": \" er ikke en funktion\",\n        \"exception_invalid_date_format\": \"Ugyldigt datoformat: \",\n        \"exception_casting\": \"Kan ikke beregne \",\n        \"exception_casting_to\": \" til \"\n    },\n    \"de\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Abbrechen\",\n        \"accept\": \"Einfügen\",\n        \"manual\": \"Handbuch\",\n        \"insert_math\": \"Mathematische Formel einfügen - MathType\",\n        \"insert_chem\": \"Eine chemische Formel einfügen – ChemType\",\n        \"minimize\": \"Verkleinern\",\n        \"maximize\": \"Vergrößern\",\n        \"fullscreen\": \"Vollbild\",\n        \"exit_fullscreen\": \"Vollbild schließen\",\n        \"close\": \"Schließen\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Modales MathType-Fenster\",\n        \"close_modal_warning\": \"Bist du sicher, dass du das Programm verlassen willst? Alle vorgenommenen Änderungen gehen damit verloren.\",\n        \"latex_name_label\": \"Latex-Formel\",\n        \"browser_no_compatible\": \"Dein Browser ist nicht mit der AJAX-Technologie kompatibel. Verwende bitte die neueste Version von Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Fehler beim Konvertieren von MathML in barrierefreien Text.\",\n        \"exception_cross_site\": \"Cross-Site-Scripting ist nur bei HTTP zulässig.\",\n        \"exception_high_surrogate\": \"Hoher Ersatz bei bei festerZeichenkodierungbei() nicht von niedrigem Ersatz befolgt.\",\n        \"exception_string_length\": \"Ungültige Zeichenfolge. Länge muss ein Vielfaches von 4 sein.\",\n        \"exception_key_nonobject\": \"Object.keys wurde für ein Nicht-Objekt aufgerufen.\",\n        \"exception_null_or_undefined\": \" Das ist Null oder nicht definiert.\",\n        \"exception_not_function\": \" ist keine Funktion\",\n        \"exception_invalid_date_format\": \"Ungültiges Datumsformat: \",\n        \"exception_casting\": \"Umwandlung nicht möglich \",\n        \"exception_casting_to\": \" zu \"\n    },\n    \"el\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Άκυρο\",\n        \"accept\": \"Εισαγωγή\",\n        \"manual\": \"Χειροκίνητα\",\n        \"insert_math\": \"Εισαγωγή μαθηματικού τύπου - MathType\",\n        \"insert_chem\": \"Εισαγωγή χημικού τύπου - ChemType\",\n        \"minimize\": \"Ελαχιστοποίηση\",\n        \"maximize\": \"Μεγιστοποίηση\",\n        \"fullscreen\": \"Πλήρης οθόνη\",\n        \"exit_fullscreen\": \"Έξοδος από πλήρη οθόνη\",\n        \"close\": \"Κλείσιμο\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Τροπικό παράθυρο MathType\",\n        \"close_modal_warning\": \"Επιθυμείτε σίγουρα αποχώρηση; Θα χαθούν οι αλλαγές που έχετε κάνει.\",\n        \"latex_name_label\": \"Τύπος LaTeX\",\n        \"browser_no_compatible\": \"Το πρόγραμμα περιήγησής σας δεν είναι συμβατό με την τεχνολογία AJAX. Χρησιμοποιήστε την πιο πρόσφατη έκδοση του Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Σφάλμα κατά τη μετατροπή από MathML σε προσβάσιμο κείμενο.\",\n        \"exception_cross_site\": \"Το XSS (Cross site scripting) επιτρέπεται μόνο για HTTP.\",\n        \"exception_high_surrogate\": \"Το υψηλό υποκατάστατο δεν ακολουθείται από χαμηλό υποκατάστατο στο fixedCharCodeAt()\",\n        \"exception_string_length\": \"Μη έγκυρη συμβολοσειρά. Το μήκος πρέπει να είναι πολλαπλάσιο του 4\",\n        \"exception_key_nonobject\": \"Έγινε κλήση του Object.keys σε μη αντικείμενο\",\n        \"exception_null_or_undefined\": \" αυτό είναι μηδενικό ή δεν έχει οριστεί\",\n        \"exception_not_function\": \" δεν είναι συνάρτηση\",\n        \"exception_invalid_date_format\": \"Μη έγκυρη μορφή ημερομηνίας: \",\n        \"exception_casting\": \"Δεν είναι δυνατή η μετατροπή \",\n        \"exception_casting_to\": \" σε \"\n    },\n    \"en\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Cancel\",\n        \"accept\": \"Insert\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Insert a math equation - MathType\",\n        \"insert_chem\": \"Insert a chemistry formula - ChemType\",\n        \"minimize\": \"Minimize\",\n        \"maximize\": \"Maximize\",\n        \"fullscreen\": \"Full-screen\",\n        \"exit_fullscreen\": \"Exit full-screen\",\n        \"close\": \"Close\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType modal window\",\n        \"close_modal_warning\": \"Are you sure you want to leave? The changes you made will be lost.\",\n        \"latex_name_label\": \"Latex Formula\",\n        \"browser_no_compatible\": \"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Error converting from MathML to accessible text.\",\n        \"exception_cross_site\": \"Cross site scripting is only allowed for HTTP.\",\n        \"exception_high_surrogate\": \"High surrogate not followed by low surrogate in fixedCharCodeAt()\",\n        \"exception_string_length\": \"Invalid string. Length must be a multiple of 4\",\n        \"exception_key_nonobject\": \"Object.keys called on non-object\",\n        \"exception_null_or_undefined\": \" this is null or not defined\",\n        \"exception_not_function\": \" is not a function\",\n        \"exception_invalid_date_format\": \"Invalid date format : \",\n        \"exception_casting\": \"Cannot cast \",\n        \"exception_casting_to\": \" to \"\n    },\n    \"es\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Cancelar\",\n        \"accept\": \"Insertar\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Insertar fórmula matemática - MathType\",\n        \"insert_chem\": \"Insertar fórmula química - ChemType\",\n        \"minimize\": \"Minimizar\",\n        \"maximize\": \"Maximizar\",\n        \"fullscreen\": \"Pantalla completa\",\n        \"exit_fullscreen\": \"Salir de pantalla completa\",\n        \"close\": \"Cerrar\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Ventana modal de MathType\",\n        \"close_modal_warning\": \"Seguro que quieres cerrar? Los cambios que has hecho se perderán\",\n        \"latex_name_label\": \"Formula en Latex\",\n        \"browser_no_compatible\": \"Tu navegador no es complatible con AJAX. Por favor, usa la última version de Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Error conviertiendo una fórmula MathML a texto accesible.\",\n        \"exception_cross_site\": \"Cross site scripting solo está permitido para HTTP.\",\n        \"exception_high_surrogate\": \"Subrogado alto no seguido por subrogado bajo en fixedCharCodeAt()\",\n        \"exception_string_length\": \"Cadena no válida. La longitud debe ser múltiplo de 4\",\n        \"exception_key_nonobject\": \"Object.keys called on non-object\",\n        \"exception_null_or_undefined\": \" esto es null o no definido\",\n        \"exception_not_function\": \" no es una función\",\n        \"exception_invalid_date_format\": \"Formato de fecha inválido: \",\n        \"exception_casting\": \"No se puede emitir\",\n        \"exception_casting_to\": \" a \"\n    },\n    \"et\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Loobu\",\n        \"accept\": \"Lisa\",\n        \"manual\": \"Käsiraamat\",\n        \"insert_math\": \"Lisa matemaatiline valem – WIRIS\",\n        \"insert_chem\": \"Lisa keemiline valem – ChemType\",\n        \"minimize\": \"Minimeeri\",\n        \"maximize\": \"Maksimeeri\",\n        \"fullscreen\": \"Täiskuva\",\n        \"exit_fullscreen\": \"Välju täiskuvalt\",\n        \"close\": \"Sule\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType'i modaalaken\",\n        \"close_modal_warning\": \"Kas soovite kindlasti lahkuda? Tehtud muudatused lähevad kaduma.\",\n        \"latex_name_label\": \"Latexi valem\",\n        \"browser_no_compatible\": \"Teie brauser ei ühildu AJAXi tehnoloogiaga. Palun kasutage Mozilla Firefoxi uusimat versiooni.\",\n        \"error_convert_accessibility\": \"Tõrge teisendamisel MathML-ist muudetavaks tekstiks.\",\n        \"exception_cross_site\": \"Ristskriptimine on lubatud ainult HTTP kasutamisel.\",\n        \"exception_high_surrogate\": \"Funktsioonis fixedCharCodeAt() ei järgne kõrgemale asendusliikmele madalam asendusliige.\",\n        \"exception_string_length\": \"Vigane string. Pikkus peab olema 4 kordne.\",\n        \"exception_key_nonobject\": \"Protseduur Object.keys kutsuti mitteobjekti korral.\",\n        \"exception_null_or_undefined\": \" see on null või määramata\",\n        \"exception_not_function\": \" ei ole funktsioon\",\n        \"exception_invalid_date_format\": \"Sobimatu kuupäeva kuju: \",\n        \"exception_casting\": \"Esitamine ei õnnestu \",\n        \"exception_casting_to\": \" – \"\n    },\n    \"eu\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Ezeztatu\",\n        \"accept\": \"Txertatu\",\n        \"manual\": \"Gida\",\n        \"insert_math\": \"Txertatu matematikako formula - MathType\",\n        \"insert_chem\": \"Txertatu formula kimiko bat - ChemType\",\n        \"minimize\": \"Ikonotu\",\n        \"maximize\": \"Maximizatu\",\n        \"fullscreen\": \"Pantaila osoa\",\n        \"exit_fullscreen\": \"Irten pantaila osotik\",\n        \"close\": \"Itxi\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType leiho modala\",\n        \"close_modal_warning\": \"Ziur irten nahi duzula? Egiten dituzun aldaketak galdu egingo dira.\",\n        \"latex_name_label\": \"LaTex Formula\",\n        \"browser_no_compatible\": \"Zure arakatzailea ez da bateragarria AJAX teknologiarekin. Erabili Mozilla Firefoxen azken bertsioa.\",\n        \"error_convert_accessibility\": \"Errorea MathMLtik testu irisgarrira bihurtzean.\",\n        \"exception_cross_site\": \"Gune arteko scriptak HTTPrako soilik onartzen dira.\",\n        \"exception_high_surrogate\": \"Ordezko baxuak ez dio ordezko altuari jarraitzen, hemen: fixedCharCodeAt()\",\n        \"exception_string_length\": \"Kate baliogabea. Luzerak 4ren multiploa izan behar du\",\n        \"exception_key_nonobject\": \"Object.keys deitu zaio objektua ez den zerbaiti\",\n        \"exception_null_or_undefined\": \" nulua edo definitu gabea da\",\n        \"exception_not_function\": \" ez da funtzio bat\",\n        \"exception_invalid_date_format\": \"Data-formatu baliogabea : \",\n        \"exception_casting\": \"Ezin da igorri \",\n        \"exception_casting_to\": \" honi \"\n    },\n    \"fi\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Peruuta\",\n        \"accept\": \"Lisää\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Liitä matemaattinen kaava - MathType\",\n        \"insert_chem\": \"Lisää kemian kaava - ChemType\",\n        \"minimize\": \"Pienennä\",\n        \"maximize\": \"Suurenna\",\n        \"fullscreen\": \"Koko ruutu\",\n        \"exit_fullscreen\": \"Poistu koko ruudun tilasta\",\n        \"close\": \"Sulje\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathTypen modaalinen ikkuna\",\n        \"close_modal_warning\": \"Oletko varma, että haluat poistua? Menetät tekemäsi muutokset.\",\n        \"latex_name_label\": \"Latex-kaava\",\n        \"browser_no_compatible\": \"Selaimesi ei tue AJAX-tekniikkaa. Ole hyvä ja käytä uusinta Firefox-versiota.\",\n        \"error_convert_accessibility\": \"Virhe muunnettaessa MathML:stä tekstiksi.\",\n        \"exception_cross_site\": \"Cross site scripting sallitaan vain HTTP:llä.\",\n        \"exception_high_surrogate\": \"fixedCharCodeAt(): yläsijaismerkkiä ei seurannut alasijaismerkki\",\n        \"exception_string_length\": \"Epäkelpo merkkijono. Pituuden on oltava 4:n kerrannainen\",\n        \"exception_key_nonobject\": \"Object.keys kutsui muuta kuin oliota\",\n        \"exception_null_or_undefined\": \" tämä on null tai ei määritelty\",\n        \"exception_not_function\": \" ei ole funktio\",\n        \"exception_invalid_date_format\": \"Virheellinen päivämäärämuoto : \",\n        \"exception_casting\": \"Ei voida muuntaa tyyppiä \",\n        \"exception_casting_to\": \" tyyppiin \"\n    },\n    \"fr\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Annuler\",\n        \"accept\": \"Insérer\",\n        \"manual\": \"Manuel\",\n        \"insert_math\": \"Insérer une formule mathématique - MathType\",\n        \"insert_chem\": \"Insérer une formule chimique - ChemType\",\n        \"minimize\": \"Minimiser\",\n        \"maximize\": \"Maximiser\",\n        \"fullscreen\": \"Plein écran\",\n        \"exit_fullscreen\": \"Quitter le plein écran\",\n        \"close\": \"Fermer\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Fenêtre modale MathType\",\n        \"close_modal_warning\": \"Confirmez-vous vouloir fermer ? Les changements effectués seront perdus.\",\n        \"latex_name_label\": \"Formule LaTeX\",\n        \"browser_no_compatible\": \"Votre navigateur n’est pas compatible avec la technologie AJAX. Veuillez utiliser la dernière version de Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Une erreur de conversion du format MathML en texte accessible est survenue.\",\n        \"exception_cross_site\": \"Le cross-site scripting n’est autorisé que pour HTTP.\",\n        \"exception_high_surrogate\": \"Substitut élevé non suivi d’un substitut inférieur dans fixedCharCodeAt()\",\n        \"exception_string_length\": \"Chaîne non valide. Longueur limitée aux multiples de 4\",\n        \"exception_key_nonobject\": \"Object.keys appelé sur un non-objet\",\n        \"exception_null_or_undefined\": \" nul ou non défini\",\n        \"exception_not_function\": \" n’est pas une fonction\",\n        \"exception_invalid_date_format\": \"Format de date non valide : \",\n        \"exception_casting\": \"Impossible de convertir \",\n        \"exception_casting_to\": \" sur \"\n    },\n    \"gl\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Cancelar\",\n        \"accept\": \"Inserir\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Inserir unha fórmula matemática - MathType\",\n        \"insert_chem\": \"Inserir unha fórmula química - ChemType\",\n        \"minimize\": \"Minimizar\",\n        \"maximize\": \"Maximizar\",\n        \"fullscreen\": \"Pantalla completa\",\n        \"exit_fullscreen\": \"Saír da pantalla completa\",\n        \"close\": \"Pechar\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Ventá modal de MathType\",\n        \"close_modal_warning\": \"Seguro que quere saír? Perderanse os cambios realizados.\",\n        \"latex_name_label\": \"Fórmula Latex\",\n        \"browser_no_compatible\": \"O seu explorador non é compatible coa tecnoloxía AJAX. Use a versión máis recente de Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Erro ao converter de MathML a texto accesible.\",\n        \"exception_cross_site\": \"Os scripts de sitios só se permiten para HTTP.\",\n        \"exception_high_surrogate\": \"Suplente superior non seguido por suplente inferior en fixedCharCodeAt()\",\n        \"exception_string_length\": \"Cadea non válida. A lonxitude debe ser un múltiplo de 4\",\n        \"exception_key_nonobject\": \"Claves de obxecto chamadas en non obxecto\",\n        \"exception_null_or_undefined\": \" nulo ou non definido\",\n        \"exception_not_function\": \" non é unha función\",\n        \"exception_invalid_date_format\": \"Formato de data non válido: \",\n        \"exception_casting\": \"Non se pode converter \",\n        \"exception_casting_to\": \" a \"\n    },\n    \"he\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"ביטול\",\n        \"accept\": \"עדכון\",\n        \"manual\": \"ידני\",\n        \"insert_math\": \"הוספת נוסחה מתמטית - MathType\",\n        \"insert_chem\": \"הוספת כתיבה כימית - ChemType\",\n        \"minimize\": \"מזערי\",\n        \"maximize\": \"מרבי\",\n        \"fullscreen\": \"מסך מלא\",\n        \"exit_fullscreen\": \"יציאה ממצב מסך מלא\",\n        \"close\": \"סגירה\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"חלון מודאלי של MathType\",\n        \"close_modal_warning\": \"האם לצאת? שינויים אשר בוצעו ימחקו.\",\n        \"latex_name_label\": \"נוסחת Latex\",\n        \"browser_no_compatible\": \"הדפדפן שלך אינו תואם לטכנולוגיית AJAX. יש להשתמש בגרסה העדכנית ביותר של Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"שגיאה בהמרה מ-MathML לטקסט נגיש.\",\n        \"exception_cross_site\": \"סקריפטינג חוצה-אתרים מורשה עבור HTTP בלבד.\",\n        \"exception_high_surrogate\": \"ערך ממלא מקום גבוה אינו מופיע אחרי ערך ממלא מקום נמוך ב-fixedCharCodeAt()‎\",\n        \"exception_string_length\": \"מחרוזת לא חוקית. האורך חייב להיות כפולה של 4\",\n        \"exception_key_nonobject\": \"בוצעה קריאה אל Object.keys ברכיב שאינו אובייקט\",\n        \"exception_null_or_undefined\": \" הוא Null או לא מוגדר\",\n        \"exception_not_function\": \"איננה פונקציה\",\n        \"exception_invalid_date_format\": \"תסדיר תאריך אינו תקין : \",\n        \"exception_casting\": \"לא ניתן להמיר \",\n        \"exception_casting_to\": \" ל \"\n    },\n    \"hr\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Poništi\",\n        \"accept\": \"Umetni\",\n        \"manual\": \"Priručnik\",\n        \"insert_math\": \"Umetnite matematičku formulu - MathType\",\n        \"insert_chem\": \"Umetnite kemijsku formulu - ChemType\",\n        \"minimize\": \"Minimiziraj\",\n        \"maximize\": \"Maksimiziraj\",\n        \"fullscreen\": \"Cijeli zaslon\",\n        \"exit_fullscreen\": \"Izlaz iz prikaza na cijelom zaslonu\",\n        \"close\": \"Zatvori\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType modalni prozor\",\n        \"close_modal_warning\": \"Sigurno želite zatvoriti? Izgubit će se unesene promjene.\",\n        \"latex_name_label\": \"Latex formula\",\n        \"browser_no_compatible\": \"Vaš preglednik nije kompatibilan s AJAX tehnologijom. Upotrijebite najnoviju verziju Mozilla Firefoxa.\",\n        \"error_convert_accessibility\": \"Pogreška konverzije iz MathML-a u dostupni tekst.\",\n        \"exception_cross_site\": \"Skriptiranje na različitim web-mjestima dopušteno je samo za HTTP.\",\n        \"exception_high_surrogate\": \"Iza visoke zamjene ne slijedi niska zamjena u fixedCharCodeAt()\",\n        \"exception_string_length\": \"Nevažeći niz. Duljina mora biti višekratnik broja 4\",\n        \"exception_key_nonobject\": \"Object.keys pozvano na ne-objekt\",\n        \"exception_null_or_undefined\": \" ovo je nula ili nije definirano\",\n        \"exception_not_function\": \" nije funkcija\",\n        \"exception_invalid_date_format\": \"Nevažeći format datuma : \",\n        \"exception_casting\": \"Ne može se poslati \",\n        \"exception_casting_to\": \" na \"\n    },\n    \"hu\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Mégsem\",\n        \"accept\": \"Beszúrás\",\n        \"manual\": \"Kézikönyv\",\n        \"insert_math\": \"Matematikai képlet beszúrása - MathType\",\n        \"insert_chem\": \"Kémiai képet beillesztése - ChemType\",\n        \"minimize\": \"Kis méret\",\n        \"maximize\": \"Nagy méret\",\n        \"fullscreen\": \"Teljes képernyő\",\n        \"exit_fullscreen\": \"Teljes képernyő elhagyása\",\n        \"close\": \"Bezárás\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType modális ablak\",\n        \"close_modal_warning\": \"Biztosan kilép? A módosítások el fognak veszni.\",\n        \"latex_name_label\": \"Latex képlet\",\n        \"browser_no_compatible\": \"A böngészője nem kompatibilis az AJAX technológiával. Használja a Mozilla Firefox legújabb verzióját.\",\n        \"error_convert_accessibility\": \"Hiba lépett fel a MathML szöveggé történő konvertálása során.\",\n        \"exception_cross_site\": \"Az oldalak közti scriptelés csak HTTP esetén engedélyezett.\",\n        \"exception_high_surrogate\": \"A magas helyettesítő karaktert nem alacsony helyettesítő karakter követi a fixedCharCodeAt() esetében\",\n        \"exception_string_length\": \"Érvénytelen karakterlánc. A hossznak a 4 többszörösének kell lennie\",\n        \"exception_key_nonobject\": \"Az Object.keys egy nem objektumra került meghívásra\",\n        \"exception_null_or_undefined\": \" null vagy nem definiált\",\n        \"exception_not_function\": \" nem függvény\",\n        \"exception_invalid_date_format\": \"Érvénytelen dátumformátum: \",\n        \"exception_casting\": \"Nem alkalmazható \",\n        \"exception_casting_to\": \" erre \"\n    },\n    \"id\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Membatalkan\",\n        \"accept\": \"Masukkan\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Masukkan rumus matematika - MathType\",\n        \"insert_chem\": \"Masukkan rumus kimia - ChemType\",\n        \"minimize\": \"Minikan\",\n        \"maximize\": \"Perbesar\",\n        \"fullscreen\": \"Layar penuh\",\n        \"exit_fullscreen\": \"Keluar layar penuh\",\n        \"close\": \"Tutup\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Jendela modal MathType\",\n        \"close_modal_warning\": \"Anda yakin ingin keluar? Anda akan kehilangan perubahan yang Anda buat.\",\n        \"latex_name_label\": \"Rumus Latex\",\n        \"browser_no_compatible\": \"Penjelajah Anda tidak kompatibel dengan teknologi AJAX. Harap gunakan Mozilla Firefox versi terbaru.\",\n        \"error_convert_accessibility\": \"Kesalahan konversi dari MathML menjadi teks yang dapat diakses.\",\n        \"exception_cross_site\": \"Skrip lintas situs hanya diizinkan untuk HTTP.\",\n        \"exception_high_surrogate\": \"Pengganti tinggi tidak diikuti oleh pengganti rendah di fixedCharCodeAt()\",\n        \"exception_string_length\": \"String tidak valid. Panjang harus kelipatan 4\",\n        \"exception_key_nonobject\": \"Object.keys meminta nonobjek\",\n        \"exception_null_or_undefined\": \" ini tidak berlaku atau tidak didefinisikan\",\n        \"exception_not_function\": \" bukan sebuah fungsi\",\n        \"exception_invalid_date_format\": \"Format tanggal tidak valid : \",\n        \"exception_casting\": \"Tidak dapat mentransmisikan \",\n        \"exception_casting_to\": \" untuk \"\n    },\n    \"it\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Annulla\",\n        \"accept\": \"Inserisci\",\n        \"manual\": \"Manuale\",\n        \"insert_math\": \"Inserisci una formula matematica - MathType\",\n        \"insert_chem\": \"Inserisci una formula chimica - ChemType\",\n        \"minimize\": \"Riduci a icona\",\n        \"maximize\": \"Ingrandisci\",\n        \"fullscreen\": \"Schermo intero\",\n        \"exit_fullscreen\": \"Esci da schermo intero\",\n        \"close\": \"Chiudi\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Finestra modale di MathType\",\n        \"close_modal_warning\": \"Confermi di voler uscire? Le modifiche effettuate andranno perse.\",\n        \"latex_name_label\": \"Formula LaTeX\",\n        \"browser_no_compatible\": \"Il tuo browser non è compatibile con la tecnologia AJAX. Utilizza la versione più recente di Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Errore durante la conversione da MathML in testo accessibile.\",\n        \"exception_cross_site\": \"Lo scripting tra siti è consentito solo per HTTP.\",\n        \"exception_high_surrogate\": \"Surrogato alto non seguito da surrogato basso in fixedCharCodeAt()\",\n        \"exception_string_length\": \"Stringa non valida. La lunghezza deve essere un multiplo di 4\",\n        \"exception_key_nonobject\": \"Metodo Object.keys richiamato in un elemento non oggetto\",\n        \"exception_null_or_undefined\": \" questo è un valore null o non definito\",\n        \"exception_not_function\": \" non è una funzione\",\n        \"exception_invalid_date_format\": \"Formato di data non valido: \",\n        \"exception_casting\": \"Impossibile eseguire il cast \",\n        \"exception_casting_to\": \" a \"\n    },\n    \"ja\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"キャンセル\",\n        \"accept\": \"挿入\",\n        \"manual\": \"マニュアル\",\n        \"insert_math\": \"数式を挿入 - MathType\",\n        \"insert_chem\": \"化学式を挿入 - ChemType\",\n        \"minimize\": \"最小化\",\n        \"maximize\": \"最大化\",\n        \"fullscreen\": \"全画面表示\",\n        \"exit_fullscreen\": \"全画面表示を解除\",\n        \"close\": \"閉じる\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType モードウィンドウ\",\n        \"close_modal_warning\": \"このページから移動してもよろしいですか？変更内容は失われます。\",\n        \"latex_name_label\": \"LaTeX 数式\",\n        \"browser_no_compatible\": \"お使いのブラウザは、AJAX 技術と互換性がありません。Mozilla Firefox の最新バージョンをご使用ください。\",\n        \"error_convert_accessibility\": \"MathML からアクセシブルなテキストへの変換中にエラーが発生しました。\",\n        \"exception_cross_site\": \"クロスサイトスクリプティングは、HTTP のみに許可されています。\",\n        \"exception_high_surrogate\": \"fixedCharCodeAt（）で上位サロゲートの後に下位サロゲートがありません\",\n        \"exception_string_length\": \"無効な文字列です。長さは4の倍数である必要があります\",\n        \"exception_key_nonobject\": \"Object.keys が非オブジェクトで呼び出されました\",\n        \"exception_null_or_undefined\": \" null であるか、定義されていません\",\n        \"exception_not_function\": \" は関数ではありません\",\n        \"exception_invalid_date_format\": \"無効な日付形式: \",\n        \"exception_casting\": \"次にキャスト \",\n        \"exception_casting_to\": \" できません \"\n    },\n    \"ko\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"취소\",\n        \"accept\": \"삽입\",\n        \"manual\": \"설명서\",\n        \"insert_math\": \"수학 공식 삽입 - MathType\",\n        \"insert_chem\": \"화학 공식 입력하기 - ChemType\",\n        \"minimize\": \"최소화\",\n        \"maximize\": \"최대화\",\n        \"fullscreen\": \"전체 화면\",\n        \"exit_fullscreen\": \"전체 화면 나가기\",\n        \"close\": \"닫기\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType 모달 창\",\n        \"close_modal_warning\": \"정말로 나가시겠습니까? 변경 사항이 손실됩니다.\",\n        \"latex_name_label\": \"Latex 공식\",\n        \"browser_no_compatible\": \"사용자의 브라우저는 AJAX 기술과 호환되지 않습니다. Mozilla Firefox 최신 버전을 사용하십시오.\",\n        \"error_convert_accessibility\": \"MathML로부터 접근 가능한 텍스트로 오류 변환.\",\n        \"exception_cross_site\": \"사이트 교차 스크립팅은 HTTP 환경에서만 사용할 수 있습니다.\",\n        \"exception_high_surrogate\": \"fixedCharCodeAt()에서는 상위 서러게이트 뒤에 하위 서러게이트가 붙지 않습니다\",\n        \"exception_string_length\": \"유효하지 않은 스트링입니다. 길이는 4의 배수여야 합니다\",\n        \"exception_key_nonobject\": \"Object.keys가 non-object를 요청하였습니다\",\n        \"exception_null_or_undefined\": \" Null값이거나 정의되지 않았습니다\",\n        \"exception_not_function\": \" 함수가 아닙니다\",\n        \"exception_invalid_date_format\": \"유효하지 않은 날짜 포맷 : \",\n        \"exception_casting\": \"캐스팅할 수 없습니다 \",\n        \"exception_casting_to\": \" (으)로 \"\n    },\n    \"nl\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Annuleren\",\n        \"insert_chem\": \"Een scheikundige formule invoegen - ChemType\",\n        \"minimize\": \"Minimaliseer\",\n        \"maximize\": \"Maximaliseer\",\n        \"fullscreen\": \"Schermvullend\",\n        \"exit_fullscreen\": \"Verlaat volledig scherm\",\n        \"close\": \"Sluit\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Modaal venster MathType\",\n        \"close_modal_warning\": \"Weet je zeker dat je de app wilt sluiten? De gemaakte wijzigingen gaan verloren.\",\n        \"latex_name_label\": \"LaTeX-formule\",\n        \"browser_no_compatible\": \"Je browser is niet compatibel met AJAX-technologie. Gebruik de meest recente versie van Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Fout bij conversie van MathML naar toegankelijke tekst.\",\n        \"exception_cross_site\": \"Cross-site scripting is alleen toegestaan voor HTTP.\",\n        \"exception_high_surrogate\": \"Hoog surrogaat niet gevolgd door laag surrogaat in fixedCharCodeAt()\",\n        \"exception_string_length\": \"Ongeldige tekenreeks. Lengte moet een veelvoud van 4 zijn\",\n        \"exception_key_nonobject\": \"Object.keys opgeroepen voor niet-object\",\n        \"exception_null_or_undefined\": \" dit is nul of niet gedefinieerd\",\n        \"exception_not_function\": \" is geen functie\",\n        \"exception_invalid_date_format\": \"Ongeldige datumnotatie: \",\n        \"exception_casting\": \"Kan niet weergeven \",\n        \"exception_casting_to\": \" op \"\n    },\n    \"no\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Avbryt\",\n        \"accept\": \"Set inn\",\n        \"manual\": \"Håndbok\",\n        \"insert_math\": \"Sett inn matematikkformel - MathType\",\n        \"insert_chem\": \"Set inn ein kjemisk formel – ChemType\",\n        \"minimize\": \"Minimer\",\n        \"maximize\": \"Maksimer\",\n        \"fullscreen\": \"Fullskjerm\",\n        \"exit_fullscreen\": \"Avslutt fullskjerm\",\n        \"close\": \"Lukk\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Modalt MathType-vindu\",\n        \"close_modal_warning\": \"Er du sikker på at du vil gå ut? Endringane du har gjort, vil gå tapt.\",\n        \"latex_name_label\": \"LaTeX-formel\",\n        \"browser_no_compatible\": \"Nettlesaren er ikkje kompatibel med AJAX-teknologien. Bruk den nyaste versjonen av Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Feil under konvertering frå MathML til tilgjengeleg tekst.\",\n        \"exception_cross_site\": \"Skripting på tvers av nettstadar er bere tillaten med HTTP.\",\n        \"exception_high_surrogate\": \"Høgt surrogat er ikkje etterfølgt av lågt surrogat i fixedCharCodeAt()\",\n        \"exception_string_length\": \"Ugyldig streng. Lengda må vera deleleg på 4\",\n        \"exception_key_nonobject\": \"Object.keys kalla på eit ikkje-objekt\",\n        \"exception_null_or_undefined\": \" dette er null eller ikkje definert\",\n        \"exception_not_function\": \" er ikkje ein funksjon\",\n        \"exception_invalid_date_format\": \"Ugyldig datoformat: \",\n        \"exception_casting\": \"Kan ikkje bruka casting \",\n        \"exception_casting_to\": \" til \"\n    },\n    \"nb\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Avbryt\",\n        \"accept\": \"Insert\",\n        \"manual\": \"Håndbok\",\n        \"insert_math\": \"Sett inn matematikkformel - MathType\",\n        \"insert_chem\": \"Sett inn en kjemisk formel – ChemType\",\n        \"minimize\": \"Minimer\",\n        \"maximize\": \"Maksimer\",\n        \"fullscreen\": \"Fullskjerm\",\n        \"exit_fullscreen\": \"Avslutt fullskjerm\",\n        \"close\": \"Lukk\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Modalt MathType-vindu\",\n        \"close_modal_warning\": \"Er du sikker på at du vil gå ut? Endringene du har gjort, vil gå tapt.\",\n        \"latex_name_label\": \"LaTeX-formel\",\n        \"browser_no_compatible\": \"Nettleseren er ikke kompatibel med AJAX-teknologien. Bruk den nyeste versjonen av Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Feil under konvertering fra MathML til tilgjengelig tekst.\",\n        \"exception_cross_site\": \"Skripting på tvers av nettsteder er bare tillatt med HTTP.\",\n        \"exception_high_surrogate\": \"Høyt surrogat etterfølges ikke av lavt surrogat i fixedCharCodeAt()\",\n        \"exception_string_length\": \"Ugyldig streng. Lengden må være delelig på 4\",\n        \"exception_key_nonobject\": \"Object.keys kalte på et ikke-objekt\",\n        \"exception_null_or_undefined\": \" dette er null eller ikke definert\",\n        \"exception_not_function\": \" er ikke en funksjon\",\n        \"exception_invalid_date_format\": \"Ugyldig datoformat: \",\n        \"exception_casting\": \"Kan ikke bruke casting \",\n        \"exception_casting_to\": \" til \"\n    },\n    \"nn\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Avbryt\",\n        \"accept\": \"Set inn\",\n        \"manual\": \"Håndbok\",\n        \"insert_math\": \"Sett inn matematikkformel - MathType\",\n        \"insert_chem\": \"Set inn ein kjemisk formel – ChemType\",\n        \"minimize\": \"Minimer\",\n        \"maximize\": \"Maksimer\",\n        \"fullscreen\": \"Fullskjerm\",\n        \"exit_fullscreen\": \"Avslutt fullskjerm\",\n        \"close\": \"Lukk\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Modalt MathType-vindu\",\n        \"close_modal_warning\": \"Er du sikker på at du vil gå ut? Endringane du har gjort, vil gå tapt.\",\n        \"latex_name_label\": \"LaTeX-formel\",\n        \"browser_no_compatible\": \"Nettlesaren er ikkje kompatibel med AJAX-teknologien. Bruk den nyaste versjonen av Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Feil under konvertering frå MathML til tilgjengeleg tekst.\",\n        \"exception_cross_site\": \"Skripting på tvers av nettstadar er bere tillaten med HTTP.\",\n        \"exception_high_surrogate\": \"Høgt surrogat er ikkje etterfølgt av lågt surrogat i fixedCharCodeAt()\",\n        \"exception_string_length\": \"Ugyldig streng. Lengda må vera deleleg på 4\",\n        \"exception_key_nonobject\": \"Object.keys kalla på eit ikkje-objekt\",\n        \"exception_null_or_undefined\": \" dette er null eller ikkje definert\",\n        \"exception_not_function\": \" er ikkje ein funksjon\",\n        \"exception_invalid_date_format\": \"Ugyldig datoformat: \",\n        \"exception_casting\": \"Kan ikkje bruka casting \",\n        \"exception_casting_to\": \" til \"\n    },\n\n    \"pl\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Anuluj\",\n        \"accept\": \"Wstaw\",\n        \"manual\": \"Instrukcja\",\n        \"insert_math\": \"Wstaw formułę matematyczną - MathType\",\n        \"insert_chem\": \"Wstaw wzór chemiczny — ChemType\",\n        \"minimize\": \"Minimalizuj\",\n        \"maximize\": \"Maksymalizuj\",\n        \"fullscreen\": \"Pełny ekran\",\n        \"exit_fullscreen\": \"Opuść tryb pełnoekranowy\",\n        \"close\": \"Zamknij\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Okno modalne MathType\",\n        \"close_modal_warning\": \"Czy na pewno chcesz zamknąć? Wprowadzone zmiany zostaną utracone.\",\n        \"latex_name_label\": \"Wzór Latex\",\n        \"browser_no_compatible\": \"Twoja przeglądarka jest niezgodna z technologią AJAX Użyj najnowszej wersji Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Błąd podczas konwertowania z formatu MathML na dostępny tekst.\",\n        \"exception_cross_site\": \"Krzyżowanie skryptów witryny jest dozwolone tylko dla HTTP.\",\n        \"exception_high_surrogate\": \"Brak niskiego surogatu po wysokim surogacie w fixedCharCodeAt()\",\n        \"exception_string_length\": \"Niewłaściwy ciąg znaków. Długość musi być wielokrotnością liczby 4.\",\n        \"exception_key_nonobject\": \"Argumentem wywołanej funkcji Object.key nie jest obiekt.\",\n        \"exception_null_or_undefined\": \" jest zerowy lub niezdefiniowany\",\n        \"exception_not_function\": \" nie jest funkcją\",\n        \"exception_invalid_date_format\": \"Nieprawidłowy format daty: \",\n        \"exception_casting\": \"Nie można rzutować \",\n        \"exception_casting_to\": \" na \"\n    },\n    \"pt\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Cancelar\",\n        \"accept\": \"Inserir\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Inserir fórmula matemática - MathType\",\n        \"insert_chem\": \"Inserir uma fórmula química - ChemType\",\n        \"minimize\": \"Minimizar\",\n        \"maximize\": \"Maximizar\",\n        \"fullscreen\": \"Ecrã completo\",\n        \"exit_fullscreen\": \"Sair do ecrã completo\",\n        \"close\": \"Fechar\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Janela modal do MathType\",\n        \"close_modal_warning\": \"Pretende sair? As alterações efetuadas serão perdidas.\",\n        \"latex_name_label\": \"Fórmula Latex\",\n        \"browser_no_compatible\": \"O seu navegador não é compatível com a tecnologia AJAX. Utilize a versão mais recente do Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Erro ao converter de MathML para texto acessível.\",\n        \"exception_cross_site\": \"O processamento de scripts em vários sites só é permitido para HTTP.\",\n        \"exception_high_surrogate\": \"Substituto alto não seguido por um substituto baixo em fixedCharCodeAt()\",\n        \"exception_string_length\": \"Cadeia inválida. O comprimento tem de ser um múltiplo de 4\",\n        \"exception_key_nonobject\": \"Object.keys chamou um não-objeto\",\n        \"exception_null_or_undefined\": \" é nulo ou não está definido\",\n        \"exception_not_function\": \" não é uma função\",\n        \"exception_invalid_date_format\": \"Formato de data inválido: \",\n        \"exception_casting\": \"Não é possível adicionar \",\n        \"exception_casting_to\": \" até \"\n    },\n    \"pt_br\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Cancelar\",\n        \"accept\": \"Inserir\",\n        \"manual\": \"Manual\",\n        \"insert_math\": \"Inserir fórmula matemática - MathType\",\n        \"insert_chem\": \"Insira uma fórmula química - ChemType\",\n        \"minimize\": \"Minimizar\",\n        \"maximize\": \"Maximizar\",\n        \"fullscreen\": \"Tela cheia\",\n        \"exit_fullscreen\": \"Sair de tela cheia\",\n        \"close\": \"Fechar\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Janela modal do MathType\",\n        \"close_modal_warning\": \"Tem certeza de que deseja sair? Todas as alterações serão perdidas.\",\n        \"latex_name_label\": \"Fórmula LaTeX\",\n        \"browser_no_compatible\": \"O navegador não é compatível com a tecnologia AJAX. Use a versão mais recente do Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Erro ao converter de MathML para texto acessível.\",\n        \"exception_cross_site\": \"O uso de scripts entre sites só é permitido para HTTP.\",\n        \"exception_high_surrogate\": \"High surrogate não seguido de low surrogate em fixedCharCodeAt()\",\n        \"exception_string_length\": \"String inválida. O comprimento deve ser um múltiplo de 4\",\n        \"exception_key_nonobject\": \"Object.keys chamados em não objeto\",\n        \"exception_null_or_undefined\": \" isto é nulo ou não definido\",\n        \"exception_not_function\": \" não é uma função\",\n        \"exception_invalid_date_format\": \"Formato de data inválido: \",\n        \"exception_casting\": \"Não é possível transmitir \",\n        \"exception_casting_to\": \" para \"\n    },\n    \"ro\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Anulare\",\n        \"accept\": \"Inserați\",\n        \"manual\": \"Ghid\",\n        \"insert_math\": \"Inserați o formulă matematică - MathType\",\n        \"insert_chem\": \"Inserați o formulă chimică - ChemType\",\n        \"minimize\": \"Minimizați\",\n        \"maximize\": \"Maximizați\",\n        \"fullscreen\": \"Afișați pe tot ecranul\",\n        \"exit_fullscreen\": \"Opriți afișarea pe tot ecranul\",\n        \"close\": \"Închideți\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Fereastră modală MathType\",\n        \"close_modal_warning\": \"Sigur doriți să ieșiți? Modificările realizate se vor pierde.\",\n        \"latex_name_label\": \"Formulă Latex\",\n        \"browser_no_compatible\": \"Browserul dvs. nu este compatibil cu tehnologia AJAX. Utilizați cea mai recentă versiune de Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Eroare la convertirea din MathML în text accesibil.\",\n        \"exception_cross_site\": \"Scriptarea între site‑uri este permisă doar pentru HTTP.\",\n        \"exception_high_surrogate\": \"Surogatul superior nu este urmat de un surogat inferior în fixedCharCodeAt()\",\n        \"exception_string_length\": \"Șir nevalid. Lungimea trebuie să fie multiplu de 4\",\n        \"exception_key_nonobject\": \"Object.keys a apelat un non-obiect\",\n        \"exception_null_or_undefined\": \" este null sau nu este definit\",\n        \"exception_not_function\": \" nu este funcție\",\n        \"exception_invalid_date_format\": \"Format de dată nevalid: \",\n        \"exception_casting\": \"nu se poate difuza \",\n        \"exception_casting_to\": \" către \"\n    },\n    \"ru\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"отмена\",\n        \"accept\": \"Вставка\",\n        \"manual\": \"вручную\",\n        \"insert_math\": \"Вставить математическую формулу: WIRIS\",\n        \"insert_chem\": \"Вставить химическую формулу — ChemType\",\n        \"minimize\": \"Свернуть\",\n        \"maximize\": \"Развернуть\",\n        \"fullscreen\": \"На весь экран\",\n        \"exit_fullscreen\": \"Выйти из полноэкранного режима\",\n        \"close\": \"Закрыть\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"Режимное окно MathType\",\n        \"close_modal_warning\": \"Вы уверены, что хотите выйти? Все внесенные изменения будут утрачены.\",\n        \"latex_name_label\": \"Формула Latex\",\n        \"browser_no_compatible\": \"Ваш браузер несовместим с технологией AJAX. Используйте последнюю версию Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"При преобразовании формулы в текст допустимого формата произошла ошибка.\",\n        \"exception_cross_site\": \"Межсайтовые сценарии доступны только для HTTP.\",\n        \"exception_high_surrogate\": \"Младший символ-заместитель не сопровождает старший символ-заместитель в исправленном методе CharCodeAt()\",\n        \"exception_string_length\": \"Недопустимая строка. Длинна должна быть кратной 4.\",\n        \"exception_key_nonobject\": \"Метод Object.keys вызван не для объекта\",\n        \"exception_null_or_undefined\": \" значение пустое или не определено\",\n        \"exception_not_function\": \" не функция\",\n        \"exception_invalid_date_format\": \"Недопустимый формат даты: \",\n        \"exception_casting\": \"Не удается привести \",\n        \"exception_casting_to\": \" к \"\n    },\n    \"sv\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Avbryt\",\n        \"accept\": \"Infoga\",\n        \"manual\": \"Bruksanvisning\",\n        \"insert_math\": \"Infoga matematisk formel - MathType\",\n        \"insert_chem\": \"Infoga en kemiformel – ChemType\",\n        \"minimize\": \"Minimera\",\n        \"maximize\": \"Maximera\",\n        \"fullscreen\": \"Helskärm\",\n        \"exit_fullscreen\": \"Stäng helskärm\",\n        \"close\": \"Stäng\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType modulfönster\",\n        \"close_modal_warning\": \"Vill du avsluta? Inga ändringar kommer att sparas.\",\n        \"latex_name_label\": \"Latex-formel\",\n        \"browser_no_compatible\": \"Din webbläsare är inte kompatibel med AJAX-teknik. Använd den senaste versionen av Mozilla Firefox.\",\n        \"error_convert_accessibility\": \"Det uppstod ett fel vid konvertering från MathML till åtkomlig text.\",\n        \"exception_cross_site\": \"Skriptkörning över flera sajter är endast tillåtet för HTTP.\",\n        \"exception_high_surrogate\": \"Hög surrogat följs inte av låg surrogat i fixedCharCodeAt()\",\n        \"exception_string_length\": \"Ogiltig sträng. Längden måste vara en multipel av 4\",\n        \"exception_key_nonobject\": \"Object.keys anropade icke-objekt\",\n        \"exception_null_or_undefined\": \" det är null eller inte definierat\",\n        \"exception_not_function\": \" är inte en funktion\",\n        \"exception_invalid_date_format\": \"Ogiltigt datumformat: \",\n        \"exception_casting\": \"Går inte att konvertera \",\n        \"exception_casting_to\": \" till \"\n    },\n    \"tr\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"Vazgeç\",\n        \"accept\": \"Ekle\",\n        \"manual\": \"Kılavuz\",\n        \"insert_math\": \"Matematik formülü ekle - MathType\",\n        \"insert_chem\": \"Kimya formülü ekleyin - ChemType\",\n        \"minimize\": \"Simge Durumuna Küçült\",\n        \"maximize\": \"Ekranı Kapla\",\n        \"fullscreen\": \"Tam Ekran\",\n        \"exit_fullscreen\": \"Tam Ekrandan Çık\",\n        \"close\": \"Kapat\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType kalıcı penceresi\",\n        \"close_modal_warning\": \"Çıkmak istediğinizden emin misiniz? Yaptığınız değişiklikler kaybolacak.\",\n        \"latex_name_label\": \"Latex Formülü\",\n        \"browser_no_compatible\": \"Tarayıcınız AJAX teknolojisiyle uyumlu değil. Lütfen en güncel Mozilla Firefox sürümünü kullanın.\",\n        \"error_convert_accessibility\": \"MathML biçiminden erişilebilir metne dönüştürme hatası.\",\n        \"exception_cross_site\": \"Siteler arası komut dosyası yazma işlemine yalnızca HTTP için izin verilir.\",\n        \"exception_high_surrogate\": \"fixedCharCodeAt() fonksiyonunda üst vekilin ardından alt vekil gelmiyor\",\n        \"exception_string_length\": \"Geçersiz dizgi. Uzunluk, 4'ün katlarından biri olmalıdır\",\n        \"exception_key_nonobject\": \"Nesne olmayan öğe üzerinde Object.keys çağrıldı\",\n        \"exception_null_or_undefined\": \" bu değer boş veya tanımlanmamış\",\n        \"exception_not_function\": \" bir fonksiyon değil\",\n        \"exception_invalid_date_format\": \"Geçersiz tarih biçimi: \",\n        \"exception_casting\": \"Tür dönüştürülemiyor \",\n        \"exception_casting_to\": \" hedef: \"\n    },\n    \"zh\": {\n        \"latex\": \"LaTeX\",\n        \"cancel\": \"取消\",\n        \"accept\": \"插入\",\n        \"manual\": \"手册\",\n        \"insert_math\": \"插入数学公式 - MathType\",\n        \"insert_chem\": \"插入化学分子式 - ChemType\",\n        \"minimize\": \"最小化\",\n        \"maximize\": \"最大化\",\n        \"fullscreen\": \"全屏幕\",\n        \"exit_fullscreen\": \"退出全屏幕\",\n        \"close\": \"关闭\",\n        \"mathtype\": \"MathType\",\n        \"title_modalwindow\": \"MathType 模式窗口\",\n        \"close_modal_warning\": \"您确定要离开吗？您所做的修改将丢失。\",\n        \"latex_name_label\": \"Latex 分子式\",\n        \"browser_no_compatible\": \"您的浏览器不兼容 AJAX 技术。请使用最新版 Mozilla Firefox。\",\n        \"error_convert_accessibility\": \"将 MathML 转换为可访问文本时出错。\",\n        \"exception_cross_site\": \"仅 HTTP 允许跨站脚本。\",\n        \"exception_high_surrogate\": \"fixedCharCodeAt() 中的高位代理之后未跟随低位代理\",\n        \"exception_string_length\": \"无效字符串。长度必须是 4 的倍数\",\n        \"exception_key_nonobject\": \"非对象调用了 Object.keys\",\n        \"exception_null_or_undefined\": \" 该值为空或未定义\",\n        \"exception_not_function\": \" 不是一个函数\",\n        \"exception_invalid_date_format\": \"无效日期格式： \",\n        \"exception_casting\": \"无法转换 \",\n        \"exception_casting_to\": \" 为 \"\n    },\n    \n\"\": {}\n}\n", "import translations from '../lang/strings.json';\n/**\n * This class represents a string manager. It's used to load localized strings.\n */\nexport default class StringManager {\n  constructor() {\n    throw new Error('Static class StringManager can not be instantiated.');\n  }\n\n  /**\n   * Returns the associated value of certain string key. If the associated value\n   * doesn't exits returns the original key.\n   * @param {string} key - string key\n   * @param {string} lang - DEFAULT = null. Specify the language to translate the string\n   * @returns {string} correspondent value. If doesn't exists original key.\n   */\n  static get(key, lang) {\n\n    // Default language definition\n    let {language} = this;\n\n    // If parameter language, use it\n    if (lang) {\n      language = lang;\n    }\n\n    // Cut down on strings. e.g. en_US -> en\n    if (language && language.length > 2) {\n      language = language.slice(0, 2);\n    }\n\n    // Check if we support the language\n    if (!this.strings.hasOwnProperty(language)) { // eslint-disable-line no-prototype-builtins\n      console.warn(`Unknown language ${language} set in StringManager.`);\n      language = 'en';\n    }\n\n    // Check if the key is supported in the given language\n    if (!this.strings[language].hasOwnProperty(key)) { // eslint-disable-line no-prototype-builtins\n      console.warn(`Unknown key ${key} for language ${language} in StringManager.`);\n      return key;\n    }\n\n    return this.strings[language][key];\n  }\n}\n\n/**\n * Dictionary of dictionaries:\n * Key: language code\n * Value: Key: id of the string\n *        Value: translation of the string\n */\nStringManager.strings = translations;\n\n/**\n * Language of the translations; English by default\n */\nStringManager.language = 'en';\n", "/* eslint-disable no-bitwise */\nimport DOMPurify from 'dompurify';\nimport MathML from './mathml';\nimport Configuration from './configuration';\nimport Latex from './latex';\nimport StringManager from './stringmanager';\n\n/**\n * This class represents an utility class.\n */\nexport default class Util {\n  /**\n   * Fires an event in a target.\n   * @param {EventTarget} eventTarget - target where event should be fired.\n   * @param {string} eventName event to fire.\n   * @static\n   */\n  static fireEvent(eventTarget, eventName) {\n    if (document.createEvent) {\n      const eventObject = document.createEvent('HTMLEvents');\n      eventObject.initEvent(eventName, true, true);\n      return !eventTarget.dispatchEvent(eventObject);\n    }\n\n    const eventObject = document.createEventObject();\n    return eventTarget.fireEvent(`on${eventName}`, eventObject);\n  }\n\n  /**\n   * Cross-browser addEventListener/attachEvent function.\n   * @param {EventTarget} eventTarget - target to add the event.\n   * @param {string} eventName - specifies the type of event.\n   * @param {Function} callBackFunction - callback function.\n   * @static\n   */\n  static addEvent(eventTarget, eventName, callBackFunction) {\n    if (eventTarget.addEventListener) {\n      eventTarget.addEventListener(eventName, callBackFunction, true);\n    } else if (eventTarget.attachEvent) {\n      // Backwards compatibility.\n      eventTarget.attachEvent(`on${eventName}`, callBackFunction);\n    }\n  }\n\n  /**\n   * Cross-browser removeEventListener/detachEvent function.\n   * @param {EventTarget} eventTarget - target to add the event.\n   * @param {string} eventName - specifies the type of event.\n   * @param {Function} callBackFunction - function to remove from the event target.\n   * @static\n   */\n  static removeEvent(eventTarget, eventName, callBackFunction) {\n    if (eventTarget.removeEventListener) {\n      eventTarget.removeEventListener(eventName, callBackFunction, true);\n    } else if (eventTarget.detachEvent) {\n      eventTarget.detachEvent(`on${eventName}`, callBackFunction);\n    }\n  }\n\n  /**\n   * Adds the a callback function, for a certain event target, to the following event types:\n   * - dblclick\n   * - mousedown\n   * - mouseup\n   * @param {EventTarget} eventTarget - event target.\n   * @param {Function} doubleClickHandler - function to run when on dblclick event.\n   * @param {Function} mousedownHandler - function to run when on mousedown event.\n   * @param {Function} mouseupHandler - function to run when on mouseup event.\n   * @static\n   */\n  static addElementEvents(eventTarget, doubleClickHandler, mousedownHandler, mouseupHandler) {\n    if (doubleClickHandler) {\n      this.callbackDblclick = (event) => {\n        const realEvent = (event) || window.event;\n        const element = realEvent.srcElement ? realEvent.srcElement : realEvent.target;\n        doubleClickHandler(element, realEvent);\n      };\n\n      Util.addEvent(eventTarget, 'dblclick', this.callbackDblclick);\n    }\n\n    if (mousedownHandler) {\n      this.callbackMousedown = (event) => {\n        const realEvent = (event) || window.event;\n        const element = realEvent.srcElement ? realEvent.srcElement : realEvent.target;\n        mousedownHandler(element, realEvent);\n      };\n\n      Util.addEvent(eventTarget, 'mousedown', this.callbackMousedown);\n    }\n\n    if (mouseupHandler) {\n      this.callbackMouseup = (event) => {\n        const realEvent = (event) || window.event;\n        const element = realEvent.srcElement ? realEvent.srcElement : realEvent.target;\n        mouseupHandler(element, realEvent);\n      };\n      // Chrome doesn't trigger this event for eventTarget if we release the mouse button\n      // while the mouse is outside the editor text field.\n      // This is a workaround: we trigger the event independently of where the mouse\n      // is when we release its button.\n      Util.addEvent(document, 'mouseup', this.callbackMouseup);\n      Util.addEvent(eventTarget, 'mouseup', this.callbackMouseup);\n    }\n  }\n\n  /**\n   * Remove all callback function, for a certain event target, to the following event types:\n   * - dblclick\n   * - mousedown\n   * - mouseup\n   * @param {EventTarget} eventTarget - event target.\n   * @static\n   */\n  static removeElementEvents(eventTarget) {\n    Util.removeEvent(eventTarget, 'dblclick', this.callbackDblclick);\n    Util.removeEvent(eventTarget, 'mousedown', this.callbackMousedown);\n    Util.removeEvent(document, 'mouseup', this.callbackMouseup);\n    Util.removeEvent(eventTarget, 'mouseup', this.callbackMouseup);\n  }\n\n  /**\n   * Adds a class name to a HTMLElement.\n   * @param {HTMLElement} element - the HTML element.\n   * @param {string} className - the class name.\n   * @static\n   */\n  static addClass(element, className) {\n    if (!Util.containsClass(element, className)) {\n      element.className += ` ${className}`;\n    }\n  }\n\n  /**\n   * Checks if a HTMLElement contains a certain class.\n   * @param {HTMLElement} element - the HTML element.\n   * @param {string} className - the className.\n   * @returns {boolean} true if the HTMLElement contains the class name. false otherwise.\n   * @static\n   */\n  static containsClass(element, className) {\n    if (element == null || !('className' in element)) {\n      return false;\n    }\n\n    const currentClasses = element.className.split(' ');\n\n    for (let i = currentClasses.length - 1; i >= 0; i -= 1) {\n      if (currentClasses[i] === className) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Remove a certain class for a HTMLElement.\n   * @param {HTMLElement} element - the HTML element.\n   * @param {string} className - the class name.\n   * @static\n   */\n  static removeClass(element, className) {\n    let newClassName = '';\n    const classes = element.className.split(' ');\n\n    for (let i = 0; i < classes.length; i += 1) {\n      if (classes[i] !== className) {\n        newClassName += `${classes[i]} `;\n      }\n    }\n    element.className = newClassName.trim();\n  }\n\n  /**\n   * Converts old xml initial text attribute (with «») to the correct one(with §lt;§gt;). It's\n   * used to parse old applets.\n   * @param {string} text - string containing safeXml characters\n   * @returns {string} a string with safeXml characters parsed.\n   * @static\n   */\n  static convertOldXmlinitialtextAttribute(text) {\n    // Used to fix a bug with Cas imported from Moodle 1.9 to Moodle 2.x.\n    // This could be removed in future.\n    const val = 'value=';\n\n    const xitpos = text.indexOf('xmlinitialtext');\n    const valpos = text.indexOf(val, xitpos);\n    const quote = text.charAt(valpos + val.length);\n    const startquote = valpos + val.length + 1;\n    const endquote = text.indexOf(quote, startquote);\n\n    const value = text.substring(startquote, endquote);\n\n    let newvalue = value.split('«').join('§lt;');\n    newvalue = newvalue.split('»').join('§gt;');\n    newvalue = newvalue.split('&').join('§');\n    newvalue = newvalue.split('¨').join('§quot;');\n\n    text = text.split(value).join(newvalue);\n    return text;\n  }\n\n  /**\n   * Cross-browser solution for creating new elements.\n   * @param {string} tagName - tag name of the wished element.\n   * @param {Object} attributes - an object where each key is a wished\n   * attribute name and each value is its value.\n   * @param {Object} [creator] - if supplied, this function will use\n   * the \"createElement\" method from this param. Otherwise\n   * document will be used as creator.\n   * @returns {Element} The DOM element with the specified attributes assigned.\n   * @static\n   */\n  static createElement(tagName, attributes, creator) {\n    if (attributes === undefined) {\n      attributes = {};\n    }\n\n    if (creator === undefined) {\n      creator = document;\n    }\n\n    let element;\n\n    /*\n    * Internet Explorer fix:\n    * If you create a new object dynamically, you can't set a non-standard attribute.\n    * For example, you can't set the \"src\" attribute on an \"applet\" object.\n    * Other browsers will throw an exception and will run the standard code.\n    */\n    try {\n      let html = `<${tagName}`;\n\n      Object.keys(attributes).forEach((attributeName) => {\n        html += ` ${attributeName}=\"${Util.htmlEntities(attributes[attributeName])}\"`;\n      });\n      html += '>';\n      element = creator.createElement(html);\n    } catch (e) {\n      element = creator.createElement(tagName);\n      Object.keys(attributes).forEach((attributeName) => {\n        element.setAttribute(attributeName, attributes[attributeName]);\n      });\n    }\n    return element;\n  }\n\n  /**\n   * Creates new HTML from it's HTML code as string.\n   * @param {string} objectCode - html code\n   * @returns {Element} the HTML element.\n   * @static\n   */\n  static createObject(objectCode, creator) {\n    if (creator === undefined) {\n      creator = document;\n    }\n\n    // Internet Explorer can't include \"param\" tag when is setting an innerHTML property.\n    objectCode = objectCode.split('<applet ').join('<span wirisObject=\"WirisApplet\" ').split('<APPLET ').join('<span wirisObject=\"WirisApplet\" '); // It is a 'span' because 'span' objects can contain 'br' nodes.\n    objectCode = objectCode.split('</applet>').join('</span>').split('</APPLET>').join('</span>');\n\n    objectCode = objectCode.split('<param ').join('<br wirisObject=\"WirisParam\" ').split('<PARAM ').join('<br wirisObject=\"WirisParam\" '); // It is a 'br' because 'br' can't contain nodes.\n    objectCode = objectCode.split('</param>').join('</br>').split('</PARAM>').join('</br>');\n\n    const container = Util.createElement('div', {}, creator);\n    container.innerHTML = objectCode;\n\n    function recursiveParamsFix(object) {\n      if (object.getAttribute && object.getAttribute('wirisObject') === 'WirisParam') {\n        const attributesParsed = {};\n\n        for (let i = 0; i < object.attributes.length; i += 1) {\n          if (object.attributes[i].nodeValue !== null) {\n            attributesParsed[object.attributes[i].nodeName] = object.attributes[i].nodeValue;\n          }\n        }\n\n        const param = Util.createElement('param', attributesParsed, creator);\n\n        // IE fix.\n        if (param.NAME) {\n          param.name = param.NAME;\n          param.value = param.VALUE;\n        }\n\n        param.removeAttribute('wirisObject');\n        object.parentNode.replaceChild(param, object);\n      } else if (object.getAttribute && object.getAttribute('wirisObject') === 'WirisApplet') {\n        const attributesParsed = {};\n\n        for (let i = 0; i < object.attributes.length; i += 1) {\n          if (object.attributes[i].nodeValue !== null) {\n            attributesParsed[object.attributes[i].nodeName] = object.attributes[i].nodeValue;\n          }\n        }\n\n        const applet = Util.createElement('applet', attributesParsed, creator);\n        applet.removeAttribute('wirisObject');\n\n        for (let i = 0; i < object.childNodes.length; i += 1) {\n          recursiveParamsFix(object.childNodes[i]);\n\n          if (object.childNodes[i].nodeName.toLowerCase() === 'param') {\n            applet.appendChild(object.childNodes[i]);\n            i -= 1; // When we insert the object child into the applet, object loses one child.\n          }\n        }\n\n        object.parentNode.replaceChild(applet, object);\n      } else {\n        for (let i = 0; i < object.childNodes.length; i += 1) {\n          recursiveParamsFix(object.childNodes[i]);\n        }\n      }\n    }\n\n    recursiveParamsFix(container);\n    return container.firstChild;\n  }\n\n  /**\n   * Converts an Element to its HTML code.\n   * @param {Element} element - entry element.\n   * @return {string} the HTML code of the input element.\n   * @static\n   */\n  static createObjectCode(element) {\n    // In case that the image was not created, the object can be null or undefined.\n    if (typeof element === 'undefined' || element === null) {\n      return null;\n    }\n\n    if (element.nodeType === 1) { // ELEMENT_NODE.\n      let output = `<${element.tagName}`;\n\n      for (let i = 0; i < element.attributes.length; i += 1) {\n        if (element.attributes[i].specified) {\n          output += ` ${element.attributes[i].name}=\"${Util.htmlEntities(element.attributes[i].value)}\"`;\n        }\n      }\n\n      if (element.childNodes.length > 0) {\n        output += '>';\n\n        for (let i = 0; i < element.childNodes.length; i += 1) {\n          output += Util.createObject(element.childNodes[i]);\n        }\n\n        output += `</${element.tagName}>`;\n      } else if (element.nodeName === 'DIV' || element.nodeName === 'SCRIPT') {\n        output += `></${element.tagName}>`;\n      } else {\n        output += '/>';\n      }\n\n      return output;\n    }\n\n    if (element.nodeType === 3) { // TEXT_NODE.\n      return Util.htmlEntities(element.nodeValue);\n    }\n\n    return '';\n  }\n\n  /**\n   * Concatenates two URL paths.\n   * @param {string} path1 - first URL path\n   * @param {string} path2 - second URL path\n   * @returns {string} new URL.\n   */\n  static concatenateUrl(path1, path2) {\n    let separator = '';\n    if ((path1.indexOf('/') !== path1.length) && (path2.indexOf('/') !== 0)) {\n      separator = '/';\n    }\n    return (path1 + separator + path2).replace(/([^:]\\/)\\/+/g, '$1');\n  }\n\n  /**\n   * Parses a text and replaces all HTML special characters by their correspondent entities.\n   * @param {string} input - text to be parsed.\n   * @returns {string} the input text with all their special characters replaced by their entities.\n   * @static\n   */\n  static htmlEntities(input) {\n    return input.split('&').join('&amp;').split('<').join('&lt;')\n      .split('>')\n      .join('&gt;')\n      .split('\"')\n      .join('&quot;');\n  }\n\n  /**\n   * Sanitize HTML to prevent XSS injections.\n   * @param {string} html - html to be sanitize.\n   * @returns {string} html sanitized.\n   * @static\n   */\n  static htmlSanitize(html) {\n    let annotationRegex = /\\<annotation.+\\<\\/annotation\\>/\n    // Get all the annotation content including the tags.\n    let annotation = html.match(annotationRegex);\n    // Sanitize html code without removing the <semantics> and <annotation> tags.\n    html = DOMPurify.sanitize(html, { ADD_TAGS: ['semantics', 'annotation'], ALLOWED_ATTR: ['mathvariant', 'class', 'linebreak', 'open', 'close']});\n    // Readd old annotation content.\n    return html.replace(annotationRegex, annotation);\n  }\n\n  /**\n   * Parses a text and replaces all the HTML entities by their characters.\n   * @param {string} input - text to be parsed\n   * @returns {string} the input text with all their entities replaced by characters.\n   * @static\n   */\n  static htmlEntitiesDecode(input) {\n    // Textarea element decodes when inner html is set.\n    const textarea = document.createElement('textarea');\n    textarea.innerHTML = input;\n    return textarea.value;\n  }\n\n  /**\n   * Returns a cross-browser http request.\n   * @return {object} httpRequest request object.\n   * @returns {XMLHttpRequest|ActiveXObject} the proper request object.\n   */\n  static createHttpRequest() {\n    const currentPath = window.location.toString().substr(0, window.location.toString().lastIndexOf('/') + 1);\n    if (currentPath.substr(0, 7) === 'file://') {\n      throw StringManager.get('exception_cross_site');\n    }\n\n    if (typeof XMLHttpRequest !== 'undefined') {\n      return new XMLHttpRequest();\n    }\n\n    try {\n      return new ActiveXObject('Msxml2.XMLHTTP');\n    } catch (e) {\n      try {\n        return new ActiveXObject('Microsoft.XMLHTTP');\n      } catch (oc) {\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Converts a hash to a HTTP query.\n   * @param {Object[]} properties - a key/value object.\n   * @returns {string} a HTTP query containing all the key value pairs with\n   * all the special characters replaced by their entities.\n   * @static\n   */\n  static httpBuildQuery(properties) {\n    let result = '';\n\n    Object.keys(properties).forEach((i) => {\n      if (properties[i] != null) {\n        result += `${Util.urlEncode(i)}=${Util.urlEncode(properties[i])}&`;\n      }\n    });\n\n    // Deleting last '&' empty character.\n    if (result.substring(result.length - 1) === '&') {\n      result = result.substring(0, result.length - 1);\n    }\n\n    return result;\n  }\n\n  /**\n   * Convert a hash to string sorting keys to get a deterministic output\n   * @param {Object[]} hash - a key/value object.\n   * @returns {string} a string with the form key1=value1...keyn=valuen\n   * @static\n   */\n  static propertiesToString(hash) {\n    // 1. Sort keys. We sort the keys because we want a deterministic output.\n    const keys = [];\n    Object.keys(hash).forEach((key) => {\n      if (Object.prototype.hasOwnProperty.call(hash, key)) {\n        keys.push(key);\n      }\n    });\n\n    const n = keys.length;\n    for (let i = 0; i < n; i += 1) {\n      for (let j = i + 1; j < n; j += 1) {\n        const s1 = keys[i];\n        const s2 = keys[j];\n        if (Util.compareStrings(s1, s2) > 0) {\n          // Swap.\n          keys[i] = s2;\n          keys[j] = s1;\n        }\n      }\n    }\n\n    // 2. Generate output.\n    let output = '';\n    for (let i = 0; i < n; i += 1) {\n      const key = keys[i];\n      output += key;\n      output += '=';\n      let value = hash[key];\n      value = value.replace('\\\\', '\\\\\\\\');\n      value = value.replace('\\n', '\\\\n');\n      value = value.replace('\\r', '\\\\r');\n      value = value.replace('\\t', '\\\\t');\n\n      output += value;\n      output += '\\n';\n    }\n    return output;\n  }\n\n  /**\n   * Compare two strings using charCodeAt method\n   * @param {string} a - first string to compare.\n   * @param {string} b - second string to compare.\n   * @returns {number} the difference between a and b\n   * @static\n   */\n  static compareStrings(a, b) {\n    let i;\n    const an = a.length;\n    const bn = b.length;\n    const n = (an > bn) ? bn : an;\n    for (i = 0; i < n; i += 1) {\n      const c = Util.fixedCharCodeAt(a, i) - Util.fixedCharCodeAt(b, i);\n      if (c !== 0) {\n        return c;\n      }\n    }\n    return a.length - b.length;\n  }\n\n  /**\n   * Fix charCodeAt() JavaScript function to handle non-Basic-Multilingual-Plane characters.\n   * @param {string} string - input string\n   * @param {number} idx - an integer greater than or equal to 0\n   * and less than the length of the string\n   * @returns {number} an integer representing the UTF-16 code of the string at the given index.\n   * @static\n   */\n  static fixedCharCodeAt(string, idx) {\n    idx = idx || 0;\n    const code = string.charCodeAt(idx);\n    let hi;\n    let low;\n\n    /* High surrogate (could change last hex to 0xDB7F to treat high\n    private surrogates as single characters) */\n\n    if (code >= 0xD800 && code <= 0xDBFF) {\n      hi = code;\n      low = string.charCodeAt(idx + 1);\n      if (Number.isNaN(low)) {\n        throw StringManager.get('exception_high_surrogate');\n      }\n      return ((hi - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000;\n    }\n\n    if (code >= 0xDC00 && code <= 0xDFFF) { // Low surrogate.\n      /* We return false to allow loops to skip this iteration since should have\n      already handled high surrogate above in the previous iteration. */\n      return false;\n    }\n    return code;\n  }\n\n  /**\n   * Returns an URL with it's query params converted into array.\n   * @param {string} url - input URL.\n   * @returns {Object[]} an array containing all URL query params.\n   * @static\n   */\n  static urlToAssArray(url) {\n    let i;\n    i = url.indexOf('?');\n    if (i > 0) {\n      const query = url.substring(i + 1);\n      const ss = query.split('&');\n      const h = {};\n      for (i = 0; i < ss.length; i += 1) {\n        const s = ss[i];\n        const kv = s.split('=');\n        if (kv.length > 1) {\n          h[kv[0]] = decodeURIComponent(kv[1].replace(/\\+/g, ' '));\n        }\n      }\n      return h;\n    }\n    return {};\n  }\n\n  /**\n   * Returns an encoded URL by replacing each instance of certain characters by\n   * one, two, three or four escape sequences using encodeURIComponent method.\n   * !'()* . will not be encoded.\n   *\n   * @param {string} clearString - URL string to be encoded\n   * @returns {string} URL with it's special characters replaced.\n   * @static\n   */\n  static urlEncode(clearString) {\n    let output = '';\n    // Method encodeURIComponent doesn't encode !'()*~ .\n    output = encodeURIComponent(clearString);\n    return output;\n  }\n\n  // TODO: To parser?\n  /**\n   * Converts the HTML of a image into the output code that WIRIS must return.\n   * By default returns the MathML stored on data-mahml attribute (if imgCode is a formula)\n   * or the Wiriscas attribute of a WIRIS applet.\n   * @param {string} imgCode - the html code from a formula or a CAS image.\n   * @param {boolean} convertToXml - true if the image should be converted to XML.\n   * @param {boolean} convertToSafeXml - true if the image should be converted to safeXML.\n   * @returns {string} the XML or safeXML of a WIRIS image.\n   * @static\n   */\n  static getWIRISImageOutput(imgCode, convertToXml, convertToSafeXml) {\n    const imgObject = Util.createObject(imgCode);\n    if (imgObject) {\n      if (imgObject.className === Configuration.get('imageClassName') || imgObject.getAttribute(Configuration.get('imageMathmlAttribute'))) {\n        if (!convertToXml) {\n          return imgCode;\n        }\n\n        const dataMathML = imgObject.getAttribute(Configuration.get('imageMathmlAttribute'));\n        // To handle annotations, first we need the MathML in XML.\n        let mathML = MathML.safeXmlDecode(dataMathML);\n\n        if (!Configuration.get('saveHandTraces')) {\n          mathML = MathML.removeAnnotation(mathML, 'application/json');\n        }\n\n        if (mathML == null) {\n          mathML = imgObject.getAttribute('alt');\n        }\n\n        if (convertToSafeXml) {\n          const safeMathML = MathML.safeXmlEncode(mathML);\n          return safeMathML;\n        }\n\n        return mathML;\n      }\n    }\n    return imgCode;\n  }\n\n  /**\n   * Gets the node length in characters.\n   * @param {Node} node - HTML node.\n   * @returns {number} node length.\n   * @static\n   */\n  static getNodeLength(node) {\n    const staticNodeLengths = {\n      IMG: 1,\n      BR: 1,\n    };\n\n    if (node.nodeType === 3) { // TEXT_NODE.\n      return node.nodeValue.length;\n    }\n\n    if (node.nodeType === 1) { // ELEMENT_NODE.\n      let length = staticNodeLengths[node.nodeName.toUpperCase()];\n\n      if (length === undefined) {\n        length = 0;\n      }\n\n      for (let i = 0; i < node.childNodes.length; i += 1) {\n        length += Util.getNodeLength(node.childNodes[i]);\n      }\n      return length;\n    }\n    return 0;\n  }\n\n  /**\n   * Gets a selected node or text from an editable HTMLElement.\n   * If the caret is on a text node, concatenates it with all the previous and next text nodes.\n   * @param {HTMLElement} target - the editable HTMLElement.\n   * @param {boolean} isIframe  - specifies if the target is an iframe or not\n   * @param {boolean} forceGetSelection - if true, ignores IE system to get\n   * the current selection and uses window.getSelection()\n   * @returns {object} an object with the 'node' key set if the item is an\n   * element or the keys 'node' and 'caretPosition' if the element is text.\n   * @static\n   */\n  static getSelectedItem(target, isIframe, forceGetSelection) {\n    let windowTarget;\n\n    if (isIframe) {\n      windowTarget = target.contentWindow;\n      windowTarget.focus();\n    } else {\n      windowTarget = window;\n      target.focus();\n    }\n\n    if (document.selection && !forceGetSelection) {\n      const range = windowTarget.document.selection.createRange();\n\n      if (range.parentElement) {\n        if (range.htmlText.length > 0) {\n          if (range.text.length === 0) {\n            return Util.getSelectedItem(target, isIframe, true);\n          }\n\n          return null;\n        }\n\n        windowTarget.document.execCommand('InsertImage', false, '#');\n        let temporalObject = range.parentElement();\n\n        if (temporalObject.nodeName.toUpperCase() !== 'IMG') {\n          // IE9 fix: parentElement() does not return the IMG node,\n          // returns the parent DIV node. In IE < 9, pasteHTML does not work well.\n          range.pasteHTML('<span id=\"wrs_openEditorWindow_temporalObject\"></span>');\n          temporalObject = windowTarget.document.getElementById('wrs_openEditorWindow_temporalObject');\n        }\n\n        let node;\n        let caretPosition;\n\n        if (temporalObject.nextSibling && temporalObject.nextSibling.nodeType === 3) { // TEXT_NODE.\n          node = temporalObject.nextSibling;\n          caretPosition = 0;\n        } else if (temporalObject.previousSibling\n          && temporalObject.previousSibling.nodeType === 3) {\n          node = temporalObject.previousSibling;\n          caretPosition = node.nodeValue.length;\n        } else {\n          node = windowTarget.document.createTextNode('');\n          temporalObject.parentNode.insertBefore(node, temporalObject);\n          caretPosition = 0;\n        }\n\n        temporalObject.parentNode.removeChild(temporalObject);\n\n        return {\n          node,\n          caretPosition,\n        };\n      }\n\n      if (range.length > 1) {\n        return null;\n      }\n\n      return {\n        node: range.item(0),\n      };\n    }\n\n    if (windowTarget.getSelection) {\n      let range;\n      const selection = windowTarget.getSelection();\n\n      try {\n        range = selection.getRangeAt(0);\n      } catch (e) {\n        range = windowTarget.document.createRange();\n      }\n\n      const node = range.startContainer;\n\n      if (node.nodeType === 3) { // TEXT_NODE.\n        return {\n          node,\n          caretPosition: range.startOffset,\n        };\n      }\n\n      if (node !== range.endContainer) {\n        return null;\n      }\n\n      if (node.nodeType === 1) { // ELEMENT_NODE.\n        const position = range.startOffset;\n\n        if (node.childNodes[position]) {\n\n          // In case that a formula is detected but not selected,\n          // we create an empty span where we could insert the new formula.\n          if (range.startOffset === range.endOffset) {\n            if (position !== 0 && node.childNodes[position - 1].localName === 'span' && node.childNodes[position].classList.contains('Wirisformula')) {\n              node.childNodes[position - 1].remove();\n              return Util.getSelectedItem(target, isIframe, forceGetSelection);\n            }\n            else if (node.childNodes[position].classList?.contains('Wirisformula')) {\n              if ((position > 0 && node.childNodes[position - 1].classList.contains('Wirisformula')) || position === 0 ) {\n                var emptySpan = document.createElement('span');\n                node.insertBefore(emptySpan, node.childNodes[position]);\n                return {\n                  node: node.childNodes[position],\n                }\n              }\n            }\n          }\n          return {\n            node: node.childNodes[position],\n          };\n        }\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Returns null if there isn't any item or if it is malformed.\n   * Otherwise returns an object containing the node with the MathML image\n   * and the cursor position inside the textarea.\n   * @param {HTMLTextAreaElement} textarea - textarea element.\n   * @returns {Object} An object containing the node, the index of the\n   * beginning  of the selected text, caret position and the start and end position of the\n   * text node.\n   * @static\n   */\n  static getSelectedItemOnTextarea(textarea) {\n    const textNode = document.createTextNode(textarea.value);\n    const textNodeValues = Latex.getLatexFromTextNode(textNode, textarea.selectionStart);\n    if (textNodeValues === null) {\n      return null;\n    }\n\n    return {\n      node: textNode,\n      caretPosition: textarea.selectionStart,\n      startPosition: textNodeValues.startPosition,\n      endPosition: textNodeValues.endPosition,\n    };\n  }\n\n  /**\n   * Looks for elements that match the given name in a HTML code string.\n   * Important: this function is very concrete for WIRIS code.\n   * It takes as preconditions lots of behaviors that are not the general case.\n   * @param {string} code -  HTML code.\n   * @param {string} name - element name.\n   * @param {boolean} autoClosed - true if the elements are autoClosed.\n   * @return {Object[]} an object containing all HTML elements of code matching the name argument.\n   * @static\n   */\n  static getElementsByNameFromString(code, name, autoClosed) {\n    const elements = [];\n    code = code.toLowerCase();\n    name = name.toLowerCase();\n    let start = code.indexOf(`<${name} `);\n\n    while (start !== -1) { // Look for nodes.\n      let endString;\n\n      if (autoClosed) {\n        endString = '>';\n      } else {\n        endString = `</${name}>`;\n      }\n\n      let end = code.indexOf(endString, start);\n\n      if (end !== -1) {\n        end += endString.length;\n        elements.push({\n          start,\n          end,\n        });\n      } else {\n        end = start + 1;\n      }\n\n      start = code.indexOf(`<${name} `, end);\n    }\n\n    return elements;\n  }\n\n  /**\n   * Returns the numeric value of a base64 character.\n   * @param  {string} character - base64 character.\n   * @returns {number} base64 character numeric value.\n   * @static\n   */\n  static decode64(character) {\n    const PLUS = '+'.charCodeAt(0);\n    const SLASH = '/'.charCodeAt(0);\n    const NUMBER = '0'.charCodeAt(0);\n    const LOWER = 'a'.charCodeAt(0);\n    const UPPER = 'A'.charCodeAt(0);\n    const PLUS_URL_SAFE = '-'.charCodeAt(0);\n    const SLASH_URL_SAFE = '_'.charCodeAt(0);\n    const code = character.charCodeAt(0);\n\n    if (code === PLUS || code === PLUS_URL_SAFE) {\n      return 62; // Char '+'.\n    }\n    if (code === SLASH || code === SLASH_URL_SAFE) {\n      return 63; // Char '/'.\n    }\n    if (code < NUMBER) {\n      return -1; // No match.\n    }\n    if (code < NUMBER + 10) {\n      return code - NUMBER + 26 + 26;\n    }\n    if (code < UPPER + 26) {\n      return code - UPPER;\n    }\n    if (code < LOWER + 26) {\n      return code - LOWER + 26;\n    }\n\n    return null;\n  }\n\n  /**\n   * Converts a base64 string to a array of bytes.\n   * @param {string} b64String - base64 string.\n   * @param {number} length - dimension of byte array (by default whole string).\n   * @return {Object[]} the resultant byte array.\n   * @static\n   */\n  static b64ToByteArray(b64String, length) {\n    let tmp;\n\n    if (b64String.length % 4 > 0) {\n      throw new Error('Invalid string. Length must be a multiple of 4'); // Tipped base64. Length is fixed.\n    }\n\n    const arr = [];\n\n    let l;\n    let placeHolders;\n    if (!length) { // All b64String string.\n      if (b64String.charAt(b64String.length - 2) === '=') {\n        placeHolders = 2;\n      } else if (b64String.charAt(b64String.length - 1) === '=') {\n        placeHolders = 1;\n      } else {\n        placeHolders = 0;\n      }\n      l = placeHolders > 0 ? b64String.length - 4 : b64String.length;\n    } else {\n      l = length;\n    }\n\n    let i;\n    for (i = 0; i < l; i += 4) {\n      // Ignoring code checker standards (bitewise operators).\n      // See https://tracker.moodle.org/browse/CONTRIB-5862 for further information.\n      // @codingStandardsIgnoreStart\n      // eslint-disable-next-line max-len\n      tmp = (Util.decode64(b64String.charAt(i)) << 18) | (Util.decode64(b64String.charAt(i + 1)) << 12) | (Util.decode64(b64String.charAt(i + 2)) << 6) | Util.decode64(b64String.charAt(i + 3));\n\n      arr.push((tmp >> 16) & 0xFF);\n      arr.push((tmp >> 8) & 0xFF);\n      arr.push(tmp & 0xFF);\n      // @codingStandardsIgnoreEnd\n    }\n\n    if (placeHolders) {\n      if (placeHolders === 2) {\n        // Ignoring code checker standards (bitewise operators).\n        // @codingStandardsIgnoreStart\n        // eslint-disable-next-line max-len\n        tmp = (Util.decode64(b64String.charAt(i)) << 2) | (Util.decode64(b64String.charAt(i + 1)) >> 4);\n        arr.push(tmp & 0xFF);\n      } else if (placeHolders === 1) {\n        // eslint-disable-next-line max-len\n        tmp = (Util.decode64(b64String.charAt(i)) << 10) | (Util.decode64(b64String.charAt(i + 1)) << 4) | (Util.decode64(b64String.charAt(i + 2)) >> 2);\n        arr.push((tmp >> 8) & 0xFF);\n        arr.push(tmp & 0xFF);\n        // @codingStandardsIgnoreEnd\n      }\n    }\n    return arr;\n  }\n\n  /**\n   * Returns the first 32-bit signed integer from a byte array.\n   * @param {Object[]} bytes - array of bytes.\n   * @returns {number} the 32-bit signed integer.\n   * @static\n   */\n  static readInt32(bytes) {\n    if (bytes.length < 4) {\n      return false;\n    }\n    const int32 = bytes.splice(0, 4);\n    // @codingStandardsIgnoreStart¡\n    return (int32[0] << 24 | int32[1] << 16 | int32[2] << 8 | int32[3] << 0);\n    // @codingStandardsIgnoreEnd\n  }\n\n  /**\n   * Read the first byte from a byte array.\n   * @param {Object} bytes - input byte array.\n   * @returns {number} first byte of the byte array.\n   * @static\n   */\n  static readByte(bytes) {\n    // @codingStandardsIgnoreStart\n    return bytes.shift() << 0;\n    // @codingStandardsIgnoreEnd\n  }\n\n  /**\n   * Read an arbitrary number of bytes, from a fixed position on a byte array.\n   * @param  {Object[]} bytes - byte array.\n   * @param  {number} pos - start position.\n   * @param  {number} len - number of bytes to read.\n   * @returns {Object[]} the byte array.\n   * @static\n   */\n  static readBytes(bytes, pos, len) {\n    return bytes.splice(pos, len);\n  }\n\n  /**\n   * Inserts or modifies formulas or CAS on a textarea.\n   * @param {HTMLTextAreaElement} textarea - textarea target.\n   * @param {string} text - text to add in the textarea. For example, to add the link to the image,\n   * call this function as (textarea, Parser.createImageSrc(mathml));\n   * @static\n   */\n  static updateTextArea(textarea, text) {\n    if (textarea && text) {\n      textarea.focus();\n\n      if (textarea.selectionStart != null) {\n        const { selectionEnd } = textarea;\n        const selectionStart = textarea.value.substring(0, textarea.selectionStart);\n        const selectionEndSub = textarea.value.substring(selectionEnd, textarea.value.length);\n        textarea.value = selectionStart + text + selectionEndSub;\n        textarea.selectionEnd = selectionEnd + text.length;\n      } else {\n        const selection = document.selection.createRange();\n        selection.text = text;\n      }\n    }\n  }\n\n  /**\n   * Modifies existing formula on a textarea.\n   * @param {HTMLTextAreaElement} textarea - text area target.\n   * @param {string} text - text to add in the textarea. For example, if you want to add the link\n   * to the image,you can call this function as\n   * Util.updateTextarea(textarea, Parser.createImageSrc(mathml));\n   * @param {number} start - beginning index from textarea where it needs to be replaced by text.\n   * @param {number} end - ending index from textarea where it needs to be replaced by text\n   * @static\n   */\n  static updateExistingTextOnTextarea(textarea, text, start, end) {\n    textarea.focus();\n    const textareaStart = textarea.value.substring(0, start);\n    textarea.value = textareaStart + text + textarea.value.substring(end, textarea.value.length);\n    textarea.selectionEnd = start + text.length;\n  }\n\n  /**\n   * Add a parameter with it's correspondent value to an URL (GET).\n   * @param {string} path - URL path\n   * @param {string} parameter - parameter\n   * @param {string} value - value\n   * @static\n   */\n  static addArgument(path, parameter, value) {\n    let sep;\n    if (path.indexOf('?') > 0) {\n      sep = '&';\n    } else {\n      sep = '?';\n    }\n    return `${path + sep + parameter}=${value}`;\n  }\n}\n", "import Configuration from './configuration';\nimport Util from './util';\n\n/**\n * @classdesc\n * This class represents MathType Image class. Contains all the logic related\n * to MathType images manipulation.\n * All MathType images are generated using the appropriate MathType\n * integration service: showimage or createimage.\n *\n * There are two available image formats:\n * - svg (default)\n * - png\n *\n * There are two formats for the image src attribute:\n * - A data-uri scheme containing the URL-encoded SVG or a PNG's base64.\n * - A link to the showimage service.\n */\nexport default class Image {\n  /**\n   * Removes data attributes from an image.\n   * @param {HTMLImageElement} img - Image where remove data attributes.\n   */\n  static removeImgDataAttributes(img) {\n    const attributesToRemove = [];\n    const { attributes } = img;\n\n    Object.keys(attributes).forEach((key) => {\n      const attribute = attributes[key];\n      if (attribute !== undefined && attribute.name !== undefined && attribute.name.indexOf('data-') === 0) {\n        // Is preferred keep an array and remove after the search\n        // because when attribute is removed the array of attributes\n        // is modified.\n        attributesToRemove.push(attribute.name);\n      }\n    });\n\n    attributesToRemove.forEach((attribute) => {\n      img.removeAttribute(attribute);\n    });\n  }\n\n  /**\n   * @static\n   * Clones all MathType image attributes from a HTMLImageElement to another.\n   * @param {HTMLImageElement} originImg - The original image.\n   * @param {HTMLImageElement} destImg - The destination image.\n   */\n  static clone(originImg, destImg) {\n    const customEditorAttributeName = Configuration.get('imageCustomEditorName');\n    if (!originImg.hasAttribute(customEditorAttributeName)) {\n      destImg.removeAttribute(customEditorAttributeName);\n    }\n\n    const mathmlAttributeName = Configuration.get('imageMathmlAttribute');\n    const imgAttributes = [\n      mathmlAttributeName,\n      customEditorAttributeName,\n      'alt',\n      'height',\n      'width',\n      'style',\n      'src',\n      'role',\n    ];\n\n    imgAttributes.forEach((iterator) => {\n      const originAttribute = originImg.getAttribute(iterator);\n      if (originAttribute) {\n        destImg.setAttribute(iterator, originAttribute);\n      }\n    });\n  }\n\n  /**\n  * Calculates the metrics of a MathType image given the the service response and the image format.\n  * @param {HTMLImageElement} img - The HTMLImageElement.\n  * @param {String} uri - The URI generated by the image service: can be a data URI scheme or a URL.\n  * @param {Boolean} jsonResponse - True the response of the image service is a\n  * JSON object. False otherwise.\n  */\n  static setImgSize(img, uri, jsonResponse) {\n    let ar;\n    let base64String;\n    let bytes;\n    let svgString;\n    if (jsonResponse) {\n      // Cleaning data:image/png;base64.\n      if (Configuration.get('imageFormat') === 'svg') {\n        // SVG format.\n        // If SVG is encoded in base64 we need to convert the base64 bytes into a SVG string.\n        if (Configuration.get('saveMode') !== 'base64') {\n          ar = Image.getMetricsFromSvgString(uri);\n        } else {\n          base64String = img.src.substr(img.src.indexOf('base64,') + 7, img.src.length);\n          svgString = '';\n          bytes = Util.b64ToByteArray(base64String, base64String.length);\n          for (let i = 0; i < bytes.length; i += 1) {\n            svgString += String.fromCharCode(bytes[i]);\n          }\n          ar = Image.getMetricsFromSvgString(svgString);\n        }\n        // PNG format: we store all metrics information in the first 88 bytes.\n      } else {\n        base64String = img.src.substr(img.src.indexOf('base64,') + 7, img.src.length);\n        bytes = Util.b64ToByteArray(base64String, 88);\n        ar = Image.getMetricsFromBytes(bytes);\n      }\n      // Backwards compatibility: we store the metrics into createimage response.\n    } else {\n      ar = Util.urlToAssArray(uri);\n    }\n    let width = ar.cw;\n    if (!width) {\n      return;\n    }\n    let height = ar.ch;\n    let baseline = ar.cb;\n    const { dpi } = ar;\n    if (dpi) {\n      width = width * 96 / dpi;\n      height = height * 96 / dpi;\n      baseline = baseline * 96 / dpi;\n    }\n    img.width = width;\n    img.height = height;\n    img.style.verticalAlign = `-${height - baseline}px`;\n  }\n\n  /**\n   * Calculates the metrics of an image which has been resized. Is used to restore the original\n   * metrics of a resized image.\n   * @param {HTMLImageElement } img - The resized HTMLImageElement.\n   */\n  static fixAfterResize(img) {\n    img.removeAttribute('style');\n    img.removeAttribute('width');\n    img.removeAttribute('height');\n    // In order to avoid resize with max-width css property.\n    img.style.maxWidth = 'none';\n\n    const processImg = (img) => {\n      if (img.src.indexOf('data:image') !== -1) {\n        if (img.src.indexOf('data:image/svg+xml') !== -1) {\n\n          // Image is in base64\n          if (img.src.indexOf('data:image/svg+xml;base64,') !== -1) {\n            // 'data:image/svg+xml;base64,'.length === 26\n            const base64String = img.getAttribute('src').substring(26);\n            const svgString = window.atob(base64String);\n            const encodedSvgString = encodeURIComponent(svgString);\n            img.setAttribute('src', `data:image/svg+xml;charset=utf8,${encodedSvgString}`);\n          }\n\n          // 'data:image/svg+xml;charset=utf8,'.length === 32.\n          const svg = decodeURIComponent(img.src.substring(32, img.src.length));\n          Image.setImgSize(img, svg, true);\n        } else {\n          // 'data:image/png;base64,' === 22.\n          const base64 = img.src.substring(22, img.src.length);\n          Image.setImgSize(img, base64, true);\n        }\n      } else {\n        Image.setImgSize(img, img.src);\n      }\n    };\n\n    // If the image doesn't contain a blob, just process it normally\n    if (img.src.indexOf('blob:') === -1) {\n      processImg(img);\n    // if it does contain a blob, then read that, replace the src with the decoded content, and process it\n    } else {\n      let reader = new FileReader();\n      reader.onload = function() {\n        img.setAttribute('src', reader.result);\n        processImg(img);\n      };\n      fetch(img.src).then(r => r.blob()).then(blob => {\n        reader.readAsDataURL(blob);\n      });\n    }\n  }\n\n  /**\n   * Returns the metrics (height, width and baseline) contained in a SVG image generated\n   * by the MathType image service. This image contains as an extra custom attribute:\n   * the baseline (wrs:baseline).\n   * @param {String} svgString - The SVG image.\n   * @return {Array} - The image metrics.\n   */\n  static getMetricsFromSvgString(svgString) {\n    let first = svgString.indexOf('height=\"');\n    let last = svgString.indexOf('\"', first + 8, svgString.length);\n    const height = svgString.substring(first + 8, last);\n\n    first = svgString.indexOf('width=\"');\n    last = svgString.indexOf('\"', first + 7, svgString.length);\n    const width = svgString.substring(first + 7, last);\n\n    first = svgString.indexOf('wrs:baseline=\"');\n    last = svgString.indexOf('\"', first + 14, svgString.length);\n    const baseline = svgString.substring(first + 14, last);\n\n    if (typeof width !== 'undefined') {\n      const arr = [];\n      arr.cw = width;\n      arr.ch = height;\n      if (typeof baseline !== 'undefined') {\n        arr.cb = baseline;\n      }\n      return arr;\n    }\n    return [];\n  }\n\n  /**\n   * Returns the metrics (width, height, baseline and dpi) contained in a PNG byte array.\n   * @param  {Array.<Bytes>} bytes - png byte array.\n   * @return {Array} The png metrics.\n   */\n  static getMetricsFromBytes(bytes) {\n    Util.readBytes(bytes, 0, 8);\n    let width;\n    let height;\n    let typ;\n    let baseline;\n    let dpi;\n    while (bytes.length >= 4) {\n      typ = Util.readInt32(bytes);\n      if (typ === 0x49484452) {\n        width = Util.readInt32(bytes);\n        height = Util.readInt32(bytes);\n        // Read 5 bytes.\n        Util.readInt32(bytes);\n        Util.readByte(bytes);\n      } else if (typ === 0x62615345) { // Baseline: 'baSE'.\n        baseline = Util.readInt32(bytes);\n      } else if (typ === 0x70485973) { // Dpis: 'pHYs'.\n        dpi = Util.readInt32(bytes);\n        dpi = (Math.round(dpi / 39.37));\n        Util.readInt32(bytes);\n        Util.readByte(bytes);\n      }\n      Util.readInt32(bytes);\n    }\n\n    if (typeof width !== 'undefined') {\n      const arr = [];\n      arr.cw = width;\n      arr.ch = height;\n      arr.dpi = dpi;\n      if (baseline) {\n        arr.cb = baseline;\n      }\n\n      return arr;\n    }\n    return [];\n  }\n}\n", "import TextCache from './textcache';\nimport ServiceProvider from './serviceprovider';\nimport MathML from './mathml';\nimport StringManager from './stringmanager';\n\n/**\n * @classdesc\n * This class represents MathType accessible class. Converts MathML to accessible text and manages\n * the associated client-side cache.\n */\nexport default class Accessibility {\n  /**\n  * Static property.\n  * Accessibility cache, each entry contains a MathML and its correspondent accessibility text.\n  * @type {TextCache}\n  */\n  static get cache() {\n    return Accessibility._cache;\n  }\n\n  /**\n   * Static property setter.\n   * Set accessibility cache.\n   * @param {TextCahe} value - The property value.\n   * @ignore\n   */\n  static set cache(value) {\n    Accessibility._cache = value;\n  }\n\n  /**\n   * Converts MathML strings to its accessible text representation.\n   * @param {String} mathML - MathML to be converted to accessible text.\n   * @param {String} [language] - Language of the accessible text. 'en' by default.\n   * @param {Array.<String>} [data] - Parameters to send to mathml2accessible service.\n   * @return {String} Accessibility text.\n   */\n  static mathMLToAccessible(mathML, language, data) {\n    if (typeof (language) === 'undefined') {\n      language = 'en';\n    }\n    // Check MathML class. If the class is chemistry,\n    // we add chemistry to data to force accessibility service\n    // to load chemistry grammar.\n    if (MathML.containClass(mathML, 'wrs_chemistry')) {\n      data.mode = 'chemistry';\n    }\n    // Ignore accesibility styles\n    data.ignoreStyles = true;\n    let accessibleText = '';\n\n    if (Accessibility.cache.get(mathML)) {\n      accessibleText = Accessibility.cache.get(mathML);\n    } else {\n      data.service = 'mathml2accessible';\n      data.lang = language;\n      const accessibleJsonResponse = JSON.parse(ServiceProvider.getService('service', data));\n      if (accessibleJsonResponse.status !== 'error') {\n        accessibleText = accessibleJsonResponse.result.text;\n        Accessibility.cache.populate(mathML, accessibleText);\n      } else {\n        accessibleText = StringManager.get('error_convert_accessibility');\n      }\n    }\n\n    return accessibleText;\n  }\n}\n\n/**\n * Contains an instance of TextCache class to manage the JavaScript accessible cache.\n * Each entry of the cache object contains the MathML and it's correspondent accessibility text.\n * @private\n * @type {TextCache}\n */\nAccessibility._cache = new TextCache();\n", "/* eslint-disable */\nvar md5;\nexport default md5;\n\n(function () {\n  var HxOverrides = function () { }\n  HxOverrides.__name__ = true;\n  HxOverrides.dateStr = function (date) {\n    var m = date.getMonth() + 1;\n    var d = date.getDate();\n    var h = date.getHours();\n    var mi = date.getMinutes();\n    var s = date.getSeconds();\n    return date.getFullYear() + \"-\" + (m < 10 ? \"0\" + m : \"\" + m) + \"-\" + (d < 10 ? \"0\" + d : \"\" + d) + \" \" + (h < 10 ? \"0\" + h : \"\" + h) + \":\" + (mi < 10 ? \"0\" + mi : \"\" + mi) + \":\" + (s < 10 ? \"0\" + s : \"\" + s);\n  }\n  HxOverrides.strDate = function (s) {\n    switch (s.length) {\n      case 8:\n        var k = s.split(\":\");\n        var d = new Date();\n        d.setTime(0);\n        d.setUTCHours(k[0]);\n        d.setUTCMinutes(k[1]);\n        d.setUTCSeconds(k[2]);\n        return d;\n      case 10:\n        var k = s.split(\"-\");\n        return new Date(k[0], k[1] - 1, k[2], 0, 0, 0);\n      case 19:\n        var k = s.split(\" \");\n        var y = k[0].split(\"-\");\n        var t = k[1].split(\":\");\n        return new Date(y[0], y[1] - 1, y[2], t[0], t[1], t[2]);\n      default:\n        throw \"Invalid date format : \" + s;\n    }\n  }\n  HxOverrides.cca = function (s, index) {\n    var x = s.charCodeAt(index);\n    if (x != x) return undefined;\n    return x;\n  }\n  HxOverrides.substr = function (s, pos, len) {\n    if (pos != null && pos != 0 && len != null && len < 0) return \"\";\n    if (len == null) len = s.length;\n    if (pos < 0) {\n      pos = s.length + pos;\n      if (pos < 0) pos = 0;\n    } else if (len < 0) len = s.length + len - pos;\n    return s.substr(pos, len);\n  }\n  HxOverrides.remove = function (a, obj) {\n    var i = 0;\n    var l = a.length;\n    while (i < l) {\n      if (a[i] == obj) {\n        a.splice(i, 1);\n        return true;\n      }\n      i++;\n    }\n    return false;\n  }\n  HxOverrides.iter = function (a) {\n    return {\n      cur: 0, arr: a, hasNext: function () {\n        return this.cur < this.arr.length;\n      }, next: function () {\n        return this.arr[this.cur++];\n      }\n    };\n  }\n  var IntIter = function (min, max) {\n    this.min = min;\n    this.max = max;\n  };\n  IntIter.__name__ = true;\n  IntIter.prototype = {\n    next: function () {\n      return this.min++;\n    }\n    , hasNext: function () {\n      return this.min < this.max;\n    }\n    , __class__: IntIter\n  }\n  var Std = function () { }\n  Std.__name__ = true;\n  Std[\"is\"] = function (v, t) {\n    return js.Boot.__instanceof(v, t);\n  }\n  Std.string = function (s) {\n    return js.Boot.__string_rec(s, \"\");\n  }\n  Std[\"int\"] = function (x) {\n    return x | 0;\n  }\n  Std.parseInt = function (x) {\n    var v = parseInt(x, 10);\n    if (v == 0 && (HxOverrides.cca(x, 1) == 120 || HxOverrides.cca(x, 1) == 88)) v = parseInt(x);\n    if (isNaN(v)) return null;\n    return v;\n  }\n  Std.parseFloat = function (x) {\n    return parseFloat(x);\n  }\n  Std.random = function (x) {\n    return Math.floor(Math.random() * x);\n  }\n  var com = com || {}\n  if (!com.wiris) com.wiris = {}\n  if (!com.wiris.js) com.wiris.js = {}\n  com.wiris.js.JsPluginTools = function () {\n    this.tryReady();\n  };\n  com.wiris.js.JsPluginTools.__name__ = true;\n  com.wiris.js.JsPluginTools.main = function () {\n    var ev;\n    ev = com.wiris.js.JsPluginTools.getInstance();\n    haxe.Timer.delay($bind(ev, ev.tryReady), 100);\n  }\n  com.wiris.js.JsPluginTools.getInstance = function () {\n    if (com.wiris.js.JsPluginTools.instance == null) com.wiris.js.JsPluginTools.instance = new com.wiris.js.JsPluginTools();\n    return com.wiris.js.JsPluginTools.instance;\n  }\n  com.wiris.js.JsPluginTools.bypassEncapsulation = function () {\n    if (window.com == null) window.com = {};\n    if (window.com.wiris == null) window.com.wiris = {};\n    if (window.com.wiris.js == null) window.com.wiris.js = {};\n    if (window.com.wiris.js.JsPluginTools == null) window.com.wiris.js.JsPluginTools = com.wiris.js.JsPluginTools.getInstance();\n  }\n  com.wiris.js.JsPluginTools.prototype = {\n    md5encode: function (content) {\n      return haxe.Md5.encode(content);\n    }\n    , doLoad: function () {\n      this.ready = true;\n      com.wiris.js.JsPluginTools.instance = this;\n      com.wiris.js.JsPluginTools.bypassEncapsulation();\n    }\n    , tryReady: function () {\n      this.ready = false;\n      if (js.Lib.document.readyState) {\n        this.doLoad();\n        this.ready = true;\n      }\n      if (!this.ready) haxe.Timer.delay($bind(this, this.tryReady), 100);\n    }\n    , __class__: com.wiris.js.JsPluginTools\n  }\n  var haxe = haxe || {}\n  haxe.Log = function () { }\n  haxe.Log.__name__ = true;\n  haxe.Log.trace = function (v, infos) {\n    js.Boot.__trace(v, infos);\n  }\n  haxe.Log.clear = function () {\n    js.Boot.__clear_trace();\n  }\n  haxe.Md5 = function () {\n  };\n  haxe.Md5.__name__ = true;\n  haxe.Md5.encode = function (s) {\n    return new haxe.Md5().doEncode(s);\n  }\n  haxe.Md5.prototype = {\n    doEncode: function (str) {\n      var x = this.str2blks(str);\n      var a = 1732584193;\n      var b = -271733879;\n      var c = -1732584194;\n      var d = 271733878;\n      var step;\n      var i = 0;\n      while (i < x.length) {\n        var olda = a;\n        var oldb = b;\n        var oldc = c;\n        var oldd = d;\n        step = 0;\n        a = this.ff(a, b, c, d, x[i], 7, -680876936);\n        d = this.ff(d, a, b, c, x[i + 1], 12, -389564586);\n        c = this.ff(c, d, a, b, x[i + 2], 17, 606105819);\n        b = this.ff(b, c, d, a, x[i + 3], 22, -1044525330);\n        a = this.ff(a, b, c, d, x[i + 4], 7, -176418897);\n        d = this.ff(d, a, b, c, x[i + 5], 12, 1200080426);\n        c = this.ff(c, d, a, b, x[i + 6], 17, -1473231341);\n        b = this.ff(b, c, d, a, x[i + 7], 22, -45705983);\n        a = this.ff(a, b, c, d, x[i + 8], 7, 1770035416);\n        d = this.ff(d, a, b, c, x[i + 9], 12, -1958414417);\n        c = this.ff(c, d, a, b, x[i + 10], 17, -42063);\n        b = this.ff(b, c, d, a, x[i + 11], 22, -1990404162);\n        a = this.ff(a, b, c, d, x[i + 12], 7, 1804603682);\n        d = this.ff(d, a, b, c, x[i + 13], 12, -40341101);\n        c = this.ff(c, d, a, b, x[i + 14], 17, -1502002290);\n        b = this.ff(b, c, d, a, x[i + 15], 22, 1236535329);\n        a = this.gg(a, b, c, d, x[i + 1], 5, -165796510);\n        d = this.gg(d, a, b, c, x[i + 6], 9, -1069501632);\n        c = this.gg(c, d, a, b, x[i + 11], 14, 643717713);\n        b = this.gg(b, c, d, a, x[i], 20, -373897302);\n        a = this.gg(a, b, c, d, x[i + 5], 5, -701558691);\n        d = this.gg(d, a, b, c, x[i + 10], 9, 38016083);\n        c = this.gg(c, d, a, b, x[i + 15], 14, -660478335);\n        b = this.gg(b, c, d, a, x[i + 4], 20, -405537848);\n        a = this.gg(a, b, c, d, x[i + 9], 5, 568446438);\n        d = this.gg(d, a, b, c, x[i + 14], 9, -1019803690);\n        c = this.gg(c, d, a, b, x[i + 3], 14, -187363961);\n        b = this.gg(b, c, d, a, x[i + 8], 20, 1163531501);\n        a = this.gg(a, b, c, d, x[i + 13], 5, -1444681467);\n        d = this.gg(d, a, b, c, x[i + 2], 9, -51403784);\n        c = this.gg(c, d, a, b, x[i + 7], 14, 1735328473);\n        b = this.gg(b, c, d, a, x[i + 12], 20, -1926607734);\n        a = this.hh(a, b, c, d, x[i + 5], 4, -378558);\n        d = this.hh(d, a, b, c, x[i + 8], 11, -2022574463);\n        c = this.hh(c, d, a, b, x[i + 11], 16, 1839030562);\n        b = this.hh(b, c, d, a, x[i + 14], 23, -35309556);\n        a = this.hh(a, b, c, d, x[i + 1], 4, -1530992060);\n        d = this.hh(d, a, b, c, x[i + 4], 11, 1272893353);\n        c = this.hh(c, d, a, b, x[i + 7], 16, -155497632);\n        b = this.hh(b, c, d, a, x[i + 10], 23, -1094730640);\n        a = this.hh(a, b, c, d, x[i + 13], 4, 681279174);\n        d = this.hh(d, a, b, c, x[i], 11, -358537222);\n        c = this.hh(c, d, a, b, x[i + 3], 16, -722521979);\n        b = this.hh(b, c, d, a, x[i + 6], 23, 76029189);\n        a = this.hh(a, b, c, d, x[i + 9], 4, -640364487);\n        d = this.hh(d, a, b, c, x[i + 12], 11, -421815835);\n        c = this.hh(c, d, a, b, x[i + 15], 16, 530742520);\n        b = this.hh(b, c, d, a, x[i + 2], 23, -995338651);\n        a = this.ii(a, b, c, d, x[i], 6, -198630844);\n        d = this.ii(d, a, b, c, x[i + 7], 10, 1126891415);\n        c = this.ii(c, d, a, b, x[i + 14], 15, -1416354905);\n        b = this.ii(b, c, d, a, x[i + 5], 21, -57434055);\n        a = this.ii(a, b, c, d, x[i + 12], 6, 1700485571);\n        d = this.ii(d, a, b, c, x[i + 3], 10, -1894986606);\n        c = this.ii(c, d, a, b, x[i + 10], 15, -1051523);\n        b = this.ii(b, c, d, a, x[i + 1], 21, -2054922799);\n        a = this.ii(a, b, c, d, x[i + 8], 6, 1873313359);\n        d = this.ii(d, a, b, c, x[i + 15], 10, -30611744);\n        c = this.ii(c, d, a, b, x[i + 6], 15, -1560198380);\n        b = this.ii(b, c, d, a, x[i + 13], 21, 1309151649);\n        a = this.ii(a, b, c, d, x[i + 4], 6, -145523070);\n        d = this.ii(d, a, b, c, x[i + 11], 10, -1120210379);\n        c = this.ii(c, d, a, b, x[i + 2], 15, 718787259);\n        b = this.ii(b, c, d, a, x[i + 9], 21, -343485551);\n        a = this.addme(a, olda);\n        b = this.addme(b, oldb);\n        c = this.addme(c, oldc);\n        d = this.addme(d, oldd);\n        i += 16;\n      }\n      return this.rhex(a) + this.rhex(b) + this.rhex(c) + this.rhex(d);\n    }\n    , ii: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitXOR(c, this.bitOR(b, ~d)), a, b, x, s, t);\n    }\n    , hh: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitXOR(this.bitXOR(b, c), d), a, b, x, s, t);\n    }\n    , gg: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitOR(this.bitAND(b, d), this.bitAND(c, ~d)), a, b, x, s, t);\n    }\n    , ff: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitOR(this.bitAND(b, c), this.bitAND(~b, d)), a, b, x, s, t);\n    }\n    , cmn: function (q, a, b, x, s, t) {\n      return this.addme(this.rol(this.addme(this.addme(a, q), this.addme(x, t)), s), b);\n    }\n    , rol: function (num, cnt) {\n      return num << cnt | num >>> 32 - cnt;\n    }\n    , str2blks: function (str) {\n      var nblk = (str.length + 8 >> 6) + 1;\n      var blks = new Array();\n      var _g1 = 0, _g = nblk * 16;\n      while (_g1 < _g) {\n        var i = _g1++;\n        blks[i] = 0;\n      }\n      var i = 0;\n      while (i < str.length) {\n        blks[i >> 2] |= HxOverrides.cca(str, i) << (str.length * 8 + i) % 4 * 8;\n        i++;\n      }\n      blks[i >> 2] |= 128 << (str.length * 8 + i) % 4 * 8;\n      var l = str.length * 8;\n      var k = nblk * 16 - 2;\n      blks[k] = l & 255;\n      blks[k] |= (l >>> 8 & 255) << 8;\n      blks[k] |= (l >>> 16 & 255) << 16;\n      blks[k] |= (l >>> 24 & 255) << 24;\n      return blks;\n    }\n    , rhex: function (num) {\n      var str = \"\";\n      var hex_chr = \"0123456789abcdef\";\n      var _g = 0;\n      while (_g < 4) {\n        var j = _g++;\n        str += hex_chr.charAt(num >> j * 8 + 4 & 15) + hex_chr.charAt(num >> j * 8 & 15);\n      }\n      return str;\n    }\n    , addme: function (x, y) {\n      var lsw = (x & 65535) + (y & 65535);\n      var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n      return msw << 16 | lsw & 65535;\n    }\n    , bitAND: function (a, b) {\n      var lsb = a & 1 & (b & 1);\n      var msb31 = a >>> 1 & b >>> 1;\n      return msb31 << 1 | lsb;\n    }\n    , bitXOR: function (a, b) {\n      var lsb = a & 1 ^ b & 1;\n      var msb31 = a >>> 1 ^ b >>> 1;\n      return msb31 << 1 | lsb;\n    }\n    , bitOR: function (a, b) {\n      var lsb = a & 1 | b & 1;\n      var msb31 = a >>> 1 | b >>> 1;\n      return msb31 << 1 | lsb;\n    }\n    , __class__: haxe.Md5\n  }\n  haxe.Timer = function (time_ms) {\n    var me = this;\n    this.id = window.setInterval(function () {\n      me.run();\n    }, time_ms);\n  };\n  haxe.Timer.__name__ = true;\n  haxe.Timer.delay = function (f, time_ms) {\n    var t = new haxe.Timer(time_ms);\n    t.run = function () {\n      t.stop();\n      f();\n    };\n    return t;\n  }\n  haxe.Timer.measure = function (f, pos) {\n    var t0 = haxe.Timer.stamp();\n    var r = f();\n    haxe.Log.trace(haxe.Timer.stamp() - t0 + \"s\", pos);\n    return r;\n  }\n  haxe.Timer.stamp = function () {\n    return new Date().getTime() / 1000;\n  }\n  haxe.Timer.prototype = {\n    run: function () {\n    }\n    , stop: function () {\n      if (this.id == null) return;\n      window.clearInterval(this.id);\n      this.id = null;\n    }\n    , __class__: haxe.Timer\n  }\n  var js = js || {}\n  js.Boot = function () { }\n  js.Boot.__name__ = true;\n  js.Boot.__unhtml = function (s) {\n    return s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n  }\n  js.Boot.__trace = function (v, i) {\n    var msg = i != null ? i.fileName + \":\" + i.lineNumber + \": \" : \"\";\n    msg += js.Boot.__string_rec(v, \"\");\n    var d;\n    if (typeof (document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null) d.innerHTML += js.Boot.__unhtml(msg) + \"<br/>\"; else if (typeof (console) != \"undefined\" && console.log != null) console.log(msg);\n  }\n  js.Boot.__clear_trace = function () {\n    var d = document.getElementById(\"haxe:trace\");\n    if (d != null) d.innerHTML = \"\";\n  }\n  js.Boot.isClass = function (o) {\n    return o.__name__;\n  }\n  js.Boot.isEnum = function (e) {\n    return e.__ename__;\n  }\n  js.Boot.getClass = function (o) {\n    return o.__class__;\n  }\n  js.Boot.__string_rec = function (o, s) {\n    if (o == null) return \"null\";\n    if (s.length >= 5) return \"<...>\";\n    var t = typeof (o);\n    if (t == \"function\" && (o.__name__ || o.__ename__)) t = \"object\";\n    switch (t) {\n      case \"object\":\n        if (o instanceof Array) {\n          if (o.__enum__) {\n            if (o.length == 2) return o[0];\n            var str = o[0] + \"(\";\n            s += \"\\t\";\n            var _g1 = 2, _g = o.length;\n            while (_g1 < _g) {\n              var i = _g1++;\n              if (i != 2) str += \",\" + js.Boot.__string_rec(o[i], s); else str += js.Boot.__string_rec(o[i], s);\n            }\n            return str + \")\";\n          }\n          var l = o.length;\n          var i;\n          var str = \"[\";\n          s += \"\\t\";\n          var _g = 0;\n          while (_g < l) {\n            var i1 = _g++;\n            str += (i1 > 0 ? \",\" : \"\") + js.Boot.__string_rec(o[i1], s);\n          }\n          str += \"]\";\n          return str;\n        }\n        var tostr;\n        try {\n          tostr = o.toString;\n        } catch (e) {\n          return \"???\";\n        }\n        if (tostr != null && tostr != Object.toString) {\n          var s2 = o.toString();\n          if (s2 != \"[object Object]\") return s2;\n        }\n        var k = null;\n        var str = \"{\\n\";\n        s += \"\\t\";\n        var hasp = o.hasOwnProperty != null;\n        for (var k in o) {\n          ;\n          if (hasp && !o.hasOwnProperty(k)) {\n            continue;\n          }\n          if (k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\") {\n            continue;\n          }\n          if (str.length != 2) str += \", \\n\";\n          str += s + k + \" : \" + js.Boot.__string_rec(o[k], s);\n        }\n        s = s.substring(1);\n        str += \"\\n\" + s + \"}\";\n        return str;\n      case \"function\":\n        return \"<function>\";\n      case \"string\":\n        return o;\n      default:\n        return String(o);\n    }\n  }\n  js.Boot.__interfLoop = function (cc, cl) {\n    if (cc == null) return false;\n    if (cc == cl) return true;\n    var intf = cc.__interfaces__;\n    if (intf != null) {\n      var _g1 = 0, _g = intf.length;\n      while (_g1 < _g) {\n        var i = _g1++;\n        var i1 = intf[i];\n        if (i1 == cl || js.Boot.__interfLoop(i1, cl)) return true;\n      }\n    }\n    return js.Boot.__interfLoop(cc.__super__, cl);\n  }\n  js.Boot.__instanceof = function (o, cl) {\n    try {\n      if (o instanceof cl) {\n        if (cl == Array) return o.__enum__ == null;\n        return true;\n      }\n      if (js.Boot.__interfLoop(o.__class__, cl)) return true;\n    } catch (e) {\n      if (cl == null) return false;\n    }\n    switch (cl) {\n      case Int:\n        return Math.ceil(o % 2147483648.0) === o;\n      case Float:\n        return typeof (o) == \"number\";\n      case Bool:\n        return o === true || o === false;\n      case String:\n        return typeof (o) == \"string\";\n      case Dynamic:\n        return true;\n      default:\n        if (o == null) return false;\n        if (cl == Class && o.__name__ != null) return true; else null;\n        if (cl == Enum && o.__ename__ != null) return true; else null;\n        return o.__enum__ == cl;\n    }\n  }\n  js.Boot.__cast = function (o, t) {\n    if (js.Boot.__instanceof(o, t)) return o; else throw \"Cannot cast \" + Std.string(o) + \" to \" + Std.string(t);\n  }\n  js.Lib = function () { }\n  js.Lib.__name__ = true;\n  js.Lib.debug = function () {\n    debugger;\n  }\n  js.Lib.alert = function (v) {\n    alert(js.Boot.__string_rec(v, \"\"));\n  }\n  js.Lib.eval = function (code) {\n    return eval(code);\n  }\n  js.Lib.setErrorHandler = function (f) {\n    js.Lib.onerror = f;\n  }\n  var $_;\n  function $bind(o, m) { var f = function () { return f.method.apply(f.scope, arguments); }; f.scope = o; f.method = m; return f; };\n  if (Array.prototype.indexOf) HxOverrides.remove = function (a, o) {\n    var i = a.indexOf(o);\n    if (i == -1) return false;\n    a.splice(i, 1);\n    return true;\n  }; else null;\n  Math.__name__ = [\"Math\"];\n  Math.NaN = Number.NaN;\n  Math.NEGATIVE_INFINITY = Number.NEGATIVE_INFINITY;\n  Math.POSITIVE_INFINITY = Number.POSITIVE_INFINITY;\n  Math.isFinite = function (i) {\n    return isFinite(i);\n  };\n  Math.isNaN = function (i) {\n    return isNaN(i);\n  };\n  String.prototype.__class__ = String;\n  String.__name__ = true;\n  Array.prototype.__class__ = Array;\n  Array.__name__ = true;\n  Date.prototype.__class__ = Date;\n  Date.__name__ = [\"Date\"];\n  var Int = { __name__: [\"Int\"] };\n  var Dynamic = { __name__: [\"Dynamic\"] };\n  var Float = Number;\n  Float.__name__ = [\"Float\"];\n  var Bool = Boolean;\n  Bool.__ename__ = [\"Bool\"];\n  var Class = { __name__: [\"Class\"] };\n  var Enum = {};\n  var Void = { __ename__: [\"Void\"] };\n  if (typeof document != \"undefined\") js.Lib.document = document;\n  if (typeof window != \"undefined\") {\n    js.Lib.window = window;\n    js.Lib.window.onerror = function (msg, url, line) {\n      var f = js.Lib.onerror;\n      if (f == null) return false;\n      return f(msg, [url + \":\" + line]);\n    };\n  }\n  com.wiris.js.JsPluginTools.main();\n  delete Array.prototype.__class__;\n}());\n\n\n(function () {\n  var HxOverrides = function () { }\n  HxOverrides.__name__ = true;\n  HxOverrides.dateStr = function (date) {\n    var m = date.getMonth() + 1;\n    var d = date.getDate();\n    var h = date.getHours();\n    var mi = date.getMinutes();\n    var s = date.getSeconds();\n    return date.getFullYear() + \"-\" + (m < 10 ? \"0\" + m : \"\" + m) + \"-\" + (d < 10 ? \"0\" + d : \"\" + d) + \" \" + (h < 10 ? \"0\" + h : \"\" + h) + \":\" + (mi < 10 ? \"0\" + mi : \"\" + mi) + \":\" + (s < 10 ? \"0\" + s : \"\" + s);\n  }\n  HxOverrides.strDate = function (s) {\n    switch (s.length) {\n      case 8:\n        var k = s.split(\":\");\n        var d = new Date();\n        d.setTime(0);\n        d.setUTCHours(k[0]);\n        d.setUTCMinutes(k[1]);\n        d.setUTCSeconds(k[2]);\n        return d;\n      case 10:\n        var k = s.split(\"-\");\n        return new Date(k[0], k[1] - 1, k[2], 0, 0, 0);\n      case 19:\n        var k = s.split(\" \");\n        var y = k[0].split(\"-\");\n        var t = k[1].split(\":\");\n        return new Date(y[0], y[1] - 1, y[2], t[0], t[1], t[2]);\n      default:\n        throw \"Invalid date format : \" + s;\n    }\n  }\n  HxOverrides.cca = function (s, index) {\n    var x = s.charCodeAt(index);\n    if (x != x) return undefined;\n    return x;\n  }\n  HxOverrides.substr = function (s, pos, len) {\n    if (pos != null && pos != 0 && len != null && len < 0) return \"\";\n    if (len == null) len = s.length;\n    if (pos < 0) {\n      pos = s.length + pos;\n      if (pos < 0) pos = 0;\n    } else if (len < 0) len = s.length + len - pos;\n    return s.substr(pos, len);\n  }\n  HxOverrides.remove = function (a, obj) {\n    var i = 0;\n    var l = a.length;\n    while (i < l) {\n      if (a[i] == obj) {\n        a.splice(i, 1);\n        return true;\n      }\n      i++;\n    }\n    return false;\n  }\n  HxOverrides.iter = function (a) {\n    return {\n      cur: 0, arr: a, hasNext: function () {\n        return this.cur < this.arr.length;\n      }, next: function () {\n        return this.arr[this.cur++];\n      }\n    };\n  }\n  var IntIter = function (min, max) {\n    this.min = min;\n    this.max = max;\n  };\n  IntIter.__name__ = true;\n  IntIter.prototype = {\n    next: function () {\n      return this.min++;\n    }\n    , hasNext: function () {\n      return this.min < this.max;\n    }\n    , __class__: IntIter\n  }\n  var Std = function () { }\n  Std.__name__ = true;\n  Std[\"is\"] = function (v, t) {\n    return js.Boot.__instanceof(v, t);\n  }\n  Std.string = function (s) {\n    return js.Boot.__string_rec(s, \"\");\n  }\n  Std[\"int\"] = function (x) {\n    return x | 0;\n  }\n  Std.parseInt = function (x) {\n    var v = parseInt(x, 10);\n    if (v == 0 && (HxOverrides.cca(x, 1) == 120 || HxOverrides.cca(x, 1) == 88)) v = parseInt(x);\n    if (isNaN(v)) return null;\n    return v;\n  }\n  Std.parseFloat = function (x) {\n    return parseFloat(x);\n  }\n  Std.random = function (x) {\n    return Math.floor(Math.random() * x);\n  }\n  var com = com || {}\n  if (!com.wiris) com.wiris = {}\n  if (!com.wiris.js) com.wiris.js = {}\n  com.wiris.js.JsPluginTools = function () {\n    this.tryReady();\n  };\n  com.wiris.js.JsPluginTools.__name__ = true;\n  com.wiris.js.JsPluginTools.main = function () {\n    var ev;\n    ev = com.wiris.js.JsPluginTools.getInstance();\n    haxe.Timer.delay($bind(ev, ev.tryReady), 100);\n  }\n  com.wiris.js.JsPluginTools.getInstance = function () {\n    if (com.wiris.js.JsPluginTools.instance == null) com.wiris.js.JsPluginTools.instance = new com.wiris.js.JsPluginTools();\n    return com.wiris.js.JsPluginTools.instance;\n  }\n  com.wiris.js.JsPluginTools.bypassEncapsulation = function () {\n    if (window.com == null) window.com = {};\n    if (window.com.wiris == null) window.com.wiris = {};\n    if (window.com.wiris.js == null) window.com.wiris.js = {};\n    if (window.com.wiris.js.JsPluginTools == null) window.com.wiris.js.JsPluginTools = com.wiris.js.JsPluginTools.getInstance();\n  }\n  com.wiris.js.JsPluginTools.prototype = {\n    md5encode: function (content) {\n      return haxe.Md5.encode(content);\n    }\n    , doLoad: function () {\n      this.ready = true;\n      com.wiris.js.JsPluginTools.instance = this;\n      com.wiris.js.JsPluginTools.bypassEncapsulation();\n    }\n    , tryReady: function () {\n      this.ready = false;\n      if (js.Lib.document.readyState) {\n        this.doLoad();\n        this.ready = true;\n      }\n      if (!this.ready) haxe.Timer.delay($bind(this, this.tryReady), 100);\n    }\n    , __class__: com.wiris.js.JsPluginTools\n  }\n  var haxe = haxe || {}\n  haxe.Log = function () { }\n  haxe.Log.__name__ = true;\n  haxe.Log.trace = function (v, infos) {\n    js.Boot.__trace(v, infos);\n  }\n  haxe.Log.clear = function () {\n    js.Boot.__clear_trace();\n  }\n  haxe.Md5 = function () {\n  };\n  haxe.Md5.__name__ = true;\n  haxe.Md5.encode = function (s) {\n    return new haxe.Md5().doEncode(s);\n  }\n  haxe.Md5.prototype = {\n    doEncode: function (str) {\n      var x = this.str2blks(str);\n      var a = 1732584193;\n      var b = -271733879;\n      var c = -1732584194;\n      var d = 271733878;\n      var step;\n      var i = 0;\n      while (i < x.length) {\n        var olda = a;\n        var oldb = b;\n        var oldc = c;\n        var oldd = d;\n        step = 0;\n        a = this.ff(a, b, c, d, x[i], 7, -680876936);\n        d = this.ff(d, a, b, c, x[i + 1], 12, -389564586);\n        c = this.ff(c, d, a, b, x[i + 2], 17, 606105819);\n        b = this.ff(b, c, d, a, x[i + 3], 22, -1044525330);\n        a = this.ff(a, b, c, d, x[i + 4], 7, -176418897);\n        d = this.ff(d, a, b, c, x[i + 5], 12, 1200080426);\n        c = this.ff(c, d, a, b, x[i + 6], 17, -1473231341);\n        b = this.ff(b, c, d, a, x[i + 7], 22, -45705983);\n        a = this.ff(a, b, c, d, x[i + 8], 7, 1770035416);\n        d = this.ff(d, a, b, c, x[i + 9], 12, -1958414417);\n        c = this.ff(c, d, a, b, x[i + 10], 17, -42063);\n        b = this.ff(b, c, d, a, x[i + 11], 22, -1990404162);\n        a = this.ff(a, b, c, d, x[i + 12], 7, 1804603682);\n        d = this.ff(d, a, b, c, x[i + 13], 12, -40341101);\n        c = this.ff(c, d, a, b, x[i + 14], 17, -1502002290);\n        b = this.ff(b, c, d, a, x[i + 15], 22, 1236535329);\n        a = this.gg(a, b, c, d, x[i + 1], 5, -165796510);\n        d = this.gg(d, a, b, c, x[i + 6], 9, -1069501632);\n        c = this.gg(c, d, a, b, x[i + 11], 14, 643717713);\n        b = this.gg(b, c, d, a, x[i], 20, -373897302);\n        a = this.gg(a, b, c, d, x[i + 5], 5, -701558691);\n        d = this.gg(d, a, b, c, x[i + 10], 9, 38016083);\n        c = this.gg(c, d, a, b, x[i + 15], 14, -660478335);\n        b = this.gg(b, c, d, a, x[i + 4], 20, -405537848);\n        a = this.gg(a, b, c, d, x[i + 9], 5, 568446438);\n        d = this.gg(d, a, b, c, x[i + 14], 9, -1019803690);\n        c = this.gg(c, d, a, b, x[i + 3], 14, -187363961);\n        b = this.gg(b, c, d, a, x[i + 8], 20, 1163531501);\n        a = this.gg(a, b, c, d, x[i + 13], 5, -1444681467);\n        d = this.gg(d, a, b, c, x[i + 2], 9, -51403784);\n        c = this.gg(c, d, a, b, x[i + 7], 14, 1735328473);\n        b = this.gg(b, c, d, a, x[i + 12], 20, -1926607734);\n        a = this.hh(a, b, c, d, x[i + 5], 4, -378558);\n        d = this.hh(d, a, b, c, x[i + 8], 11, -2022574463);\n        c = this.hh(c, d, a, b, x[i + 11], 16, 1839030562);\n        b = this.hh(b, c, d, a, x[i + 14], 23, -35309556);\n        a = this.hh(a, b, c, d, x[i + 1], 4, -1530992060);\n        d = this.hh(d, a, b, c, x[i + 4], 11, 1272893353);\n        c = this.hh(c, d, a, b, x[i + 7], 16, -155497632);\n        b = this.hh(b, c, d, a, x[i + 10], 23, -1094730640);\n        a = this.hh(a, b, c, d, x[i + 13], 4, 681279174);\n        d = this.hh(d, a, b, c, x[i], 11, -358537222);\n        c = this.hh(c, d, a, b, x[i + 3], 16, -722521979);\n        b = this.hh(b, c, d, a, x[i + 6], 23, 76029189);\n        a = this.hh(a, b, c, d, x[i + 9], 4, -640364487);\n        d = this.hh(d, a, b, c, x[i + 12], 11, -421815835);\n        c = this.hh(c, d, a, b, x[i + 15], 16, 530742520);\n        b = this.hh(b, c, d, a, x[i + 2], 23, -995338651);\n        a = this.ii(a, b, c, d, x[i], 6, -198630844);\n        d = this.ii(d, a, b, c, x[i + 7], 10, 1126891415);\n        c = this.ii(c, d, a, b, x[i + 14], 15, -1416354905);\n        b = this.ii(b, c, d, a, x[i + 5], 21, -57434055);\n        a = this.ii(a, b, c, d, x[i + 12], 6, 1700485571);\n        d = this.ii(d, a, b, c, x[i + 3], 10, -1894986606);\n        c = this.ii(c, d, a, b, x[i + 10], 15, -1051523);\n        b = this.ii(b, c, d, a, x[i + 1], 21, -2054922799);\n        a = this.ii(a, b, c, d, x[i + 8], 6, 1873313359);\n        d = this.ii(d, a, b, c, x[i + 15], 10, -30611744);\n        c = this.ii(c, d, a, b, x[i + 6], 15, -1560198380);\n        b = this.ii(b, c, d, a, x[i + 13], 21, 1309151649);\n        a = this.ii(a, b, c, d, x[i + 4], 6, -145523070);\n        d = this.ii(d, a, b, c, x[i + 11], 10, -1120210379);\n        c = this.ii(c, d, a, b, x[i + 2], 15, 718787259);\n        b = this.ii(b, c, d, a, x[i + 9], 21, -343485551);\n        a = this.addme(a, olda);\n        b = this.addme(b, oldb);\n        c = this.addme(c, oldc);\n        d = this.addme(d, oldd);\n        i += 16;\n      }\n      return this.rhex(a) + this.rhex(b) + this.rhex(c) + this.rhex(d);\n    }\n    , ii: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitXOR(c, this.bitOR(b, ~d)), a, b, x, s, t);\n    }\n    , hh: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitXOR(this.bitXOR(b, c), d), a, b, x, s, t);\n    }\n    , gg: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitOR(this.bitAND(b, d), this.bitAND(c, ~d)), a, b, x, s, t);\n    }\n    , ff: function (a, b, c, d, x, s, t) {\n      return this.cmn(this.bitOR(this.bitAND(b, c), this.bitAND(~b, d)), a, b, x, s, t);\n    }\n    , cmn: function (q, a, b, x, s, t) {\n      return this.addme(this.rol(this.addme(this.addme(a, q), this.addme(x, t)), s), b);\n    }\n    , rol: function (num, cnt) {\n      return num << cnt | num >>> 32 - cnt;\n    }\n    , str2blks: function (str) {\n      var nblk = (str.length + 8 >> 6) + 1;\n      var blks = new Array();\n      var _g1 = 0, _g = nblk * 16;\n      while (_g1 < _g) {\n        var i = _g1++;\n        blks[i] = 0;\n      }\n      var i = 0;\n      while (i < str.length) {\n        blks[i >> 2] |= HxOverrides.cca(str, i) << (str.length * 8 + i) % 4 * 8;\n        i++;\n      }\n      blks[i >> 2] |= 128 << (str.length * 8 + i) % 4 * 8;\n      var l = str.length * 8;\n      var k = nblk * 16 - 2;\n      blks[k] = l & 255;\n      blks[k] |= (l >>> 8 & 255) << 8;\n      blks[k] |= (l >>> 16 & 255) << 16;\n      blks[k] |= (l >>> 24 & 255) << 24;\n      return blks;\n    }\n    , rhex: function (num) {\n      var str = \"\";\n      var hex_chr = \"0123456789abcdef\";\n      var _g = 0;\n      while (_g < 4) {\n        var j = _g++;\n        str += hex_chr.charAt(num >> j * 8 + 4 & 15) + hex_chr.charAt(num >> j * 8 & 15);\n      }\n      return str;\n    }\n    , addme: function (x, y) {\n      var lsw = (x & 65535) + (y & 65535);\n      var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n      return msw << 16 | lsw & 65535;\n    }\n    , bitAND: function (a, b) {\n      var lsb = a & 1 & (b & 1);\n      var msb31 = a >>> 1 & b >>> 1;\n      return msb31 << 1 | lsb;\n    }\n    , bitXOR: function (a, b) {\n      var lsb = a & 1 ^ b & 1;\n      var msb31 = a >>> 1 ^ b >>> 1;\n      return msb31 << 1 | lsb;\n    }\n    , bitOR: function (a, b) {\n      var lsb = a & 1 | b & 1;\n      var msb31 = a >>> 1 | b >>> 1;\n      return msb31 << 1 | lsb;\n    }\n    , __class__: haxe.Md5\n  }\n  haxe.Timer = function (time_ms) {\n    var me = this;\n    this.id = window.setInterval(function () {\n      me.run();\n    }, time_ms);\n  };\n  haxe.Timer.__name__ = true;\n  haxe.Timer.delay = function (f, time_ms) {\n    var t = new haxe.Timer(time_ms);\n    t.run = function () {\n      t.stop();\n      f();\n    };\n    return t;\n  }\n  haxe.Timer.measure = function (f, pos) {\n    var t0 = haxe.Timer.stamp();\n    var r = f();\n    haxe.Log.trace(haxe.Timer.stamp() - t0 + \"s\", pos);\n    return r;\n  }\n  haxe.Timer.stamp = function () {\n    return new Date().getTime() / 1000;\n  }\n  haxe.Timer.prototype = {\n    run: function () {\n    }\n    , stop: function () {\n      if (this.id == null) return;\n      window.clearInterval(this.id);\n      this.id = null;\n    }\n    , __class__: haxe.Timer\n  }\n  var js = js || {}\n  js.Boot = function () { }\n  js.Boot.__name__ = true;\n  js.Boot.__unhtml = function (s) {\n    return s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n  }\n  js.Boot.__trace = function (v, i) {\n    var msg = i != null ? i.fileName + \":\" + i.lineNumber + \": \" : \"\";\n    msg += js.Boot.__string_rec(v, \"\");\n    var d;\n    if (typeof (document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null) d.innerHTML += js.Boot.__unhtml(msg) + \"<br/>\"; else if (typeof (console) != \"undefined\" && console.log != null) console.log(msg);\n  }\n  js.Boot.__clear_trace = function () {\n    var d = document.getElementById(\"haxe:trace\");\n    if (d != null) d.innerHTML = \"\";\n  }\n  js.Boot.isClass = function (o) {\n    return o.__name__;\n  }\n  js.Boot.isEnum = function (e) {\n    return e.__ename__;\n  }\n  js.Boot.getClass = function (o) {\n    return o.__class__;\n  }\n  js.Boot.__string_rec = function (o, s) {\n    if (o == null) return \"null\";\n    if (s.length >= 5) return \"<...>\";\n    var t = typeof (o);\n    if (t == \"function\" && (o.__name__ || o.__ename__)) t = \"object\";\n    switch (t) {\n      case \"object\":\n        if (o instanceof Array) {\n          if (o.__enum__) {\n            if (o.length == 2) return o[0];\n            var str = o[0] + \"(\";\n            s += \"\\t\";\n            var _g1 = 2, _g = o.length;\n            while (_g1 < _g) {\n              var i = _g1++;\n              if (i != 2) str += \",\" + js.Boot.__string_rec(o[i], s); else str += js.Boot.__string_rec(o[i], s);\n            }\n            return str + \")\";\n          }\n          var l = o.length;\n          var i;\n          var str = \"[\";\n          s += \"\\t\";\n          var _g = 0;\n          while (_g < l) {\n            var i1 = _g++;\n            str += (i1 > 0 ? \",\" : \"\") + js.Boot.__string_rec(o[i1], s);\n          }\n          str += \"]\";\n          return str;\n        }\n        var tostr;\n        try {\n          tostr = o.toString;\n        } catch (e) {\n          return \"???\";\n        }\n        if (tostr != null && tostr != Object.toString) {\n          var s2 = o.toString();\n          if (s2 != \"[object Object]\") return s2;\n        }\n        var k = null;\n        var str = \"{\\n\";\n        s += \"\\t\";\n        var hasp = o.hasOwnProperty != null;\n        for (var k in o) {\n          ;\n          if (hasp && !o.hasOwnProperty(k)) {\n            continue;\n          }\n          if (k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\") {\n            continue;\n          }\n          if (str.length != 2) str += \", \\n\";\n          str += s + k + \" : \" + js.Boot.__string_rec(o[k], s);\n        }\n        s = s.substring(1);\n        str += \"\\n\" + s + \"}\";\n        return str;\n      case \"function\":\n        return \"<function>\";\n      case \"string\":\n        return o;\n      default:\n        return String(o);\n    }\n  }\n  js.Boot.__interfLoop = function (cc, cl) {\n    if (cc == null) return false;\n    if (cc == cl) return true;\n    var intf = cc.__interfaces__;\n    if (intf != null) {\n      var _g1 = 0, _g = intf.length;\n      while (_g1 < _g) {\n        var i = _g1++;\n        var i1 = intf[i];\n        if (i1 == cl || js.Boot.__interfLoop(i1, cl)) return true;\n      }\n    }\n    return js.Boot.__interfLoop(cc.__super__, cl);\n  }\n  js.Boot.__instanceof = function (o, cl) {\n    try {\n      if (o instanceof cl) {\n        if (cl == Array) return o.__enum__ == null;\n        return true;\n      }\n      if (js.Boot.__interfLoop(o.__class__, cl)) return true;\n    } catch (e) {\n      if (cl == null) return false;\n    }\n    switch (cl) {\n      case Int:\n        return Math.ceil(o % 2147483648.0) === o;\n      case Float:\n        return typeof (o) == \"number\";\n      case Bool:\n        return o === true || o === false;\n      case String:\n        return typeof (o) == \"string\";\n      case Dynamic:\n        return true;\n      default:\n        if (o == null) return false;\n        if (cl == Class && o.__name__ != null) return true; else null;\n        if (cl == Enum && o.__ename__ != null) return true; else null;\n        return o.__enum__ == cl;\n    }\n  }\n  js.Boot.__cast = function (o, t) {\n    if (js.Boot.__instanceof(o, t)) return o; else throw \"Cannot cast \" + Std.string(o) + \" to \" + Std.string(t);\n  }\n  js.Lib = function () { }\n  js.Lib.__name__ = true;\n  js.Lib.debug = function () {\n    debugger;\n  }\n  js.Lib.alert = function (v) {\n    alert(js.Boot.__string_rec(v, \"\"));\n  }\n  js.Lib.eval = function (code) {\n    return eval(code);\n  }\n  js.Lib.setErrorHandler = function (f) {\n    js.Lib.onerror = f;\n  }\n  var $_;\n  function $bind(o, m) { var f = function () { return f.method.apply(f.scope, arguments); }; f.scope = o; f.method = m; return f; };\n  if (Array.prototype.indexOf) HxOverrides.remove = function (a, o) {\n    var i = a.indexOf(o);\n    if (i == -1) return false;\n    a.splice(i, 1);\n    return true;\n  }; else null;\n  Math.__name__ = [\"Math\"];\n  Math.NaN = Number.NaN;\n  Math.NEGATIVE_INFINITY = Number.NEGATIVE_INFINITY;\n  Math.POSITIVE_INFINITY = Number.POSITIVE_INFINITY;\n  Math.isFinite = function (i) {\n    return isFinite(i);\n  };\n  Math.isNaN = function (i) {\n    return isNaN(i);\n  };\n  String.prototype.__class__ = String;\n  String.__name__ = true;\n  Array.prototype.__class__ = Array;\n  Array.__name__ = true;\n  Date.prototype.__class__ = Date;\n  Date.__name__ = [\"Date\"];\n  var Int = { __name__: [\"Int\"] };\n  var Dynamic = { __name__: [\"Dynamic\"] };\n  var Float = Number;\n  Float.__name__ = [\"Float\"];\n  var Bool = Boolean;\n  Bool.__ename__ = [\"Bool\"];\n  var Class = { __name__: [\"Class\"] };\n  var Enum = {};\n  var Void = { __ename__: [\"Void\"] };\n  if (typeof document != \"undefined\") js.Lib.document = document;\n  if (typeof window != \"undefined\") {\n    js.Lib.window = window;\n    js.Lib.window.onerror = function (msg, url, line) {\n      var f = js.Lib.onerror;\n      if (f == null) return false;\n      return f(msg, [url + \":\" + line]);\n    };\n  }\n  com.wiris.js.JsPluginTools.main();\n}());\ndelete Array.prototype.__class__;\n// @codingStandardsIgnoreEnd\n", "import Util from './util';\nimport Latex from './latex';\nimport MathML from './mathml';\nimport Image from './image';\nimport Accessibility from './accessibility';\nimport ServiceProvider from './serviceprovider';\nimport Configuration from './configuration';\nimport Constants from './constants';\n// eslint-disable-next-line no-unused-vars\nimport md5 from './md5';\n\n/**\n * @classdesc\n * This class represent a MahML parser. Converts MathML into formulas depending on the\n * image format (SVG, PNG, base64) and the save mode (XML, safeXML, Image) configured\n * in the backend.\n */\nexport default class Parser {\n  /**\n   * Converts a MathML string to an img element.\n   * @param {Document} creator - Document object to call createElement method.\n   * @param {string} mathml - MathML code\n   * @param {Object[]} wirisProperties - object containing WIRIS custom properties\n   * @param {language} language - custom language for accessibility.\n   * @returns {HTMLImageElement} the formula image corresponding to initial MathML string.\n   * @static\n   */\n  static mathmlToImgObject(creator, mathml, wirisProperties, language) {\n    const imgObject = creator.createElement('img');\n    imgObject.align = 'middle';\n    imgObject.style.maxWidth = 'none';\n    let data = wirisProperties || {};\n\n    // Take into account the backend config\n    const wirisEditorProperties = Configuration.get(\"editorParameters\");\n    data = { ...wirisEditorProperties, ...data };\n\n    data.mml = mathml;\n    data.lang = language;\n    // Request metrics of the generated image.\n    data.metrics = 'true';\n    data.centerbaseline = 'false';\n\n    // Full base64 method (edit & save).\n    if (Configuration.get('saveMode') === 'base64' && Configuration.get('base64savemode') === 'default') {\n      data.base64 = true;\n    }\n\n    // Render js params: _wrs_int_wirisProperties contains some js render params.\n    // Since MathML can support render params, js params should be send only to editor.\n\n    imgObject.className = Configuration.get('imageClassName');\n\n    if (mathml.indexOf('class=\"') !== -1) {\n      // We check here if the MathML has been created from a customEditor (such chemistry)\n      // to add custom editor name attribute to img object (if necessary).\n      let mathmlSubstring = mathml.substring(mathml.indexOf('class=\"') + 'class=\"'.length, mathml.length);\n      mathmlSubstring = mathmlSubstring.substring(0, mathmlSubstring.indexOf('\"'));\n      mathmlSubstring = mathmlSubstring.substring(4, mathmlSubstring.length);\n      imgObject.setAttribute(Configuration.get('imageCustomEditorName'), mathmlSubstring);\n    }\n\n    // Performance enabled.\n    if (Configuration.get('wirisPluginPerformance') && (Configuration.get('saveMode') === 'xml' || Configuration.get('saveMode') === 'safeXml')) {\n      let result = JSON.parse(Parser.createShowImageSrc(data, language));\n      if (result.status === 'warning') {\n        // POST call.\n        // if the mathml is malformed, this function will throw an exception.\n        try {\n          result = JSON.parse(ServiceProvider.getService('showimage', data));\n        } catch (e) {\n          return null;\n        }\n      }\n      ({ result } = result);\n      if (result.format === 'png') {\n        imgObject.src = `data:image/png;base64,${result.content}`;\n      } else {\n        imgObject.src = `data:image/svg+xml;charset=utf8,${Util.urlEncode(result.content)}`;\n      }\n      imgObject.setAttribute(Configuration.get('imageMathmlAttribute'), MathML.safeXmlEncode(mathml));\n      Image.setImgSize(imgObject, result.content, true);\n\n      if (Configuration.get('enableAccessibility')) {\n        if (typeof result.alt === 'undefined') {\n          imgObject.alt = Accessibility.mathMLToAccessible(mathml, language, data);\n        } else {\n          imgObject.alt = result.alt;\n        }\n      }\n    } else {\n      const result = Parser.createImageSrc(mathml, data);\n      imgObject.setAttribute(Configuration.get('imageMathmlAttribute'), MathML.safeXmlEncode(mathml));\n      imgObject.src = result;\n      Image.setImgSize(imgObject, result, Configuration.get('saveMode') === 'base64' && Configuration.get('base64savemode') === 'default');\n      if (Configuration.get('enableAccessibility')) {\n        imgObject.alt = Accessibility.mathMLToAccessible(mathml, language, data);\n      }\n    }\n\n    if (typeof Parser.observer !== 'undefined') {\n      Parser.observer.observe(imgObject);\n    }\n\n    // Role math https://www.w3.org/TR/wai-aria/roles#math.\n    imgObject.setAttribute('role', 'math');\n    return imgObject;\n  }\n\n  /**\n   * Returns the source to showimage service by calling createimage service. The\n   * output of the createimage service is a URL path pointing to showimage service.\n   * This method is called when performance is disabled.\n   * @param {string} mathml - MathML code.\n   * @param {Object[]} data - data object containing service parameters.\n   * @returns {string} the showimage path.\n   */\n  static createImageSrc(mathml, data) {\n    // Full base64 method (edit & save).\n    if (Configuration.get('saveMode') === 'base64' && Configuration.get('base64savemode') === 'default') {\n      data.base64 = true;\n    }\n\n    let result = ServiceProvider.getService('createimage', data);\n\n    if (result.indexOf('@BASE@') !== -1) {\n      // Replacing '@BASE@' with the base URL of createimage.\n      const baseParts = ServiceProvider.getServicePath('createimage').split('/');\n      baseParts.pop();\n      result = result.split('@BASE@').join(baseParts.join('/'));\n    }\n\n    return result;\n  }\n\n  /**\n   * Parses initial HTML code. If the HTML contains data generated by WIRIS,\n   * this data would be converted as following:\n   * <pre>\n   * MathML code: Image containing the corresponding MathML formulas.\n   * MathML code with LaTeX annotation : LaTeX string.\n   * </pre>\n   * @param {string} code - HTML code containing MathML data.\n   * @param {string} language - language to create image alt text.\n   * @returns {string} HTML code with the original MathML converted into LaTeX and images.\n   */\n  static initParse(code, language) {\n    /* Note: The code inside this function has been inverted.\n    If you invert again the code then you cannot use correctly LaTeX\n    in Moodle.\n    */\n    code = Parser.initParseSaveMode(code, language);\n    return Parser.initParseEditMode(code);\n  }\n\n  /**\n   * Parses initial HTML code depending on the save mode. Transforms all MathML\n   * occurrences for it's correspondent image or LaTeX.\n   * @param {string} code - HTML code to be parsed\n   * @param {string} language - language to create image alt text.\n   * @returns {string} HTML code parsed.\n   */\n  static initParseSaveMode(code, language) {\n    if (Configuration.get('saveMode')) {\n      // Converting XML to tags.\n      code = Latex.parseMathmlToLatex(code, Constants.safeXmlCharacters);\n      code = Latex.parseMathmlToLatex(code, Constants.xmlCharacters);\n      code = Parser.parseMathmlToImg(code, Constants.safeXmlCharacters, language);\n      code = Parser.parseMathmlToImg(code, Constants.xmlCharacters, language);\n      if (Configuration.get('saveMode') === 'base64' && Configuration.get('base64savemode') === 'image') {\n        code = Parser.codeImgTransform(code, 'base642showimage');\n      }\n    }\n    return code;\n  }\n\n  /**\n   * Parses initial HTML code depending on the edit mode.\n   * If 'latex' parseMode is enabled all MathML containing an annotation with encoding='LaTeX' will\n   * be converted into a LaTeX string instead of an image.\n   * @param {string} code - HTML code containing MathML.\n   * @returns {string} parsed HTML code.\n   */\n  static initParseEditMode(code) {\n    if (Configuration.get('parseModes').indexOf('latex') !== -1) {\n      const imgList = Util.getElementsByNameFromString(code, 'img', true);\n      const token = 'encoding=\"LaTeX\">';\n      // While replacing images with latex, the indexes of the found images changes\n      // respecting the original code, so this carry is needed.\n      let carry = 0;\n\n      for (let i = 0; i < imgList.length; i += 1) {\n        const imgCode = code.substring(imgList[i].start + carry, imgList[i].end + carry);\n\n        if (imgCode.indexOf(` class=\"${Configuration.get('imageClassName')}\"`) !== -1) {\n          let mathmlStartToken = ` ${Configuration.get('imageMathmlAttribute')}=\"`;\n          let mathmlStart = imgCode.indexOf(mathmlStartToken);\n\n          if (mathmlStart === -1) {\n            mathmlStartToken = ' alt=\"';\n            mathmlStart = imgCode.indexOf(mathmlStartToken);\n          }\n\n          if (mathmlStart !== -1) {\n            mathmlStart += mathmlStartToken.length;\n            const mathmlEnd = imgCode.indexOf('\"', mathmlStart);\n            const mathml = Util.htmlSanitize(MathML.safeXmlDecode(imgCode.substring(mathmlStart, mathmlEnd)));\n            let latexStartPosition = mathml.indexOf(token);\n\n            if (latexStartPosition !== -1) {\n              latexStartPosition += token.length;\n              const latexEndPosition = mathml.indexOf('</annotation>', latexStartPosition);\n              const latex = mathml.substring(latexStartPosition, latexEndPosition);\n\n              const replaceText = `$$${Util.htmlEntitiesDecode(latex)}$$`;\n              const start = code.substring(0, imgList[i].start + carry);\n              const end = code.substring(imgList[i].end + carry);\n              code = start + replaceText + end;\n              carry += replaceText.length - (imgList[i].end - imgList[i].start);\n            }\n          }\n        }\n      }\n    }\n\n    return code;\n  }\n\n  /**\n   * Parses end HTML code. The end HTML code is HTML code with embedded images\n   * or LaTeX formulas created with MathType. <br>\n   * By default this method converts the formula images and LaTeX strings in MathML. <br>\n   * If image mode is enabled the images will not be converted into MathML. For further information see {@link https://docs.wiris.com/mathtype/en/mathtype-integrations/mathtype-web-interface-features/full-mathml-mode---wirisplugins-js.html}.\n   * @param {string} code - HTML to be parsed\n   * @returns {string} the HTML code parsed.\n   */\n  static endParse(code) {\n    // Transform LaTeX ocurrences to MathML elements.\n    const codeEndParsedEditMode = Parser.endParseEditMode(code);\n    // Transform img elements to MathML elements.\n    const codeEndParseSaveMode = Parser.endParseSaveMode(codeEndParsedEditMode);\n    return codeEndParseSaveMode;\n  }\n\n  /**\n   * Parses end HTML code depending on the edit mode.\n   * - LaTeX is an enabled parse mode, all LaTeX occurrences will be converted into MathML.\n   * @param {string} code - HTML code to be parsed.\n   * @returns {string} HTML code parsed.\n   */\n  static endParseEditMode(code) {\n    // Converting LaTeX to images.\n    if (Configuration.get('parseModes').indexOf('latex') !== -1) {\n      let output = '';\n      let endPosition = 0;\n      let startPosition = code.indexOf('$$');\n      while (startPosition !== -1) {\n        output += code.substring(endPosition, startPosition);\n        endPosition = code.indexOf('$$', startPosition + 2);\n\n        if (endPosition !== -1) {\n          // Before, it was a condition here to execute the next codelines\n          // 'latex.indexOf('<') == -1'.\n          // We don't know why it was used, but seems to have a conflict with\n          // latex formulas that contains '<'.\n          const latex = code.substring(startPosition + 2, endPosition);\n          const decodedLatex = Util.htmlEntitiesDecode(latex);\n          let mathml = Util.htmlSanitize(Latex.getMathMLFromLatex(decodedLatex, true));\n          if (!Configuration.get('saveHandTraces')) {\n            // Remove hand traces.\n            mathml = MathML.removeAnnotation(mathml, 'application/json');\n          }\n          output += mathml;\n          endPosition += 2;\n        } else {\n          output += '$$';\n          endPosition = startPosition + 2;\n        }\n\n        startPosition = code.indexOf('$$', endPosition);\n      }\n\n      output += code.substring(endPosition, code.length);\n      code = output;\n    }\n\n    return code;\n  }\n\n  /**\n   * Parses end HTML code depending on the save mode. Converts all\n   * images into the element determined by the save mode:\n   * - xml: Parses images formulas into MathML.\n   * - safeXml: Parses images formulas into safeMAthML\n   * - base64: Parses images into base64 images.\n   * - image: Parse images into images (no parsing)\n   * @param {string} code - HTML code to be parsed\n   * @returns {string} HTML code parsed.\n   */\n  static endParseSaveMode(code) {\n    if (Configuration.get('saveMode')) {\n      if (Configuration.get('saveMode') === 'safeXml') {\n        code = Parser.codeImgTransform(code, 'img2mathml');\n      } else if (Configuration.get('saveMode') === 'xml') {\n        code = Parser.codeImgTransform(code, 'img2mathml');\n      } else if (Configuration.get('saveMode') === 'base64' && Configuration.get('base64savemode') === 'image') {\n        code = Parser.codeImgTransform(code, 'img264');\n      }\n    }\n\n    return code;\n  }\n\n\n  /**\n   * Auxiliar function that builds the data object to send to the showimage endpoint\n   * @param {Object[]} data - object containing showimage service parameters.\n   * @param {string} language - string containing the language of the formula.\n   * @returns {Object} JSON object with the data to send to showimage.\n   */\n  static createShowImageSrcData(data, language) {\n    const dataMd5 = {};\n    const renderParams = ['mml', 'color', 'centerbaseline', 'zoom', 'dpi', 'fontSize', 'fontFamily', 'defaultStretchy', 'backgroundColor', 'format'];\n    renderParams.forEach((param) => {\n      if (typeof data[param] !== 'undefined') {\n        dataMd5[param] = data[param];\n      }\n    });\n    // Data variables to get.\n    const dataObject = {};\n    Object.keys(data).forEach((key) => {\n      // We don't need mathml in this request we try to get cached.\n      // Only need the formula md5 calculated before.\n      if (key !== 'mml') {\n        dataObject[key] = data[key];\n      }\n    });\n\n    dataObject.formula = com.wiris.js.JsPluginTools.md5encode(Util.propertiesToString(dataMd5));\n    dataObject.lang = (typeof language === 'undefined') ? 'en' : language;\n    dataObject.version = Configuration.get('version');\n\n    return dataObject;\n  }\n\n  /**\n   * Returns the result to call showimage service with the formula md5 as parameter.\n   *  The result could be:\n   * - {'status' : warning'} : The image associated to the MathML md5 is not in cache.\n   * - {'status' : 'ok' ...} : The image associated to the MathML md5 is in cache.\n   * @param {Object[]} data - object containing showimage service parameters.\n   * @param {string} language - string containing the language of the formula.\n   * @returns {Object} JSON object containing showimage response.\n   */\n  static createShowImageSrc(data, language) {\n    const dataObject = this.createShowImageSrcData(data, language);\n    const result = ServiceProvider.getService('showimage', Util.httpBuildQuery(dataObject), true);\n    return result;\n  }\n\n  /**\n   * Transform html img tags inside a html code to mathml, base64 img tags (i.e with base64 on src)\n   * or showimage img tags (i.e with showimage.php on src)\n   * @param  {string} code - HTML code\n   * @param  {string} mode - base642showimage or img2mathml or img264 transform.\n   * @returns {string} html - code transformed.\n   */\n  static codeImgTransform(code, mode) {\n    let output = '';\n    let endPosition = 0;\n    const pattern = /<img/gi;\n    const patternLength = pattern.source.length;\n\n    while (pattern.test(code)) {\n      const startPosition = pattern.lastIndex - patternLength;\n      output += code.substring(endPosition, startPosition);\n\n      let i = startPosition + 1;\n\n      while (i < code.length && endPosition <= startPosition) {\n        const character = code.charAt(i);\n\n        if (character === '\"' || character === '\\'') {\n          const characterNextPosition = code.indexOf(character, i + 1);\n\n          if (characterNextPosition === -1) {\n            i = code.length; // End while.\n          } else {\n            i = characterNextPosition;\n          }\n        } else if (character === '>') {\n          endPosition = i + 1;\n        }\n\n        i += 1;\n      }\n\n      if (endPosition < startPosition) { // The img tag is stripped.\n        output += code.substring(startPosition, code.length);\n        return output;\n      }\n      let imgCode = code.substring(startPosition, endPosition);\n      const imgObject = Util.createObject(imgCode);\n      let xmlCode = imgObject.getAttribute(Configuration.get('imageMathmlAttribute'));\n      let convertToXml;\n      let convertToSafeXml;\n\n      if (mode === 'base642showimage') {\n        if (xmlCode == null) {\n          xmlCode = imgObject.getAttribute('alt');\n        }\n        xmlCode = MathML.safeXmlDecode(xmlCode);\n        imgCode = Parser.mathmlToImgObject(document, xmlCode, null, null);\n        output += Util.createObjectCode(imgCode);\n      } else if (mode === 'img2mathml') {\n        if (Configuration.get('saveMode')) {\n          if (Configuration.get('saveMode') === 'safeXml') {\n            convertToXml = true;\n            convertToSafeXml = true;\n          } else if (Configuration.get('saveMode') === 'xml') {\n            convertToXml = true;\n            convertToSafeXml = false;\n          }\n        }\n        output += Util.getWIRISImageOutput(imgCode, convertToXml, convertToSafeXml);\n      } else if (mode === 'img264') {\n        if (xmlCode === null) {\n          xmlCode = imgObject.getAttribute('alt');\n        }\n        xmlCode = MathML.safeXmlDecode(xmlCode);\n\n        const properties = {};\n        properties.base64 = 'true';\n        imgCode = Parser.mathmlToImgObject(document, xmlCode, properties, null);\n        // Metrics.\n        Image.setImgSize(imgCode, imgCode.src, true);\n        output += Util.createObjectCode(imgCode);\n      }\n    }\n    output += code.substring(endPosition, code.length);\n    return output;\n  }\n\n  /**\n   * Converts all occurrences of MathML to the corresponding image.\n   * @param {string} content - string with valid MathML code.\n   * The MathML code doesn't contain semantics.\n   * @param {Constants} characters - Constant object containing xmlCharacters\n   * or safeXmlCharacters relation.\n   * @param {string} language - a valid language code\n   * in order to generate formula accessibility.\n   * @returns {string} The input string with all the MathML\n   * occurrences replaced by the corresponding image.\n   */\n  static parseMathmlToImg(content, characters, language) {\n    let output = '';\n    const mathTagBegin = `${characters.tagOpener}math`;\n    const mathTagEnd = `${characters.tagOpener}/math${characters.tagCloser}`;\n    let start = content.indexOf(mathTagBegin);\n    let end = 0;\n\n    while (start !== -1) {\n      output += content.substring(end, start);\n      // Avoid WIRIS images to be parsed.\n      const imageMathmlAtrribute = content.indexOf(Configuration.get('imageMathmlAttribute'));\n      end = content.indexOf(mathTagEnd, start);\n\n      if (end === -1) {\n        end = content.length - 1;\n      } else if (imageMathmlAtrribute !== -1) {\n        // First close tag of img attribute\n        // If a mathmlAttribute exists should be inside a img tag.\n        end += content.indexOf('/>', start);\n      } else {\n        end += mathTagEnd.length;\n      }\n\n      if (!MathML.isMathmlInAttribute(content, start) && imageMathmlAtrribute === -1) {\n        let mathml = content.substring(start, end);\n        mathml = (characters.id === Constants.safeXmlCharacters.id)\n          ? MathML.safeXmlDecode(mathml)\n          : MathML.mathMLEntities(mathml);\n        output += Util.createObjectCode(Parser.mathmlToImgObject(document, mathml, null, language));\n      } else {\n        output += content.substring(start, end);\n      }\n\n      start = content.indexOf(mathTagBegin, end);\n    }\n\n    output += content.substring(end, content.length);\n    return output;\n  }\n}\n\n// Mutation observers to avoid wiris image formulas class be removed.\nif (typeof MutationObserver !== 'undefined') {\n  const mutationObserver = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      if (mutation.oldValue === Configuration.get('imageClassName')\n        && mutation.attributeName === 'class'\n        && mutation.target.className.indexOf(Configuration.get('imageClassName')) === -1) {\n        mutation.target.className = Configuration.get('imageClassName');\n      }\n    });\n  });\n\n  Parser.observer = Object.create(mutationObserver);\n  Parser.observer.Config = { attributes: true, attributeOldValue: true };\n  // We use own default config.\n  Parser.observer.observe = function (target) {\n    Object.getPrototypeOf(this).observe(target, this.Config);\n  };\n}\n", "/* eslint-disable class-methods-use-this */\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-extra-semi */\n\n// The rules above are disabled because we are implementing\n// an external interface.\n\nexport default class EditorListener {\n  /**\n   * @classdesc\n   * Determines if the content of the\n   * MathType Editor has changes.\n   * @implements {EditorListeners}\n   * @constructs\n   */\n  constructor() {\n    /**\n     * Indicates if the content of the editor has changed.\n     * @type {Boolean}\n     */\n    this.isContentChanged = false;\n\n    /**\n     * Indicates if the listener should be waiting for changes in the editor.\n     * @type {Boolean}\n     */\n    this.waitingForChanges = false;\n  }\n\n  /**\n   * Sets {@link EditorListener.isContentChanged} property.\n   * @param {Boolean} value - The new vlue.\n   */\n  setIsContentChanged(value) {\n    this.isContentChanged = value;\n  }\n\n  /**\n   * Returns true if the content of the editor has been changed, false otherwise.\n   * @return {Boolean}\n   */\n  getIsContentChanged() {\n    return this.isContentChanged;\n  };\n\n  /**\n   * Determines if the EditorListener should wait for any changes.\n   * @param {Boolean} value - True if the editor should wait for changes, false otherwise.\n   */\n  setWaitingForChanges(value) {\n    this.waitingForChanges = value;\n  }\n\n  /**\n   * EditorListener method to overwrite.\n   * @type {JsEditor}\n   * @ignore\n   */\n  caretPositionChanged(_editor) { };\n\n  /**\n   * EditorListener method to overwrite\n   * @type {JsEditor}\n   * @ignore\n   */\n  clipboardChanged(_editor) { };\n\n  /**\n   * Determines if the content of an editor has been changed.\n   * @param {JsEditor} editor - editor object.\n   */\n  contentChanged(_editor) {\n    if (this.waitingForChanges === true && this.isContentChanged === false) {\n      this.isContentChanged = true;\n    }\n  }\n\n  /**\n   * EditorListener method to overwrite\n   * @param {JsEditor} editor - The editor instance.\n   */\n  styleChanged(_editor) {\n  }\n\n  /**\n   * EditorListener method to overwrite\n   * @param {JsEditor} - The editor instance.\n   */\n  transformationReceived(_editor) {\n  }\n}\n", "let wasm;\n\nconst cachedTextDecoder = (typeof TextDecoder !== 'undefined' ? new TextDecoder('utf-8', { ignoreBOM: true, fatal: true }) : { decode: () => { throw Error('TextDecoder not available') } } );\n\nif (typeof TextDecoder !== 'undefined') { cachedTextDecoder.decode(); };\n\nlet cachedUint8Memory0 = null;\n\nfunction getUint8Memory0() {\n    if (cachedUint8Memory0 === null || cachedUint8Memory0.byteLength === 0) {\n        cachedUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachedUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n    ptr = ptr >>> 0;\n    return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nconst heap = new Array(128).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nlet heap_next = heap.length;\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction getObject(idx) { return heap[idx]; }\n\nfunction dropObject(idx) {\n    if (idx < 132) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nconst cachedTextEncoder = (typeof TextEncoder !== 'undefined' ? new TextEncoder('utf-8') : { encode: () => { throw Error('TextEncoder not available') } } );\n\nconst encodeString = (typeof cachedTextEncoder.encodeInto === 'function'\n    ? function (arg, view) {\n    return cachedTextEncoder.encodeInto(arg, view);\n}\n    : function (arg, view) {\n    const buf = cachedTextEncoder.encode(arg);\n    view.set(buf);\n    return {\n        read: arg.length,\n        written: buf.length\n    };\n});\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n\n    if (realloc === undefined) {\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = malloc(buf.length, 1) >>> 0;\n        getUint8Memory0().subarray(ptr, ptr + buf.length).set(buf);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    }\n\n    let len = arg.length;\n    let ptr = malloc(len, 1) >>> 0;\n\n    const mem = getUint8Memory0();\n\n    let offset = 0;\n\n    for (; offset < len; offset++) {\n        const code = arg.charCodeAt(offset);\n        if (code > 0x7F) break;\n        mem[ptr + offset] = code;\n    }\n\n    if (offset !== len) {\n        if (offset !== 0) {\n            arg = arg.slice(offset);\n        }\n        ptr = realloc(ptr, len, len = offset + arg.length * 3, 1) >>> 0;\n        const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n        const ret = encodeString(arg, view);\n\n        offset += ret.written;\n    }\n\n    WASM_VECTOR_LEN = offset;\n    return ptr;\n}\n\nfunction isLikeNone(x) {\n    return x === undefined || x === null;\n}\n\nlet cachedInt32Memory0 = null;\n\nfunction getInt32Memory0() {\n    if (cachedInt32Memory0 === null || cachedInt32Memory0.byteLength === 0) {\n        cachedInt32Memory0 = new Int32Array(wasm.memory.buffer);\n    }\n    return cachedInt32Memory0;\n}\n\nlet cachedFloat64Memory0 = null;\n\nfunction getFloat64Memory0() {\n    if (cachedFloat64Memory0 === null || cachedFloat64Memory0.byteLength === 0) {\n        cachedFloat64Memory0 = new Float64Array(wasm.memory.buffer);\n    }\n    return cachedFloat64Memory0;\n}\n\nfunction debugString(val) {\n    // primitive types\n    const type = typeof val;\n    if (type == 'number' || type == 'boolean' || val == null) {\n        return  `${val}`;\n    }\n    if (type == 'string') {\n        return `\"${val}\"`;\n    }\n    if (type == 'symbol') {\n        const description = val.description;\n        if (description == null) {\n            return 'Symbol';\n        } else {\n            return `Symbol(${description})`;\n        }\n    }\n    if (type == 'function') {\n        const name = val.name;\n        if (typeof name == 'string' && name.length > 0) {\n            return `Function(${name})`;\n        } else {\n            return 'Function';\n        }\n    }\n    // objects\n    if (Array.isArray(val)) {\n        const length = val.length;\n        let debug = '[';\n        if (length > 0) {\n            debug += debugString(val[0]);\n        }\n        for(let i = 1; i < length; i++) {\n            debug += ', ' + debugString(val[i]);\n        }\n        debug += ']';\n        return debug;\n    }\n    // Test for built-in\n    const builtInMatches = /\\[object ([^\\]]+)\\]/.exec(toString.call(val));\n    let className;\n    if (builtInMatches.length > 1) {\n        className = builtInMatches[1];\n    } else {\n        // Failed to match the standard '[object ClassName]'\n        return toString.call(val);\n    }\n    if (className == 'Object') {\n        // we're a user defined class or Object\n        // JSON.stringify avoids problems with cycles, and is generally much\n        // easier than looping through ownProperties of `val`.\n        try {\n            return 'Object(' + JSON.stringify(val) + ')';\n        } catch (_) {\n            return 'Object';\n        }\n    }\n    // errors\n    if (val instanceof Error) {\n        return `${val.name}: ${val.message}\\n${val.stack}`;\n    }\n    // TODO we could test for more things here, like `Set`s and `Map`s.\n    return className;\n}\n\nfunction makeClosure(arg0, arg1, dtor, f) {\n    const state = { a: arg0, b: arg1, cnt: 1, dtor };\n    const real = (...args) => {\n        // First up with a closure we increment the internal reference\n        // count. This ensures that the Rust closure environment won't\n        // be deallocated while we're invoking it.\n        state.cnt++;\n        try {\n            return f(state.a, state.b, ...args);\n        } finally {\n            if (--state.cnt === 0) {\n                wasm.__wbindgen_export_2.get(state.dtor)(state.a, state.b);\n                state.a = 0;\n\n            }\n        }\n    };\n    real.original = state;\n\n    return real;\n}\nfunction __wbg_adapter_34(arg0, arg1, arg2) {\n    wasm.__wbindgen_export_3(arg0, arg1, addHeapObject(arg2));\n}\n\nfunction makeMutClosure(arg0, arg1, dtor, f) {\n    const state = { a: arg0, b: arg1, cnt: 1, dtor };\n    const real = (...args) => {\n        // First up with a closure we increment the internal reference\n        // count. This ensures that the Rust closure environment won't\n        // be deallocated while we're invoking it.\n        state.cnt++;\n        const a = state.a;\n        state.a = 0;\n        try {\n            return f(a, state.b, ...args);\n        } finally {\n            if (--state.cnt === 0) {\n                wasm.__wbindgen_export_2.get(state.dtor)(a, state.b);\n\n            } else {\n                state.a = a;\n            }\n        }\n    };\n    real.original = state;\n\n    return real;\n}\nfunction __wbg_adapter_37(arg0, arg1) {\n    wasm.__wbindgen_export_4(arg0, arg1);\n}\n\nfunction __wbg_adapter_40(arg0, arg1, arg2) {\n    wasm.__wbindgen_export_5(arg0, arg1, addHeapObject(arg2));\n}\n\nfunction handleError(f, args) {\n    try {\n        return f.apply(this, args);\n    } catch (e) {\n        wasm.__wbindgen_export_6(addHeapObject(e));\n    }\n}\nfunction __wbg_adapter_99(arg0, arg1, arg2, arg3) {\n    wasm.__wbindgen_export_7(arg0, arg1, addHeapObject(arg2), addHeapObject(arg3));\n}\n\n/**\n*/\nexport function main_js() {\n    wasm.main_js();\n}\n\nfunction getArrayU8FromWasm0(ptr, len) {\n    ptr = ptr >>> 0;\n    return getUint8Memory0().subarray(ptr / 1, ptr / 1 + len);\n}\n/**\n*/\nexport const Level = Object.freeze({ Error:0,\"0\":\"Error\",Warn:1,\"1\":\"Warn\",Info:2,\"2\":\"Info\",Debug:3,\"3\":\"Debug\", });\n/**\n*/\nexport class Telemeter {\n\n    static __wrap(ptr) {\n        ptr = ptr >>> 0;\n        const obj = Object.create(Telemeter.prototype);\n        obj.__wbg_ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.__wbg_ptr;\n        this.__wbg_ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_telemeter_free(ptr);\n    }\n    /**\n    * @param {any} solution\n    * @param {any} hosts\n    * @param {any} config\n    */\n    constructor(solution, hosts, config) {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.telemeter_new(retptr, addHeapObject(solution), addHeapObject(hosts), addHeapObject(config));\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            var r2 = getInt32Memory0()[retptr / 4 + 2];\n            if (r2) {\n                throw takeObject(r1);\n            }\n            return Telemeter.__wrap(r0);\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    * @param {string} sender_id\n    * @returns {Promise<any>}\n    */\n    identify(sender_id) {\n        const ptr0 = passStringToWasm0(sender_id, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.telemeter_identify(this.__wbg_ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n    /**\n    * @param {string} event_type\n    * @param {any} event_payload\n    * @returns {Promise<any>}\n    */\n    track(event_type, event_payload) {\n        const ptr0 = passStringToWasm0(event_type, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.telemeter_track(this.__wbg_ptr, ptr0, len0, addHeapObject(event_payload));\n        return takeObject(ret);\n    }\n    /**\n    * @param {any} level\n    * @param {string} message\n    * @param {any} payload\n    * @returns {Promise<any>}\n    */\n    log(level, message, payload) {\n        const ptr0 = passStringToWasm0(message, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.telemeter_log(this.__wbg_ptr, addHeapObject(level), ptr0, len0, addHeapObject(payload));\n        return takeObject(ret);\n    }\n    /**\n    * @returns {Promise<any>}\n    */\n    finish() {\n        const ptr = this.__destroy_into_raw();\n        const ret = wasm.telemeter_finish(ptr);\n        return takeObject(ret);\n    }\n    /**\n    * @param {boolean | undefined} new_debug_status\n    */\n    debug(new_debug_status) {\n        wasm.telemeter_debug(this.__wbg_ptr, isLikeNone(new_debug_status) ? 0xFFFFFF : new_debug_status ? 1 : 0);\n    }\n}\n\nasync function __wbg_load(module, imports) {\n    if (typeof Response === 'function' && module instanceof Response) {\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            try {\n                return await WebAssembly.instantiateStreaming(module, imports);\n\n            } catch (e) {\n                if (module.headers.get('Content-Type') != 'application/wasm') {\n                    console.warn(\"`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n\n                } else {\n                    throw e;\n                }\n            }\n        }\n\n        const bytes = await module.arrayBuffer();\n        return await WebAssembly.instantiate(bytes, imports);\n\n    } else {\n        const instance = await WebAssembly.instantiate(module, imports);\n\n        if (instance instanceof WebAssembly.Instance) {\n            return { instance, module };\n\n        } else {\n            return instance;\n        }\n    }\n}\n\nfunction __wbg_get_imports() {\n    const imports = {};\n    imports.wbg = {};\n    imports.wbg.__wbindgen_string_new = function(arg0, arg1) {\n        const ret = getStringFromWasm0(arg0, arg1);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_b51585de1b234aff = function() {\n        const ret = new Object();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_status_ac85a3142a84caa2 = function(arg0) {\n        const ret = getObject(arg0).status;\n        return ret;\n    };\n    imports.wbg.__wbg_headers_b70de86b8e989bc0 = function(arg0) {\n        const ret = getObject(arg0).headers;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new0_c0be7df4b6bd481f = function() {\n        const ret = new Date();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_getTime_5e2054f832d82ec9 = function(arg0) {\n        const ret = getObject(arg0).getTime();\n        return ret;\n    };\n    imports.wbg.__wbindgen_object_drop_ref = function(arg0) {\n        takeObject(arg0);\n    };\n    imports.wbg.__wbindgen_is_object = function(arg0) {\n        const val = getObject(arg0);\n        const ret = typeof(val) === 'object' && val !== null;\n        return ret;\n    };\n    imports.wbg.__wbg_crypto_c48a774b022d20ac = function(arg0) {\n        const ret = getObject(arg0).crypto;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_process_298734cf255a885d = function(arg0) {\n        const ret = getObject(arg0).process;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_versions_e2e78e134e3e5d01 = function(arg0) {\n        const ret = getObject(arg0).versions;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_node_1cd7a5d853dbea79 = function(arg0) {\n        const ret = getObject(arg0).node;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_string = function(arg0) {\n        const ret = typeof(getObject(arg0)) === 'string';\n        return ret;\n    };\n    imports.wbg.__wbg_require_8f08ceecec0f4fee = function() { return handleError(function () {\n        const ret = module.require;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_msCrypto_bcb970640f50a1e8 = function(arg0) {\n        const ret = getObject(arg0).msCrypto;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_newwithlength_e5d69174d6984cd7 = function(arg0) {\n        const ret = new Uint8Array(arg0 >>> 0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_get_44be0491f933a435 = function(arg0, arg1) {\n        const ret = getObject(arg0)[arg1 >>> 0];\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_next_ddb3312ca1c4e32a = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).next();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_done_5c1f01fb660d73b5 = function(arg0) {\n        const ret = getObject(arg0).done;\n        return ret;\n    };\n    imports.wbg.__wbg_value_1695675138684bd5 = function(arg0) {\n        const ret = getObject(arg0).value;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_iterator_97f0c81209c6c35a = function() {\n        const ret = Symbol.iterator;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_next_526fc47e980da008 = function(arg0) {\n        const ret = getObject(arg0).next;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_function = function(arg0) {\n        const ret = typeof(getObject(arg0)) === 'function';\n        return ret;\n    };\n    imports.wbg.__wbg_call_cb65541d95d71282 = function() { return handleError(function (arg0, arg1) {\n        const ret = getObject(arg0).call(getObject(arg1));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbindgen_object_clone_ref = function(arg0) {\n        const ret = getObject(arg0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_self_1ff1d729e9aae938 = function() { return handleError(function () {\n        const ret = self.self;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_window_5f4faef6c12b79ec = function() { return handleError(function () {\n        const ret = window.window;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_globalThis_1d39714405582d3c = function() { return handleError(function () {\n        const ret = globalThis.globalThis;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_global_651f05c6a0944d1c = function() { return handleError(function () {\n        const ret = global.global;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbindgen_is_undefined = function(arg0) {\n        const ret = getObject(arg0) === undefined;\n        return ret;\n    };\n    imports.wbg.__wbg_newnoargs_581967eacc0e2604 = function(arg0, arg1) {\n        const ret = new Function(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_isArray_4c24b343cb13cfb1 = function(arg0) {\n        const ret = Array.isArray(getObject(arg0));\n        return ret;\n    };\n    imports.wbg.__wbg_values_e80af618f92c8649 = function(arg0) {\n        const ret = getObject(arg0).values();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_call_01734de55d61e11d = function() { return handleError(function (arg0, arg1, arg2) {\n        const ret = getObject(arg0).call(getObject(arg1), getObject(arg2));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_isSafeInteger_bb8e18dd21c97288 = function(arg0) {\n        const ret = Number.isSafeInteger(getObject(arg0));\n        return ret;\n    };\n    imports.wbg.__wbg_new_43f1b47c28813cbd = function(arg0, arg1) {\n        try {\n            var state0 = {a: arg0, b: arg1};\n            var cb0 = (arg0, arg1) => {\n                const a = state0.a;\n                state0.a = 0;\n                try {\n                    return __wbg_adapter_99(a, state0.b, arg0, arg1);\n                } finally {\n                    state0.a = a;\n                }\n            };\n            const ret = new Promise(cb0);\n            return addHeapObject(ret);\n        } finally {\n            state0.a = state0.b = 0;\n        }\n    };\n    imports.wbg.__wbindgen_memory = function() {\n        const ret = wasm.memory;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_buffer_085ec1f694018c4f = function(arg0) {\n        const ret = getObject(arg0).buffer;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_8125e318e6245eed = function(arg0) {\n        const ret = new Uint8Array(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_set_5cf90238115182c3 = function(arg0, arg1, arg2) {\n        getObject(arg0).set(getObject(arg1), arg2 >>> 0);\n    };\n    imports.wbg.__wbg_length_72e2208bbc0efc61 = function(arg0) {\n        const ret = getObject(arg0).length;\n        return ret;\n    };\n    imports.wbg.__wbindgen_string_get = function(arg0, arg1) {\n        const obj = getObject(arg1);\n        const ret = typeof(obj) === 'string' ? obj : undefined;\n        var ptr1 = isLikeNone(ret) ? 0 : passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        var len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    };\n    imports.wbg.__wbg_get_97b561fb56f034b5 = function() { return handleError(function (arg0, arg1) {\n        const ret = Reflect.get(getObject(arg0), getObject(arg1));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_has_c5fcd020291e56b8 = function() { return handleError(function (arg0, arg1) {\n        const ret = Reflect.has(getObject(arg0), getObject(arg1));\n        return ret;\n    }, arguments) };\n    imports.wbg.__wbg_set_092e06b0f9d71865 = function() { return handleError(function (arg0, arg1, arg2) {\n        const ret = Reflect.set(getObject(arg0), getObject(arg1), getObject(arg2));\n        return ret;\n    }, arguments) };\n    imports.wbg.__wbg_stringify_e25465938f3f611f = function() { return handleError(function (arg0) {\n        const ret = JSON.stringify(getObject(arg0));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_new_55c9955722952374 = function() { return handleError(function () {\n        const ret = new AbortController();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_signal_4bd18fb489af2d4c = function(arg0) {\n        const ret = getObject(arg0).signal;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_abort_654b796176d117aa = function(arg0) {\n        getObject(arg0).abort();\n    };\n    imports.wbg.__wbg_newwithbyteoffsetandlength_6da8e527659b86aa = function(arg0, arg1, arg2) {\n        const ret = new Uint8Array(getObject(arg0), arg1 >>> 0, arg2 >>> 0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_fetch_8eaf01857a5bb21f = function(arg0, arg1) {\n        const ret = getObject(arg0).fetch(getObject(arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_fetch_381efb5e862610fa = function(arg0) {\n        const ret = fetch(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_d258248ed531ff54 = function(arg0, arg1) {\n        const ret = new Error(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_null = function(arg0) {\n        const ret = getObject(arg0) === null;\n        return ret;\n    };\n    imports.wbg.__wbindgen_boolean_get = function(arg0) {\n        const v = getObject(arg0);\n        const ret = typeof(v) === 'boolean' ? (v ? 1 : 0) : 2;\n        return ret;\n    };\n    imports.wbg.__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4 = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof Uint8Array;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbg_instanceof_ArrayBuffer_39ac22089b74fddb = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof ArrayBuffer;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbindgen_number_get = function(arg0, arg1) {\n        const obj = getObject(arg1);\n        const ret = typeof(obj) === 'number' ? obj : undefined;\n        getFloat64Memory0()[arg0 / 8 + 1] = isLikeNone(ret) ? 0 : ret;\n        getInt32Memory0()[arg0 / 4 + 0] = !isLikeNone(ret);\n    };\n    imports.wbg.__wbg_entries_e51f29c7bba0c054 = function(arg0) {\n        const ret = Object.entries(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_String_9aa17d6248d519a5 = function(arg0, arg1) {\n        const ret = String(getObject(arg1));\n        const ptr1 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    };\n    imports.wbg.__wbg_get_723f83ba0c34871a = function(arg0, arg1) {\n        const ret = getObject(arg0)[takeObject(arg1)];\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_b66404b6322c59bf = function() { return handleError(function (arg0, arg1) {\n        const ret = new WebSocket(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_setbinaryType_096c70c4a9d97499 = function(arg0, arg1) {\n        getObject(arg0).binaryType = takeObject(arg1);\n    };\n    imports.wbg.__wbg_log_1d3ae0273d8f4f8a = function(arg0) {\n        console.log(getObject(arg0));\n    };\n    imports.wbg.__wbg_error_788ae33f81d3b84b = function(arg0) {\n        console.error(getObject(arg0));\n    };\n    imports.wbg.__wbg_warn_d60e832f9882c1b2 = function(arg0) {\n        console.warn(getObject(arg0));\n    };\n    imports.wbg.__wbg_info_2e30e8204b29d91d = function(arg0) {\n        console.info(getObject(arg0));\n    };\n    imports.wbg.__wbg_navigator_7c9103698acde322 = function(arg0) {\n        const ret = getObject(arg0).navigator;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_warn_fb2e68e6e02a4cb1 = function(arg0, arg1) {\n        console.warn(getObject(arg0), getObject(arg1));\n    };\n    imports.wbg.__wbg_readyState_b25418fd198bf715 = function(arg0) {\n        const ret = getObject(arg0).readyState;\n        return ret;\n    };\n    imports.wbg.__wbg_close_dfa389d8fddb52fc = function() { return handleError(function (arg0) {\n        getObject(arg0).close();\n    }, arguments) };\n    imports.wbg.__wbg_document_f7ace2b956f30a4f = function(arg0) {\n        const ret = getObject(arg0).document;\n        return isLikeNone(ret) ? 0 : addHeapObject(ret);\n    };\n    imports.wbg.__wbg_visibilityState_d18aa202782db311 = function(arg0) {\n        const ret = getObject(arg0).visibilityState;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_error_new = function(arg0, arg1) {\n        const ret = new Error(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_addEventListener_5651108fc3ffeb6e = function() { return handleError(function (arg0, arg1, arg2, arg3) {\n        getObject(arg0).addEventListener(getStringFromWasm0(arg1, arg2), getObject(arg3));\n    }, arguments) };\n    imports.wbg.__wbg_removeEventListener_5de660c02ed784e4 = function() { return handleError(function (arg0, arg1, arg2, arg3) {\n        getObject(arg0).removeEventListener(getStringFromWasm0(arg1, arg2), getObject(arg3));\n    }, arguments) };\n    imports.wbg.__wbg_localStorage_dbac11bd189e9fa0 = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).localStorage;\n        return isLikeNone(ret) ? 0 : addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_getItem_ed8e218e51f1efeb = function() { return handleError(function (arg0, arg1, arg2, arg3) {\n        const ret = getObject(arg1).getItem(getStringFromWasm0(arg2, arg3));\n        var ptr1 = isLikeNone(ret) ? 0 : passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        var len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    }, arguments) };\n    imports.wbg.__wbg_setItem_d002ee486462bfff = function() { return handleError(function (arg0, arg1, arg2, arg3, arg4) {\n        getObject(arg0).setItem(getStringFromWasm0(arg1, arg2), getStringFromWasm0(arg3, arg4));\n    }, arguments) };\n    imports.wbg.__wbg_platform_6a9b59df01050eac = function() { return handleError(function (arg0, arg1) {\n        const ret = getObject(arg1).platform;\n        const ptr1 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    }, arguments) };\n    imports.wbg.__wbg_hardwareConcurrency_3b217d60cc0aa1a6 = function(arg0) {\n        const ret = getObject(arg0).hardwareConcurrency;\n        return ret;\n    };\n    imports.wbg.__wbg_languages_4ab80469955a57f7 = function(arg0) {\n        const ret = getObject(arg0).languages;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_length_fff51ee6522a1a18 = function(arg0) {\n        const ret = getObject(arg0).length;\n        return ret;\n    };\n    imports.wbg.__wbg_screen_452da8d1ab76046e = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).screen;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_width_07fc222a210e15f1 = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).width;\n        return ret;\n    }, arguments) };\n    imports.wbg.__wbg_height_6fa226ea329cffc1 = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).height;\n        return ret;\n    }, arguments) };\n    imports.wbg.__wbg_pixelDepth_59e67c400cb7862f = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).pixelDepth;\n        return ret;\n    }, arguments) };\n    imports.wbg.__wbg_maxTouchPoints_831c1f1c938603aa = function(arg0) {\n        const ret = getObject(arg0).maxTouchPoints;\n        return ret;\n    };\n    imports.wbg.__wbg_keys_386d224d0262f361 = function(arg0) {\n        const ret = Object.keys(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_sort_3dd97e5325a14f4c = function(arg0) {\n        const ret = getObject(arg0).sort();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_mediaDevices_3e7cfbc0834c7ebc = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).mediaDevices;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_enumerateDevices_bdfeafd96a31de36 = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).enumerateDevices();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_deviceId_2f4358ebee927f5c = function(arg0, arg1) {\n        const ret = getObject(arg1).deviceId;\n        const ptr1 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    };\n    imports.wbg.__wbindgen_cb_drop = function(arg0) {\n        const obj = takeObject(arg0).original;\n        if (obj.cnt-- == 1) {\n            obj.a = 0;\n            return true;\n        }\n        const ret = false;\n        return ret;\n    };\n    imports.wbg.__wbg_instanceof_Response_fc4327dbfcdf5ced = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof Response;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbg_randomFillSync_dc1e9a60c158336d = function() { return handleError(function (arg0, arg1) {\n        getObject(arg0).randomFillSync(takeObject(arg1));\n    }, arguments) };\n    imports.wbg.__wbg_subarray_13db269f57aa838d = function(arg0, arg1, arg2) {\n        const ret = getObject(arg0).subarray(arg1 >>> 0, arg2 >>> 0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_getRandomValues_37fa2ca9e4e07fab = function() { return handleError(function (arg0, arg1) {\n        getObject(arg0).getRandomValues(getObject(arg1));\n    }, arguments) };\n    imports.wbg.__wbindgen_debug_string = function(arg0, arg1) {\n        const ret = debugString(getObject(arg1));\n        const ptr1 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    };\n    imports.wbg.__wbindgen_throw = function(arg0, arg1) {\n        throw new Error(getStringFromWasm0(arg0, arg1));\n    };\n    imports.wbg.__wbg_then_b2267541e2a73865 = function(arg0, arg1, arg2) {\n        const ret = getObject(arg0).then(getObject(arg1), getObject(arg2));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_then_f7e06ee3c11698eb = function(arg0, arg1) {\n        const ret = getObject(arg0).then(getObject(arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_resolve_53698b95aaf7fcf8 = function(arg0) {\n        const ret = Promise.resolve(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_newwithstrandinit_cad5cd6038c7ff5d = function() { return handleError(function (arg0, arg1, arg2) {\n        const ret = new Request(getStringFromWasm0(arg0, arg1), getObject(arg2));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_instanceof_Window_9029196b662bc42a = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof Window;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbg_new_1eead62f64ca15ce = function() { return handleError(function () {\n        const ret = new Headers();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_append_fda9e3432e3e88da = function() { return handleError(function (arg0, arg1, arg2, arg3, arg4) {\n        getObject(arg0).append(getStringFromWasm0(arg1, arg2), getStringFromWasm0(arg3, arg4));\n    }, arguments) };\n    imports.wbg.__wbg_url_8503de97f69da463 = function(arg0, arg1) {\n        const ret = getObject(arg1).url;\n        const ptr1 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len1 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len1;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n    };\n    imports.wbg.__wbg_send_1a008ea2eb3a1951 = function() { return handleError(function (arg0, arg1, arg2) {\n        getObject(arg0).send(getArrayU8FromWasm0(arg1, arg2));\n    }, arguments) };\n    imports.wbg.__wbindgen_closure_wrapper1507 = function(arg0, arg1, arg2) {\n        const ret = makeClosure(arg0, arg1, 84, __wbg_adapter_34);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_closure_wrapper1671 = function(arg0, arg1, arg2) {\n        const ret = makeMutClosure(arg0, arg1, 84, __wbg_adapter_37);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_closure_wrapper1878 = function(arg0, arg1, arg2) {\n        const ret = makeMutClosure(arg0, arg1, 94, __wbg_adapter_40);\n        return addHeapObject(ret);\n    };\n\n    return imports;\n}\n\nfunction __wbg_init_memory(imports, maybe_memory) {\n\n}\n\nfunction __wbg_finalize_init(instance, module) {\n    wasm = instance.exports;\n    __wbg_init.__wbindgen_wasm_module = module;\n    cachedFloat64Memory0 = null;\n    cachedInt32Memory0 = null;\n    cachedUint8Memory0 = null;\n\n    wasm.__wbindgen_start();\n    return wasm;\n}\n\nfunction initSync(module) {\n    if (wasm !== undefined) return wasm;\n\n    const imports = __wbg_get_imports();\n\n    __wbg_init_memory(imports);\n\n    if (!(module instanceof WebAssembly.Module)) {\n        module = new WebAssembly.Module(module);\n    }\n\n    const instance = new WebAssembly.Instance(module, imports);\n\n    return __wbg_finalize_init(instance, module);\n}\n\nasync function __wbg_init(input) {\n    if (wasm !== undefined) return wasm;\n\n    if (typeof input === 'undefined') {\n        input = new URL('telemeter_wasm_bg.wasm', import.meta.url);\n    }\n    const imports = __wbg_get_imports();\n\n    if (typeof input === 'string' || (typeof Request === 'function' && input instanceof Request) || (typeof URL === 'function' && input instanceof URL)) {\n        input = fetch(input);\n    }\n\n    __wbg_init_memory(imports);\n\n    const { instance, module } = await __wbg_load(await input, imports);\n\n    return __wbg_finalize_init(instance, module);\n}\n\nexport { initSync }\nexport default __wbg_init;\n", "import init, { Telemeter as TelemeterWASM } from \"../telemeter-wasm\";\n\n/**\n * @classdesc\n * This class implements the @wiris/telemeter-wasm. A utility that helps our Solutions to send the data\n * to Telemetry in a more comfortable and homogeneous way.\n */\nexport default class Telemeter {\n\n  /**\n   * Inits Telemeter class.\n   * The parameters structures are defiended on {@link [Telemeter API](https://github.com/wiris/telemeter/blob/main/docs/USAGE.md#telemeter-api)}\n   * @param {Object} telemeterAttributes.solution - The product that send data to Telemetry.\n   * @param {Object} telemeterAttributes.hosts - Data about the environment where solution is integrated.\n   * @param {Object} telemeterAttributes.config - Configuration parameters.\n   */\n  static init(telemeterAttributes) {\n    if (!this.telemeter && !this.waitingForInit){\n      this.waitingForInit = true;\n      init(telemeterAttributes.url)\n        .then(() => {\n          this.telemeter = new TelemeterWASM(\n            telemeterAttributes.solution,\n            telemeterAttributes.hosts,\n            telemeterAttributes.config);\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n        .finally(() => this.waitingForInit = false);\n    }\n  }\n\n  /**\n   * Closes the Telemetry Session. After calling this method no data will be added to the Telemetry Session.\n   */\n  static async finish() {\n    if (!this.telemeter) return;\n\n    try {\n      let local_telemeter = this.telemeter;\n      this.telemeter = undefined;\n      await local_telemeter.finish();\n    } catch (e) {\n      console.error(e);\n    }\n  }\n}\n", "import Configuration from './configuration';\nimport Core from './core.src';\nimport EditorListener from './editorlistener';\nimport Listeners from './listeners';\nimport MathML from './mathml';\nimport Util from './util';\nimport Telemeter from './telemeter';\n\nexport default class ContentManager {\n  /**\n   * @classdesc\n   * This class represents a modal dialog, managing the following:\n   * - The insertion of content into the current instance of the {@link ModalDialog} class.\n   * - The actions to be done once the modal object has been submitted\n   *   (submitAction} method).\n   * - The update of the content when the {@link ModalDialog} class is also updated,\n   *   for example when ModalDialog is re-opened.\n   * - The communication between the {@link ModalDialog} class and itself, if the content\n   *   has been changed (hasChanges} method).\n   * @constructs\n   * @param {Object} contentManagerAttributes - Object containing all attributes needed to\n   * create a new instance.\n   */\n  constructor(contentManagerAttributes) {\n    /**\n     * An object containing MathType editor parameters. See\n     * http://docs.wiris.com/en/mathtype/mathtype_web/sdk-api/parameters for further information.\n     * @type {Object}\n     */\n    this.editorAttributes = {};\n    if ('editorAttributes' in contentManagerAttributes) {\n      this.editorAttributes = contentManagerAttributes.editorAttributes;\n    } else {\n      throw new Error('ContentManager constructor error: editorAttributes property missed.');\n    }\n\n    /**\n     * CustomEditors instance. Contains the custom editors.\n     * @type {CustomEditors}\n     */\n    this.customEditors = null;\n    if ('customEditors' in contentManagerAttributes) {\n      this.customEditors = contentManagerAttributes.customEditors;\n    }\n\n    /**\n* Environment properties. This object contains data about the integration platform.\n* @type {Object}\n* @property {String} editor - Editor name. Usually the HTML editor.\n* @property {String} mode - Save mode. Xml by default.\n* @property {String} version - Plugin version.\n  */\n    this.environment = {};\n    if ('environment' in contentManagerAttributes) {\n      this.environment = contentManagerAttributes.environment;\n    } else {\n      throw new Error('ContentManager constructor error: environment property missed');\n    }\n\n    /**\n      * ContentManager language.\n      * @type {String}\n      */\n    this.language = '';\n    if ('language' in contentManagerAttributes) {\n      this.language = contentManagerAttributes.language;\n    } else {\n      throw new Error('ContentManager constructor error: language property missed');\n    }\n\n    /**\n    * {@link EditorListener} instance. Manages the changes inside the editor.\n    * @type {EditorListener}\n    */\n    this.editorListener = new EditorListener();\n\n    /**\n     * MathType editor instance.\n     * @type {JsEditor}\n     */\n    this.editor = null;\n\n    /**\n     * Navigator user agent.\n     * @type {String}\n     */\n    this.ua = navigator.userAgent.toLowerCase();\n\n    /**\n     * Mobile device properties object\n     * @type {DeviceProperties}\n     */\n    this.deviceProperties = {};\n    this.deviceProperties.isAndroid = this.ua.indexOf('android') > -1;\n    this.deviceProperties.isIOS = ContentManager.isIOS();\n\n    /**\n     * Custom editor toolbar.\n     * @type {String}\n     */\n    this.toolbar = null;\n\n    /**\n     * Custom editor toolbar.\n     * @type {String}\n     */\n    this.dbclick = null;\n\n    /**\n     * Instance of the {@link ModalDialog} class associated with the current\n     * {@link ContentManager} instance.\n     * @type {ModalDialog}\n     */\n    this.modalDialogInstance = null;\n\n    /**\n     * ContentManager listeners.\n     * @type {Listeners}\n     */\n    this.listeners = new Listeners();\n\n    /**\n     * MathML associated to the ContentManager instance.\n     * @type {String}\n     */\n    this.mathML = null;\n\n    /**\n     * Indicates if the edited element is a new one or not.\n     * @type {Boolean}\n     */\n    this.isNewElement = true;\n\n    /**\n     * {@link IntegrationModel} instance. Needed to call wrapper methods.\n     * @type {IntegrationModel}\n     */\n    this.integrationModel = null;\n  }\n\n  /**\n   * Adds a new listener to the current {@link ContentManager} instance.\n   * @param {Object} listener - The listener to be added.\n   */\n  addListener(listener) {\n    this.listeners.add(listener);\n  }\n\n  /**\n   * Sets an instance of {@link IntegrationModel} class to the current {@link ContentManager}\n   * instance.\n   * @param {IntegrationModel} integrationModel - The {@link IntegrationModel} instance.\n   */\n  setIntegrationModel(integrationModel) {\n    this.integrationModel = integrationModel;\n  }\n\n  /**\n   * Sets the {@link ModalDialog} instance into the current {@link ContentManager} instance.\n   * @param {ModalDialog} modalDialogInstance - The {@link ModalDialog} instance\n   */\n  setModalDialogInstance(modalDialogInstance) {\n    this.modalDialogInstance = modalDialogInstance;\n  }\n\n  /**\n   * Inserts the content into the current {@link ModalDialog} instance updating\n   * the title and inserting the JavaScript editor.\n   */\n  insert() {\n    // Before insert the editor we update the modal object title to avoid weird render display.\n    this.updateTitle(this.modalDialogInstance);\n    this.insertEditor(this.modalDialogInstance);\n  }\n\n  /**\n   * Inserts MathType editor into the {@link ModalDialog.contentContainer}. It waits until\n   * editor's JavaScript is loaded.\n   */\n  insertEditor() {\n    if (ContentManager.isEditorLoaded()) {\n      this.editor = window.com.wiris.jsEditor.JsEditor.newInstance(this.editorAttributes);\n      this.editor.insertInto(this.modalDialogInstance.contentContainer);\n      this.editor.focus();\n      if (this.modalDialogInstance.rtl) {\n        this.editor.action('rtl');\n      }\n      // Setting div in rtl in case of it's activated.\n      if (this.editor.getEditorModel().isRTL()) {\n        this.editor.element.style.direction = 'rtl';\n      }\n\n      // Editor listener: this object manages the changes logic of editor.\n      this.editor.getEditorModel().addEditorListener(this.editorListener);\n\n      // iOS events.\n      if (this.modalDialogInstance.deviceProperties.isIOS) {\n        setTimeout(function () {\n          // Make sure the modalDialogInstance is available when the timeout is over\n          // to avoid throw errors and stop execution.\n          if (this.hasOwnProperty('modalDialogInstance')) this.modalDialogInstance.hideKeyboard(); // eslint-disable-line no-prototype-builtins\n        }, 400);\n\n        const formulaDisplayDiv = document.getElementsByClassName('wrs_formulaDisplay')[0];\n        Util.addEvent(formulaDisplayDiv, 'focus', this.modalDialogInstance.handleOpenedIosSoftkeyboard);\n        Util.addEvent(formulaDisplayDiv, 'blur', this.modalDialogInstance.handleClosedIosSoftkeyboard);\n      }\n      // Fire onLoad event. Necessary to set the MathML into the editor\n      // after is loaded.\n      this.listeners.fire('onLoad', {});\n    } else {\n      setTimeout(ContentManager.prototype.insertEditor.bind(this), 100);\n    }\n  }\n\n  /**\n   * Initializes the current class by loading MathType script.\n   */\n  init() {\n    if (!ContentManager.isEditorLoaded()) {\n      this.addEditorAsExternalDependency();\n    }\n  }\n\n  /**\n   * Adds script element to the DOM to include editor externally.\n   */\n  addEditorAsExternalDependency() {\n    const script = document.createElement('script');\n    script.type = 'text/javascript';\n    let editorUrl = Configuration.get('editorUrl');\n    // We create an object url for parse url string and work more efficiently.\n    const anchorElement = document.createElement('a');\n\n    ContentManager.setHrefToAnchorElement(anchorElement, editorUrl);\n    ContentManager.setProtocolToAnchorElement(anchorElement);\n\n    editorUrl = ContentManager.getURLFromAnchorElement(anchorElement);\n\n    // Load editor URL. We add stats as GET params.\n    const stats = this.getEditorStats();\n    script.src = `${editorUrl}?lang=${this.language}&stats-editor=${stats.editor}&stats-mode=${stats.mode}&stats-version=${stats.version}`;\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n  }\n\n  /**\n   * Sets the specified url to the anchor element.\n   * @param {HTMLAnchorElement} anchorElement - Element where set 'url'.\n   * @param {String} url - URL to set.\n   */\n  static setHrefToAnchorElement(anchorElement, url) {\n    anchorElement.href = url;\n  }\n\n  /**\n   * Sets the current protocol to the anchor element.\n   * @param {HTMLAnchorElement} anchorElement - Element where set its protocol.\n   */\n  static setProtocolToAnchorElement(anchorElement) {\n    // Change to https if necessary.\n    if (window.location.href.indexOf('https://') === 0) {\n      // It check if browser is https and configuration is http.\n      // If this is so, we will replace protocol.\n      if (anchorElement.protocol === 'http:') {\n        anchorElement.protocol = 'https:';\n      }\n    }\n  }\n\n  /**\n   * Returns the url of the anchor element adding the current port\n   * if it is needed.\n   * @param {HTMLAnchorElement} anchorElement - Element where extract the url.\n   * @returns {String}\n   */\n  static getURLFromAnchorElement(anchorElement) {\n    // Check protocol and remove port if it's standard.\n    const removePort = anchorElement.port === '80' || anchorElement.port === '443' || anchorElement.port === '';\n    return `${anchorElement.protocol}//${anchorElement.hostname}${removePort ? '' : (`:${anchorElement.port}`)}${anchorElement.pathname.startsWith('/') ? anchorElement.pathname : (`/${anchorElement.pathname}`)}`; // eslint-disable-line max-len\n  }\n\n  /**\n   * Returns object with editor stats.\n   *\n   * @typedef {Object} EditorStatsObject\n   * @property {string} editor - Editor name.\n   * @property {string} mode - Current configuration for formula save mode.\n   * @property {string} version - Current plugins version.\n   * @returns {EditorStatsObject}\n   */\n  getEditorStats() {\n    // Editor stats. Use environment property to set it.\n    const stats = {};\n    if ('editor' in this.environment) {\n      stats.editor = this.environment.editor;\n    } else {\n      stats.editor = 'unknown';\n    }\n\n    if ('mode' in this.environment) {\n      stats.mode = this.environment.mode;\n    } else {\n      stats.mode = Configuration.get('saveMode');\n    }\n\n    if ('version' in this.environment) {\n      stats.version = this.environment.version;\n    } else {\n      stats.version = Configuration.get('version');\n    }\n\n    return stats;\n  }\n\n  /**\n   * Returns true if device is iOS. Otherwise, false.\n   * @returns {Boolean}\n   */\n  static isIOS() {\n    return [\n      'iPad Simulator',\n      'iPhone Simulator',\n      'iPod Simulator',\n      'iPad',\n      'iPhone',\n      'iPod',\n    ].includes(navigator.platform)\n    // iPad on iOS 13 detection\n    || (navigator.userAgent.includes('Mac') && 'ontouchend' in document);\n  }\n\n  /**\n   * Returns true if device is Mobile. Otherwise, false.\n   * @returns {Boolean}\n   */\n  static isMobile() {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)\n  }\n\n  /**\n   * Returns true if editor is loaded. Otherwise, false.\n   * @returns {Boolean}\n   */\n  static isEditorLoaded() {\n    // To know if editor JavaScript is loaded we need to wait until\n    // window.com.wiris.jsEditor.JsEditor.newInstance is ready.\n    return (window.com && window.com.wiris && window.com.wiris.jsEditor\n      && window.com.wiris.jsEditor.JsEditor && window.com.wiris.jsEditor.JsEditor.newInstance);\n  }\n\n  /**\n  * Sets the {@link ContentManager.editor} initial content.\n  */\n  setInitialContent() {\n    if (!this.isNewElement) {\n      this.setMathML(this.mathML);\n    }\n  }\n\n  /**\n   * Sets a MathML into {@link ContentManager.editor} instance.\n   * @param {String} mathml - MathML string.\n   * @param {Boolean} focusDisabled - If true editor don't get focus after the MathML is set.\n   * False by default.\n   */\n  setMathML(mathml, focusDisabled) {\n    // By default focus is enabled.\n    if (typeof focusDisabled === 'undefined') {\n      focusDisabled = false;\n    }\n    // Using setMathML method is not a change produced by the user but for the API\n    // so we set to false the contentChange property of editorListener.\n    this.editor.setMathMLWithCallback(mathml, () => {\n      this.editorListener.setWaitingForChanges(true);\n    });\n\n    // We need to wait a little until the callback finish.\n    setTimeout(() => {\n      this.editorListener.setIsContentChanged(false);\n    }, 500);\n\n    // In some scenarios - like closing modal object - editor mustn't be focused.\n    if (!focusDisabled) {\n      this.onFocus();\n    }\n  }\n\n  /**\n   * Sets the focus to the current instance of {@link ContentManager.editor}. Triggered by\n   * {@link ModalDialog.focus}.\n   */\n  onFocus() {\n    if (typeof this.editor !== 'undefined' && this.editor != null) {\n      this.editor.focus();\n\n      // On WordPress integration, the focus gets lost right after setting it.\n      // To fix this, we enforce another focus some milliseconds after this behaviour.\n      setTimeout(() => {this.editor.focus()}, 100);\n    }\n  }\n\n  /**\n   * Updates the edition area by calling {@link IntegrationModel.updateFormula}.\n   * Triggered by {@link ModalDialog.submitAction}.\n   */\n  submitAction() {\n    if (!this.editor.isFormulaEmpty()) {\n      let mathML = this.editor.getMathMLWithSemantics();\n      // Add class for custom editors.\n      if (this.customEditors.getActiveEditor() !== null) {\n        const { toolbar } = this.customEditors.getActiveEditor();\n        mathML = MathML.addCustomEditorClassAttribute(mathML, toolbar);\n      } else {\n        // We need - if exists - the editor name from MathML\n        // class attribute.\n        Object.keys(this.customEditors.editors).forEach((key) => {\n          mathML = MathML.removeCustomEditorClassAttribute(mathML, key);\n        });\n      }\n      const mathmlEntitiesEncoded = MathML.mathMLEntities(mathML);\n      this.integrationModel.updateFormula(mathmlEntitiesEncoded);\n    } else {\n      this.integrationModel.updateFormula(null);\n    }\n\n    this.customEditors.disable();\n    this.integrationModel.notifyWindowClosed();\n\n    // Set disabled focus to prevent lost focus.\n    this.setEmptyMathML();\n    this.customEditors.disable();\n  }\n\n  /**\n   * Sets an empty MathML as {@link ContentManager.editor} content.\n   */\n  setEmptyMathML() {\n    // As second argument we pass.\n    if (this.deviceProperties.isAndroid || this.deviceProperties.isIOS) {\n      // We need to set a empty annotation in order to maintain editor in Hand mode.\n      // Adding dir rtl in case of it's activated.\n      if (this.editor.getEditorModel().isRTL()) {\n        this.setMathML('<math dir=\"rtl\"><semantics><annotation encoding=\"application/json\">[]</annotation></semantics></math>', true);\n      } else {\n        this.setMathML('<math><semantics><annotation encoding=\"application/json\">[]</annotation></semantics></math>', true);\n      }\n    } else if (this.editor.getEditorModel().isRTL()) {\n      this.setMathML('<math dir=\"rtl\"/>', true);\n    } else {\n      this.setMathML('<math/>', true);\n    }\n  }\n\n  /**\n   * Open event. Triggered by {@link ModalDialog.open}. Does the following:\n   * - Updates the {@link ContentManager.editor} content\n   *   (with an empty MathML or an existing formula),\n   * - Updates the {@link ContentManager.editor} toolbar.\n   * - Recovers the the focus.\n   */\n  onOpen() {\n    if (this.isNewElement) {\n      this.setEmptyMathML();\n    } else {\n      this.setMathML(this.mathML);\n    }\n    let toolbar = this.updateToolbar();\n    this.onFocus();\n\n    if (this.deviceProperties.isIOS) {\n      const zoom = document.documentElement.clientWidth / window.innerWidth;\n\n      if (zoom !== 1) {\n        // Open editor in Keyboard mode if user use iOS, Safari and page is zoomed.\n        this.setKeyboardMode();\n      }\n    }\n\n    let trigger = this.dbclick ? 'formula' : 'button';\n    try {\n      Telemeter.telemeter.track(\"OPENED_MTCT_EDITOR\", {\n        toolbar: toolbar,\n        trigger: trigger,\n      });\n    } catch (err) {\n      console.error(err);\n    }\n\n    Core.globalListeners.fire('onModalOpen', {});\n  }\n\n  /**\n   * Change Editor in keyboard mode when is loaded\n   */\n  setKeyboardMode() {\n    const wrsEditor = document.getElementsByClassName('wrs_handOpen wrs_disablePalette')[0];\n    if (wrsEditor) {\n      wrsEditor.classList.remove('wrs_handOpen');\n      wrsEditor.classList.remove('wrs_disablePalette');\n    } else {\n      setTimeout(ContentManager.prototype.setKeyboardMode.bind(this), 100);\n    }\n  }\n\n  /**\n   * Sets the correct toolbar depending if exist other custom toolbars\n   * at the same time (e.g: Chemistry).\n   */\n  updateToolbar() {\n    this.updateTitle(this.modalDialogInstance);\n    const customEditor = this.customEditors.getActiveEditor();\n\n    let toolbar;\n    if (customEditor) {\n      toolbar = customEditor.toolbar\n        ? customEditor.toolbar\n        : _wrs_int_wirisProperties.toolbar;\n\n      if (this.toolbar == null || this.toolbar !== toolbar) {\n        this.setToolbar(toolbar);\n      }\n    } else {\n      toolbar = this.getToolbar();\n      if (this.toolbar == null || this.toolbar !== toolbar) {\n        this.setToolbar(toolbar);\n        this.customEditors.disable();\n      }\n    }\n\n    return toolbar;\n  }\n\n  /**\n   * Updates the current {@link ModalDialog.title}. If a {@link CustomEditors} is enabled\n   * sets the custom editor title. Otherwise sets the default title.\n   */\n  updateTitle() {\n    const customEditor = this.customEditors.getActiveEditor();\n    if (customEditor) {\n      this.modalDialogInstance.setTitle(customEditor.title);\n    } else {\n      this.modalDialogInstance.setTitle('MathType');\n    }\n  }\n\n  /**\n   * Returns the editor toolbar, depending on the configuration local or server side.\n   * @returns {String} - Toolbar identifier.\n   */\n  getToolbar() {\n    let toolbar = 'general';\n    if ('toolbar' in this.editorAttributes) {\n      ({ toolbar } = this.editorAttributes);\n    }\n    // TODO: Change global integration variable for integration custom toolbar.\n    if (toolbar === 'general') {\n      // eslint-disable-next-line camelcase\n      toolbar = (typeof _wrs_int_wirisProperties === 'undefined' || typeof _wrs_int_wirisProperties.toolbar === 'undefined') ? 'general' : _wrs_int_wirisProperties.toolbar;\n    }\n\n    return toolbar;\n  }\n\n  /**\n   * Sets the current {@link ContentManager.editor} instance toolbar.\n   * @param {String} toolbar - The toolbar name.\n   */\n  setToolbar(toolbar) {\n    this.toolbar = toolbar;\n    this.editor.setParams({ toolbar: this.toolbar });\n  }\n\n  /**\n   * Returns true if the content of the editor has been changed. The logic of the changes\n   * is delegated to {@link EditorListener} class.\n   * @returns {Boolean} True if the editor content has been changed. False otherwise.\n   */\n  hasChanges() {\n    return (!this.editor.isFormulaEmpty() && this.editorListener.getIsContentChanged());\n  }\n\n  /**\n   * Handle keyboard events detected in modal when elements of this class intervene.\n   * @param {KeyboardEvent} keyboardEvent - The keyboard event.\n   */\n  onKeyDown(keyboardEvent) {\n    if (keyboardEvent.key !== undefined && keyboardEvent.repeat === false) {\n      if (keyboardEvent.key === 'Escape' || keyboardEvent.key === 'Esc') { // Code to detect Esc event.\n        // There should be only one element with class name 'wrs_pressed' at the same time.\n        let list = document.getElementsByClassName('wrs_expandButton wrs_expandButtonFor3RowsLayout wrs_pressed');\n        if (list.length === 0) {\n          list = document.getElementsByClassName('wrs_expandButton wrs_expandButtonFor2RowsLayout wrs_pressed');\n          if (list.length === 0) {\n            list = document.getElementsByClassName('wrs_select wrs_pressed');\n            if (list.length === 0) {\n              this.modalDialogInstance.cancelAction();\n              keyboardEvent.stopPropagation();\n              keyboardEvent.preventDefault();\n            }\n          }\n        }\n      } else if (keyboardEvent.shiftKey && keyboardEvent.key === 'Tab') { // Code to detect shift Tab event.\n        if (document.activeElement === this.modalDialogInstance.submitButton) {\n          // Focus is on OK button.\n          this.editor.focus();\n          keyboardEvent.stopPropagation();\n          keyboardEvent.preventDefault();\n        } else if (document.querySelector('[title=\"Manual\"]') === document.activeElement) {\n          // Focus is on minimize button (_).\n          this.modalDialogInstance.closeDiv.focus();\n          keyboardEvent.stopPropagation();\n          keyboardEvent.preventDefault();\n        } else {\n          if (document.activeElement === this.modalDialogInstance.minimizeDiv) {\n            // Focus on cancel button.\n            if (!(this.modalDialogInstance.properties.state === 'minimized')) {\n              this.modalDialogInstance.cancelButton.focus();\n              keyboardEvent.stopPropagation();\n              keyboardEvent.preventDefault();\n            }\n          }\n        }\n      } else if (keyboardEvent.key === 'Tab') { // Code to detect Tab event.\n        if (document.activeElement === this.modalDialogInstance.cancelButton) {\n          // Focus is on X button.\n          this.modalDialogInstance.minimizeDiv.focus();\n          keyboardEvent.stopPropagation();\n          keyboardEvent.preventDefault();\n        } else if (document.activeElement === this.modalDialogInstance.closeDiv) {\n          // Focus on help button.\n          if (!(this.modalDialogInstance.properties.state === 'minimized')) {\n            const element = document.querySelector('[title=\"Manual\"]');\n            element.focus();\n            keyboardEvent.stopPropagation();\n            keyboardEvent.preventDefault();\n          }\n        } else {\n          // There should be only one element with class name 'wrs_formulaDisplay'.\n          const element = document.getElementsByClassName('wrs_formulaDisplay')[0];\n          if (element.getAttribute('class') === 'wrs_formulaDisplay wrs_focused') {\n            // Focus is on formuladisplay.\n            this.modalDialogInstance.submitButton.focus();\n            keyboardEvent.stopPropagation();\n            keyboardEvent.preventDefault();\n          }\n        }\n      }\n    }\n  }\n}\n", "/**\n * A custom editor is MathType editor with a different\n * @typedef {Object} CustomEditor\n * @property {String} CustomEditor.name - Custom editor name.\n * @property {String} CustomEditor.toolbar - Custom editor toolbar.\n * @property {String} CustomEditor.icon - Custom editor icon.\n * @property {String} CustomEditor.confVariable - Configuration property to manage\n * the availability of the custom editor.\n * @property {String} CustomEditor.title - Custom editor modal dialog title.\n * @property {String} CustomEditor.tooltip - Custom editor icon tooltip.\n */\n\nexport default class CustomEditors {\n  /**\n   * @classdesc\n   * This class represents the MathType custom editors manager.\n   * A custom editor is MathType editor with a custom  toolbar.\n   * This class associates a {@link CustomEditor} to:\n   * - It's own formulas\n   * - A custom toolbar\n   * - An icon to open it from a HTML editor.\n   * - A tooltip for the icon.\n   * - A global variable to enable or disable it globally.\n   * @constructs\n   */\n  constructor() {\n    /**\n     * The custom editors.\n     * @type {Array.<CustomEditor>}\n     */\n\n    this.editors = [];\n    /**\n     * The active editor name.\n     * @type {String}\n     */\n    this.activeEditor = 'default';\n  }\n\n  /**\n   * Adds a {@link CustomEditor} to editors array.\n   * @param {String} editorName - The editor name.\n   * @param {CustomEditor} editorParams - The custom editor parameters.\n   */\n  addEditor(editorName, editorParams) {\n    const customEditor = {};\n    customEditor.name = editorParams.name;\n    customEditor.toolbar = editorParams.toolbar;\n    customEditor.icon = editorParams.icon;\n    customEditor.confVariable = editorParams.confVariable;\n    customEditor.title = editorParams.title;\n    customEditor.tooltip = editorParams.tooltip;\n    this.editors[editorName] = customEditor;\n  }\n\n  /**\n   * Enables a {@link CustomEditor}.\n   * @param {String} customEditorName - The custom editor name.\n   */\n  enable(customEditorName) {\n    this.activeEditor = customEditorName;\n  }\n\n  /**\n   * Disables a {@link CustomEditor}.\n   */\n  disable() {\n    this.activeEditor = 'default';\n  }\n\n  /**\n   * Returns the active editor.\n   * @return {CustomEditor} - A {@link CustomEditor} if a custom editor is enabled. Null otherwise.\n   */\n  getActiveEditor() {\n    if (this.activeEditor !== 'default') {\n      return this.editors[this.activeEditor];\n    }\n    return null;\n  }\n}\n", "/**\n * Represents the configuration properties generated from the frontend (JavaScript variables).\n * @type {Object}\n * @property {string} imageClassName - Default MathType formula image class.\n * @property {string} imageClassName - Default MathType CAS image class.\n * @ignore\n */\nconst jsProperties = {\n  imageCustomEditorName: 'data-custom-editor',\n  imageClassName: 'Wirisformula',\n  CASClassName: 'Wiriscas',\n};\nexport default jsProperties;\n", "export default class Event {\n  /**\n   * @classdesc\n   * This class represents a custom event. Events should be fired by the {@link Listener} class.\n   *\n   * ```js\n   *  let customEvent = new Event();\n   *  customEvent.properties = {};\n   *\n   *  let listeners = new Listeners();\n   *  listeners.newListener(eventName, callback);\n   *\n   *  listeners.fire(eventName, customEvent) *\n   * ```\n   * @constructs\n   */\n  constructor() {\n    /**\n     * Indicates if the event should be cancelled.\n     * @type {Boolean}\n     */\n\n    this.cancelled = false;\n    /**\n     * Indicates if the event should be prevented.\n     * @type {Boolean}\n     */\n    this.defaultPrevented = false;\n  }\n\n  /**\n   * Cancels the event.\n   */\n  cancel() {\n    this.cancelled = true;\n  }\n\n  /**\n   * Prevents the default action.\n   */\n  preventDefault() {\n    this.defaultPrevented = true;\n  }\n}\n", "import IntegrationModel from './integrationmodel';\n\n/**\n\n */\nexport default class PopUpMessage {\n  /**\n   * @classdesc\n   * This class represents a dialog message overlaying a DOM element in order to\n   * accept / cancel discard changes. The dialog can be closed i.e the overlay disappears\n   * o canceled. In this last case a callback function should be called.\n   * @constructs\n   * @param {Object} popupMessageAttributes - Object containing popup properties.\n   * @param {HTMLElement} popupMessageAttributes.overlayElement - Element to overlay.\n   * @param {Object} popupMessageAttributes.callbacks - Contains callback\n   * methods for close and cancel actions.\n   * @param {Object} popupMessageAttributes.strings - Contains all the strings needed.\n   */\n  constructor(popupMessageAttributes) {\n    /**\n     * Element to be overlaid when the popup appears.\n     */\n    this.overlayElement = popupMessageAttributes.overlayElement;\n\n    this.callbacks = popupMessageAttributes.callbacks;\n\n    /**\n     * HTMLElement element to wrap all HTML elements inside the popupMessage.\n     */\n    this.overlayWrapper = this.overlayElement.appendChild(document.createElement('div'));\n    this.overlayWrapper.setAttribute('class', 'wrs_popupmessage_overlay_envolture');\n\n    /**\n     * HTMLElement to display the popup message, close button and cancel button.\n     */\n    this.message = this.overlayWrapper.appendChild(document.createElement('div'));\n    this.message.id = 'wrs_popupmessage';\n    this.message.setAttribute('class', 'wrs_popupmessage_panel');\n    this.message.setAttribute('role', 'dialog');\n    this.message.setAttribute('aria-describedby', 'description_txt');\n    const paragraph = document.createElement('p');\n    const text = document.createTextNode(popupMessageAttributes.strings.message);\n    paragraph.appendChild(text);\n    paragraph.id = 'description_txt';\n    this.message.appendChild(paragraph);\n\n    /**\n     * HTML element overlaying the overlayElement.\n     */\n    const overlay = this.overlayWrapper.appendChild(document.createElement('div'));\n    overlay.setAttribute('class', 'wrs_popupmessage_overlay');\n    // We create a overlay that close popup message on click in there\n    overlay.addEventListener('click', this.cancelAction.bind(this));\n\n    /**\n     * HTML element containing cancel and close buttons.\n     */\n    this.buttonArea = this.message.appendChild(document.createElement('div'));\n    this.buttonArea.setAttribute('class', 'wrs_popupmessage_button_area');\n    this.buttonArea.id = 'wrs_popup_button_area';\n\n    // Close button arguments.\n    const buttonSubmitArguments = {\n      class: 'wrs_button_accept',\n      innerHTML: popupMessageAttributes.strings.submitString,\n      id: 'wrs_popup_accept_button',\n      // To identifiy the element in automated testing\n      'data-testid': 'mtcteditor-cd-close-button',\n    };\n\n    /**\n     * Close button arguments.\n     */\n    this.closeButton = this.createButton(buttonSubmitArguments, this.closeAction.bind(this));\n    this.buttonArea.appendChild(this.closeButton);\n\n    // Cancel button arguments.\n    const buttonCancelArguments = {\n      class: 'wrs_button_cancel',\n      innerHTML: popupMessageAttributes.strings.cancelString,\n      id: 'wrs_popup_cancel_button',\n      // To identifiy the element in automated testing\n      'data-testid': 'mtcteditor-cd-cancel-button',\n    };\n\n    /**\n     * Cancel button.\n     */\n    this.cancelButton = this.createButton(buttonCancelArguments, this.cancelAction.bind(this));\n    this.buttonArea.appendChild(this.cancelButton);\n  }\n\n  /**\n   * This method create a button with arguments and return button dom object\n   * @param {Object} parameters - An object containing id, class and innerHTML button text.\n   * @param {String} parameters.id - Button id.\n   * @param {String} parameters.class - Button class name.\n   * @param {String} parameters.innerHTML - Button innerHTML text.\n   * @param {Object} callback- Callback method to call on click event.\n   * @returns {HTMLElement} HTML button.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  createButton(parameters, callback) {\n    let element = {};\n    element = document.createElement('button');\n    element.setAttribute('id', parameters.id);\n    element.setAttribute('class', parameters.class);\n    element.innerHTML = parameters.innerHTML;\n    element.addEventListener('click', callback);\n    if (parameters['data-testid']) {\n      element.setAttribute('data-testid', parameters['data-testid']);\n    }\n\n    return element;\n  }\n\n  /**\n   * Shows the popupmessage containing a message, and two buttons\n   * to cancel the action or close the modal dialog.\n   */\n  show() {\n    if (this.overlayWrapper.style.display !== 'block') {\n      // Clear focus with blur for prevent press any key.\n      document.activeElement.blur();\n      this.overlayWrapper.style.display = 'block';\n      this.closeButton.focus();\n    } else {\n      this.overlayWrapper.style.display = 'none';\n      // _wrs_modalWindow.focus(); This throws an error of not existing _wrs_modalWindow\n    }\n  }\n\n  /**\n   * This method cancels the popupMessage: the dialog disappears revealing the overlaid element.\n   * A callback method is called (if defined). For example a method to focus the overlaid element.\n   */\n  cancelAction() {\n    this.overlayWrapper.style.display = 'none';\n    if (typeof this.callbacks.cancelCallback !== 'undefined') {\n      this.callbacks.cancelCallback();\n      // Set temporal image to null to prevent loading\n      // an existent formula when strarting one from scrath. Make focus come back too.\n      // IntegrationModel.setActionsOnCancelButtons();\n    }\n  }\n\n  /**\n   * This method closes the popupMessage: the dialog disappears and the close callback is called.\n   * For example to close the overlaid element.\n   */\n  closeAction() {\n    this.cancelAction();\n    if (typeof this.callbacks.closeCallback !== 'undefined') {\n      this.callbacks.closeCallback();\n    }\n    IntegrationModel.setActionsOnCancelButtons();\n  }\n\n  /**\n   * Handle keyboard events detected in modal when elements of this class intervene.\n   * @param {KeyboardEvent} keyboardEvent - The keyboard event.\n   */\n  onKeyDown(keyboardEvent) {\n    if (keyboardEvent.key !== undefined) {\n      // Code to detect Esc event.\n      if (keyboardEvent.key === 'Escape' || keyboardEvent.key === 'Esc') {\n        this.cancelAction();\n        keyboardEvent.stopPropagation();\n        keyboardEvent.preventDefault();\n      } else if (keyboardEvent.key === 'Tab') { // Code to detect Tab event.\n        if (document.activeElement === this.closeButton) {\n          this.cancelButton.focus();\n        } else {\n          this.closeButton.focus();\n        }\n        keyboardEvent.stopPropagation();\n        keyboardEvent.preventDefault();\n      }\n    }\n  }\n}\n", "// eslint-disable-next-line max-classes-per-file\nimport PopUpMessage from './popupmessage';\nimport Util from './util';\nimport Configuration from './configuration';\nimport Listeners from './listeners';\nimport StringManager from './stringmanager';\nimport ContentManager from './contentmanager';\nimport Telemeter from './telemeter';\nimport IntegrationModel from './integrationmodel';\nimport Core from './core.src';\n\nimport closeIcon from '../styles/icons/general/close_icon.svg';  //eslint-disable-line\nimport closeHoverIcon from '../styles/icons/hover/close_icon_h.svg';  //eslint-disable-line\nimport fullsIcon from '../styles/icons/general/fulls_icon.svg';  //eslint-disable-line\nimport fullsHoverIcon from '../styles/icons/hover/fulls_icon_h.svg';  //eslint-disable-line\nimport minIcon from '../styles/icons/general/min_icon.svg';  //eslint-disable-line\nimport minHoverIcon from '../styles/icons/hover/min_icon_h.svg';  //eslint-disable-line\nimport minsIcon from '../styles/icons/general/mins_icon.svg';  //eslint-disable-line\nimport minsHoverIcon from '../styles/icons/hover/mins_icon_h.svg';  //eslint-disable-line\nimport maxIcon from '../styles/icons/general/max_icon.svg';  //eslint-disable-line\nimport maxHoverIcon from '../styles/icons/hover/max_icon_h.svg';  //eslint-disable-line\n\n/**\n * @typedef {Object} DeviceProperties\n * @property {String} DeviceProperties.orientation - Indicates of the orientation of the device.\n * @property {Boolean} DeviceProperties.isAndroid - True if the device is Android. False otherwise.\n * @property {Boolean} DeviceProperties.isIOS - True if the device is iOS. False otherwise.\n * @property {Boolean} DeviceProperties.isMobile - True if the device is a mobile one.\n * False otherwise.\n * @property {Boolean} DeviceProperties.isDesktop - True if the device is a desktop one.\n * False otherwise.\n */\n\nexport default class ModalDialog {\n  /**\n   * @classdesc\n   * This class represents a modal dialog. The modal dialog admits\n   * a {@link ContentManager} instance to manage the content of the dialog.\n   * @constructs\n   * @param {Object} modalDialogAttributes  - An object containing all modal dialog attributes.\n   */\n  constructor(modalDialogAttributes) {\n    this.attributes = modalDialogAttributes;\n\n    // Metrics.\n    const ua = navigator.userAgent.toLowerCase();\n    const isAndroid = ua.indexOf('android') > -1;\n    const isIOS = ContentManager.isIOS();\n    this.iosSoftkeyboardOpened = false;\n    this.iosMeasureUnit = ua.indexOf('crios') === -1 ? '%' : 'vh';\n    this.iosDivHeight = `100%${this.iosMeasureUnit}`;\n\n    const deviceWidth = window.outerWidth;\n    const deviceHeight = window.outerHeight;\n\n    const landscape = deviceWidth > deviceHeight;\n    const portrait = deviceWidth < deviceHeight;\n\n    // TODO: Detect isMobile without using editor metrics.\n    const isLandscape = (landscape && this.attributes.height > deviceHeight);\n    const isPortrait = portrait && this.attributes.width > deviceWidth;\n    const isMobile =  ContentManager.isMobile();\n\n    // Obtain number of current instance.\n    this.instanceId = document.getElementsByClassName('wrs_modal_dialogContainer').length;\n\n    // Device object properties.\n\n    /**\n     * @type {DeviceProperties}\n     */\n    this.deviceProperties = {\n      orientation: landscape ? 'landscape' : 'portait',\n      isAndroid,\n      isIOS,\n      isMobile,\n      isDesktop: !isMobile && !isIOS && !isAndroid,\n    };\n\n    this.properties = {\n      created: false,\n      state: '',\n      previousState: '',\n      position: { bottom: 0, right: 10 },\n      size: { height: 338, width: 580 },\n    };\n\n    /**\n     * Object to keep website's style before change it on lock scroll for mobile devices.\n     * @type {Object}\n     * @property {String} bodyStylePosition - Previous body style postion.\n     * @property {String} bodyStyleOverflow - Previous body style overflow.\n     * @property {String} htmlStyleOverflow - Previous body style overflow.\n     * @property {String} windowScrollX - Previous window's scroll Y.\n     * @property {String} windowScrollY - Previous window's scroll X.\n     */\n    this.websiteBeforeLockParameters = null;\n\n    let attributes = {};\n    attributes.class = 'wrs_modal_overlay';\n    attributes.id = this.getElementId(attributes.class);\n    this.overlay = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = 'wrs_modal_title_bar';\n    attributes.id = this.getElementId(attributes.class);\n    this.titleBar = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = 'wrs_modal_title';\n    attributes.id = this.getElementId(attributes.class);\n    this.title = Util.createElement('div', attributes);\n    this.title.innerHTML = 'offline';\n\n    attributes = {};\n    attributes.class = 'wrs_modal_close_button';\n    attributes.id = this.getElementId(attributes.class);\n    attributes.title = StringManager.get('close');\n    attributes.style = {};\n    this.closeDiv = Util.createElement('a', attributes);\n    this.closeDiv.setAttribute('role', 'button');\n    this.closeDiv.setAttribute('tabindex', 3);\n    // Apply styles and events after the creation as createElement doesn't process them correctly\n    let generalStyle = `background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(closeIcon)})`;\n    let hoverStyle = `background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(closeHoverIcon)})`;\n    this.closeDiv.setAttribute('style', generalStyle);\n    this.closeDiv.setAttribute('onmouseover', `this.style = \"${hoverStyle}\";`);\n    this.closeDiv.setAttribute('onmouseout', `this.style = \"${generalStyle}\";`);\n    // To identifiy the element in automated testing\n    this.closeDiv.setAttribute('data-testid', 'mtcteditor-close-button');\n\n    attributes = {};\n    attributes.class = 'wrs_modal_stack_button';\n    attributes.id = this.getElementId(attributes.class);\n    attributes.title = StringManager.get('exit_fullscreen');\n    this.stackDiv = Util.createElement('a', attributes);\n    this.stackDiv.setAttribute('role', 'button');\n    this.stackDiv.setAttribute('tabindex', 2);\n    generalStyle = `background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(minsIcon)})`;\n    hoverStyle = `background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(minsHoverIcon)})`;\n    this.stackDiv.setAttribute('style', generalStyle);\n    this.stackDiv.setAttribute('onmouseover', `this.style = \"${hoverStyle}\";`);\n    this.stackDiv.setAttribute('onmouseout', `this.style = \"${generalStyle}\";`);\n    // To identifiy the element in automated testing\n    this.stackDiv.setAttribute('data-testid', 'mtcteditor-fullscreen-disable-button');\n\n    attributes = {};\n    attributes.class = 'wrs_modal_maximize_button';\n    attributes.id = this.getElementId(attributes.class);\n    attributes.title = StringManager.get('fullscreen');\n    this.maximizeDiv = Util.createElement('a', attributes);\n    this.maximizeDiv.setAttribute('role', 'button');\n    this.maximizeDiv.setAttribute('tabindex', 2);\n    generalStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(fullsIcon)})`;\n    hoverStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(fullsHoverIcon)})`;\n    this.maximizeDiv.setAttribute('style', generalStyle);\n    this.maximizeDiv.setAttribute('onmouseover', `this.style = \"${hoverStyle}\";`);\n    this.maximizeDiv.setAttribute('onmouseout', `this.style = \"${generalStyle}\";`);\n    // To identifiy the element in automated testing\n    this.maximizeDiv.setAttribute('data-testid', 'mtcteditor-fullscreen-enable-button');\n\n    attributes = {};\n    attributes.class = 'wrs_modal_minimize_button';\n    attributes.id = this.getElementId(attributes.class);\n    attributes.title = StringManager.get('minimize');\n    this.minimizeDiv = Util.createElement('a', attributes);\n    this.minimizeDiv.setAttribute('role', 'button');\n    this.minimizeDiv.setAttribute('tabindex', 1);\n    generalStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(minIcon)})`;\n    hoverStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(minHoverIcon)})`;\n    this.minimizeDiv.setAttribute('style', generalStyle);\n    this.minimizeDiv.setAttribute('onmouseover', `this.style = \"${hoverStyle}\";`);\n    this.minimizeDiv.setAttribute('onmouseout', `this.style = \"${generalStyle}\";`);\n    // To identifiy the element in automated testing\n    this.minimizeDiv.setAttribute('data-testid', 'mtcteditor-minimize-button');\n\n    attributes = {};\n    attributes.class = 'wrs_modal_dialogContainer';\n    attributes.id = this.getElementId(attributes.class);\n    attributes.role = 'dialog';\n    this.container = Util.createElement('div', attributes);\n    this.container.setAttribute('aria-labeledby', 'wrs_modal_title[0]');\n\n    attributes = {};\n    attributes.class = 'wrs_modal_wrapper';\n    attributes.id = this.getElementId(attributes.class);\n    this.wrapper = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = 'wrs_content_container';\n    attributes.id = this.getElementId(attributes.class);\n    this.contentContainer = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = 'wrs_modal_controls';\n    attributes.id = this.getElementId(attributes.class);\n    this.controls = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = 'wrs_modal_buttons_container';\n    attributes.id = this.getElementId(attributes.class);\n    this.buttonContainer = Util.createElement('div', attributes);\n\n    // Buttons: all button must be created using createSubmitButton method.\n    this.submitButton = this.createSubmitButton(\n      {\n        id: this.getElementId('wrs_modal_button_accept'),\n        class: 'wrs_modal_button_accept',\n        innerHTML: StringManager.get('accept'),\n        // To identifiy the element in automated testing\n        'data-testid': 'mtcteditor-insert-button',\n      },\n      this.submitAction.bind(this),\n    );\n\n    this.cancelButton = this.createSubmitButton(\n      {\n        id: this.getElementId('wrs_modal_button_cancel'),\n        class: 'wrs_modal_button_cancel',\n        innerHTML: StringManager.get('cancel'),\n        // To identifiy the element in automated testing\n        'data-testid': 'mtcteditor-cancel-button',\n      },\n      this.cancelAction.bind(this),\n    );\n\n    this.contentManager = null;\n\n    // Overlay popup.\n    const popupStrings = {\n      cancelString: StringManager.get('cancel'),\n      submitString: StringManager.get('close'),\n      message: StringManager.get('close_modal_warning'),\n    };\n\n    const callbacks = {\n      closeCallback: () => { this.close(); },\n      cancelCallback: () => { this.focus(); },\n    };\n\n    const popupupProperties = {\n      overlayElement: this.container,\n      callbacks,\n      strings: popupStrings,\n    };\n\n    this.popup = new PopUpMessage(popupupProperties);\n\n    /**\n    * Indicates if directionality of the modal dialog is RTL. false by default.\n    * @type {Boolean}\n    */\n    this.rtl = false;\n    if ('rtl' in this.attributes) {\n      this.rtl = this.attributes.rtl;\n    }\n\n    // Event handlers need modal instance context.\n    this.handleOpenedIosSoftkeyboard = this.handleOpenedIosSoftkeyboard.bind(this);\n    this.handleClosedIosSoftkeyboard = this.handleClosedIosSoftkeyboard.bind(this);\n  }\n\n  /**\n   * This method sets an ContentManager instance to ModalDialog. ContentManager\n   * manages the logic of ModalDialog content: submit, update, close and changes.\n   * @param {ContentManager} contentManager - ContentManager instance.\n   */\n  setContentManager(contentManager) {\n    this.contentManager = contentManager;\n  }\n\n  /**\n   * Returns the modal contentElement object.\n   * @returns {ContentManager} the instance of the ContentManager class.\n  */\n  getContentManager() {\n    return this.contentManager;\n  }\n\n  /**\n   * This method is called when the modal object has been submitted. Calls\n   * contentElement submitAction method - if exists - and closes the modal\n   * object. No logic about the content should be placed here,\n   * contentElement.submitAction is the responsible of the content logic.\n   */\n  submitAction() {\n    if (typeof this.contentManager.submitAction !== 'undefined') {\n      this.contentManager.submitAction();\n    }\n\n    try {\n      Telemeter.telemeter.track(\"CLOSED_MTCT_EDITOR\", {\n        toolbar: this.contentManager.toolbar,\n        trigger: \"mtct_insert\",\n      });\n    } catch (err) {\n      console.error(err);\n    }\n\n    this.close();\n  }\n\n  /**\n   * This method is called when the modal object has been cancelled. If\n   * contentElement has implemented hasChanges method, a confirm popup\n   * will be shown if hasChanges returns true.\n   */\n  cancelAction() {\n    // opening a existing formula editor when trying to open a new one\n    if (typeof this.contentManager.hasChanges === 'undefined') {\n      // Set temporal image to null to prevent loading\n      // an existent formula when strarting one from scrath. Make focus come back too.\n      IntegrationModel.setActionsOnCancelButtons();\n\n      try {\n        Telemeter.telemeter.track(\"CLOSED_MTCT_EDITOR\", {\n          toolbar: this.contentManager.toolbar,\n          trigger: \"mtct_close\",\n        });\n      } catch (err) {\n        console.error(err);\n      }\n\n      this.close();\n    } else if (!this.contentManager.hasChanges()) {\n      IntegrationModel.setActionsOnCancelButtons();\n\n      try {\n        Telemeter.telemeter.track(\"CLOSED_MTCT_EDITOR\", {\n          toolbar: this.contentManager.toolbar,\n          trigger: \"mtct_close\",\n        });\n      } catch (err) {\n        console.error(err);\n      }\n\n      this.close();\n    } else {\n      this.showPopUpMessage();\n\n      try {\n        Telemeter.telemeter.track(\"CLOSED_MTCT_EDITOR\", {\n          toolbar: this.contentManager.toolbar,\n          trigger: \"mtct_close\",\n        });\n      } catch (err) {\n        console.error(err);\n      }\n    }\n  }\n\n  /**\n   * Returns a button element.\n   * @param {Object} properties - Input button properties.\n   * @param {String} properties.class - Input button class.\n   * @param {String} properties.innerHTML - Input button innerHTML.\n   * @param {Object} callback - Callback function associated to click event.\n   * @returns {HTMLButtonElement} The button element.\n   *\n   */\n  // eslint-disable-next-line class-methods-use-this\n  createSubmitButton(properties, callback) {\n    class SubmitButton {\n      constructor() {\n        this.element = document.createElement('button');\n        this.element.id = properties.id;\n        this.element.className = properties.class;\n        this.element.innerHTML = properties.innerHTML;\n        this.element.dataset.testid = properties['data-testid'];\n        Util.addEvent(this.element, 'click', callback);\n      }\n\n      getElement() {\n        return this.element;\n      }\n    }\n    return new SubmitButton(properties, callback).getElement();\n  }\n\n  /**\n   * Creates the modal window object inserting a contentElement object.\n   */\n  create() {\n    /* Modal Window Structure\n    _____________________________________________________________________________________\n    |wrs_modal_dialog_Container                                                         |\n    | _________________________________________________________________________________ |\n    | |title_bar                          minimize_button  stack_button  close_button | |\n    | |_______________________________________________________________________________| |\n    | |wrapper                                                                        | |\n    | | _____________________________________________________________________________ | |\n    | | |content                                                                    | | |\n    | | |                                                                           | | |\n    | | |                                                                           | | |\n    | | |___________________________________________________________________________| | |\n    | | _____________________________________________________________________________ | |\n    | | |controls                                                                   | | |\n    | | | ___________________________________                                       | | |\n    | | | |buttonContainer                  |                                       | | |\n    | | | | _______________________________ |                                       | | |\n    | | | | |button_accept | button_cancel| |                                       | | |\n    | | | |_|_____________ |______________|_|                                       | | |\n    | | |___________________________________________________________________________| | |\n    | |_______________________________________________________________________________| |\n    |___________________________________________________________________________________| */\n\n    this.titleBar.appendChild(this.closeDiv);\n    this.titleBar.appendChild(this.stackDiv);\n    this.titleBar.appendChild(this.maximizeDiv);\n    this.titleBar.appendChild(this.minimizeDiv);\n    this.titleBar.appendChild(this.title);\n\n    if (this.deviceProperties.isDesktop) {\n      this.container.appendChild(this.titleBar);\n    }\n\n    this.wrapper.appendChild(this.contentContainer);\n    this.wrapper.appendChild(this.controls);\n\n    this.controls.appendChild(this.buttonContainer);\n\n    this.buttonContainer.appendChild(this.submitButton);\n    this.buttonContainer.appendChild(this.cancelButton);\n\n    this.container.appendChild(this.wrapper);\n\n    // Check if browser has scrollBar before modal has modified.\n    this.recalculateScrollBar();\n\n    document.body.appendChild(this.container);\n    document.body.appendChild(this.overlay);\n\n    if (this.deviceProperties.isDesktop) { // Desktop.\n      this.createModalWindowDesktop();\n      this.createResizeButtons();\n\n      this.addListeners();\n      // Maximize window only when the configuration is set and the device is not iOS or Android.\n      if (Configuration.get('modalWindowFullScreen')) {\n        this.maximize();\n      }\n    } else if (this.deviceProperties.isAndroid) {\n      this.createModalWindowAndroid();\n    } else if (this.deviceProperties.isIOS) {\n      this.createModalWindowIos();\n    }\n\n    if (this.contentManager != null) {\n      this.contentManager.insert(this);\n    }\n\n    this.properties.open = true;\n    this.properties.created = true;\n\n    // Checks language directionality.\n    if (this.isRTL()) {\n      this.container.style.right = `${window.innerWidth - this.scrollbarWidth - this.container.offsetWidth}px`;\n      this.container.className += ' wrs_modal_rtl';\n    }\n  }\n\n  /**\n   * Creates a button in the modal object to resize it.\n   */\n  createResizeButtons() {\n    // This is a definition of Resize Button Bottom-Right.\n    this.resizerBR = document.createElement('div');\n    this.resizerBR.className = 'wrs_bottom_right_resizer';\n    this.resizerBR.innerHTML = '◢';\n    // To identifiy the element in automated testing\n    this.resizerBR.dataset.testid = 'mtcteditor-resize-button-right';\n    // This is a definition of Resize Button Top-Left.\n    this.resizerTL = document.createElement('div');\n    this.resizerTL.className = 'wrs_bottom_left_resizer';\n    // To identifiy the element in automated testing\n    this.resizerTL.dataset.testid = 'mtcteditor-resize-button-left';\n    // Append resize buttons to modal.\n    this.container.appendChild(this.resizerBR);\n    this.titleBar.appendChild(this.resizerTL);\n    // Add events to resize on click and drag.\n    Util.addEvent(this.resizerBR, 'mousedown', this.activateResizeStateBR.bind(this));\n    Util.addEvent(this.resizerTL, 'mousedown', this.activateResizeStateTL.bind(this));\n  }\n\n  /**\n   * Initialize variables for Bottom-Right resize button\n   * @param {MouseEvent} mouseEvent - Mouse event.\n   */\n  activateResizeStateBR(mouseEvent) {\n    this.initializeResizeProperties(mouseEvent, false);\n  }\n\n  /**\n   * Initialize variables for Top-Left resize button\n   * @param {MouseEvent} mouseEvent - Mouse event.\n   */\n  activateResizeStateTL(mouseEvent) {\n    this.initializeResizeProperties(mouseEvent, true);\n  }\n\n  /**\n   * Common method to initialize variables at resize.\n   * @param {MouseEvent} mouseEvent - Mouse event.\n   */\n  initializeResizeProperties(mouseEvent, leftOption) {\n    // Apply class for disable involuntary select text when drag.\n    Util.addClass(document.body, 'wrs_noselect');\n    Util.addClass(this.overlay, 'wrs_overlay_active');\n    this.resizeDataObject = {\n      x: this.eventClient(mouseEvent).X,\n      y: this.eventClient(mouseEvent).Y,\n    };\n    // Save Initial state of modal to compare on drag and obtain the difference.\n    this.initialWidth = parseInt(this.container.style.width, 10);\n    this.initialHeight = parseInt(this.container.style.height, 10);\n    if (!leftOption) {\n      this.initialRight = parseInt(this.container.style.right, 10);\n      this.initialBottom = parseInt(this.container.style.bottom, 10);\n    } else {\n      this.leftScale = true;\n    }\n    if (!this.initialRight) {\n      this.initialRight = 0;\n    }\n    if (!this.initialBottom) {\n      this.initialBottom = 0;\n    }\n    // Disable mouse events on editor when we start to drag modal.\n    document.body.style['user-select'] = 'none';\n  }\n\n  /**\n   * This method opens the modal window, restoring the previous state, position and metrics,\n   * if exists. By default the modal object opens in stack mode.\n   */\n  open() {\n    // Removing close class.\n    this.removeClass('wrs_closed');\n    // Hiding keyboard for mobile devices.\n    const { isIOS } = this.deviceProperties;\n    const { isAndroid } = this.deviceProperties;\n    const { isMobile } = this.deviceProperties;\n    if (isIOS || isAndroid || isMobile) {\n      // Restore scale to 1.\n      this.restoreWebsiteScale();\n      this.lockWebsiteScroll();\n      // Due to editor wait we need to wait until editor focus.\n      setTimeout(() => { this.hideKeyboard(); }, 400);\n    }\n\n    // New modal window. He need to create the whole object.\n    if (!this.properties.created) {\n      this.create();\n    } else {\n      // Previous state closed. Open method can be called even the previous state is open,\n      // for example updating the content of the modal object.\n      if (!this.properties.open) {\n        this.properties.open = true;\n\n        // Restoring the previous open state: if the modal object has been closed\n        // re-open it should preserve the state and the metrics.\n        if (!this.deviceProperties.isAndroid && !this.deviceProperties.isIOS) {\n          this.restoreState();\n        }\n      }\n\n      // Maximize window only when the configuration is set and the device is not iOs or Android.\n      if (this.deviceProperties.isDesktop && Configuration.get('modalWindowFullScreen')) {\n        this.maximize();\n      }\n\n      // In iOS we need to recalculate the size of the modal object because\n      // iOS keyboard is a float div which can overlay the modal object.\n      if (this.deviceProperties.isIOS) {\n        this.iosSoftkeyboardOpened = false;\n        this.setContainerHeight(`${100 + this.iosMeasureUnit}`);\n      }\n    }\n\n    if (!ContentManager.isEditorLoaded()) {\n      const listener = Listeners.newListener('onLoad', () => {\n        this.contentManager.onOpen(this);\n      });\n      this.contentManager.addListener(listener);\n    } else {\n      this.contentManager.onOpen(this);\n    }\n  }\n\n  /**\n   * Closes modal window and restores viewport header.\n   */\n  close() {\n    this.removeClass('wrs_maximized');\n    this.removeClass('wrs_minimized');\n    this.removeClass('wrs_stack');\n    this.addClass('wrs_closed');\n    this.saveModalProperties();\n    this.unlockWebsiteScroll();\n    this.properties.open = false;\n\n    Core.globalListeners.fire('onModalClose', {});\n  }\n\n  /**\n   * Sets the website scale to one.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  restoreWebsiteScale() {\n    let viewportmeta = document.querySelector('meta[name=viewport]');\n    // Let the equal symbols in order to search and make meta's final content.\n    const contentAttrsToUpdate = ['initial-scale=', 'minimum-scale=', 'maximum-scale='];\n    const contentAttrsValuesToUpdate = ['1.0', '1.0', '1.0'];\n    const setMetaAttrFunc = (viewportelement, contentAttrs) => {\n      const contentAttr = viewportelement.getAttribute('content');\n      // If it exists, we need to maintain old values and put our values.\n      if (contentAttr) {\n        const attrArray = contentAttr.split(',');\n        let finalContentMeta = '';\n        const oldAttrs = [];\n        for (let i = 0; i < attrArray.length; i += 1) {\n          let isAttrToUpdate = false;\n          let j = 0;\n          while (!isAttrToUpdate && j < contentAttrs.length) {\n            if (attrArray[i].indexOf(contentAttrs[j])) {\n              isAttrToUpdate = true;\n            }\n            j += 1;\n          }\n\n          if (!isAttrToUpdate) {\n            oldAttrs.push(attrArray[i]);\n          }\n        }\n\n        for (let i = 0; i < contentAttrs.length; i += 1) {\n          const attr = contentAttrs[i] + contentAttrsValuesToUpdate[i];\n          finalContentMeta += i === 0 ? attr : `,${attr}`;\n        }\n\n        for (let i = 0; i < oldAttrs.length; i += 1) {\n          finalContentMeta += `,${oldAttrs[i]}`;\n        }\n        viewportelement.setAttribute('content', finalContentMeta);\n        // It needs to set to empty because setAttribute refresh only when attribute is different.\n        viewportelement.setAttribute('content', '');\n        viewportelement.setAttribute('content', contentAttr);\n      } else {\n        viewportelement.setAttribute('content', 'initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0');\n        viewportelement.removeAttribute('content');\n      }\n    };\n\n    if (!viewportmeta) {\n      viewportmeta = document.createElement('meta');\n      document.getElementsByTagName('head')[0].appendChild(viewportmeta);\n      setMetaAttrFunc(viewportmeta, contentAttrsToUpdate, contentAttrsValuesToUpdate);\n      viewportmeta.remove();\n    } else {\n      setMetaAttrFunc(viewportmeta, contentAttrsToUpdate, contentAttrsValuesToUpdate);\n    }\n  }\n\n  /**\n   * Locks website scroll for mobile devices.\n   */\n  lockWebsiteScroll() {\n    this.websiteBeforeLockParameters = {\n      bodyStylePosition: document.body.style.position ? document.body.style.position : '',\n      bodyStyleOverflow: document.body.style.overflow ? document.body.style.overflow : '',\n      htmlStyleOverflow: document.documentElement.style.overflow ? document.documentElement.style.overflow : '',\n      windowScrollX: window.scrollX,\n      windowScrollY: window.scrollY,\n    };\n  }\n\n  /**\n   * Unlocks website scroll for mobile devices.\n   */\n  unlockWebsiteScroll() {\n    if (this.websiteBeforeLockParameters) {\n      document.body.style.position = this.websiteBeforeLockParameters.bodyStylePosition;\n      document.body.style.overflow = this.websiteBeforeLockParameters.bodyStyleOverflow;\n      document.documentElement.style.overflow = this.websiteBeforeLockParameters.htmlStyleOverflow;\n      const { windowScrollX } = this.websiteBeforeLockParameters;\n      const { windowScrollY } = this.websiteBeforeLockParameters;\n      window.scrollTo(windowScrollX, windowScrollY);\n      this.websiteBeforeLockParameters = null;\n    }\n  }\n\n  /**\n   * Util function to known if browser is IE11.\n   * @returns {Boolean} true if the browser is IE11. false otherwise.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  isIE11() {\n    if (navigator.userAgent.search('Msie/') >= 0 || navigator.userAgent.search('Trident/') >= 0 || navigator.userAgent.search('Edge/') >= 0) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns if the current language type is RTL.\n   * @return {Boolean} true if current language is RTL. false otherwise.\n   */\n  isRTL() {\n    if (this.attributes.language === 'ar' || this.attributes.language === 'he') {\n      return true;\n    }\n    return this.rtl;\n  }\n\n  /**\n   * Adds a class to all modal ModalDialog DOM elements.\n   * @param {String} className - Class name.\n   */\n  addClass(className) {\n    Util.addClass(this.overlay, className);\n    Util.addClass(this.titleBar, className);\n    Util.addClass(this.overlay, className);\n    Util.addClass(this.container, className);\n    Util.addClass(this.contentContainer, className);\n    Util.addClass(this.stackDiv, className);\n    Util.addClass(this.minimizeDiv, className);\n    Util.addClass(this.maximizeDiv, className);\n    Util.addClass(this.wrapper, className);\n  }\n\n  /**\n   * Remove a class from all modal DOM elements.\n   * @param {String} className - Class name.\n   */\n  removeClass(className) {\n    Util.removeClass(this.overlay, className);\n    Util.removeClass(this.titleBar, className);\n    Util.removeClass(this.overlay, className);\n    Util.removeClass(this.container, className);\n    Util.removeClass(this.contentContainer, className);\n    Util.removeClass(this.stackDiv, className);\n    Util.removeClass(this.minimizeDiv, className);\n    Util.removeClass(this.maximizeDiv, className);\n    Util.removeClass(this.wrapper, className);\n  }\n\n  /**\n   * Create modal dialog for desktop.\n   */\n  createModalWindowDesktop() {\n    this.addClass('wrs_modal_desktop');\n    this.stack();\n  }\n\n  /**\n   * Create modal dialog for non android devices.\n   */\n  createModalWindowAndroid() {\n    this.addClass('wrs_modal_android');\n    window.addEventListener('resize', this.orientationChangeAndroidSoftkeyboard.bind(this));\n  }\n\n  /**\n   * Create modal dialog for iOS devices.\n   */\n  createModalWindowIos() {\n    this.addClass('wrs_modal_ios');\n    // Refresh the size when the orientation is changed.\n    window.addEventListener('resize', this.orientationChangeIosSoftkeyboard.bind(this));\n  }\n\n  /**\n   * Restore previous state, position and size of previous stacked modal dialog.\n   */\n  restoreState() {\n    if (this.properties.state === 'maximized') {\n      // Reset states for prevent return to stack state.\n      this.maximize();\n    } else if (this.properties.state === 'minimized') {\n      // Reset states for prevent return to stack state.\n      this.properties.state = this.properties.previousState;\n      this.properties.previousState = '';\n      this.minimize();\n    } else {\n      this.stack();\n    }\n  }\n\n  /**\n   * Stacks the modal object.\n   */\n  stack() {\n    this.properties.previousState = this.properties.state;\n    this.properties.state = 'stack';\n    this.removeClass('wrs_maximized');\n    this.minimizeDiv.title = StringManager.get('minimize');\n    this.removeClass('wrs_minimized');\n    this.addClass('wrs_stack');\n\n    // Change maximize/minimize icon to minimize icon\n    const generalStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(minIcon)})`;\n    const hoverStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(minHoverIcon)})`;\n    this.minimizeDiv.setAttribute('style', generalStyle);\n    this.minimizeDiv.setAttribute('onmouseover', `this.style = \"${hoverStyle}\";`);\n    this.minimizeDiv.setAttribute('onmouseout', `this.style = \"${generalStyle}\";`);\n\n    this.restoreModalProperties();\n\n    if (typeof this.resizerBR !== 'undefined' && typeof this.resizerTL !== 'undefined') {\n      this.setResizeButtonsVisibility();\n    }\n\n    // Need recalculate position of actual modal because window can was changed in fullscreenmode.\n    this.recalculateScrollBar();\n    this.recalculatePosition();\n    this.recalculateScale();\n    this.focus();\n  }\n\n  /**\n   * Minimizes the modal object.\n   */\n  minimize() {\n    // Saving width, height, top and bottom parameters to restore when opening.\n    this.saveModalProperties();\n    this.title.style.cursor = 'pointer';\n    if (this.properties.state === 'minimized' && this.properties.previousState === 'stack') {\n      this.stack();\n    } else if (this.properties.state === 'minimized' && this.properties.previousState === 'maximized') {\n      this.maximize();\n    } else {\n      // Setting css to prevent important tag into css style.\n      this.container.style.height = '30px';\n      this.container.style.width = '250px';\n      this.container.style.bottom = '0px';\n      this.container.style.right = '10px';\n\n      this.removeListeners();\n      this.properties.previousState = this.properties.state;\n      this.properties.state = 'minimized';\n      this.setResizeButtonsVisibility();\n      this.minimizeDiv.title = StringManager.get('maximize');\n\n      if (Util.containsClass(this.overlay, 'wrs_stack')) {\n        this.removeClass('wrs_stack');\n      } else {\n        this.removeClass('wrs_maximized');\n      }\n      this.addClass('wrs_minimized');\n\n      // Change minimize icon to maximize icon\n      const generalStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(maxIcon)})`;\n      const hoverStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(maxHoverIcon)})`;\n      this.minimizeDiv.setAttribute('style', generalStyle);\n      this.minimizeDiv.setAttribute('onmouseover', `this.style = \"${hoverStyle}\";`);\n      this.minimizeDiv.setAttribute('onmouseout', `this.style = \"${generalStyle}\";`);\n    }\n  }\n\n  /**\n   * Maximizes the modal object.\n   */\n  maximize() {\n    // Saving width, height, top and bottom parameters to restore when openning.\n    this.saveModalProperties();\n    if (this.properties.state !== 'maximized') {\n      this.properties.previousState = this.properties.state;\n      this.properties.state = 'maximized';\n    }\n    // Don't permit resize on maximize mode.\n    this.setResizeButtonsVisibility();\n\n    if (Util.containsClass(this.overlay, 'wrs_minimized')) {\n      this.minimizeDiv.title = StringManager.get('minimize');\n      this.removeClass('wrs_minimized');\n    } else if (Util.containsClass(this.overlay, 'wrs_stack')) {\n      this.container.style.left = null;\n      this.container.style.top = null;\n      this.removeClass('wrs_stack');\n    }\n\n    this.addClass('wrs_maximized');\n\n    // Change maximize icon to minimize icon\n    const generalStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(minIcon)})`;\n    const hoverStyle = `background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(minHoverIcon)})`;\n    this.minimizeDiv.setAttribute('style', generalStyle);\n    this.minimizeDiv.setAttribute('onmouseover', `this.style = \"${hoverStyle}\";`);\n    this.minimizeDiv.setAttribute('onmouseout', `this.style = \"${generalStyle}\";`);\n\n    // Set size to 80% screen with a max size.\n    this.setSize(parseInt(window.innerHeight * 0.8, 10), parseInt(window.innerWidth * 0.8, 10));\n    if (this.container.clientHeight > 700) {\n      this.container.style.height = '700px';\n    }\n    if (this.container.clientWidth > 1200) {\n      this.container.style.width = '1200px';\n    }\n\n    // Setting modal position in center on screen.\n    const { innerHeight } = window;\n    const { innerWidth } = window;\n    const { offsetHeight } = this.container;\n    const { offsetWidth } = this.container;\n    const bottom = (innerHeight / 2) - (offsetHeight / 2);\n    const right = (innerWidth / 2) - (offsetWidth / 2);\n\n    this.setPosition(bottom, right);\n    this.recalculateScale();\n    this.recalculatePosition();\n    this.recalculateSize();\n    this.focus();\n  }\n\n  /**\n   * Expand again the modal object from a minimized state.\n   */\n  reExpand() {\n    if (this.properties.state === 'minimized') {\n      if (this.properties.previousState === 'maximized') {\n        this.maximize();\n      } else {\n        this.stack();\n      }\n      this.title.style.cursor = '';\n    }\n  }\n\n  /**\n   * Sets modal size.\n   * @param {Number} height - Height of the ModalDialog\n   * @param {Number} width - Width of the ModalDialog.\n   */\n  setSize(height, width) {\n    this.container.style.height = `${height}px`;\n    this.container.style.width = `${width}px`;\n    this.recalculateSize();\n  }\n\n  /**\n   * Sets modal position using bottom and right style attributes.\n   * @param  {number} bottom - bottom attribute.\n   * @param  {number} right - right attribute.\n   */\n  setPosition(bottom, right) {\n    this.container.style.bottom = `${bottom}px`;\n    this.container.style.right = `${right}px`;\n  }\n\n  /**\n   * Saves position and size parameters of and open ModalDialog. This attributes\n   * are needed to restore it on re-open.\n   */\n  saveModalProperties() {\n    // Saving values of modal only when modal is in stack state.\n    if (this.properties.state === 'stack') {\n      this.properties.position.bottom = parseInt(this.container.style.bottom, 10);\n      this.properties.position.right = parseInt(this.container.style.right, 10);\n      this.properties.size.width = parseInt(this.container.style.width, 10);\n      this.properties.size.height = parseInt(this.container.style.height, 10);\n    }\n  }\n\n  /**\n   * Restore ModalDialog position and size parameters.\n   */\n  restoreModalProperties() {\n    if (this.properties.state === 'stack') {\n      // Restoring Bottom and Right values from last modal.\n      this.setPosition(this.properties.position.bottom, this.properties.position.right);\n      // Restoring Height and Left values from last modal.\n      this.setSize(this.properties.size.height, this.properties.size.width);\n    }\n  }\n\n  /**\n   * Sets the modal dialog initial size.\n   */\n  recalculateSize() {\n    this.wrapper.style.width = `${this.container.clientWidth - 12}px`;\n    this.wrapper.style.height = `${this.container.clientHeight - 38}px`;\n    this.contentContainer.style.height = `${parseInt(this.wrapper.offsetHeight - 50, 10)}px`;\n  }\n\n  /**\n   * Enable or disable visibility of resize buttons in modal window depend on state.\n   */\n  setResizeButtonsVisibility() {\n    if (this.properties.state === 'stack') {\n      this.resizerTL.style.visibility = 'visible';\n      this.resizerBR.style.visibility = 'visible';\n    } else {\n      this.resizerTL.style.visibility = 'hidden';\n      this.resizerBR.style.visibility = 'hidden';\n    }\n  }\n\n  /**\n   * Makes an object draggable adding mouse and touch events.\n   */\n  addListeners() {\n    // Button events (maximize, minimize, stack and close).\n    this.maximizeDiv.addEventListener('click', this.maximize.bind(this), true);\n    this.stackDiv.addEventListener('click', this.stack.bind(this), true);\n    this.minimizeDiv.addEventListener('click', this.minimize.bind(this), true);\n    this.closeDiv.addEventListener('click', this.cancelAction.bind(this));\n    this.maximizeDiv.addEventListener('keypress', function(e) {\n      if (e.key === 'Enter' || e.key === ' ' || e.keyCode === 13 || e.keyCode === 32) { // Handle enter and space.\n        e.target.click();\n      }\n    }, true);\n    this.stackDiv.addEventListener('keypress', function(e) {\n      if (e.key === 'Enter' || e.key === ' ' || e.keyCode === 13 || e.keyCode === 32) { // Handle enter and space.\n        e.target.click();\n        e.preventDefault();\n      }\n    }, true);\n    this.minimizeDiv.addEventListener('keypress', function(e) {\n      if (e.key === 'Enter' || e.key === ' ' || e.keyCode === 13 || e.keyCode === 32) { // Handle enter and space.\n        e.target.click();\n        e.preventDefault();\n      }\n    }, true);\n    this.closeDiv.addEventListener('keypress', function(e) {\n      if (e.key === 'Enter' || e.key === ' ' || e.keyCode === 13 || e.keyCode === 32) { // Handle enter and space.\n        e.target.click();\n        e.preventDefault();\n      }\n    });\n    this.title.addEventListener('click', this.reExpand.bind(this));\n\n    // Overlay events (close).\n    this.overlay.addEventListener('click', this.cancelAction.bind(this));\n\n    // Mouse events.\n    Util.addEvent(window, 'mousedown', this.startDrag.bind(this));\n    Util.addEvent(window, 'mouseup', this.stopDrag.bind(this));\n    Util.addEvent(window, 'mousemove', this.drag.bind(this));\n    Util.addEvent(window, 'resize', this.onWindowResize.bind(this));\n    // Key events.\n    Util.addEvent(window, 'keydown', this.onKeyDown.bind(this));\n  }\n\n  /**\n   * Removes draggable events from an object.\n   */\n  removeListeners() {\n    // Mouse events.\n    Util.removeEvent(window, 'mousedown', this.startDrag);\n    Util.removeEvent(window, 'mouseup', this.stopDrag);\n    Util.removeEvent(window, 'mousemove', this.drag);\n    Util.removeEvent(window, 'resize', this.onWindowResize);\n    // Key events.\n    Util.removeEvent(window, 'keydown', this.onKeyDown);\n  }\n\n  /**\n   * Returns mouse or touch coordinates (on touch events ev.ClientX doesn't exists)\n   * @param {MouseEvent} mouseEvent - Mouse event.\n   * @return {Object} With the X and Y coordinates.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  eventClient(mouseEvent) {\n    if (typeof (mouseEvent.clientX) === 'undefined' && mouseEvent.changedTouches) {\n      const client = {\n        X: mouseEvent.changedTouches[0].clientX,\n        Y: mouseEvent.changedTouches[0].clientY,\n      };\n      return client;\n    }\n    const client = {\n      X: mouseEvent.clientX,\n      Y: mouseEvent.clientY,\n    };\n    return client;\n  }\n\n  /**\n   * Start drag function: set the object dragDataObject with the draggable\n   * object offsets coordinates.\n   * when drag starts (on touchstart or mousedown events).\n   * @param {MouseEvent} mouseEvent - Touchstart or mousedown event.\n   */\n  startDrag(mouseEvent) {\n    if (this.properties.state === 'minimized') {\n      return;\n    }\n    if (mouseEvent.target === this.title) {\n      if (typeof this.dragDataObject === 'undefined' || this.dragDataObject === null) {\n        // Save first click mouse point on screen.\n        this.dragDataObject = {\n          x: this.eventClient(mouseEvent).X,\n          y: this.eventClient(mouseEvent).Y,\n        };\n        // Reset last drag position when start drag.\n        this.lastDrag = {\n          x: '0px',\n          y: '0px',\n        };\n        // Init right and bottom values for window modal if it isn't exist.\n        if (this.container.style.right === '') {\n          this.container.style.right = '0px';\n        }\n        if (this.container.style.bottom === '') {\n          this.container.style.bottom = '0px';\n        }\n\n        // Needed for IE11 for apply disabled mouse events on editor because\n        // iexplorer need a dinamic object to apply this property.\n        if (this.isIE11()) {\n          // this.iframe.style['position'] = 'relative';\n        }\n        // Apply class for disable involuntary select text when drag.\n        Util.addClass(document.body, 'wrs_noselect');\n        Util.addClass(this.overlay, 'wrs_overlay_active');\n        // Obtain screen limits for prevent overflow.\n        this.limitWindow = this.getLimitWindow();\n      }\n    }\n  }\n\n  /**\n   * Updates dragDataObject with the draggable object coordinates when\n   * the draggable object is being moved.\n   * @param {MouseEvent} mouseEvent - The mouse event.\n   */\n  drag(mouseEvent) {\n    if (this.dragDataObject) {\n      mouseEvent.preventDefault();\n      // Calculate max and min between actual mouse position and limit of screeen.\n      // It restric the movement of modal into window.\n      let limitY = Math.min(this.eventClient(mouseEvent).Y, this.limitWindow.minPointer.y);\n      limitY = Math.max(this.limitWindow.maxPointer.y, limitY);\n      let limitX = Math.min(this.eventClient(mouseEvent).X, this.limitWindow.minPointer.x);\n      limitX = Math.max(this.limitWindow.maxPointer.x, limitX);\n      // Substract limit with first position to obtain relative pixels increment\n      // to the anchor point.\n      const dragX = `${limitX - this.dragDataObject.x}px`;\n      const dragY = `${limitY - this.dragDataObject.y}px`;\n      // Save last valid position of modal before window overflow.\n      this.lastDrag = {\n        x: dragX,\n        y: dragY,\n      };\n      // This move modal with hadware acceleration.\n      this.container.style.transform = `translate3d(${dragX},${dragY},0)`;\n    }\n    if (this.resizeDataObject) {\n      const { innerWidth } = window;\n      const { innerHeight } = window;\n      let limitX = Math.min(this.eventClient(mouseEvent).X, innerWidth - this.scrollbarWidth - 7);\n      let limitY = Math.min(this.eventClient(mouseEvent).Y, innerHeight - 7);\n      if (limitX < 0) {\n        limitX = 0;\n      }\n\n      if (limitY < 0) {\n        limitY = 0;\n      }\n\n      let scaleMultiplier;\n      if (this.leftScale) {\n        scaleMultiplier = -1;\n      } else {\n        scaleMultiplier = 1;\n      }\n\n      this.container.style.width = `${this.initialWidth + scaleMultiplier * (limitX - this.resizeDataObject.x)}px`;\n      this.container.style.height = `${this.initialHeight + scaleMultiplier * (limitY - this.resizeDataObject.y)}px`;\n      if (!this.leftScale) {\n        if (this.resizeDataObject.x - limitX - this.initialWidth < -580) {\n          this.container.style.right = `${this.initialRight - (limitX - this.resizeDataObject.x)}px`;\n        } else {\n          this.container.style.right = `${this.initialRight + this.initialWidth - 580}px`;\n          this.container.style.width = '580px';\n        }\n        if (this.resizeDataObject.y - limitY < this.initialHeight - 338) {\n          this.container.style.bottom = `${this.initialBottom - (limitY - this.resizeDataObject.y)}px`;\n        } else {\n          this.container.style.bottom = `${this.initialBottom + this.initialHeight - 338}px`;\n          this.container.style.height = '338px';\n        }\n      }\n      this.recalculateScale();\n      this.recalculatePosition();\n    }\n  }\n\n  /**\n   * Returns the boundaries of actual window to limit modal movement.\n   * @return {Object} Object containing mouseX and mouseY coordinates of actual mouse on screen.\n   */\n  getLimitWindow() {\n    // Obtain dimensions of window page.\n    const maxWidth = window.innerWidth;\n    const maxHeight = window.innerHeight;\n\n    // Calculate relative position of mouse point into window.\n    const { offsetHeight } = this.container;\n    const contStyleBottom = parseInt(this.container.style.bottom, 10);\n    const contStyleRight = parseInt(this.container.style.right, 10);\n\n    const { pageXOffset } = window;\n    const dragY = this.dragDataObject.y;\n    const dragX = this.dragDataObject.x;\n\n    const offSetToolbarY = (offsetHeight + contStyleBottom - (maxHeight - (dragY - pageXOffset)));\n    const offSetToolbarX = maxWidth - this.scrollbarWidth - (dragX - pageXOffset) - contStyleRight;\n\n    // Calculate limits with sizes of window, modal and mouse position.\n    const minPointerY = maxHeight - this.container.offsetHeight + offSetToolbarY;\n    const maxPointerY = this.title.offsetHeight - (this.title.offsetHeight - offSetToolbarY);\n    const minPointerX = maxWidth - offSetToolbarX - this.scrollbarWidth;\n    const maxPointerX = (this.container.offsetWidth - offSetToolbarX);\n    const minPointer = { x: minPointerX, y: minPointerY };\n    const maxPointer = { x: maxPointerX, y: maxPointerY };\n    return { minPointer, maxPointer };\n  }\n\n  /**\n   * Returns the scrollbar width size of browser\n   * @returns {Number} The scrollbar width.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  getScrollBarWidth() {\n    // Create a paragraph with full width of page.\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '200px';\n\n    // Create a hidden div to compare sizes.\n    const outer = document.createElement('div');\n    outer.style.position = 'absolute';\n    outer.style.top = '0px';\n    outer.style.left = '0px';\n    outer.style.visibility = 'hidden';\n    outer.style.width = '200px';\n    outer.style.height = '150px';\n    outer.style.overflow = 'hidden';\n    outer.appendChild(inner);\n\n    document.body.appendChild(outer);\n    const widthOuter = inner.offsetWidth;\n\n    // Change type overflow of paragraph for measure scrollbar.\n    outer.style.overflow = 'scroll';\n    let widthInner = inner.offsetWidth;\n\n    // If measure is the same, we compare with internal div.\n    if (widthOuter === widthInner) {\n      widthInner = outer.clientWidth;\n    }\n    document.body.removeChild(outer);\n\n    return (widthOuter - widthInner);\n  }\n\n  /**\n   * Set the dragDataObject to null.\n   */\n  stopDrag() {\n    // Due to we have multiple events that call this function, we need only to execute\n    // the next modifiers one time,\n    // when the user stops to drag and dragDataObject is not null (the object to drag is attached).\n    if (this.dragDataObject || this.resizeDataObject) {\n      // If modal doesn't change, it's not necessary to set position with interpolation.\n      this.container.style.transform = '';\n      if (this.dragDataObject) {\n        this.container.style.right = `${parseInt(this.container.style.right, 10) - parseInt(this.lastDrag.x, 10)}px`;\n        this.container.style.bottom = `${parseInt(this.container.style.bottom, 10) - parseInt(this.lastDrag.y, 10)}px`;\n      }\n      // We make focus on editor after drag modal windows to prevent lose focus.\n      this.focus();\n      // Restore mouse events on iframe.\n      // this.iframe.style['pointer-events'] = 'auto';\n      document.body.style['user-select'] = '';\n      // Restore static state of iframe if we use Internet Explorer.\n      if (this.isIE11()) {\n        // this.iframe.style['position'] = null;\n      }\n      // Active text select event.\n      Util.removeClass(document.body, 'wrs_noselect');\n      Util.removeClass(this.overlay, 'wrs_overlay_active');\n    }\n    this.dragDataObject = null;\n    this.resizeDataObject = null;\n    this.initialWidth = null;\n    this.leftScale = null;\n  }\n\n  /**\n   * Recalculates scale for modal when resize browser window.\n   */\n  onWindowResize() {\n    this.recalculateScrollBar();\n    this.recalculatePosition();\n    this.recalculateScale();\n  }\n\n  /**\n   * Triggers keyboard events:\n   * - Tab key tab to go to submit button.\n   * - Esc key to close the modal dialog.\n   * @param {KeyboardEvent} keyboardEvent - The keyboard event.\n   */\n  onKeyDown(keyboardEvent) {\n    if (keyboardEvent.key !== undefined) {\n      // Popupmessage is not oppened.\n      if (this.popup.overlayWrapper.style.display !== 'block') {\n        // Code to detect Esc event\n        if (keyboardEvent.key === 'Escape' || keyboardEvent.key === 'Esc') {\n          if (this.properties.open) {\n            this.contentManager.onKeyDown(keyboardEvent);\n          }\n        } else if (keyboardEvent.shiftKey && keyboardEvent.key === 'Tab') { // Code to detect shift Tab event.\n          if (document.activeElement === this.cancelButton) {\n            this.submitButton.focus();\n            keyboardEvent.stopPropagation();\n            keyboardEvent.preventDefault();\n          } else {\n            this.contentManager.onKeyDown(keyboardEvent);\n          }\n        } else if (keyboardEvent.key === 'Tab') { // Code to detect Tab event.\n          if (document.activeElement === this.submitButton) {\n            this.cancelButton.focus();\n            keyboardEvent.stopPropagation();\n            keyboardEvent.preventDefault();\n          } else {\n            this.contentManager.onKeyDown(keyboardEvent);\n          }\n        }\n      } else { // Popupmessage oppened.\n        this.popup.onKeyDown(keyboardEvent);\n      }\n    }\n  }\n\n  /**\n   * Recalculating position for modal dialog when the browser is resized.\n   */\n  recalculatePosition() {\n    this.container.style.right = `${Math.min(parseInt(this.container.style.right, 10), window.innerWidth - this.scrollbarWidth - this.container.offsetWidth)}px`;\n    if (parseInt(this.container.style.right, 10) < 0) {\n      this.container.style.right = '0px';\n    }\n    this.container.style.bottom = `${Math.min(parseInt(this.container.style.bottom, 10), window.innerHeight - this.container.offsetHeight)}px`;\n    if (parseInt(this.container.style.bottom, 10) < 0) {\n      this.container.style.bottom = '0px';\n    }\n  }\n\n  /**\n   * Recalculating scale for modal when the browser is resized.\n   */\n  recalculateScale() {\n    let sizeModificated = false;\n    if (parseInt(this.container.style.width, 10) > 580) {\n      this.container.style.width = `${Math.min(parseInt(this.container.style.width, 10), window.innerWidth - this.scrollbarWidth)}px`;\n      sizeModificated = true;\n    } else {\n      this.container.style.width = '580px';\n      sizeModificated = true;\n    }\n    if (parseInt(this.container.style.height, 10) > 338) {\n      this.container.style.height = `${Math.min(parseInt(this.container.style.height, 10), window.innerHeight)}px`;\n      sizeModificated = true;\n    } else {\n      this.container.style.height = '338px';\n      sizeModificated = true;\n    }\n    if (sizeModificated) {\n      this.recalculateSize();\n    }\n  }\n\n  /**\n   * Recalculating width of browser scroll bar.\n   */\n  recalculateScrollBar() {\n    this.hasScrollBar = window.innerWidth > document.documentElement.clientWidth;\n    if (this.hasScrollBar) {\n      this.scrollbarWidth = this.getScrollBarWidth();\n    } else {\n      this.scrollbarWidth = 0;\n    }\n  }\n\n  /**\n   * Hide soft keyboards on iOS devices.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  hideKeyboard() {\n    // iOS keyboard can't be detected or hide directly from JavaScript.\n    // So, this method simulates that user focus a text input and blur\n    // the selection.\n    const inputField = document.createElement('input');\n    this.container.appendChild(inputField);\n    inputField.focus();\n    inputField.blur();\n    // Is removed to not see it.\n    inputField.remove();\n  }\n\n  /**\n   * Focus to contentManager object.\n   */\n  focus() {\n    if (this.contentManager != null && typeof this.contentManager.onFocus !== 'undefined') {\n      this.contentManager.onFocus();\n    }\n  }\n\n  /**\n   * Returns true when the device is on portrait mode.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  portraitMode() {\n    return window.innerHeight > window.innerWidth;\n  }\n\n  /**\n   * Event handler that change container size when IOS softkeyboard is opened.\n   */\n  handleOpenedIosSoftkeyboard() {\n    if (!this.iosSoftkeyboardOpened && this.iosDivHeight != null && this.iosDivHeight === `100${this.iosMeasureUnit}`) {\n      if (this.portraitMode()) {\n        this.setContainerHeight(`63${this.iosMeasureUnit}`);\n      } else {\n        this.setContainerHeight(`40${this.iosMeasureUnit}`);\n      }\n    }\n    this.iosSoftkeyboardOpened = true;\n  }\n\n  /**\n   * Event handler that change container size when IOS softkeyboard is closed.\n   */\n  handleClosedIosSoftkeyboard() {\n    this.iosSoftkeyboardOpened = false;\n    this.setContainerHeight(`100${this.iosMeasureUnit}`);\n  }\n\n  /**\n   * Change container sizes when orientation is changed on iOS.\n   */\n  orientationChangeIosSoftkeyboard() {\n    if (this.iosSoftkeyboardOpened) {\n      if (this.portraitMode()) {\n        this.setContainerHeight(`63${this.iosMeasureUnit}`);\n      } else {\n        this.setContainerHeight(`40${this.iosMeasureUnit}`);\n      }\n    } else {\n      this.setContainerHeight(`100${this.iosMeasureUnit}`);\n    }\n  }\n\n  /**\n   * Change container sizes when orientation is changed on Android.\n   */\n  orientationChangeAndroidSoftkeyboard() {\n    this.setContainerHeight('100%');\n  }\n\n  /**\n   * Set iframe container height.\n   * @param {Number} height - New height.\n   */\n  setContainerHeight(height) {\n    this.iosDivHeight = height;\n    this.wrapper.style.height = height;\n  }\n\n  /**\n   * Check content of editor before close action.\n   */\n  showPopUpMessage() {\n    if (this.properties.state === 'minimized') {\n      this.stack();\n    }\n    this.popup.show();\n  }\n\n  /**\n   * Sets the tithle of the modal dialog.\n   * @param {String} title - Modal dialog title.\n   */\n  setTitle(title) {\n    this.title.innerHTML = title;\n  }\n\n  /**\n   * Returns the id of an element, adding the instance number to\n   * the element class name:\n   * className --> className[idNumber]\n   * @param {String} className - The element class name.\n   * @returns {String} A string appending the instance id to the className.\n   */\n  getElementId(className) {\n    return `${className}[${this.instanceId}]`;\n  }\n}\n", "/* eslint-disable */\nvar polyfills;\nexport default polyfills;\n\n// Polyfills.\n/*! http://mths.be/codepointat v0.1.0 by @mathias */\nif (!String.prototype.codePointAt) {\n  (function () {\n    'use strict'; // needed to support `apply`/`call` with `undefined`/`null`\n    var codePointAt = function (position) {\n      if (this == null) {\n        throw TypeError();\n      }\n      var string = String(this);\n      var size = string.length;\n      // `ToInteger`\n      var index = position ? Number(position) : 0;\n      if (index != index) { // better `isNaN`\n        index = 0;\n      }\n      // Account for out-of-bounds indices:\n      if (index < 0 || index >= size) {\n        return undefined;\n      }\n      // Get the first code unit\n      var first = string.charCodeAt(index);\n      var second;\n      if ( // check if it’s the start of a surrogate pair\n        first >= 0xD800 && first <= 0xDBFF && // high surrogate\n        size > index + 1 // there is a next code unit\n      ) {\n        second = string.charCodeAt(index + 1);\n        if (second >= 0xDC00 && second <= 0xDFFF) { // low surrogate\n          // http://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n          return (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n        }\n      }\n      return first;\n    };\n    if (Object.defineProperty) {\n      Object.defineProperty(String.prototype, 'codePointAt', {\n        'value': codePointAt,\n        'configurable': true,\n        'writable': true\n      });\n    } else {\n      String.prototype.codePointAt = codePointAt;\n    }\n  }());\n}\n\n// Object.assign polyfill.\nif (typeof Object.assign != 'function') {\n  // Must be writable: true, enumerable: false, configurable: true\n  Object.defineProperty(Object, \"assign\", {\n    value: function assign(target, varArgs) { // .length of function is 2\n      'use strict';\n      if (target == null) { // TypeError if undefined or null\n        throw new TypeError('Cannot convert undefined or null to object');\n      }\n\n      var to = Object(target);\n\n      for (var index = 1; index < arguments.length; index++) {\n        var nextSource = arguments[index];\n\n        if (nextSource != null) { // Skip over if undefined or null\n          for (var nextKey in nextSource) {\n            // Avoid bugs when hasOwnProperty is shadowed\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n              to[nextKey] = nextSource[nextKey];\n            }\n          }\n        }\n      }\n      return to;\n    },\n    writable: true,\n    configurable: true\n  });\n}\n\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\nif (!Array.prototype.includes) {\n  Object.defineProperty(Array.prototype, 'includes', {\n    value: function(searchElement, fromIndex) {\n\n      if (this == null) {\n        throw new TypeError('\"this\" s null or is not defined');\n      }\n\n      // 1. Let O be ? ToObject(this value).\n      var o = Object(this);\n\n      // 2. Let len be ? ToLength(? Get(O, \"length\")).\n      var len = o.length >>> 0;\n\n      // 3. if len is 0, return false.\n      if (len === 0) {\n        return false;\n      }\n\n      // 4. Let n be ? ToInteger(fromIndex).\n      //    (if fromIndex is undefinedo, this step generates the value 0.)\n      var n = fromIndex | 0;\n\n      // 5. if n ≥ 0, then\n      //  a. Let k be n.\n      // 6. Else n < 0,\n      //  a. Let k be len + n.\n      //  b. if k < 0, let k be 0.\n      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n      function sameValueZero(x, y) {\n        return x === y || (typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y));\n      }\n\n      // 7. Repeat while k < len\n      while (k < len) {\n        // a. let element k be the result of ? Get(O, ! ToString(k)).\n        // b. if SameValueZero(searchElement, elementK) is true, return true.\n        if (sameValueZero(o[k], searchElement)) {\n          return true;\n        }\n        // c. Increase k by 1.\n        k++;\n      }\n\n      // 8. Return false\n      return false;\n    }\n  });\n}\n\nif (!String.prototype.includes) {\n  String.prototype.includes = function(search, start) {\n    'use strict';\n\n    if (search instanceof RegExp) {\n      throw TypeError('first argument must not be a RegExp');\n    }\n    if (start === undefined) { start = 0; }\n    return this.indexOf(search, start) !== -1;\n  };\n}\n\n\nif (!String.prototype.startsWith) {\n  Object.defineProperty(String.prototype, 'startsWith', {\n      value: function(search, rawPos) {\n          var pos = rawPos > 0 ? rawPos|0 : 0;\n          return this.substring(pos, pos + search.length) === search;\n      }\n  });\n}\n", "import Parser from './parser';\nimport Util from './util';\nimport StringManager from './stringmanager';\nimport ContentManager from './contentmanager';\nimport Latex from './latex';\nimport MathML from './mathml';\nimport CustomEditors from './customeditors';\nimport Configuration from './configuration';\nimport jsProperties from './jsvariables';\nimport Event from './event';\nimport Listeners from './listeners';\nimport Image from './image';\nimport ServiceProvider from './serviceprovider';\nimport ModalDialog from './modal';\nimport Telemeter from './telemeter';\nimport './polyfills';\nimport '../styles/styles.css';\n\n/**\n * @typedef {Object} CoreProperties\n * @property {ServiceProviderProperties} serviceProviderProperties\n * - The ServiceProvider class properties. *\n */\nexport default class Core {\n  /**\n   * @classdesc\n   * This class represents MathType integration Core, managing the following:\n   * - Integration initialization.\n   * - Event managing.\n   * - Insertion of formulas into the edit area.\n   * ```js\n   *       let core = new Core();\n   *       core.addListener(listener);\n   *       core.language = 'en';\n   *\n   *       // Initializing Core class.\n   *       core.init(configurationService);\n   * ```\n   * @constructs\n   * Core constructor.\n   * @param {CoreProperties}\n   */\n  constructor(coreProperties) {\n    /**\n     * Language. Needed for accessibility and locales. 'en' by default.\n     * @type {String}\n     */\n    this.language = 'en';\n\n    /**\n     * Edit mode, 'images' by default. Admits the following values:\n     * - images\n     * - latex\n     * @type {String}\n     */\n    this.editMode = 'images';\n\n    /**\n     * Modal dialog instance.\n     * @type {ModalDialog}\n     */\n    this.modalDialog = null;\n\n    /**\n     * The instance of {@link CustomEditors}. By default\n     * the only custom editor is the Chemistry editor.\n     * @type {CustomEditors}\n     */\n    this.customEditors = new CustomEditors();\n\n    /**\n     * Chemistry editor.\n     * @type {CustomEditor}\n     */\n    const chemEditorParams = {\n      name: 'Chemistry',\n      toolbar: 'chemistry',\n      icon: 'chem.png',\n      confVariable: 'chemEnabled',\n      title: 'ChemType',\n      tooltip: 'Insert a chemistry formula - ChemType', // TODO: Localize tooltip.\n    };\n\n    this.customEditors.addEditor('chemistry', chemEditorParams);\n\n    /**\n     * Environment properties. This object contains data about the integration platform.\n     * @typedef IntegrationEnvironment\n     * @property {String} IntegrationEnvironment.editor - Editor name. For example the HTML editor.\n     * @property {String} IntegrationEnvironment.mode - Integration save mode.\n     * @property {String} IntegrationEnvironment.version - Integration version.\n     *\n     */\n\n    /**\n     * The environment properties object.\n     * @type {IntegrationEnvironment}\n     */\n    this.environment = {};\n\n    /**\n     * @typedef EditionProperties\n     * @property {Boolean} editionProperties.isNewElement - True if the formula is a new one.\n     * False otherwise.\n     * @property {HTMLImageElement} editionProperties.temporalImage- The image element.\n     * Null if the formula is new.\n     * @property {Range} editionProperties.latexRange - Tha range that contains the LaTeX formula.\n     * @property {Range} editionProperties.range - The range that contains the image element.\n     * @property {String} editionProperties.editMode - The edition mode. 'images' by default.\n     */\n\n    /**\n     * The properties of the current edition process.\n     * @type {EditionProperties}\n     */\n    this.editionProperties = {};\n\n    this.editionProperties.isNewElement = true;\n    this.editionProperties.temporalImage = null;\n    this.editionProperties.latexRange = null;\n    this.editionProperties.range = null;\n    this.editionProperties.editionStartTime = null;\n\n    /**\n     * The {@link IntegrationModel} instance.\n     * @type {IntegrationModel}\n     */\n    this.integrationModel = null;\n\n    /**\n     * The {@link ContentManager} instance.\n     * @type {ContentManager}\n     */\n    this.contentManager = null;\n\n    /**\n     * The current browser.\n     * @type {String}\n     */\n    this.browser = (() => {\n      const ua = navigator.userAgent;\n      let browser = 'none';\n      if (ua.search('Edge/') >= 0) {\n        browser = 'EDGE';\n      } else if (ua.search('Chrome/') >= 0) {\n        browser = 'CHROME';\n      } else if (ua.search('Trident/') >= 0) {\n        browser = 'IE';\n      } else if (ua.search('Firefox/') >= 0) {\n        browser = 'FIREFOX';\n      } else if (ua.search('Safari/') >= 0) {\n        browser = 'SAFARI';\n      }\n      return browser;\n    }\n    )();\n\n    /**\n     * Plugin listeners.\n     * @type {Array.<Object>}\n     */\n    this.listeners = new Listeners();\n\n    /**\n     * Service provider properties.\n     * @type {ServiceProviderProperties}\n     */\n    this.serviceProviderProperties = {};\n    if ('serviceProviderProperties' in coreProperties) {\n      this.serviceProviderProperties = coreProperties.serviceProviderProperties;\n    } else {\n      throw new Error('serviceProviderProperties property missing.');\n    }\n  }\n\n  /**\n   * Static property.\n   * Core listeners.\n   * @private\n   * @type {Listeners}\n   */\n  static get globalListeners() {\n    return Core._globalListeners;\n  }\n\n  /**\n   * Static property setter.\n   * Set core listeners.\n   * @param {Listeners} value - The property value.\n   * @ignore\n   */\n  static set globalListeners(value) {\n    Core._globalListeners = value;\n  }\n\n  /**\n   * Core state. Says if it was loaded previously.\n   * True when Core.init was called. Otherwise, false.\n   * @private\n   * @type {Boolean}\n   */\n  static get initialized() {\n    return Core._initialized;\n  }\n\n  /**\n   * Core state. Says if it was loaded previously.\n   * @param {Boolean} value - True to say that Core.init was called. Otherwise, false.\n   * @ignore\n   */\n  static set initialized(value) {\n    Core._initialized = value;\n  }\n\n  /**\n   * Sets the {@link Core.integrationModel} property.\n   * @param {IntegrationModel} integrationModel - The {@link IntegrationModel} property.\n   */\n  setIntegrationModel(integrationModel) {\n    this.integrationModel = integrationModel;\n  }\n\n  /**\n   * Sets the {@link Core.environment} property.\n   * @param {IntegrationEnvironment} integrationEnvironment -\n   * The {@link IntegrationEnvironment} object.\n   */\n  setEnvironment(integrationEnvironment) {\n    if ('editor' in integrationEnvironment) {\n      this.environment.editor = integrationEnvironment.editor;\n    }\n    if ('mode' in integrationEnvironment) {\n      this.environment.mode = integrationEnvironment.mode;\n    }\n    if ('version' in integrationEnvironment) {\n      this.environment.version = integrationEnvironment.version;\n    }\n  }\n\n  /**\n   * Returns the current {@link ModalDialog} instance.\n   * @returns {ModalDialog} The current {@link ModalDialog} instance.\n   */\n  getModalDialog() {\n    return this.modalDialog;\n  }\n\n  /**\n   * Inits the {@link Core} class, doing the following:\n   * - Calls asynchronously configuration service, retrieving the backend configuration in a JSON.\n   * - Updates {@link Configuration} class with the previous configuration properties.\n   * - Updates the {@link ServiceProvider} class using the configuration service path as reference.\n   * - Loads language strings.\n   * - Fires onLoad event.\n   * @param {Object} serviceParameters - Service parameters.\n   */\n  init() {\n    if (!Core.initialized) {\n      const serviceProviderListener = Listeners.newListener('onInit', () => {\n        const jsConfiguration = ServiceProvider.getService('configurationjs', '', 'get');\n        const jsonConfiguration = JSON.parse(jsConfiguration);\n        Configuration.addConfiguration(jsonConfiguration);\n        // Adding JavaScript (not backend) configuration variables.\n        Configuration.addConfiguration(jsProperties);\n        // Fire 'onLoad' event:\n        // All integration must listen this event in order to know if the plugin\n        // has been properly loaded.\n        StringManager.language = this.language;\n        this.listeners.fire('onLoad', {});\n      });\n\n      ServiceProvider.addListener(serviceProviderListener);\n      ServiceProvider.init(this.serviceProviderProperties);\n\n      Core.initialized = true;\n    } else {\n      // Case when there are more than two editor instances.\n      // After the first editor all the other editors don't need to load any file or service.\n      this.listeners.fire('onLoad', {});\n    }\n  }\n\n  /**\n   * Adds a {@link Listener} to the current instance of the {@link Core} class.\n   * @param {Listener} listener - The listener object.\n   */\n  addListener(listener) {\n    this.listeners.add(listener);\n  }\n\n  /**\n   * Adds the global {@link Listener} instance to {@link Core} class.\n   * @param {Listener} listener - The event listener to be added.\n   * @static\n   */\n  static addGlobalListener(listener) {\n    Core.globalListeners.add(listener);\n  }\n\n  beforeUpdateFormula(mathml, wirisProperties) {\n    /**\n     * This event is fired before updating the formula.\n     * @type {Object}\n     * @property {String} mathml - MathML to be transformed.\n     * @property {String} editMode - Edit mode.\n     * @property {Object} wirisProperties - Extra attributes for the formula.\n     * @property {String} language - Formula language.\n     */\n    const beforeUpdateEvent = new Event();\n\n    beforeUpdateEvent.mathml = mathml;\n\n    // Cloning wirisProperties object\n    // We don't want wirisProperties object modified.\n    beforeUpdateEvent.wirisProperties = {};\n\n    if (wirisProperties != null) {\n      Object.keys(wirisProperties).forEach((attr) => {\n        beforeUpdateEvent.wirisProperties[attr] = wirisProperties[attr];\n      });\n    }\n\n    // Read only.\n    beforeUpdateEvent.language = this.language;\n    beforeUpdateEvent.editMode = this.editMode;\n\n    if (this.listeners.fire('onBeforeFormulaInsertion', beforeUpdateEvent)) {\n      return {};\n    }\n\n    if (Core.globalListeners.fire('onBeforeFormulaInsertion', beforeUpdateEvent)) {\n      return {};\n    }\n\n    return {\n      mathml: beforeUpdateEvent.mathml,\n      wirisProperties: beforeUpdateEvent.wirisProperties,\n    };\n  }\n\n  /**\n   * Converts a MathML into it's correspondent image and inserts the image is\n   * inserted in a HTMLElement target by creating\n   * a new image or updating an existing one.\n   * @param {HTMLElement} focusElement - The HTMLElement to be focused after the insertion.\n   * @param {Window} windowTarget - The window element where the editable content is.\n   * @param {String} mathml - The MathML.\n   * @param {Array.<Object>} wirisProperties - The extra attributes for the formula.\n   * @returns {ReturnObject} - Object with the information of the node or latex to insert.\n   */\n  insertFormula(focusElement, windowTarget, mathml, wirisProperties) {\n    /**\n     * It is the object with the information of the node or latex to insert.\n     * @typedef ReturnObject\n     * @property {Node} [node] - The DOM node to insert.\n     * @property {String} [latex] - The latex to insert.\n     */\n    const returnObject = {};\n\n    if (!mathml) {\n      this.insertElementOnSelection(null, focusElement, windowTarget);\n    } else if (this.editMode === 'latex') {\n      returnObject.latex = Latex.getLatexFromMathML(mathml);\n      // this.integrationModel.getNonLatexNode is an integration wrapper\n      // to have special behaviours for nonLatex.\n      // Not all the integrations have special behaviours for nonLatex.\n      if (!!this.integrationModel.fillNonLatexNode && !returnObject.latex) {\n        const afterUpdateEvent = new Event();\n        afterUpdateEvent.editMode = this.editMode;\n        afterUpdateEvent.windowTarget = windowTarget;\n        afterUpdateEvent.focusElement = focusElement;\n        afterUpdateEvent.latex = returnObject.latex;\n        this.integrationModel.fillNonLatexNode(afterUpdateEvent, windowTarget, mathml);\n      } else {\n        returnObject.node = windowTarget.document.createTextNode(`$$${returnObject.latex}$$`);\n      }\n      this.insertElementOnSelection(returnObject.node, focusElement, windowTarget);\n    } else {\n      returnObject.node = Parser.mathmlToImgObject(windowTarget.document,\n        mathml,\n        wirisProperties, this.language);\n\n      this.insertElementOnSelection(returnObject.node, focusElement, windowTarget);\n    }\n\n    return returnObject;\n  }\n\n  afterUpdateFormula(focusElement, windowTarget, node, latex) {\n    /**\n     * This event is fired after update the formula.\n     * @type {Event}\n     * @param {String} editMode - edit mode.\n     * @param {Object} windowTarget - target window.\n     * @param {Object} focusElement - target element to be focused after update.\n     * @param {String} latex - LaTeX generated by the formula (editMode=latex).\n     * @param {Object} node - node generated after update the formula (text if LaTeX img otherwise).\n     */\n    const afterUpdateEvent = new Event();\n    afterUpdateEvent.editMode = this.editMode;\n    afterUpdateEvent.windowTarget = windowTarget;\n    afterUpdateEvent.focusElement = focusElement;\n    afterUpdateEvent.node = node;\n    afterUpdateEvent.latex = latex;\n\n    if (this.listeners.fire('onAfterFormulaInsertion', afterUpdateEvent)) {\n      return {};\n    }\n\n    if (Core.globalListeners.fire('onAfterFormulaInsertion', afterUpdateEvent)) {\n      return {};\n    }\n\n    return {};\n  }\n\n  /**\n   * Sets the caret after a given Node and set the focus to the owner document.\n   * @param {Node} node - The Node element.\n   */\n  placeCaretAfterNode(node) {\n    this.integrationModel.getSelection();\n    const nodeDocument = node.ownerDocument;\n    if (typeof nodeDocument.getSelection !== 'undefined' && !!node.parentElement) {\n      const range = nodeDocument.createRange();\n      range.setStartAfter(node);\n      range.collapse(true);\n      const selection = nodeDocument.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(range);\n      nodeDocument.body.focus();\n    }\n  }\n\n  /**\n   * Replaces a Selection object with an HTMLElement.\n   * @param {HTMLElement} element - The HTMLElement to replace the selection.\n   * @param {HTMLElement} focusElement - The HTMLElement to be focused after the replace.\n   * @param {Window} windowTarget - The window target.\n   */\n  insertElementOnSelection(element, focusElement, windowTarget) {\n    let mathmlOrigin = null;\n    if (this.editionProperties.isNewElement) {\n      if (element) {\n        if (focusElement.type === 'textarea') {\n          Util.updateTextArea(focusElement, element.textContent);\n        } else if (document.selection && document.getSelection === 0) {\n          let range = windowTarget.document.selection.createRange();\n          windowTarget.document.execCommand('InsertImage', false, element.src);\n\n          if (!('parentElement' in range)) {\n            windowTarget.document.execCommand('delete', false);\n            range = windowTarget.document.selection.createRange();\n            windowTarget.document.execCommand('InsertImage', false, element.src);\n          }\n\n          if ('parentElement' in range) {\n            const temporalObject = range.parentElement();\n\n            if (temporalObject.nodeName.toUpperCase() === 'IMG') {\n              temporalObject.parentNode.replaceChild(element, temporalObject);\n            } else {\n              // IE9 fix: parentNode() does not return the IMG node,\n              // returns the parent DIV node. In IE < 9, pasteHTML does not work well.\n              range.pasteHTML(Util.createObjectCode(element));\n            }\n          }\n        } else {\n          const editorSelection = this.integrationModel.getSelection();\n          let range = null;\n          // In IE is needed keep the range due to after focus the modal window\n          // it can't be retrieved the last selection.\n          if (this.editionProperties.range) {\n            ({ range } = this.editionProperties);\n            this.editionProperties.range = null;\n          } else {\n            range = editorSelection.getRangeAt(0);\n          }\n\n          // Delete if something was surrounded.\n          range.deleteContents();\n\n          let node = range.startContainer;\n          const position = range.startOffset;\n\n          if (node.nodeType === 3) { // TEXT_NODE.\n            node = node.splitText(position);\n            node.parentNode.insertBefore(element, node);\n          } else if (node.nodeType === 1) { // ELEMENT_NODE.\n            node.insertBefore(element, node.childNodes[position]);\n          }\n\n          this.placeCaretAfterNode(element);\n        }\n      } else if (focusElement.type === 'textarea') {\n        focusElement.focus();\n      } else {\n        const editorSelection = this.integrationModel.getSelection();\n        editorSelection.removeAllRanges();\n\n        if (this.editionProperties.range) {\n          const { range } = this.editionProperties;\n          this.editionProperties.range = null;\n          editorSelection.addRange(range);\n        }\n      }\n    } else if (this.editionProperties.latexRange) {\n      if (document.selection && document.getSelection === 0) {\n        this.editionProperties.isNewElement = true;\n        this.editionProperties.latexRange.select();\n        this.insertElementOnSelection(element, focusElement, windowTarget);\n      } else {\n        this.editionProperties.latexRange.deleteContents();\n        this.editionProperties.latexRange.insertNode(element);\n        this.placeCaretAfterNode(element);\n      }\n    } else if (focusElement.type === 'textarea') {\n      let item;\n      // Wrapper for some integrations that can have special behaviours to show latex.\n      if (typeof this.integrationModel.getSelectedItem !== 'undefined') {\n        item = this.integrationModel.getSelectedItem(focusElement, false);\n      } else {\n        item = Util.getSelectedItemOnTextarea(focusElement);\n      }\n      Util.updateExistingTextOnTextarea(focusElement,\n        element.textContent,\n        item.startPosition,\n        item.endPosition);\n    } else {\n      mathmlOrigin = this.editionProperties.temporalImage?.dataset.mathml;\n      if (element && element.nodeName.toLowerCase() === 'img') { // Editor empty, formula has been erased on edit.\n        // There are editors (e.g: CKEditor) that put attributes in images.\n        // We don't allow that behaviour in our images.\n        Image.removeImgDataAttributes(this.editionProperties.temporalImage);\n        // Clone is needed to maintain event references to temporalImage.\n        Image.clone(element, this.editionProperties.temporalImage);\n      } else {\n        this.editionProperties.temporalImage.remove();\n      }\n      this.placeCaretAfterNode(this.editionProperties.temporalImage);\n    }\n    \n    // Build the telemeter payload separated to delete null/undefined entries.\n    const mathml = element?.dataset?.mathml;\n    let payload = {\n      mathml_origin: mathmlOrigin ? MathML.safeXmlDecode(mathmlOrigin) : mathmlOrigin,\n      mathml: mathml ? MathML.safeXmlDecode(mathml) : mathml,\n      elapsed_time: Date.now() - this.editionProperties.editionStartTime,\n      editor_origin: null, // TODO read formula to find out whether it comes from Oxygen Desktop\n      toolbar: this.modalDialog.contentManager.toolbar,\n      size: mathml?.length,\n    };\n\n    // Remove the desired null keys.\n    Object.keys(payload).forEach(key => {\n      if (key === 'mathml_origin' || key === 'editor_origin') !payload[key] ? delete payload[key] : {}\n    });\n    \n    try {\n      Telemeter.telemeter.track(\"INSERTED_FORMULA\", {\n        ...payload,\n      });\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  /**\n   * Opens a modal dialog containing MathType editor..\n   * @param {HTMLElement} target - The target HTMLElement where formulas should be inserted.\n   * @param {Boolean} isIframe - True if the target HTMLElement is an iframe. False otherwise.\n   */\n  openModalDialog(target, isIframe) {\n\n    // Count the time since the editor is open\n    this.editionProperties.editionStartTime = Date.now();\n\n    // Textarea elements don't have normal document ranges. It only accepts latex edit.\n    this.editMode = 'images';\n\n    // In IE is needed keep the range due to after focus the modal window\n    // it can't be retrieved the last selection.\n    try {\n      if (isIframe) {\n        // Is needed focus the target first.\n        target.contentWindow.focus();\n        const selection = target.contentWindow.getSelection();\n        this.editionProperties.range = selection.getRangeAt(0);\n      } else {\n        // Is needed focus the target first.\n        target.focus();\n        const selection = getSelection();\n        this.editionProperties.range = selection.getRangeAt(0);\n      }\n    } catch (e) {\n      this.editionProperties.range = null;\n    }\n\n    if (isIframe === undefined) {\n      isIframe = true;\n    }\n\n    this.editionProperties.latexRange = null;\n\n    if (target) {\n      let selectedItem;\n      if (typeof this.integrationModel.getSelectedItem !== 'undefined') {\n        selectedItem = this.integrationModel.getSelectedItem(target, isIframe);\n      } else {\n        selectedItem = Util.getSelectedItem(target, isIframe);\n      }\n\n      // Check LaTeX if and only if the node is a text node (nodeType==3).\n      if (selectedItem) {\n        // Case when image was selected and button pressed.\n        if (!selectedItem.caretPosition && Util.containsClass(selectedItem.node, Configuration.get('imageClassName'))) {\n          this.editionProperties.temporalImage = selectedItem.node;\n          this.editionProperties.isNewElement = false;\n        } else if (selectedItem.node.nodeType === 3) {\n          // If it's a text node means that editor is working with LaTeX.\n          if (this.integrationModel.getMathmlFromTextNode) {\n            // If integration has this function it isn't set range due to we don't\n            // know if it will be put into a textarea as a text or image.\n            const mathml = this.integrationModel.getMathmlFromTextNode(\n              selectedItem.node,\n              selectedItem.caretPosition,\n            );\n            if (mathml) {\n              this.editMode = 'latex';\n              this.editionProperties.isNewElement = false;\n              this.editionProperties.temporalImage = document.createElement('img');\n              this.editionProperties.temporalImage.setAttribute(\n                Configuration.get('imageMathmlAttribute'),\n                MathML.safeXmlEncode(mathml),\n              );\n            }\n          } else {\n            const latexResult = Latex.getLatexFromTextNode(\n              selectedItem.node,\n              selectedItem.caretPosition,\n            );\n            if (latexResult) {\n              const mathml = Latex.getMathMLFromLatex(latexResult.latex);\n              this.editMode = 'latex';\n              this.editionProperties.isNewElement = false;\n              this.editionProperties.temporalImage = document.createElement('img');\n              this.editionProperties.temporalImage.setAttribute(\n                Configuration.get('imageMathmlAttribute'),\n                MathML.safeXmlEncode(mathml),\n              );\n              const windowTarget = isIframe ? target.contentWindow : window;\n\n              if (target.tagName.toLowerCase() !== 'textarea') {\n                if (document.selection) {\n                  let leftOffset = 0;\n                  let previousNode = latexResult.startNode.previousSibling;\n\n                  while (previousNode) {\n                    leftOffset += Util.getNodeLength(previousNode);\n                    previousNode = previousNode.previousSibling;\n                  }\n\n                  this.editionProperties.latexRange = windowTarget.document.selection.createRange();\n                  this.editionProperties.latexRange.moveToElementText(\n                    latexResult.startNode.parentNode,\n                  );\n                  this.editionProperties.latexRange.move(\n                    'character',\n                    leftOffset + latexResult.startPosition,\n                  );\n                  this.editionProperties.latexRange.moveEnd(\n                    'character',\n                    latexResult.latex.length + 4,\n                  ); // Plus 4 for the '$$' characters.\n                } else {\n                  this.editionProperties.latexRange = windowTarget.document.createRange();\n                  this.editionProperties.latexRange.setStart(\n                    latexResult.startNode,\n                    latexResult.startPosition,\n                  );\n                  this.editionProperties.latexRange.setEnd(\n                    latexResult.endNode,\n                    latexResult.endPosition,\n                  );\n                }\n              }\n            }\n          }\n        }\n      } else if (target.tagName.toLowerCase() === 'textarea') {\n        // By default editMode is 'images', but when target is a textarea it needs to be 'latex'.\n        this.editMode = 'latex';\n      }\n    }\n\n    // Setting an object with the editor parameters.\n    // Editor parameters can be customized in several ways:\n    // 1 - editorAttributes: Contains the default editor attributes,\n    //  usually the metrics in a comma separated string. Always exists.\n    // 2 - editorParameters: Object containing custom editor parameters.\n    // These parameters are defined in the backend. So they affects all integration instances.\n\n    // The backend send the default editor attributes in a coma separated\n    // with the following structure: key1=value1,key2=value2...\n    const defaultEditorAttributesArray = Configuration.get('editorAttributes').split(', ');\n    const defaultEditorAttributes = {};\n    for (let i = 0, len = defaultEditorAttributesArray.length; i < len; i += 1) {\n      const tempAttribute = defaultEditorAttributesArray[i].split('=');\n      const key = tempAttribute[0];\n      const value = tempAttribute[1];\n      defaultEditorAttributes[key] = value;\n    }\n    // Custom editor parameters.\n    const editorAttributes = {\n      language: this.language, // Default language value\n    };\n    // Editor parameters in backend, usually configuration.ini.\n    const serverEditorParameters = Configuration.get('editorParameters');\n    // Editor parameters through JavaScript configuration.\n    const cliendEditorParameters = this.integrationModel.editorParameters;\n    Object.assign(editorAttributes, defaultEditorAttributes, serverEditorParameters);\n    Object.assign(editorAttributes, defaultEditorAttributes, cliendEditorParameters);\n\n    // Now, update backwards: if user has set a custom language, pass that back to core properties\n    this.language = editorAttributes.language;\n    StringManager.language = this.language;\n\n    editorAttributes.rtl = this.integrationModel.rtl;\n\n    const contentManagerAttributes = {};\n    contentManagerAttributes.editorAttributes = editorAttributes;\n    contentManagerAttributes.language = this.language;\n    contentManagerAttributes.customEditors = this.customEditors;\n    contentManagerAttributes.environment = this.environment;\n\n    if (this.modalDialog == null) {\n      this.modalDialog = new ModalDialog(editorAttributes);\n      this.contentManager = new ContentManager(contentManagerAttributes);\n      // When an instance of ContentManager is created we need to wait until\n      // the ContentManager is ready by listening 'onLoad' event.\n      const listener = Listeners.newListener('onLoad', () => {\n        this.contentManager.dbclick = this.editionProperties.dbclick;\n        this.contentManager.isNewElement = this.editionProperties.isNewElement;\n        if (this.editionProperties.temporalImage != null) {\n          const mathML = MathML.safeXmlDecode(this.editionProperties.temporalImage.getAttribute(Configuration.get('imageMathmlAttribute')));\n          this.contentManager.mathML = mathML;\n        }\n      });\n      this.contentManager.addListener(listener);\n      this.contentManager.init();\n      this.modalDialog.setContentManager(this.contentManager);\n      this.contentManager.setModalDialogInstance(this.modalDialog);\n    } else {\n      this.contentManager.dbclick = this.editionProperties.dbclick;\n      this.contentManager.isNewElement = this.editionProperties.isNewElement;\n      if (this.editionProperties.temporalImage != null) {\n        const mathML = MathML.safeXmlDecode(this.editionProperties.temporalImage.getAttribute(Configuration.get('imageMathmlAttribute')));\n        this.contentManager.mathML = mathML;\n      }\n    }\n    this.contentManager.setIntegrationModel(this.integrationModel);\n    this.modalDialog.open();\n  }\n\n  /**\n   * Returns the {@link CustomEditors} instance.\n   * @return {CustomEditors} The current {@link CustomEditors} instance.\n   */\n  getCustomEditors() {\n    return this.customEditors;\n  }\n}\n\n/**\n * Core static listeners.\n * @type {Listeners}\n * @private\n */\nCore._globalListeners = new Listeners();\n\n/**\n * Resources state. Says if they were loaded or not.\n * @type {Boolean}\n * @private\n */\nCore._initialized = false;\n", "// eslint-disable-next-line no-unused-vars, import/named\nimport Core from './core.src';\nimport Image from './image';\nimport Listeners from './listeners';\nimport Util from './util';\nimport Configuration from './configuration';\nimport ServiceProvider from './serviceprovider';\nimport Telemeter from './telemeter';\nimport warnIcon from '../styles/icons/general/warn_icon.svg';  //eslint-disable-line\n\n/**\n * @typedef {Object} IntegrationModelProperties\n * @property {string} configurationService - Configuration service path.\n * This parameter is needed to determine all services paths.\n * @property {HTMLElement} integrationModelProperties.target - HTML target.\n * @property {string} integrationModelProperties.scriptName - Integration script name.\n * Usually the name of the integration script.\n * @property {Object} integrationModelProperties.environment - integration environment properties.\n * @property {Object} [integrationModelProperties.callbackMethodArguments] - object containing\n * callback method arguments.\n * @property {string} [integrationModelProperties.version] - integration version number.\n * @property {Object} [integrationModelProperties.editorObject] - object containing\n * the integration editor instance.\n * @property {boolean} [integrationModelProperties.rtl] - true if the editor is in RTL mode.\n * false otherwise.\n * @property {ServiceProviderProperties} [integrationModelProperties.serviceProviderProperties]\n * - The service parameters.\n * @property {Object} [integrationModelProperties.integrationParameters]\n * - Overwritten integration parameters.\n */\n\nexport default class IntegrationModel {\n  /**\n   * @classdesc\n   * This class represents an integration model, allowing the integration script to\n   * communicate with Core class. Each integration must extend this class.\n   * @constructs\n   * @param {IntegrationModelProperties} integrationModelProperties\n   */\n  constructor(integrationModelProperties) {\n    /**\n     * Language. Needed for accessibility and locales. English by default.\n     */\n    this.language = 'en';\n\n    /**\n     * Service parameters\n     * @type {ServiceProviderProperties}\n     */\n    this.serviceProviderProperties = {};\n    if ('serviceProviderProperties' in integrationModelProperties) {\n      this.serviceProviderProperties = integrationModelProperties.serviceProviderProperties;\n    }\n\n    /**\n     * Configuration service path. The integration service is needed by Core class to\n     * load all the backend configuration into the frontend and also to create the paths\n     * of all services (all services lives in the same route). Mandatory property.\n     */\n    this.configurationService = '';\n    if ('configurationService' in integrationModelProperties) {\n      this.serviceProviderProperties.URI = integrationModelProperties.configurationService;\n      console.warn('Deprecated property configurationService. Use serviceParameters on instead.',\n        [integrationModelProperties.configurationService]);\n    }\n\n    /**\n     * Plugin version. Needed to stats and caching.\n     * @type {string}\n     */\n    this.version = ('version' in integrationModelProperties ? integrationModelProperties.version : '');\n\n    /**\n     * DOM target in which the plugin works. Needed to associate events, insert formulas, etc.\n     * Mandatory property.\n     */\n    this.target = null;\n    if ('target' in integrationModelProperties) {\n      this.target = integrationModelProperties.target;\n    } else {\n      throw new Error('IntegrationModel constructor error: target property missed.');\n    }\n\n    /**\n     * Integration script name. Needed to know the plugin path.\n     */\n    if ('scriptName' in integrationModelProperties) {\n      this.scriptName = integrationModelProperties.scriptName;\n    }\n\n    /**\n     * Object containing the arguments needed by the callback function.\n     */\n    this.callbackMethodArguments = {};\n    if ('callbackMethodArguments' in integrationModelProperties) {\n      this.callbackMethodArguments = integrationModelProperties.callbackMethodArguments;\n    }\n\n    /**\n     * Contains information about the integration environment:\n     * like the name of the editor, the version, etc.\n     */\n    this.environment = {};\n    if ('environment' in integrationModelProperties) {\n      this.environment = integrationModelProperties.environment;\n    }\n\n    /**\n     * Indicates if the DOM target is - or not - and iframe.\n     */\n    this.isIframe = false;\n    if (this.target != null) {\n      this.isIframe = (this.target.tagName.toUpperCase() === 'IFRAME');\n    }\n\n    /**\n     * Instance of the integration editor object. Usually the entry point to access the API\n     * of a HTML editor.\n     */\n    this.editorObject = null;\n    if ('editorObject' in integrationModelProperties) {\n      this.editorObject = integrationModelProperties.editorObject;\n    }\n\n    /**\n     * Specifies if the direction of the text is RTL. false by default.\n     */\n    this.rtl = false;\n    if ('rtl' in integrationModelProperties) {\n      this.rtl = integrationModelProperties.rtl;\n    }\n\n    /**\n     * Specifies if the integration model exposes the locale strings. false by default.\n     */\n    this.managesLanguage = false;\n    if ('managesLanguage' in integrationModelProperties) {\n      this.managesLanguage = integrationModelProperties.managesLanguage;\n    }\n\n    /**\n     * Indicates if an image is selected. Needed to resize the image to the original size in case\n     * the image is resized.\n     * @type {boolean}\n     */\n    this.temporalImageResizing = false;\n\n    /**\n     * The Core class instance associated to the integration model.\n     * @type {Core}\n     */\n    this.core = null;\n\n    /**\n     * Integration model listeners.\n     * @type {Listeners}\n     */\n    this.listeners = new Listeners();\n\n    // Parameters overwrite.\n    if ('integrationParameters' in integrationModelProperties) {\n      IntegrationModel.integrationParameters.forEach((parameter) => {\n        if (parameter in integrationModelProperties.integrationParameters) {\n          // Don't add empty parameters.\n          const value = integrationModelProperties.integrationParameters[parameter];\n          if (Object.keys(value).length !== 0) {\n            this[parameter] = value;\n          }\n        }\n      });\n    }\n  }\n\n  /**\n   * Init function. Usually called from the integration side once the core.js file is loaded.\n   */\n  init() {\n    // Check if language is an object and select the property necessary\n    this.language = this.getLanguage();\n\n    // We need to wait until Core class is loaded ('onLoad' event) before\n    // call the callback method.\n    const listener = Listeners.newListener('onLoad', () => {\n      this.callbackFunction(this.callbackMethodArguments);\n    });\n\n    // Backwards compatibility.\n    if (this.serviceProviderProperties.URI.indexOf('configuration') !== -1) {\n      const uri = this.serviceProviderProperties.URI;\n      const server = ServiceProvider.getServerLanguageFromService(uri);\n      this.serviceProviderProperties.server = server;\n      const configurationIndex = this.serviceProviderProperties.URI.indexOf('configuration');\n      const subsTring = this.serviceProviderProperties.URI.substring(0, configurationIndex);\n      this.serviceProviderProperties.URI = subsTring;\n    }\n\n    let serviceParametersURI = this.serviceProviderProperties.URI;\n    serviceParametersURI = serviceParametersURI.indexOf('/') === 0 || serviceParametersURI.indexOf('http') === 0\n      ? serviceParametersURI\n      : Util.concatenateUrl(this.getPath(), serviceParametersURI);\n\n    this.serviceProviderProperties.URI = serviceParametersURI;\n\n    const coreProperties = {};\n    coreProperties.serviceProviderProperties = this.serviceProviderProperties;\n    this.setCore(new Core(coreProperties));\n    this.core.addListener(listener);\n    this.core.language = this.language;\n\n    // Initializing Core class.\n    this.core.init();\n    // TODO: Move to Core constructor.\n    this.core.setEnvironment(this.environment);\n\n    // No internet conection modal.\n    let attributes = {};\n    attributes.class = attributes.id = \"wrs_modal_offline\";\n    this.offlineModal = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = \"wrs_modal_content_offline\";\n    this.offlineModalContent = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = \"wrs_modal_offline_close\";\n    this.offlineModalClose = Util.createElement('span', attributes);\n    this.offlineModalClose.innerHTML = '&times;';\n\n    attributes = {};\n    attributes.class = \"wrs_modal_offline_warn\";\n    this.offlineModalWarn = Util.createElement('span', attributes);\n    let generalStyle = `background-image: url(data:image/svg+xml;base64,${window.btoa(warnIcon)})`;\n    this.offlineModalWarn.setAttribute('style', generalStyle);\n\n    attributes = {};\n    attributes.class = \"wrs_modal_offline_text_container\";\n    this.offlineModalMessage = Util.createElement('div', attributes);\n\n    attributes = {};\n    attributes.class = \"wrs_modal_offline_text_warn\";\n    this.offlineModalMessage1 = Util.createElement('p', attributes);\n    this.offlineModalMessage1.innerHTML = 'You are not online!';\n\n    attributes = {};\n    attributes.class = \"wrs_modal_offline_text\";\n    this.offlineModalMessage2 = Util.createElement('p', attributes);\n    this.offlineModalMessage2.innerHTML = `Thank you for using MathType. We have detected you are disconnected from the network. We remind you that you'll need to be connected to use MathType. <br /><br />Please refresh the page if this message continues appearing.`;\n\n    //Append offline modal elements\n    this.offlineModalContent.appendChild(this.offlineModalClose);\n    this.offlineModalMessage.appendChild(this.offlineModalMessage1);\n    this.offlineModalMessage.appendChild(this.offlineModalMessage2);\n    this.offlineModalContent.appendChild(this.offlineModalMessage);\n    this.offlineModalContent.appendChild(this.offlineModalWarn);\n    this.offlineModal.appendChild(this.offlineModalContent);\n    document.body.appendChild(this.offlineModal);\n\n    let modal = document.getElementById(\"wrs_modal_offline\");\n    this.offlineModalClose.addEventListener('click', function() {modal.style.display = \"none\";});\n\n    // Store editor name for telemetry purposes.\n    let editorName = this.environment.editor;\n    editorName = editorName.slice(0, -1); // Remove version number from editors\n    if (editorName.includes(\"TinyMCE\")) editorName = \"TinyMCE\"; // Remove version from Tinymce editor.\n    if (editorName.includes(\"Generic\")) editorName = \"Generic\"; // Remove version from Generic editor.\n    let solutionTelemeter = editorName;\n\n    // If moodle, add information to hosts and solution.\n    let isMoodle = (!!((typeof M === 'object' && M !== null))),\n      lms;\n\n    if (isMoodle) {\n      solutionTelemeter = 'Moodle';\n      lms = {\n        nam: 'moodle',\n        fam: 'lms',\n        ver: this.environment.moodleVersion,\n        category: this.environment.moodleCourseCategory,\n        course: this.environment.moodleCourseName,\n      }\n      if (!editorName.includes('TinyMCE')) {\n        editorName = 'Atto';\n      }\n    }\n\n    // Get the OS and its version.\n    let OSData = this.getOS();\n\n    // Get the broswer and its version.\n    let broswerData = this.getBrowser();\n\n    // Create list of hosts to send to telemetry.\n    let hosts = [\n      {\n        nam: broswerData.detectedBrowser,\n        fam: \"browser\",\n        ver: broswerData.versionBrowser,\n      },\n      {\n        nam: editorName.toLowerCase(),\n        fam: \"html-editor\",\n        ver: this.environment.editorVersion,\n      },\n      {\n        nam: OSData.detectedOS,\n        fam: \"os\",\n        ver: OSData.versionOS,\n      },\n      {\n        nam: window.location.hostname,\n        fam: \"domain\",\n      },\n      lms,\n    ];\n\n    // Filter hosts to remove empty objects and empty keys.\n    hosts = hosts.filter(function( element ) {\n      if (element) Object.keys(element).forEach(key => element[key] === \"unknown\" ? delete element[key] : {});\n      return element !== undefined;\n    });\n\n    // Initialize telemeter\n    Telemeter.init({\n      solution: {\n        name: \"MathType for \" + solutionTelemeter,\n        version: this.version,\n      },\n      hosts: hosts,\n      config: {\n        test: false, // True to use the staging Telemetry endpoint instead of the production one.\n        debug: false, // True to show more information about Telemeter's execution and use dev-tools.\n        dry_run: false, // True to skip sending data to the Telemetry endpoint (for example for unit tests).\n        api_key: \"eda2ce9b-0e8a-46f2-acdd-c228a615314e\", // to auth against Telemetry. Data team is the responsible of providing it.\n      },\n      url: undefined,\n    })\n\n  }\n\n  /**\n   * Returns the Browser name and its version.\n   * @return {array} - detectedBrowser = Operating System name.\n   *                   versionBrowser = Operating System version.\n   */\n  getBrowser() {\n    // default value for OS just in case nothing is detected\n    let detectedBrowser = \"unknown\",\n      versionBrowser = \"unknown\";\n\n    let userAgent = window.navigator.userAgent;\n\n    if(/Brave/.test(userAgent)) {\n      detectedBrowser = \"brave\";\n      if (userAgent.indexOf(\"Brave/\")) {\n        let start = userAgent.indexOf(\"Brave\") + 6;\n        let end = userAgent.substring(start).indexOf(' ');\n        end = (end === -1) ? userAgent.lastIndexOf(\"\") : end;\n        versionBrowser = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n      }\n    } else if (userAgent.indexOf('Edg/') !== -1) {\n      detectedBrowser = \"edge_chromium\";\n      let start = userAgent.indexOf(\"Edg/\") + 4;\n      versionBrowser = (userAgent.substring(start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n    } else if (/Edg/.test(userAgent)) {\n      detectedBrowser = \"edge\";\n      let start = userAgent.indexOf(\"Edg\") + 3;\n      start = start + userAgent.substring(start).indexOf('/');\n      let end = userAgent.substring(start).indexOf(' ');\n      end = (end === -1) ? userAgent.lastIndexOf(\"\") : end;\n      versionBrowser = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n    } else if (/Firefox/.test(userAgent) || /FxiOS/.test(userAgent)) {\n      detectedBrowser = \"firefox\";\n      let start = userAgent.indexOf(\"Firefox\");\n      start = (start === -1) ? userAgent.indexOf(\"FxiOS\") : start;\n      start = start + userAgent.substring(start).indexOf('/') + 1;\n      let end = userAgent.substring(start).indexOf(' ');\n      end = (end === -1) ? userAgent.lastIndexOf(\"\") : end;\n      versionBrowser = (userAgent.substring(start, end + start).replace( '_', '.' ));\n    } else if (/OPR/.test(userAgent)) {\n      detectedBrowser = \"opera\";\n      let start = userAgent.indexOf(\"OPR/\") + 4;\n      let end = userAgent.substring(start).indexOf(' ');\n      end = (end === -1) ? userAgent.lastIndexOf(\"\") : end;\n      versionBrowser = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n    } else if (/Chrome/.test(userAgent) || /CriOS/.test(userAgent)) {\n      detectedBrowser = \"chrome\";\n      let start = userAgent.indexOf(\"Chrome\");\n      start = (start === -1) ? userAgent.indexOf(\"CriOS\") : start;\n      start = start + userAgent.substring(start).indexOf('/') + 1;\n      let end = userAgent.substring(start).indexOf(' ');\n      end = (end === -1) ? userAgent.lastIndexOf(\"\") : end;\n      versionBrowser = (userAgent.substring(start, end + start).replace( '_', '.' ));\n    } else if (/Safari/.test(userAgent)) {\n      detectedBrowser = \"safari\";\n      let start = userAgent.indexOf(\"Version/\");\n      start = start + userAgent.substring(start).indexOf('/') + 1;\n      let end = userAgent.substring(start).indexOf(' ');\n      end = (end === -1) ? userAgent.lastIndexOf(\"\") : end;\n      versionBrowser = (userAgent.substring(start, end + start).replace( '_', '.' ));\n    }\n\n    return { detectedBrowser, versionBrowser };\n  }\n\n  /**\n   * Returns the operating system and its version.\n   * @return {array} - detectedOS = Operating System name.\n   *                   versionOS = Operating System version.\n   */\n  getOS() {\n\n    // default value for OS just in case nothing is detected\n    let detectedOS = \"unknown\",\n      versionOS = \"unknown\";\n\n    // Retrieve properties to easily detect the OS\n    let userAgent = window.navigator.userAgent,\n      platform = window.navigator.platform,\n      macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'],\n      windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'],\n      iosPlatforms = ['iPhone', 'iPad', 'iPod'];\n\n    // Find OS and their respective versions\n    if (macosPlatforms.indexOf(platform) !== -1) {\n      detectedOS = 'macos';\n      if (userAgent.indexOf(\"OS X\") !== -1) {\n        let start = userAgent.indexOf(\"OS X\") + 5;\n        let end = userAgent.substring(start).indexOf(' ');\n        versionOS = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n      }\n    } else if (iosPlatforms.indexOf(platform) !== -1) {\n      detectedOS = 'ios';\n      if (userAgent.indexOf(\"OS \") !== -1) {\n        let start = userAgent.indexOf(\"OS \") + 3;\n        let end = userAgent.substring(start).indexOf(')');\n        versionOS = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n      }\n    } else if (windowsPlatforms.indexOf(platform) !== -1) {\n      detectedOS = 'windows';\n      let start = userAgent.indexOf(\"Windows\");\n      let end = userAgent.substring(start).indexOf(';');\n      if (end === -1) {\n        end = userAgent.substring(start).indexOf(')');\n      }\n      versionOS = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n    } else if (/Android/.test(userAgent)) {\n      detectedOS = 'android';\n      let start = userAgent.indexOf(\"Android\");\n      let end = userAgent.substring(start).indexOf(';');\n      if (end === -1) {\n        end = userAgent.substring(start).indexOf(')');\n      }\n      versionOS = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n    }else if (/CrOS/.test(userAgent)) {\n        detectedOS = 'chromeos';\n        let start = userAgent.indexOf(\"CrOS \") + 5;\n        start = start + userAgent.substring(start).indexOf(' ');\n        let end = userAgent.substring(start).indexOf(')');\n        versionOS = (userAgent.substring(start, end + start).replace( '_', '.' )).replace(/[^\\d.-]/g, '');\n    } else if (detectedOS === \"unknown\" && /Linux/.test(platform)) {\n      detectedOS = 'linux';\n    }\n\n    return { detectedOS, versionOS };\n  }\n\n  /**\n   * Returns the absolute path of the integration script.\n   * @return {string} - Absolute path for the integration script.\n   */\n  getPath() {\n    if (typeof this.scriptName === 'undefined') {\n      throw new Error('scriptName property needed for getPath.');\n    }\n    const col = document.getElementsByTagName('script');\n    let path = '';\n    for (let i = 0; i < col.length; i += 1) {\n      const j = col[i].src.lastIndexOf(this.scriptName);\n      if (j >= 0) {\n        path = col[i].src.substr(0, j - 1);\n      }\n    }\n    return path;\n  }\n\n  /**\n   * Returns integration model plugin version\n   * @param {string} - Plugin version\n   */\n  getVersion() {\n    return this.version;\n  }\n\n  /**\n   * Sets the language property.\n   * @param {string} language - language code.\n   */\n  setLanguage(language) {\n    this.language = language;\n  }\n\n  /**\n   * Sets a Core instance.\n   * @param {Core} core - instance of Core class.\n   */\n  setCore(core) {\n    this.core = core;\n    core.setIntegrationModel(this);\n  }\n\n  /**\n   * Returns the Core instance.\n   * @returns {Core} instance of Core class.\n   */\n  getCore() {\n    return this.core;\n  }\n\n  /**\n   * Sets the object target and updates the iframe property.\n   * @param {HTMLElement} target - target object.\n   */\n  setTarget(target) {\n    this.target = target;\n    this.isIframe = (this.target.tagName.toUpperCase() === 'IFRAME');\n  }\n\n  /**\n   * Sets the editor object.\n   * @param {Object} editorObject - The editor object.\n   */\n  setEditorObject(editorObject) {\n    this.editorObject = editorObject;\n  }\n\n  /**\n   * Opens formula editor to editing a new formula. Can be overwritten in order to make some\n   * actions from integration part before the formula is edited.\n   */\n  openNewFormulaEditor() {\n    if (window.navigator.onLine) {\n      this.core.editionProperties.dbclick = false;\n      this.core.editionProperties.isNewElement = true;\n      this.core.openModalDialog(this.target, this.isIframe);\n    } else {\n      let modal = document.getElementById(\"wrs_modal_offline\");\n      modal.style.display = \"block\";\n    }\n  }\n\n  /**\n   * Opens formula editor to editing an existing formula. Can be overwritten in order to make some\n   * actions from integration part before the formula is edited.\n   */\n  openExistingFormulaEditor() {\n    if (window.navigator.onLine) {\n      this.core.editionProperties.isNewElement = false;\n      this.core.openModalDialog(this.target, this.isIframe);\n    } else {\n      let modal = document.getElementById(\"wrs_modal_offline\");\n      modal.style.display = \"block\";\n    }\n  }\n\n  /**\n   * Wrapper to Core.updateFormula method.\n   * Transform a MathML into a image formula.\n   * Then the image formula is inserted in the specified target, creating a new image (new formula)\n   * or updating an existing one.\n   * @param {string} mathml - MathML to generate the formula.\n   * @param {string} editMode - Edit Mode (LaTeX or images).\n   */\n  updateFormula(mathml) {\n    if (this.editorParameters) {\n      mathml = com.wiris.editor.util.EditorUtils.addAnnotation(mathml, 'application/vnd.wiris.mtweb-params+json', JSON.stringify(this.editorParameters));\n    }\n    let focusElement;\n    let windowTarget;\n    const wirisProperties = null;\n\n    if (this.isIframe) {\n      focusElement = this.target.contentWindow;\n      windowTarget = this.target.contentWindow;\n    } else {\n      focusElement = this.target;\n      windowTarget = window;\n    }\n\n    let obj = this.core.beforeUpdateFormula(mathml, wirisProperties);\n\n    if (!obj) {\n      return '';\n    }\n\n    obj = this.insertFormula(focusElement, windowTarget, obj.mathml, obj.wirisProperties);\n\n    if (!obj) {\n      return '';\n    }\n\n    return this.core.afterUpdateFormula(obj.focusElement, obj.windowTarget, obj.node, obj.latex);\n  }\n\n  /**\n   * Wrapper to Core.insertFormula method.\n   * Inserts the formula in the specified target, creating\n   * a new image (new formula) or updating an existing one.\n   * @param {string} mathml - MathML to generate the formula.\n   * @param {string} editMode - Edit Mode (LaTeX or images).\n   * @returns {ReturnObject} - Object with the information of the node or latex to insert.\n   */\n  insertFormula(focusElement, windowTarget, mathml, wirisProperties) {\n    const obj =  this.core.insertFormula(focusElement, windowTarget, mathml, wirisProperties);\n\n    // Delete temporal image when inserted\n    this.core.editionProperties.temporalImage = null;\n\n    return obj;\n  }\n\n  /**\n   * Returns the target selection.\n   * @returns {Selection} target selection.\n   */\n  getSelection() {\n    if (this.isIframe) {\n      this.target.contentWindow.focus();\n      return this.target.contentWindow.getSelection();\n    }\n    this.target.focus();\n    return window.getSelection();\n  }\n\n  /**\n   * Add events to formulas in the DOM target. The events added are the following:\n   * - doubleClickHandler: handles Double-click event on formulas by opening an editor\n   * to edit them.\n   * - mouseDownHandler: handles mouse down event on formulas by saving the size of the formula\n   * in case the the formula is resized.\n   * - mouseUpHandler: handles mouse up event on formulas by restoring the saved formula size\n   * in case the formula is resized.\n   */\n  addEvents() {\n    const eventTarget = this.isIframe ? this.target.contentWindow.document : this.target;\n    Util.addElementEvents(\n      eventTarget,\n      (element, event) => {\n        this.doubleClickHandler(element, event);\n        // Avoid creating the doublick listener more than once for each element.\n        event.stopImmediatePropagation();\n      },\n      (element, event) => {\n        this.mousedownHandler(element, event);\n      },\n      (element, event) => {\n        this.mouseupHandler(element, event);\n      },\n    );\n  }\n\n  /**\n   * Remove events to formulas in the DOM target.\n   */\n  removeEvents() {\n    const eventTarget = this.isIframe ? this.target.contentWindow.document : this.target;\n    Util.removeElementEvents(eventTarget);\n  }\n\n  /**\n   * Remove events and set this.editorObject to null in order to prevent memory leaks.\n   */\n  destroy() {\n    this.removeEvents();\n    this.editorObject = null;\n  }\n\n  /**\n   * Handles a Double-click on the target element. Opens an editor\n   * to re-edit the double-clicked formula.\n   * @param {HTMLElement} element - DOM object target.\n   */\n  doubleClickHandler(element) {\n    this.core.editionProperties.dbclick = true;\n    if (element.nodeName.toLowerCase() === 'img') {\n      this.core.getCustomEditors().disable();\n      const customEditorAttributeName = Configuration.get('imageCustomEditorName');\n      if (element.hasAttribute(customEditorAttributeName)) {\n        const customEditor = element.getAttribute(customEditorAttributeName);\n        this.core.getCustomEditors().enable(customEditor);\n      }\n      if (Util.containsClass(element, Configuration.get('imageClassName'))) {\n        this.core.editionProperties.temporalImage = element;\n        this.core.editionProperties.isNewElement = true;\n        this.openExistingFormulaEditor();\n      }\n    }\n  }\n\n  /**\n   * Handles a mouse up event on the target element. Restores the image size to avoid\n   * resizing formulas.\n   */\n  mouseupHandler() {\n    if (this.temporalImageResizing) {\n      setTimeout(() => {\n        Image.fixAfterResize(this.temporalImageResizing);\n      }, 10);\n    }\n  }\n\n  /**\n   * Handles a mouse down event on the target element. Saves the formula size to avoid\n   * resizing formulas.\n   * @param {HTMLElement} element - target element.\n   */\n  mousedownHandler(element) {\n    if (element.nodeName.toLowerCase() === 'img') {\n      if (Util.containsClass(element, Configuration.get('imageClassName'))) {\n        this.temporalImageResizing = element;\n      }\n    }\n  }\n\n  /**\n   * Returns the integration language. By default the browser agent. This method\n   * should be overwritten to obtain the integration language, for example using the\n   * plugin API of an HTML editor.\n   * @returns {string} integration language.\n   */\n  getLanguage() {\n    return this.getBrowserLanguage();\n  }\n\n  /**\n   * Returns the browser language.\n   * @returns {string} the browser language.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  getBrowserLanguage() {\n    let language = 'en';\n    if (navigator.userLanguage) {\n      language = navigator.userLanguage.substring(0, 2);\n    } else if (navigator.language) {\n      language = navigator.language.substring(0, 2);\n    } else {\n      language = 'en';\n    }\n    return language;\n  }\n\n  /**\n   * This function is called once the {@link Core} is loaded. IntegrationModel class\n   * will fire this method when {@link Core} 'onLoad' event is fired.\n   * This method should content all the logic to init\n   * the integration.\n   */\n  callbackFunction() {\n    // It's needed to wait until the integration target is ready. The event is fired\n    // from the integration side.\n    const listener = Listeners.newListener('onTargetReady', () => {\n      this.addEvents(this.target);\n    });\n    this.listeners.add(listener);\n  }\n\n  /**\n   * Function called when the content submits an action.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  notifyWindowClosed() {\n    // Nothing.\n  }\n\n  /**\n   * Wrapper.\n   * Extracts mathml of a determined text node. This function is used as a wrapper inside core.js\n   * in order to get mathml from a text node that can contain normal LaTeX or other chosen text.\n   * @param {string} textNode - text node to extract the MathML.\n   * @param {int} caretPosition - caret position inside the text node.\n   * @returns {string} MathML inside the text node.\n   */\n\n  // eslint-disable-next-line class-methods-use-this, no-unused-vars\n  getMathmlFromTextNode(textNode, caretPosition) {}\n\n  /**\n   * Wrapper\n   * It fills wrs event object of nonLatex with the desired data.\n   * @param {Object} event - event object.\n   * @param {Object} window dom window object.\n   * @param {string} mathml valid mathml.\n   */\n  // eslint-disable-next-line class-methods-use-this, no-unused-vars\n  fillNonLatexNode(event, window, mathml) {}\n\n  /**\n    Wrapper.\n   * Returns selected item from the target.\n   * @param {HTMLElement} target - target element\n   * @param {boolean} iframe\n   */\n  // eslint-disable-next-line class-methods-use-this, no-unused-vars\n  getSelectedItem(target, isIframe) {}\n\n  // Set temporal image to null and make focus come back.\n  static setActionsOnCancelButtons() {\n\n    // Make focus come back on the previous place it was when click cancel button\n    const currentInstance = WirisPlugin.currentInstance;\n    const editorSelection = currentInstance.getSelection();\n    editorSelection.removeAllRanges();\n\n    if (currentInstance.core.editionProperties.range) {\n      const { range } = currentInstance.core.editionProperties;\n      currentInstance.core.editionProperties.range = null;\n      editorSelection.addRange(range);\n      if (range.startOffset !== range.endOffset) {\n        currentInstance.core.placeCaretAfterNode(currentInstance.core.editionProperties.temporalImage);\n      }\n    }\n\n    // eslint-disable-next-line no-undef\n    if (WirisPlugin.currentInstance) {\n      WirisPlugin.currentInstance.core.editionProperties.temporalImage = null; // eslint-disable-line\n    }\n  }\n}\n\n// To know if the integration that extends this class implements\n// wrapper methods, they are set as undefined.\nIntegrationModel.prototype.getMathmlFromTextNode = undefined;\nIntegrationModel.prototype.fillNonLatexNode = undefined;\nIntegrationModel.prototype.getSelectedItem = undefined;\n\n/**\n * An object containing a list with the overwritable class constructor properties.\n * @type {Object}\n */\nIntegrationModel.integrationParameters = ['serviceProviderProperties', 'editorParameters'];\n", "import IntegrationModel from '@wiris/mathtype-html-integration-devkit/src/integrationmodel';\nimport Util from '@wiris/mathtype-html-integration-devkit/src/util';\nimport Configuration from '@wiris/mathtype-html-integration-devkit/src/configuration';\nimport Latex from '@wiris/mathtype-html-integration-devkit/src/latex';\nimport MathML from '@wiris/mathtype-html-integration-devkit/src/mathml';\nimport Telemeter from '@wiris/mathtype-html-integration-devkit/src/telemeter';\n\n/**\n * This class represents the MathType integration for CKEditor5.\n * @extends {IntegrationModel}\n */\nexport default class CKEditor5Integration extends IntegrationModel {\n  constructor(ckeditorIntegrationModelProperties) {\n    const editor = ckeditorIntegrationModelProperties.editorObject;\n\n    if (typeof editor.config !== 'undefined' && typeof editor.config.get('mathTypeParameters') !== 'undefined') {\n      ckeditorIntegrationModelProperties.integrationParameters = editor.config.get('mathTypeParameters');\n    }\n    /**\n         * CKEditor5 Integration.\n         *\n         * @param {integrationModelProperties} integrationModelAttributes\n         */\n    super(ckeditorIntegrationModelProperties);\n\n    /**\n     * Folder name used for the integration inside CKEditor plugins folder.\n     */\n    this.integrationFolderName = 'ckeditor_wiris';\n  }\n\n  /**\n     * @inheritdoc\n     * @returns {string} - The CKEditor instance language.\n     * @override\n     */\n  getLanguage() {\n    // Returns the CKEDitor instance language taking into account that the language can be an object.\n    // Try to get editorParameters.language, fail silently otherwise\n    try {\n      return this.editorParameters.language;\n    } catch (e) {}\n    const languageObject = this.editorObject.config.get('language');\n    if (languageObject != null) {\n      if (typeof (languageObject) === 'object') {\n        // eslint-disable-next-line no-prototype-builtins\n        if (languageObject.hasOwnProperty('ui')) {\n          return languageObject.ui;\n        } return languageObject;\n      }\n      return languageObject;\n    }\n    return super.getLanguage();\n  }\n\n  /**\n     * Adds callbacks to the following CKEditor listeners:\n     * - 'focus' - updates the current instance.\n     * - 'contentDom' - adds 'doubleclick' callback.\n     * - 'doubleclick' - sets to null data.dialog property to avoid modifications for MathType formulas.\n     * - 'setData' - parses the data converting MathML into images.\n     * - 'afterSetData' - adds an observer to MathType formulas to avoid modifications.\n     * - 'getData' - parses the data converting images into selected save mode (MathML by default).\n     * - 'mode' - recalculates the active element.\n     */\n  addEditorListeners() {\n    const editor = this.editorObject;\n\n    if (typeof editor.config.wirislistenersdisabled === 'undefined'\n      || !editor.config.wirislistenersdisabled) {\n      this.checkElement();\n    }\n  }\n\n  /**\n     * Checks the current container and assign events in case that it doesn't have them.\n     * CKEditor replaces several times the element element during its execution,\n     * so we must assign the events again to editor element.\n     */\n  checkElement() {\n    const editor = this.editorObject;\n    const newElement = editor.sourceElement;\n\n    // If the element wasn't treated, add the events.\n    if (!newElement.wirisActive) {\n      this.setTarget(newElement);\n      this.addEvents();\n      // Set the element as treated\n      newElement.wirisActive = true;\n    }\n  }\n\n  /**\n     * @inheritdoc\n     * @param {HTMLElement} element - HTMLElement target.\n     * @param {MouseEvent} event - event which trigger the handler.\n     */\n  doubleClickHandler(element, event) {\n    this.core.editionProperties.dbclick = true;\n    if (this.editorObject.isReadOnly === false) {\n      if (element.nodeName.toLowerCase() === 'img') {\n        if (Util.containsClass(element, Configuration.get('imageClassName'))) {\n          // Some plugins (image2, image) open a dialog on Double-click. On formulas\n          // doubleclick event ends here.\n          if (typeof event.stopPropagation !== 'undefined') { // old I.E compatibility.\n            event.stopPropagation();\n          } else {\n            event.returnValue = false;\n          }\n          this.core.getCustomEditors().disable();\n          const customEditorAttr = element.getAttribute(Configuration.get('imageCustomEditorName'));\n          if (customEditorAttr) {\n            this.core.getCustomEditors().enable(customEditorAttr);\n          }\n          this.core.editionProperties.temporalImage = element;\n          this.openExistingFormulaEditor();\n        }\n      }\n    }\n  }\n\n  /** @inheritdoc */\n  static getCorePath() {\n    return null; // TODO\n  }\n\n  /** @inheritdoc */\n  callbackFunction() {\n    super.callbackFunction();\n    this.addEditorListeners();\n  }\n\n  openNewFormulaEditor() {\n    // Store the editor selection as it will be lost upon opening the modal\n    this.core.editionProperties.selection = this.editorObject.editing.view.document.selection;\n\n    return super.openNewFormulaEditor();\n  }\n\n  /**\n     * Replaces old formula with new MathML or inserts it in caret position if new\n     * @param {String} mathml MathML to update old one or insert\n     * @returns {module:engine/model/element~Element} The model element corresponding to the inserted image\n     */\n  insertMathml(mathml) {\n    // This returns the value returned by the callback function (writer => {...})\n    return this.editorObject.model.change((writer) => {\n      const core = this.getCore();\n      const selection = this.editorObject.model.document.selection;\n\n      const modelElementNew = writer.createElement('mathml', {\n        formula: mathml,\n        ...Object.fromEntries(selection.getAttributes()), // To keep the format, such as style and font\n      });\n\n      // Obtain the DOM <span><img ... /></span> object corresponding to the formula\n      if (core.editionProperties.isNewElement) {\n        // Don't bother inserting anything at all if the MathML is empty.\n        if (!mathml) return;\n\n        const viewSelection = this.core.editionProperties.selection || this.editorObject.editing.view.document.selection;\n        const modelPosition = this.editorObject.editing.mapper.toModelPosition(viewSelection.getLastPosition());\n\n        this.editorObject.model.insertObject(modelElementNew, modelPosition);\n\n        // Remove selection\n        if (!viewSelection.isCollapsed) {\n          for (const range of viewSelection.getRanges()) {\n            writer.remove(this.editorObject.editing.mapper.toModelRange(range));\n          }\n        }\n\n        // Set carret after the formula\n        const position = this.editorObject.model.createPositionAfter(modelElementNew);\n        writer.setSelection(position);\n      } else {\n        const img = core.editionProperties.temporalImage;\n        const viewElement = this.editorObject.editing.view.domConverter.domToView(img).parent;\n        const modelElementOld = this.editorObject.editing.mapper.toModelElement(viewElement);\n\n        // Insert the new <mathml> and remove the old one\n        const position = this.editorObject.model.createPositionBefore(modelElementOld);\n\n        // If the given MathML is empty, don't insert a new formula.\n        if (mathml) {\n          this.editorObject.model.insertObject(modelElementNew, position);\n        }\n        writer.remove(modelElementOld);\n      }\n\n      // eslint-disable-next-line consistent-return\n      return modelElementNew;\n    });\n  }\n\n  /**\n     * Finds the text node corresponding to given DOM text element.\n     * @param {element} viewElement Element to find corresponding text node of.\n     * @returns {module:engine/model/text~Text|undefined} Text node corresponding to the given element or undefined if it doesn't exist.\n     */\n  findText(viewElement) { // eslint-disable-line consistent-return\n    // mapper always converts text nodes to *new* model elements so we need to convert the text's parents and then come back down\n    let pivot = viewElement;\n    let element;\n    while (!element) {\n      element = this.editorObject.editing.mapper.toModelElement(\n        this.editorObject.editing.view.domConverter.domToView(\n          pivot,\n        ),\n      );\n      pivot = pivot.parentElement;\n    }\n\n    // Navigate through all the subtree under `pivot` in order to find the correct text node\n    const range = this.editorObject.model.createRangeIn(element);\n    const descendants = Array.from(range.getItems());\n    for (const node of descendants) {\n      let viewElementData = viewElement.data;\n      if (viewElement.nodeType === 3) {\n        // Remove invisible white spaces\n        viewElementData = viewElementData.replaceAll(String.fromCharCode(8288), '')\n      }\n      if (node.is('textProxy') && node.data === viewElementData.replace(String.fromCharCode(160), ' ')) {\n        return node.textNode;\n      }\n    }\n  }\n\n  /** @inheritdoc */\n  insertFormula(focusElement, windowTarget, mathml, wirisProperties) { // eslint-disable-line no-unused-vars\n    const returnObject = {};\n\n    let mathmlOrigin;\n    if (!mathml) {\n      this.insertMathml('');\n    } else if (this.core.editMode === 'latex') {\n      returnObject.latex = Latex.getLatexFromMathML(mathml);\n      returnObject.node = windowTarget.document.createTextNode(`$$${returnObject.latex}$$`);\n\n      this.editorObject.model.change((writer) => {\n        const { latexRange } = this.core.editionProperties;\n\n        const startNode = this.findText(latexRange.startContainer);\n        const endNode = this.findText(latexRange.endContainer);\n\n        let startPosition = writer.createPositionAt(startNode.parent, startNode.startOffset + latexRange.startOffset);\n        let endPosition = writer.createPositionAt(endNode.parent, endNode.startOffset + latexRange.endOffset);\n\n        let range = writer.createRange(\n          startPosition,\n          endPosition,\n        );\n\n\n\n        // When Latex is next to image/formula.\n        if (latexRange.startContainer.nodeType === 3 && latexRange.startContainer.previousSibling?.nodeType === 1) {\n          // Get the position of the latex to be replaced.\n          let latexEdited = '$$' +(Latex.getLatexFromMathML(MathML.safeXmlDecode(this.core.editionProperties.temporalImage.dataset.mathml))) + '$$';\n          let data = latexRange.startContainer.data;\n\n          // Remove invisible characters.\n          data = data.replaceAll(String.fromCharCode(8288), '')\n\n          // Get to the start of the latex we are editing.\n          let offset = data.indexOf(latexEdited);\n          let dataOffset = data.substring(offset);\n          let second$ = dataOffset.substring(2).indexOf(\"$$\") + 4;\n          let substring = dataOffset.substr(0, second$);\n          data = data.replace(substring, '');\n\n          if (!data) {\n            startPosition = writer.createPositionBefore(startNode);\n            range = startNode;\n          } else {\n            startPosition = startPosition = writer.createPositionAt(startNode.parent, startNode.startOffset + offset);\n            endPosition = writer.createPositionAt(endNode.parent, endNode.startOffset + second$ + offset);\n            range = writer.createRange(\n              startPosition,\n              endPosition,\n            );\n          }\n        }\n\n        writer.remove(range);\n        writer.insertText(`$$${returnObject.latex}$$`, startNode.getAttributes(), startPosition);\n      });\n    } else {\n      mathmlOrigin = this.core.editionProperties.temporalImage?.dataset.mathml;\n      try {\n        returnObject.node = this.editorObject.editing.view.domConverter.viewToDom(\n          this.editorObject.editing.mapper.toViewElement(\n            this.insertMathml(mathml),\n          ), windowTarget.document,\n        );\n      } catch (e) {\n        const x = e.toString();\n        if ((x).includes(\"CKEditorError: Cannot read property 'parent' of undefined\")) {\n          this.core.modalDialog.cancelAction();\n        }\n      }\n    }\n\n    // Build the telemeter payload separated to delete null/undefined entries.\n    let payload = {\n      mathml_origin: mathmlOrigin ? MathML.safeXmlDecode(mathmlOrigin) : mathmlOrigin,\n      mathml: mathml ? MathML.safeXmlDecode(mathml) : mathml,\n      elapsed_time: Date.now() - this.core.editionProperties.editionStartTime,\n      editor_origin: null, // TODO read formula to find out whether it comes from Oxygen Desktop\n      toolbar: this.core.modalDialog.contentManager.toolbar,\n      size: mathml?.length,\n    };\n\n    // Remove desired null keys.\n    Object.keys(payload).forEach(key => {\n      if (key === 'mathml_origin' || key === 'editor_origin') !payload[key] ? delete payload[key] : {}\n    });\n\n    try {\n      Telemeter.telemeter.track(\"INSERTED_FORMULA\", {\n        ...payload,\n      });\n    } catch (err) {\n      console.error(err);\n    }\n\n    /* Due to PLUGINS-1329, we add the onChange event to the CK4 insertFormula.\n        We probably should add it here as well, but we should look further into how */\n    // this.editorObject.fire('change');\n\n    // Remove temporal image of inserted formula\n    this.core.editionProperties.temporalImage = null;\n\n    return returnObject;\n  }\n\n  /**\n     * Function called when the content submits an action.\n     */\n  notifyWindowClosed() {\n    this.editorObject.editing.view.focus();\n  }\n}\n", "/* eslint-disable max-classes-per-file */\nimport Command from '@ckeditor/ckeditor5-core/src/command';\nimport CKEditor5Integration from './integration';\n\n/**\n * Command for opening the MathType editor\n */\nexport class MathTypeCommand extends Command {\n  execute(options = {}) {\n    // Check we get a valid integration\n    // eslint-disable-next-line no-prototype-builtins\n    if (!options.hasOwnProperty('integration') || !(options.integration instanceof CKEditor5Integration)) {\n      throw 'Must pass a valid CKEditor5Integration instance as attribute \"integration\" of options';\n    }\n\n    // Save the integration instance as a property of the command.\n    this.integration = options.integration;\n\n    // Set custom editor or disable it\n    this.setEditor();\n\n    // Open the editor\n    this.openEditor();\n  }\n\n  /**\n     * Sets the appropriate custom editor, if any, or disables them.\n     */\n  setEditor() {\n    // It's possible that a custom editor was last used.\n    // We need to disable it to avoid wrong behaviors.\n    this.integration.core.getCustomEditors().disable();\n  }\n\n  /**\n     * Checks whether we are editing an existing formula or a new one and opens the editor.\n     */\n  openEditor() {\n    this.integration.core.editionProperties.dbclick = false;\n    const image = this._getSelectedImage();\n    if (typeof image !== 'undefined' && image !== null && image.classList.contains(WirisPlugin.Configuration.get('imageClassName'))) {\n      this.integration.core.editionProperties.temporalImage = image;\n      this.integration.openExistingFormulaEditor();\n    } else {\n      this.integration.openNewFormulaEditor();\n    }\n  }\n\n  /**\n     * Gets the currently selected formula image\n     * @returns {Element} selected image, if any, undefined otherwise\n     */\n  _getSelectedImage() {\n    const { selection } = this.editor.editing.view.document;\n\n    // If we can not extract the formula, fall back to default behavior.\n    if (selection.isCollapsed || selection.rangeCount !== 1) {\n      return;\n    }\n\n    // Look for the <span> wrapping the formula and then for the <img/> inside\n\n    const range = selection.getFirstRange();\n\n    let image;\n\n    for (const span of range) {\n      if (span.item.name !== 'span') {\n        return;\n      }\n      image = span.item.getChild(0);\n      break;\n    }\n\n    if (!image) {\n      return;\n    }\n\n    // eslint-disable-next-line consistent-return\n    return this.editor.editing.view.domConverter.mapViewToDom(image);\n  }\n}\n\n/**\n * Command for opening the ChemType editor\n */\nexport class ChemTypeCommand extends MathTypeCommand {\n  setEditor() {\n    this.integration.core.getCustomEditors().enable('chemistry');\n  }\n}\n", "// CKEditor imports\nimport Plugin from '@ckeditor/ckeditor5-core/src/plugin';\nimport ButtonView from '@ckeditor/ckeditor5-ui/src/button/buttonview';\nimport ClickObserver from '@ckeditor/ckeditor5-engine/src/view/observer/clickobserver';\nimport HtmlDataProcessor from '@ckeditor/ckeditor5-engine/src/dataprocessor/htmldataprocessor';\nimport XmlDataProcessor from '@ckeditor/ckeditor5-engine/src/dataprocessor/xmldataprocessor';\nimport UpcastWriter from '@ckeditor/ckeditor5-engine/src/view/upcastwriter';\nimport { toWidget, viewToModelPositionOutsideModelElement } from '@ckeditor/ckeditor5-widget/src/utils';\nimport Widget from '@ckeditor/ckeditor5-widget/src/widget';\n\n// MathType API imports\nimport IntegrationModel from '@wiris/mathtype-html-integration-devkit/src/integrationmodel';\nimport Core from '@wiris/mathtype-html-integration-devkit/src/core.src';\nimport Parser from '@wiris/mathtype-html-integration-devkit/src/parser';\nimport Util from '@wiris/mathtype-html-integration-devkit/src/util';\nimport Image from '@wiris/mathtype-html-integration-devkit/src/image';\nimport Configuration from '@wiris/mathtype-html-integration-devkit/src/configuration';\nimport Listeners from '@wiris/mathtype-html-integration-devkit/src/listeners';\nimport MathML from '@wiris/mathtype-html-integration-devkit/src/mathml';\nimport Latex from '@wiris/mathtype-html-integration-devkit/src/latex';\nimport StringManager from '@wiris/mathtype-html-integration-devkit/src/stringmanager';\n\n// Local imports\nimport { MathTypeCommand, ChemTypeCommand } from './commands';\nimport CKEditor5Integration from './integration';\n\nimport mathIcon from '../theme/icons/formula.svg';\nimport chemIcon from '../theme/icons/chem.svg';\n\nimport packageInfo from '../package.json';\n\nexport let currentInstance = null; // eslint-disable-line import/no-mutable-exports\n\nexport default class MathType extends Plugin {\n  static get requires() {\n    return [Widget];\n  }\n\n  static get pluginName() {\n    return 'MathType';\n  }\n\n  init() {\n    // Create the MathType API Integration object\n    const integration = this._addIntegration();\n    currentInstance = integration;\n\n    // Add the MathType and ChemType commands to the editor\n    this._addCommands();\n\n    // Add the buttons for MathType and ChemType\n    this._addViews(integration);\n\n    // Registers the <mathml> element in the schema\n    this._addSchema();\n\n    // Add the downcast and upcast converters\n    this._addConverters();\n\n    // Expose the WirisPlugin variable to the window\n    this._exposeWiris();\n  }\n\n  /**\n   * Inherited from Plugin class: Executed when CKEditor5 is destroyed\n   */\n  destroy() { // eslint-disable-line class-methods-use-this\n    currentInstance.destroy();\n  }\n\n  /**\n     * Create the MathType API Integration object\n     * @returns {CKEditor5Integration} the integration object\n     */\n  _addIntegration() {\n    const { editor } = this;\n\n    /**\n         * Integration model constructor attributes.\n         * @type {integrationModelProperties}\n         */\n    const integrationProperties = {};\n    integrationProperties.environment = {};\n    integrationProperties.environment.editor = 'CKEditor5';\n    integrationProperties.environment.editorVersion = '5.x';\n    integrationProperties.version = packageInfo.version;\n    integrationProperties.editorObject = editor;\n    integrationProperties.serviceProviderProperties = {};\n    integrationProperties.serviceProviderProperties.URI = 'https://www.wiris.net/demo/plugins/app';\n    integrationProperties.serviceProviderProperties.server = 'java';\n    integrationProperties.target = editor.sourceElement;\n    integrationProperties.scriptName = 'bundle.js';\n    integrationProperties.managesLanguage = true;\n    // etc\n\n    // There are platforms like Drupal that initialize CKEditor but they hide or remove the container element.\n    // To avoid a wrong behaviour, this integration only starts if the workspace container exists.\n    let integration;\n    if (integrationProperties.target) {\n      // Instance of the integration associated to this editor instance\n      integration = new CKEditor5Integration(integrationProperties);\n      integration.init();\n      integration.listeners.fire('onTargetReady', {});\n\n      integration.checkElement();\n\n      this.listenTo(editor.editing.view.document, 'click', (evt, data) => {\n        // Is Double-click\n        if (data.domEvent.detail === 2) {\n          integration.doubleClickHandler(data.domTarget, data.domEvent);\n          evt.stop();\n        }\n      }, { priority: 'highest' });\n    }\n\n    return integration;\n  }\n\n  /**\n     * Add the MathType and ChemType commands to the editor\n     */\n  _addCommands() {\n    const { editor } = this;\n\n    // Add command to open the formula editor\n    editor.commands.add('MathType', new MathTypeCommand(editor));\n\n    // Add command to open the chemistry formula editor\n    editor.commands.add('ChemType', new ChemTypeCommand(editor));\n  }\n\n  /**\n     * Add the buttons for MathType and ChemType\n     * @param {CKEditor5Integration} integration the integration object\n     */\n  _addViews(integration) {\n    const { editor } = this;\n\n    // Check if MathType editor is enabled\n    if (Configuration.get('editorEnabled')) {\n      // Add button for the formula editor\n      editor.ui.componentFactory.add('MathType', (locale) => {\n        const view = new ButtonView(locale);\n\n        // View is enabled iff command is enabled\n        view.bind('isEnabled').to(editor.commands.get('MathType'), 'isEnabled');\n\n        view.set({\n          label: StringManager.get('insert_math', editor.config.get('language')),\n          icon: mathIcon,\n          tooltip: true,\n        });\n\n        // Callback executed once the image is clicked.\n        view.on('execute', () => {\n          editor.execute('MathType', {\n            integration, // Pass integration as parameter\n          });\n        });\n\n        return view;\n      });\n    }\n\n    // Check if ChemType editor is enabled\n    if (Configuration.get('chemEnabled')) {\n      // Add button for the chemistry formula editor\n      editor.ui.componentFactory.add('ChemType', (locale) => {\n        const view = new ButtonView(locale);\n\n        // View is enabled iff command is enabled\n        view.bind('isEnabled').to(editor.commands.get('ChemType'), 'isEnabled');\n\n        view.set({\n          label: StringManager.get('insert_chem', editor.config.get('language')),\n          icon: chemIcon,\n          tooltip: true,\n        });\n\n        // Callback executed once the image is clicked.\n        view.on('execute', () => {\n          editor.execute('ChemType', {\n            integration, // Pass integration as parameter\n          });\n        });\n\n        return view;\n      });\n    }\n\n    // Observer for the Double-click event\n    editor.editing.view.addObserver(ClickObserver);\n  }\n\n  /**\n     * Registers the <mathml> element in the schema\n     */\n  _addSchema() {\n    const { schema } = this.editor.model;\n\n    schema.register('mathml', {\n      inheritAllFrom: '$inlineObject',\n      allowAttributes: ['formula'],\n    });\n  }\n\n  /**\n     * Add the downcast and upcast converters\n     */\n  _addConverters() {\n    const { editor } = this;\n\n    // Editing view -> Model\n    editor.conversion.for('upcast').elementToElement({\n      view: {\n        name: 'span',\n        classes: 'ck-math-widget',\n      },\n      model: (viewElement, { writer: modelWriter }) => {\n        const formula = MathML.safeXmlDecode(viewElement.getChild(0).getAttribute('data-mathml'));\n        return modelWriter.createElement('mathml', {\n          formula,\n        });\n      },\n    });\n\n    // Data view -> Model\n    editor.data.upcastDispatcher.on('element:math', (evt, data, conversionApi) => {\n      const { consumable, writer } = conversionApi;\n      const { viewItem } = data;\n\n      // When element was already consumed then skip it.\n      if (!consumable.test(viewItem, { name: true })) {\n        return;\n      }\n\n      // If we encounter any <math> with a LaTeX annotation inside,\n      // convert it into a \"$$...$$\" string.\n      const isLatex = mathIsLatex(viewItem); // eslint-disable-line no-use-before-define\n\n      // Get the formula of the <math> (which is all its children).\n      const processor = new XmlDataProcessor(editor.editing.view.document);\n\n      // Only god knows why the following line makes viewItem lose all of its children,\n      // so we obtain isLatex before doing this because we need viewItem's children for that.\n      const upcastWriter = new UpcastWriter(editor.editing.view.document);\n      const viewDocumentFragment = upcastWriter.createDocumentFragment(viewItem.getChildren());\n\n      // and obtain the attributes of <math> too!\n      const mathAttributes = [...viewItem.getAttributes()]\n        .map(([key, value]) => ` ${key}=\"${value}\"`)\n        .join('');\n\n      // We process the document fragment\n      let formula = processor.toData(viewDocumentFragment) || '';\n\n      // And obtain the complete formula\n      formula = Util.htmlSanitize(`<math${mathAttributes}>${formula}</math>`);\n\n      // Replaces the < & > characters to its HTMLEntity to avoid render issues.\n      formula = formula.replaceAll('\"<\"', '\"&lt;\"')\n        .replaceAll('\">\"', '\"&gt;\"')\n        .replaceAll('><<', '>&lt;<');\n\n\n      /* Model node that contains what's going to actually be inserted. This can be either:\n            - A <mathml> element with a formula attribute set to the given formula, or\n            - If the original <math> had a LaTeX annotation, then the annotation surrounded by \"$$...$$\" */\n      const modelNode = isLatex\n        ? writer.createText(Parser.initParse(formula, editor.config.get('language')))\n        : writer.createElement('mathml', { formula });\n\n      // Find allowed parent for element that we are going to insert.\n      // If current parent does not allow to insert element but one of the ancestors does\n      // then split nodes to allowed parent.\n      const splitResult = conversionApi.splitToAllowedParent(modelNode, data.modelCursor);\n\n      // When there is no split result it means that we can't insert element to model tree, so let's skip it.\n      if (!splitResult) {\n        return;\n      }\n\n      // Insert element on allowed position.\n      conversionApi.writer.insert(modelNode, splitResult.position);\n\n      // Consume appropriate value from consumable values list.\n      consumable.consume(viewItem, { name: true });\n\n      const parts = conversionApi.getSplitParts(modelNode);\n\n      // Set conversion result range.\n      data.modelRange = writer.createRange(\n        conversionApi.writer.createPositionBefore(modelNode),\n        conversionApi.writer.createPositionAfter(parts[parts.length - 1]),\n      );\n\n      // Now we need to check where the `modelCursor` should be.\n      if (splitResult.cursorParent) {\n        // If we split parent to insert our element then we want to continue conversion in the new part of the split parent.\n        //\n        // before: <allowed><notAllowed>foo[]</notAllowed></allowed>\n        // after:  <allowed><notAllowed>foo</notAllowed><converted></converted><notAllowed>[]</notAllowed></allowed>\n\n        data.modelCursor = conversionApi.writer.createPositionAt(splitResult.cursorParent, 0);\n      } else {\n        // Otherwise just continue after inserted element.\n        data.modelCursor = data.modelRange.end;\n      }\n    });\n\n    /**\n         * Whether the given view <math> element has a LaTeX annotation element.\n         * @param {*} math\n         * @returns {bool}\n         */\n    function mathIsLatex(math) {\n      const semantics = math.getChild(0);\n      if (!semantics || semantics.name !== 'semantics') return false;\n      for (const child of semantics.getChildren()) {\n        if (child.name === 'annotation' && child.getAttribute('encoding') === 'LaTeX') {\n          return true;\n        }\n      }\n      return false;\n    }\n\n    function createViewWidget(modelItem, { writer: viewWriter }) {\n      const widgetElement = viewWriter.createContainerElement('span', {\n        class: 'ck-math-widget',\n      });\n\n      const mathUIElement = createViewImage(modelItem, { writer: viewWriter }); // eslint-disable-line no-use-before-define\n\n      if (mathUIElement) {\n        viewWriter.insert(viewWriter.createPositionAt(widgetElement, 0), mathUIElement);\n      }\n\n      return toWidget(widgetElement, viewWriter);\n    }\n\n    function createViewImage(modelItem, { writer: viewWriter }) {\n      const htmlDataProcessor = new HtmlDataProcessor(viewWriter.document);\n\n      const mathString = modelItem.getAttribute('formula').replaceAll('ref=\"<\"', 'ref=\"&lt;\"');\n      const imgHtml = Parser.initParse(mathString, editor.config.get('language'));\n      const imgElement = htmlDataProcessor.toView(imgHtml).getChild(0);\n\n      /* Although we use the HtmlDataProcessor to obtain the attributes,\n            we must create a new EmptyElement which is independent of the\n            DataProcessor being used by this editor instance */\n      if (imgElement) {\n        return viewWriter.createEmptyElement('img', imgElement.getAttributes(), {\n          renderUnsafeAttributes: ['src'],\n        });\n      }\n\n      return null;\n    }\n\n    // Model -> Editing view\n    editor.conversion.for('editingDowncast').elementToElement({\n      model: 'mathml',\n      view: createViewWidget,\n    });\n\n    // Model -> Data view\n    editor.conversion.for('dataDowncast').elementToElement({\n      model: 'mathml',\n      view: createDataString, // eslint-disable-line no-use-before-define\n    });\n\n    /**\n     * Makes a copy of the given view node.\n     * @param {module:engine/view/node~Node} sourceNode Node to copy.\n     * @returns {module:engine/view/node~Node} Copy of the node.\n     */\n    function clone(viewWriter, sourceNode) {\n      if (sourceNode.is('text')) {\n        return viewWriter.createText(sourceNode.data);\n      } if (sourceNode.is('element')) {\n        if (sourceNode.is('emptyElement')) {\n          return viewWriter.createEmptyElement(sourceNode.name, sourceNode.getAttributes());\n        }\n        const element = viewWriter.createContainerElement(sourceNode.name, sourceNode.getAttributes());\n        for (const child of sourceNode.getChildren()) {\n          viewWriter.insert(viewWriter.createPositionAt(element, 'end'), clone(viewWriter, child));\n        }\n        return element;\n      }\n\n      throw new Exception('Given node has unsupported type.'); // eslint-disable-line no-undef\n    }\n\n    function createDataString(modelItem, { writer: viewWriter }) {\n      const htmlDataProcessor = new HtmlDataProcessor(viewWriter.document);\n\n      let mathString = Parser.endParseSaveMode(modelItem.getAttribute('formula'));\n\n      const sourceMathElement = htmlDataProcessor.toView(mathString).getChild(0);\n\n      return clone(viewWriter, sourceMathElement);\n    }\n\n    // This stops the view selection getting into the <span>s and messing up caret movement\n    editor.editing.mapper.on(\n      'viewToModelPosition',\n      viewToModelPositionOutsideModelElement(editor.model, (viewElement) => viewElement.hasClass('ck-math-widget')),\n    );\n\n    // Keep a reference to the original get and set function.\n    const { get, set } = editor.data;\n\n    /**\n     * Hack to transform $$latex$$ into <math> in editor.getData()'s output.\n     */\n    editor.data.get = (options) => {\n      let output = get.bind(editor.data)(options);\n      \n      // CKEditor 5 replaces all the time the &lt; and &gt; for < and >, which our render can't understand.\n      // We replace the values inserted for CKEditro5 to be able to render the formulas with the mentioned characters.\n      output = output.replaceAll('\"<\"', '\"&lt;\"')\n        .replaceAll('\">\"', '\"&gt;\"')\n        .replaceAll('><<', '>&lt;<');\n\n      // Ckeditor retrieves editor data and removes the image information on the formulas\n      // We transform all the retrieved data to images and then we Parse the data.\n      let imageFormula = Parser.initParse(output);\n      return Parser.endParse(imageFormula);\n    };\n\n    /**\n    * Hack to transform <math> with LaTeX into $$LaTeX$$ in editor.setData().\n    */\n    editor.data.set = (data) => {\n      // Retrieve the data to be set on the CKEditor.\n      let modifiedData = data;\n      // Regex to find all mathml formulas.\n      const regexp = /<math(.*?)<\\/math>/gm;\n\n      // Get all MathML formulas and store them in an array.\n      let formulas = [...data.matchAll(regexp)];\n\n      // Loop to find LaTeX formulas and replace the MathML for the LaTeX notation.\n      formulas.forEach((formula) => {\n        let mathml = formula[0];\n        if (mathml.includes('encoding=\"LaTeX\"')) { // LaTeX found.\n          let latex = '$$$' + Latex.getLatexFromMathML(mathml) + '$$$'; // We add $$$ instead of $$ because the replace function ignores one $.\n          modifiedData = modifiedData.replace(mathml, latex);\n        }\n      });\n      \n      // Run the setData code from CKEditor5 with the modified string.\n      set.bind(editor.data)(modifiedData); \n    };  \n  }\n\n  /**\n     * Expose the WirisPlugin variable to the window\n     */\n  // eslint-disable-next-line class-methods-use-this\n  _exposeWiris() {\n    window.WirisPlugin = {\n      Core,\n      Parser,\n      Image,\n      MathML,\n      Util,\n      Configuration,\n      Listeners,\n      IntegrationModel,\n      currentInstance,\n      Latex,\n    };\n  }\n}\n", "{\n  \"name\": \"@wiris/mathtype-ckeditor5\",\n  \"version\": \"8.7.1\",\n  \"description\": \"MathType Web for CKEditor5 editor\",\n  \"keywords\": [\n    \"chem\",\n    \"chemistry\",\n    \"chemtype\",\n    \"ckeditor\",\n    \"ckeditor5\",\n    \"editor\",\n    \"equation\",\n    \"latex\",\n    \"math\",\n    \"mathml\",\n    \"maths\",\n    \"mathtype\",\n    \"wiris\"\n  ],\n  \"repository\": \"https://github.com/wiris/html-integrations/tree/stable/packages/mathtype-ckeditor5\",\n  \"homepage\": \"https://www.wiris.com/\",\n  \"bugs\": {\n    \"email\": \"support@wiris.com\"\n  },\n  \"license\": \"MIT\",\n  \"author\": \"WIRIS Team (http://www.wiris.com)\",\n  \"files\": [\n    \"/src\",\n    \"icons\",\n    \"theme\",\n    \"lang\"\n  ],\n  \"main\": \"src/plugin.js\",\n  \"scripts\": {\n    \"build\": \"exit 0\"\n  },\n  \"dependencies\": {\n    \"@ckeditor/ckeditor5-core\": \">=23.0.0\",\n    \"@ckeditor/ckeditor5-engine\": \">=23.0.0\",\n    \"@ckeditor/ckeditor5-ui\": \">=23.0.0\",\n    \"@ckeditor/ckeditor5-widget\": \">=23.0.0\",\n    \"@wiris/mathtype-html-integration-devkit\": \"1.14.1\"\n  }\n}\n"],
  "mappings": "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,MACA,MACA,QACA,UACA,UACA,MACA,QACA,KACA,OACA,SACA,OACA,OACA,SACA,UACA,MACA,QACA,OACA,QACA,WACA,QACA,YACA,SACA,OACA,QACA,MACA,YACA,UACA,UACA,KACA,WACA,OACA,YACA,KACA,MACA,MACA,QACA,KACA,QACA,WACA,UACA,UACA,SACA,UACA,UACA,QACA,UACA,UACA,SACA,OACA,WACA,OACA,SACA,SACA,MACA,YACA,YACA,SACA,MACA,SACA,QACA,MACA,SACA,MACA,KACA,MACA,OACA,SACA,KArHyB,CAAD;AAyHnB,IAAM8D,QAAM9D,OAAO,CACxB,OACA,KACA,YACA,eACA,gBACA,gBACA,iBACA,oBACA,UACA,YACA,QACA,QACA,WACA,UACA,QACA,KACA,SACA,YACA,SACA,SACA,QACA,kBACA,UACA,QACA,YACA,SACA,QACA,WACA,WACA,YACA,kBACA,QACA,QACA,SACA,UACA,UACA,QACA,YACA,SACA,QACA,SACA,QACA,OA3CwB,CAAD;AA8ClB,IAAM+D,aAAa/D,OAAO,CAC/B,WACA,iBACA,uBACA,eACA,oBACA,qBACA,qBACA,kBACA,WACA,WACA,WACA,WACA,WACA,kBACA,WACA,WACA,eACA,gBACA,YACA,gBACA,sBACA,eACA,UACA,cAxB+B,CAAD;AA+BzB,IAAMgE,gBAAgBhE,OAAO,CAClC,WACA,iBACA,UACA,WACA,gBACA,aACA,oBACA,kBACA,iBACA,iBACA,iBACA,SACA,aACA,QACA,gBACA,aACA,WACA,iBACA,UACA,OACA,cACA,WACA,KAvBkC,CAAD;AA0B5B,IAAMiE,WAASjE,OAAO,CAC3B,QACA,YACA,UACA,WACA,SACA,UACA,MACA,cACA,iBACA,MACA,MACA,SACA,WACA,YACA,SACA,QACA,MACA,UACA,SACA,UACA,QACA,QACA,WACA,UACA,OACA,SACA,OACA,UACA,YA7B2B,CAAD;AAkCrB,IAAMkE,mBAAmBlE,OAAO,CACrC,WACA,eACA,cACA,YACA,aACA,WACA,WACA,UACA,UACA,SACA,aACA,cACA,kBACA,eACA,MAfqC,CAAD;AAkB/B,IAAMmE,OAAOnE,OAAO,CAAC,OAAD,CAAD;ACpRnB,IAAM6D,OAAO7D,OAAO,CACzB,UACA,UACA,SACA,OACA,kBACA,gBACA,wBACA,YACA,cACA,WACA,UACA,WACA,eACA,eACA,WACA,QACA,SACA,SACA,SACA,QACA,WACA,YACA,gBACA,UACA,eACA,YACA,YACA,WACA,OACA,YACA,2BACA,yBACA,YACA,aACA,WACA,gBACA,QACA,OACA,WACA,UACA,UACA,QACA,QACA,YACA,MACA,aACA,aACA,SACA,QACA,SACA,QACA,QACA,WACA,QACA,OACA,OACA,aACA,SACA,UACA,OACA,aACA,YACA,SACA,QACA,SACA,WACA,cACA,UACA,QACA,WACA,WACA,eACA,eACA,UACA,WACA,WACA,cACA,YACA,OACA,YACA,OACA,YACA,QACA,QACA,WACA,cACA,SACA,YACA,SACA,QACA,SACA,QACA,WACA,SACA,OACA,UACA,QACA,SACA,WACA,YACA,SACA,aACA,QACA,UACA,UACA,SACA,SACA,SACA,MA7GyB,CAAD;AAgHnB,IAAM8D,MAAM9D,OAAO,CACxB,iBACA,cACA,YACA,sBACA,UACA,iBACA,iBACA,WACA,iBACA,kBACA,SACA,QACA,MACA,SACA,QACA,iBACA,aACA,aACA,SACA,uBACA,+BACA,iBACA,mBACA,MACA,MACA,KACA,MACA,MACA,mBACA,aACA,WACA,WACA,OACA,YACA,aACA,OACA,QACA,gBACA,aACA,UACA,eACA,eACA,iBACA,eACA,aACA,oBACA,gBACA,cACA,gBACA,eACA,MACA,MACA,MACA,MACA,cACA,YACA,iBACA,qBACA,UACA,QACA,MACA,mBACA,MACA,OACA,KACA,MACA,MACA,MACA,MACA,WACA,aACA,cACA,YACA,QACA,gBACA,kBACA,gBACA,oBACA,kBACA,SACA,cACA,cACA,gBACA,gBACA,eACA,eACA,oBACA,aACA,OACA,QACA,SACA,UACA,QACA,OACA,QACA,cACA,UACA,YACA,WACA,SACA,UACA,eACA,UACA,YACA,eACA,QACA,cACA,uBACA,oBACA,gBACA,UACA,iBACA,uBACA,kBACA,KACA,MACA,MACA,UACA,QACA,QACA,eACA,aACA,WACA,UACA,UACA,SACA,QACA,mBACA,oBACA,oBACA,gBACA,eACA,gBACA,eACA,cACA,gBACA,oBACA,qBACA,kBACA,mBACA,qBACA,kBACA,UACA,gBACA,SACA,gBACA,kBACA,YACA,WACA,WACA,aACA,oBACA,eACA,mBACA,kBACA,cACA,QACA,MACA,MACA,WACA,UACA,WACA,cACA,WACA,cACA,iBACA,iBACA,SACA,gBACA,QACA,gBACA,oBACA,oBACA,KACA,MACA,MACA,SACA,KACA,MACA,MACA,KACA,YAtLwB,CAAD;AAyLlB,IAAMiE,SAASjE,OAAO,CAC3B,UACA,eACA,SACA,YACA,SACA,gBACA,eACA,cACA,cACA,SACA,OACA,WACA,gBACA,YACA,SACA,SACA,UACA,QACA,MACA,WACA,UACA,iBACA,UACA,UACA,kBACA,aACA,YACA,eACA,WACA,WACA,iBACA,YACA,YACA,QACA,YACA,YACA,cACA,WACA,UACA,UACA,eACA,iBACA,wBACA,aACA,aACA,cACA,YACA,kBACA,kBACA,aACA,WACA,SACA,OArD2B,CAAD;AAwDrB,IAAMoE,MAAMpE,OAAO,CACxB,cACA,UACA,eACA,aACA,aALwB,CAAD;AChWlB,IAAMqE,gBAAgBpE,KAAK,2BAAD;AAC1B,IAAMqE,WAAWrE,KAAK,uBAAD;AACrB,IAAMsE,cAActE,KAAK,eAAD;AACxB,IAAMuE,YAAYvE,KAAK,4BAAD;AACtB,IAAMwE,YAAYxE,KAAK,gBAAD;AACtB,IAAMyE,iBAAiBzE;EAC5B;;AADgC;AAG3B,IAAM0E,oBAAoB1E,KAAK,uBAAD;AAC9B,IAAM2E,kBAAkB3E;EAC7B;;AADiC;AAG5B,IAAM4E,eAAe5E,KAAK,SAAD;ACMhC,IAAM6E,YAAY,SAAZA,aAAY;AAAA,SAAO,OAAOC,WAAW,cA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",
  "names": ["userAgent", "a", "b", "a", "b", "k", "spy", "event", "value", "count", "defaultEmitterClass", "code", "modifiers", "code", "keyCodes", "code", "Class", "wait", "isStringArray", "clone", "svg", "text", "Node", "document", "Node", "document", "Node", "document", "count", "normalize", "document", "Node", "document", "getFillerOffset", "document", "first", "Node", "document", "count", "normalize", "document", "html", "currentNode", "domNode", "document", "document", "document", "hasOwnProperty", "Object", "setPrototypeOf", "isFrozen", "getPrototypeOf", "getOwnPropertyDescriptor", "freeze", "seal", "create", "Reflect", "apply", "construct", "fun", "thisValue", "args", "x", "Func", "arrayForEach", "unapply", "Array", "prototype", "forEach", "arrayPop", "pop", "arrayPush", "push", "stringToLowerCase", "String", "toLowerCase", "stringToString", "toString", "stringMatch", "match", "stringReplace", "replace", "stringIndexOf", "indexOf", "stringTrim", "trim", "regExpTest", "RegExp", "test", "typeErrorCreate", "unconstruct", "TypeError", "func", "thisArg", "addToSet", "set", "array", "transformCaseFunc", "l", "length", "element", "lcElement", "clone", "object", "newObject", "property", "lookupGetter", "prop", "desc", "get", "value", "fallbackValue", "console", "warn", "html", "svg", "svgFilters", "svgDisallowed", "mathMl", "mathMlDisallowed", "text", "xml", "MUSTACHE_EXPR", "ERB_EXPR", "TMPLIT_EXPR", "DATA_ATTR", "ARIA_ATTR", "IS_ALLOWED_URI", "IS_SCRIPT_OR_DATA", "ATTR_WHITESPACE", "DOCTYPE_NAME", "getGlobal", "window", "_createTrustedTypesPolicy", "trustedTypes", "document", "createPolicy", "suffix", "ATTR_NAME", "currentScript", "hasAttribute", "getAttribute", "policyName", "createHTML", "createScriptURL", "scriptUrl", "_", "createDOMPurify", "DOMPurify", "root", "version", "VERSION", "removed", "nodeType", "isSupported", "originalDocument", "DocumentFragment", "HTMLTemplateElement", "Node", "Element", "NodeFilter", "NamedNodeMap", "MozNamedAttrMap", "HTMLFormElement", "DOMParser", "ElementPrototype", "cloneNode", "getNextSibling", "getChildNodes", "getParentNode", "template", "createElement", "content", "ownerDocument", "trustedTypesPolicy", "emptyHTML", "implementation", "createNodeIterator", "createDocumentFragment", "getElementsByTagName", "importNode", "documentMode", "hooks", "createHTMLDocument", "undefined", "EXPRESSIONS", "ALLOWED_TAGS", "DEFAULT_ALLOWED_TAGS", "TAGS", "ALLOWED_ATTR", "DEFAULT_ALLOWED_ATTR", "ATTRS", "CUSTOM_ELEMENT_HANDLING", "tagNameCheck", "writable", "configurable", "enumerable", "attributeNameCheck", "allowCustomizedBuiltInElements", "FORBID_TAGS", "FORBID_ATTR", "ALLOW_ARIA_ATTR", "ALLOW_DATA_ATTR", "ALLOW_UNKNOWN_PROTOCOLS", "ALLOW_SELF_CLOSE_IN_ATTR", "SAFE_FOR_TEMPLATES", "WHOLE_DOCUMENT", "SET_CONFIG", "FORCE_BODY", "RETURN_DOM", "RETURN_DOM_FRAGMENT", "RETURN_TRUSTED_TYPE", "SANITIZE_DOM", "SANITIZE_NAMED_PROPS", "SANITIZE_NAMED_PROPS_PREFIX", "KEEP_CONTENT", "IN_PLACE", "USE_PROFILES", "FORBID_CONTENTS", "DEFAULT_FORBID_CONTENTS", "DATA_URI_TAGS", "DEFAULT_DATA_URI_TAGS", "URI_SAFE_ATTRIBUTES", "DEFAULT_URI_SAFE_ATTRIBUTES", "MATHML_NAMESPACE", "SVG_NAMESPACE", "HTML_NAMESPACE", "NAMESPACE", "IS_EMPTY_INPUT", "ALLOWED_NAMESPACES", "DEFAULT_ALLOWED_NAMESPACES", "PARSER_MEDIA_TYPE", "SUPPORTED_PARSER_MEDIA_TYPES", "DEFAULT_PARSER_MEDIA_TYPE", "CONFIG", "formElement", "isRegexOrFunction", "testValue", "Function", "_parseConfig", "cfg", "ADD_URI_SAFE_ATTR", "ADD_DATA_URI_TAGS", "ALLOWED_URI_REGEXP", "ADD_TAGS", "ADD_ATTR", "table", "tbody", "MATHML_TEXT_INTEGRATION_POINTS", "HTML_INTEGRATION_POINTS", "COMMON_SVG_AND_HTML_ELEMENTS", "ALL_SVG_TAGS", "ALL_MATHML_TAGS", "_checkValidNamespace", "parent", "tagName", "namespaceURI", "parentTagName", "Boolean", "_forceRemove", "node", "parentNode", "removeChild", "outerHTML", "remove", "_removeAttribute", "name", "attribute", "getAttributeNode", "from", "removeAttribute", "setAttribute", "_initDocument", "dirty", "doc", "leadingWhitespace", "matches", "dirtyPayload", "parseFromString", "documentElement", "createDocument", "innerHTML", "body", "insertBefore", "createTextNode", "childNodes", "call", "_createIterator", "SHOW_ELEMENT", "SHOW_COMMENT", "SHOW_TEXT", "_isClobbered", "elm", "nodeName", "textContent", "attributes", "hasChildNodes", "_isNode", "_executeHook", "entryPoint", "currentNode", "data", "hook", "_sanitizeElements", "allowedTags", "firstElementChild", "_basicCustomElementTest", "childCount", "i", "_isValidAttribute", "lcTag", "lcName", "_sanitizeAttributes", "attr", "hookEvent", "attrName", "attrValue", "keepAttr", "allowedAttributes", "forceKeepAttr", "getAttributeType", "setAttributeNS", "_sanitizeShadowDOM", "fragment", "shadowNode", "shadowIterator", "nextNode", "sanitize", "importedNode", "oldNode", "returnNode", "toStaticHTML", "appendChild", "firstChild", "nodeIterator", "shadowroot", "shadowrootmod", "serializedHTML", "doctype", "setConfig", "clearConfig", "isValidAttribute", "tag", "addHook", "hookFunction", "removeHook", "removeHooks", "removeAllHooks", "text", "eventObject", "text", "html", "code", "img", "svg", "first", "code", "ptr", "code", "module", "arg0", "arg1", "module", "Telemeter", "Telemeter", "text", "isAndroid", "Telemeter", "client", "first", "Telemeter", "Telemeter", "userAgent", "window", "currentInstance", "_a", "Telemeter", "clone"]
}
